<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Dreamhack-rev-basic-8 문제 풀이 - TouBVa </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="rev-basic-8 문제 풀이- Dreamhack-rev-basic-8 문제 풀이"> <meta name="keywords" content="Dreamhack-rev-basic-8 문제 풀이, TouBVa, reversing,reversing"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="TouBVa" property="og:site_name" /> <meta content="Dreamhack-rev-basic-8 문제 풀이" property="og:title" /> <meta content="article" property="og:type" /> <meta content="rev-basic-8 문제 풀이" property="og:description" /> <meta content="https://touBVa.github.io/blog/reversing/2024-12-01-rev-basic-8" property="og:url" /> <meta content="2024-12-01T01:00:00-06:00" property="article:published_time" /> <meta content="https://touBVa.github.io/about/" property="article:author" /> <meta content="https://touBVa.github.io/assets/img/posts/2024-12-01-rev-basic-8/Untitled.png" property="og:image" /> <meta content="reversing" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Dreamhack-rev-basic-8 문제 풀이" /> <meta name="twitter:url" content="https://touBVa.github.io/blog/reversing/2024-12-01-rev-basic-8" /> <meta name="twitter:description" content="rev-basic-8 문제 풀이" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/css/main.css" /> <!-- <link rel="stylesheet" href="https://touBVa.github.io/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="https://touBVa.github.io/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'https://touBVa.github.io' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="https://touBVa.github.io/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="https://touBVa.github.io/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="https://touBVa.github.io/assets/js/search.js"></script> <script src="https://touBVa.github.io/assets/js/on-scroll-progress.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark nav-down" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">TouBVa</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/contact" >Contact</a > </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/styleguide"> Styleguide </a> </li> --> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <!-- <li class="nav-item" style="margin-top:5px; padding-right:20px;" > <a class="header__checkout snipcart-checkout"> <svg width="31" height="27" viewBox="0 0 31 27" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M1.10512 0.368718C0.560256 0.368718 0.118164 0.812066 0.118164 1.35848C0.118164 1.9049 0.560256 2.34824 1.10512 2.34824H4.90887L8.30138 18.4009C8.43503 19.0053 8.83085 19.5079 9.32946 19.5041H25.7788C26.3005 19.5118 26.7799 19.0375 26.7799 18.5143C26.7799 17.9911 26.3006 17.5168 25.7788 17.5245H10.1315L9.71003 15.545H27.095C27.5371 15.5412 27.9547 15.2048 28.0511 14.7718L30.354 4.87412C30.4825 4.29933 29.9852 3.67172 29.3979 3.66786H7.21171L6.6771 1.15221C6.58329 0.71276 6.15921 0.368652 5.7107 0.368652L1.10512 0.368718ZM7.623 5.64746H12.7634L13.2569 8.61674H8.25005L7.623 5.64746ZM14.7785 5.64746H20.9881L20.4946 8.61674H15.2719L14.7785 5.64746ZM23.0031 5.64746H28.1537L27.4649 8.61674H22.5097L23.0031 5.64746ZM8.67181 10.5963H13.5862L14.0797 13.5656H9.29919L8.67181 10.5963ZM15.6009 10.5963H20.1656L19.6721 13.5656H16.0944L15.6009 10.5963ZM22.1807 10.5963H27.0023L26.3135 13.5656H21.6872L22.1807 10.5963ZM12.6197 20.164C10.8141 20.164 9.32979 21.6525 9.32979 23.4632C9.32979 25.2739 10.8141 26.7624 12.6197 26.7624C14.4252 26.7624 15.9095 25.2739 15.9095 23.4632C15.9095 21.6525 14.4252 20.164 12.6197 20.164ZM22.4892 20.164C20.6837 20.164 19.1994 21.6525 19.1994 23.4632C19.1994 25.2739 20.6837 26.7624 22.4892 26.7624C24.2948 26.7624 25.7791 25.2739 25.7791 23.4632C25.7791 21.6525 24.2948 20.164 22.4892 20.164ZM12.6197 22.1435C13.3586 22.1435 13.9356 22.7222 13.9356 23.4632C13.9356 24.2042 13.3586 24.7829 12.6197 24.7829C11.8807 24.7829 11.3037 24.2042 11.3037 23.4632C11.3037 22.7222 11.8807 22.1435 12.6197 22.1435ZM22.4892 22.1435C23.2282 22.1435 23.8052 22.7222 23.8052 23.4632C23.8052 24.2042 23.2282 24.7829 22.4892 24.7829C21.7503 24.7829 21.1733 24.2042 21.1733 23.4632C21.1733 22.7222 21.7503 22.1435 22.4892 22.1435Z" fill="#ff7901" class="header__checkout-fill"></path> </svg> <span class="snipcart-items-count"></span> <span class="snipcart-total-price"></span> </a> </li> --> <script type="text/javascript"> var didScroll; var lastScrollTop = 0; var delta = 5; var navbarHeight = document.querySelector('#topNav').offsetHeight; window.addEventListener('scroll', function(event) { didScroll = true; }); setInterval(function() { if (didScroll) { hasScrolled(); didScroll = false; } }, 250); function hasScrolled() { var st = window.pageYOffset || document.documentElement.scrollTop; if (Math.abs(lastScrollTop - st) <= delta) return; var nav = document.querySelector('#topNav'); var prog = document.querySelector('#progress-bar'); if (st > lastScrollTop && st > navbarHeight) { nav.classList.remove('nav-down'); nav.classList.add('nav-up'); prog.classList.remove('toDown'); prog.classList.add('toUp'); } else { if (st < lastScrollTop) { nav.classList.remove('nav-up'); nav.classList.add('nav-down'); prog.classList.remove('toUp'); prog.classList.add('toDown'); } } lastScrollTop = st; } </script> <!-- <li class="nav-item"> <input class="nav-link switch theme-toggle" type="checkbox" name="checkbox" /> </li> --> </ul> </nav> <div id="progress-bar"></div> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Dreamhack-rev-basic-8 문제 풀이</h1> <h4 class="post-meta">rev-basic-8 문제 풀이</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="https://touBVa.github.io/blog/authors/TouBVa">TouBVa</a></span> </span > at <time datetime="2024-12-01 01:00:00 -0600" itemprop="datePublished" >Dec 1, 2024</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/reversing/2024-12-01-rev-basic-8" ></span> <div class="post-categories"> Category : <a href="/blog/categories/reversing" >reversing</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top " src="https://touBVa.github.io/assets/img/posts/2024-12-01-rev-basic-8/Untitled.png" alt="" style="height: 50%; width: 50%; display: block; margin-left: auto; margin-right: auto;" /> <br /> <br /> <ul id="markdown-toc"> <li><a href="#0-메타데이터-확인" id="markdown-toc-0-메타데이터-확인">0. 메타데이터 확인</a></li> <li><a href="#1-동적-분석" id="markdown-toc-1-동적-분석">1. 동적 분석</a></li> <li><a href="#2-정적-분석" id="markdown-toc-2-정적-분석">2. 정적 분석</a> <ul> <li><a href="#21-sub_140001000" id="markdown-toc-21-sub_140001000">2.1. sub_140001000</a></li> <li><a href="#22-2s-complement" id="markdown-toc-22-2s-complement">2.2. 2’s complement</a></li> <li><a href="#23-sub_140001000-내부-비교-루틴어셈블리" id="markdown-toc-23-sub_140001000-내부-비교-루틴어셈블리">2.3. sub_140001000 내부 비교 루틴(어셈블리)</a></li> <li><a href="#23-난관에-봉착하다" id="markdown-toc-23-난관에-봉착하다">2.3. 난관에 봉착하다</a></li> <li><a href="#24-난관에서-빠져나왔다" id="markdown-toc-24-난관에서-빠져나왔다">2.4. 난관에서 빠져나왔다</a></li> </ul> </li> <li><a href="#3-질문" id="markdown-toc-3-질문">3. 질문.</a></li> </ul> <p><br /></p> <h2 id="0-메타데이터-확인">0. 메타데이터 확인</h2> <p><br /></p> <p><img src="/assets/img/posts/2024-12-01-rev-basic-8/Untitled.png" alt="/assets/img/posts/2024-12-01-rev-basic-8/Untitled.png" width="100%" height="100%" /></p> <p><br /></p> <p>PE64, C언어로 작성된 프로그램</p> <p><br /></p> <h2 id="1-동적-분석">1. 동적 분석</h2> <p><br /></p> <p>Input 나오고, 사용자 입력 받고, Correct / Wrong 판별해 보여줌</p> <p>콘솔에서 stdin 받음</p> <p><br /></p> <h2 id="2-정적-분석">2. 정적 분석</h2> <p><br /></p> <p>역시나 똑같음</p> <p><img src="/assets/img/posts/2024-12-01-rev-basic-8/Untitled_1.png" alt="/assets/img/posts/2024-12-01-rev-basic-8/Untitled_1.png" width="100%" height="100%" /></p> <p><br /></p> <p>이제 sub_140001000을 들여다보자.</p> <p><br /></p> <h3 id="21-sub_140001000">2.1. sub_140001000</h3> <p><img src="/assets/img/posts/2024-12-01-rev-basic-8/Untitled_2.png" alt="/assets/img/posts/2024-12-01-rev-basic-8/Untitled_2.png" width="100%" height="100%" /></p> <p><br /></p> <p>안예뻐</p> <p><img src="/assets/img/posts/2024-12-01-rev-basic-8/Untitled_3.png" alt="/assets/img/posts/2024-12-01-rev-basic-8/Untitled_3.png" width="100%" height="100%" /></p> <p><br /></p> <p>이젠예뻐</p> <p>byte_140003000 안에 담긴 데이터는 아래와 같음</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">AC</span> <span class="n">F3</span> <span class="mi">0</span><span class="n">C</span> <span class="mi">25</span> <span class="n">A3</span> <span class="mi">10</span> <span class="n">B7</span> <span class="mi">25</span> <span class="mi">16</span> <span class="n">C6</span> <span class="n">B7</span> <span class="n">BC</span> <span class="mi">07</span> <span class="mi">25</span> <span class="mi">02</span> <span class="n">D5</span> <span class="n">C6</span> <span class="mi">11</span> <span class="mi">07</span> <span class="n">C5</span>
</code></pre></div></div> <p><br /></p> <p>궁금한 점. 왜 -5를 곱한 걸까? 이 문제의 의도가 뭘까?</p> <p>1byte 자료형이 마이너스를 표현하는 방법에 대해 알아보라는 뜻 아닐까?</p> <p>흠… 진짜 왜지?</p> <p><br /></p> <h3 id="22-2s-complement">2.2. 2’s complement</h3> <p><br /></p> <p>이진수의 모든 자리 숫자를 반전시키고, 1을 더해서 2의 보수를 구한다.</p> <p>2의 보수인 수는 원래 숫자의 음수로 취급된다.</p> <p>(자세한 건 생략)</p> <p><br /></p> <h3 id="23-sub_140001000-내부-비교-루틴어셈블리">2.3. sub_140001000 내부 비교 루틴(어셈블리)</h3> <p><br /></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="n">__int64</span><span class="p">)</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0x15</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>  <span class="p">{</span>    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)(</span><span class="o">-</span><span class="mi">5</span> <span class="o">*</span> <span class="n">usr_input</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="n">byte_140003000</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>      <span class="k">return</span> <span class="mi">0</span><span class="n">i64</span><span class="p">;</span>  <span class="p">}</span>
</code></pre></div></div> <p><br /></p> <p>뭔가 감이 안 오는 것 같으면 어셈을 한 번 보는 것도 좋으니, 어셈으로 위 비교문의 if 조건을 보자.</p> <div class="language-nasm highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">movsxd</span>  <span class="nb">rax</span><span class="p">,</span> <span class="p">[</span><span class="nb">rsp</span><span class="o">+</span><span class="mh">18h</span><span class="o">+</span><span class="nv">var_18</span><span class="p">]</span><span class="nv">mov</span>     <span class="nb">rcx</span><span class="p">,</span> <span class="p">[</span><span class="nb">rsp</span><span class="o">+</span><span class="mh">18h</span><span class="o">+</span><span class="nv">arg_0</span><span class="p">]</span><span class="nv">movzx</span>   <span class="nb">eax</span><span class="p">,</span> <span class="kt">byte</span> <span class="nv">ptr</span> <span class="p">[</span><span class="nb">rcx</span><span class="o">+</span><span class="nb">rax</span><span class="p">]</span><span class="nv">imul</span>    <span class="nb">eax</span><span class="p">,</span> <span class="mb">11111011b</span><span class="nv">and</span>     <span class="nb">eax</span><span class="p">,</span> <span class="mb">11111111b</span><span class="nv">movsxd</span>  <span class="nb">rcx</span><span class="p">,</span> <span class="p">[</span><span class="nb">rsp</span><span class="o">+</span><span class="mh">18h</span><span class="o">+</span><span class="nv">var_18</span><span class="p">]</span><span class="nv">lea</span>     <span class="nb">rdx</span><span class="p">,</span> <span class="kt">byte</span><span class="nv">_140003000</span>
<span class="nf">movzx</span>   <span class="nb">ecx</span><span class="p">,</span> <span class="kt">byte</span> <span class="nv">ptr</span> <span class="p">[</span><span class="nb">rdx</span><span class="o">+</span><span class="nb">rcx</span><span class="p">]</span><span class="nv">cmp</span>     <span class="nb">eax</span><span class="p">,</span> <span class="nb">ecx</span><span class="nv">jz</span>      <span class="nv">short</span> <span class="nv">loc_140001053</span>
</code></pre></div></div> <p><br /></p> <p>imul~and 까지가 가장 중요한 부분이다.</p> <p>앞서 설명한 2’s complement를 감안할 때, imul 의 operand 2는</p> <p>0x11111011(2) == -0x00000101(2) == -5(10)</p> <p>and 연산의 이유는 뭐지?</p> <p><br /></p> <p>아 r계열 레지스터(64bit) 에 e계열 레지스터인 것처럼 값을 넣었으니까(32bit) 상위 32bit의 값을 정리해 주려고 하는 거구나</p> <ul> <li>5 곱하는 이유…char 자료형이니 8bit 내에서 일어나는 일을 보고 싶은 것 같은데</li> </ul> <p>이걸 어떻게 표현해야 하지?</p> <p><br /></p> <p>imul이라는 레지스터가 중요함. 이건 부호 연산을 할 수 있는 레지스터임 → 이걸 썼다는 것은 음수를 썼을 가능성이 높다는 뜻</p> <p>동적 분석은 보통 x64dbg 사용한다</p> <p>연산하고 and 연산이 추가되는 경우는, 하위 n 비트를 구하기 위한 목적이 크다. 형변환이라든가… 자료형(크기) 다른 포맷으로 변경한다든가….</p> <p><br /></p> <h3 id="23-난관에-봉착하다">2.3. 난관에 봉착하다</h3> <p><br /></p> <ul> <li>5*usr_input == 정답배열이어야 하는데</li> </ul> <p>이걸 뒤집으면</p> <p>5 * usr_input == -정답배열</p> <p>즉, 정답배열에 2’s complement를 취한 걸 정답’ 라고 하면</p> <p>뭘 5번 덧셈해야(ALU는 덧셈연산밖에 못하니까) 정답’ 이 되는지 나와야 하는데, 안 나온다.</p> <p>심지어 usr_input은 char type라서 1byte짜리로, 부동소수점 타입도 안 된다.</p> <p><br /></p> <h3 id="24-난관에서-빠져나왔다">2.4. 난관에서 빠져나왔다</h3> <p><br /></p> <p>어차피 1byte짜리니까, 0~255까지 모든 숫자를 넣어보면서,</p> <ul> <li>5*usr_input == 정답배열을 충족하는 0x15짜리 길이 문자열을 도출해도 된다고 생각했다.</li> </ul> <p>브루트포싱은 아래와 같이 했음</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tmp</span><span class="o">=</span><span class="p">[</span><span class="s">'AC F3 0C 25 A3 10 B7 25 16 C6 B7 BC 07 25 02 D5 C6 11 07 C5'</span><span class="p">]</span>
<span class="n">tmp2</span><span class="o">=</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
<span class="n">byte_140003000</span><span class="o">=</span><span class="p">[]</span>
<span class="n">solve</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp2</span><span class="p">:</span>
    <span class="n">byte_140003000</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">byte_140003000</span><span class="p">:</span>
    <span class="n">solve</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">brute_force</span> <span class="k">for</span> <span class="n">brute_force</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span> <span class="k">if</span> <span class="p">((</span><span class="n">brute_force</span><span class="o">*</span><span class="mh">0xFB</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFF</span> <span class="o">==</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">solve</span><span class="p">)</span>
<span class="n">solve_tmp</span><span class="o">=</span><span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">solve</span><span class="p">]</span>
<span class="n">solve_string</span><span class="o">=</span><span class="p">[]</span>
<span class="n">solve_string</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">''</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">solve_tmp</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">solve_string</span><span class="p">)</span>
</code></pre></div></div> <p><br /></p> <p>플래그 획득까지 완료</p> <p><br /></p> <h2 id="3-질문">3. 질문.</h2> <p><br /></p> <p>그런데 왜 역산이 불가능하지?</p> <p>개인적으로 추측해 보았다.</p> <p>1byte로 표현하는 수라면, 0~255 까지를 한 주기로 하는 정수의 모듈러 군이다.</p> <p>모듈러 군 내에서 곱셈은 일대일 함수가 아니므로 곱셈과 나눗셈의 역산 관계가 성립되지 않는다. 하나의 역원 존재 불가</p> <p>곱셈이고 나눗셈이고 덧셈의 연장인데 왜? 라고 생각할 수 있을 것 같다. 그러나 모듈러 연산이 적용되는 닫힌군이라는 게 이 역산 불가의 원인으로 작용하므로… 음수는 의미없고</p> <p>이런 원리를 이용한 게 PKI이고.</p> <p>즉 밑을 상대적으로 작게(255) 들고 가는 모듈러 집합이라 5라는 작은 수를 곱해도 80% 이상 확률로(해당 군의 약 20%인 0~50까지는 5를 곱해도 255 이상이 아님) 나머지 연산이 이루어질 수 있기 때문에 어쩔 수 없이 (1-0.8^0x14) * 100 == 98.845% 의 확률로 복원 불가능한 정보임</p> <p>따라서 브루트 포싱만이 답이라고 생각함.</p> <p><br /></p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="https://touBVa.github.io/blog/reversing/2024-12-01-rev-basic-8" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About TouBVA </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="https://touBVa.github.io/assets/img/authors/toubva.jpeg" alt="TouBVA" /> </div> <div class="col-md-6"> <p class="author_bio">A Security Researcher, now concentrating on Security Consulting.</p> <p>Email : touBVa@gmail.com</p> <p>Website : https://toubva.github.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/TouBVa" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/johndoe" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.youtube.com/channel/UCSfLBFFfNU9r6ihfei6VeJw" target="_blank"><i class="fab fa-youtube fa-fw"></i></a> <a class="social-link" href="https://www.facebook.com/johndoe" target="_blank"><i class="fab fa-facebook fa-fw"></i></a> <a class="social-link" href="https://www.twitter.com/johndoe" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <div id="disqus_thread", style="width: 90%; margin-left: 5%;"><script> var disqus_config = function () { this.page.url = "https://touBVa.github.io/blog/reversing/2024-12-01-rev-basic-8"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/reversing/rev-basic-8"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://toubva.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About TouBVa</div> <div class="card-body"> <p class="author_bio">Welcome to my world!</p><!-- Place this tag where you want the github button to render. --> <a class="github-button" href="https://github.com/touBVa/touBVa.github.io" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star my blog on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#dreamhack_system_hacking"></div> <li class="tag-head"> <a href="/blog/categories/dreamhack_system_hacking">dreamhack_system_hacking</a> </li> <a name="dreamhack_system_hacking"></a> <div id="#system_hacking"></div> <li class="tag-head"> <a href="/blog/categories/system_hacking">system_hacking</a> </li> <a name="system_hacking"></a> <div id="#protostar"></div> <li class="tag-head"> <a href="/blog/categories/protostar">protostar</a> </li> <a name="protostar"></a> <div id="#certification_study"></div> <li class="tag-head"> <a href="/blog/categories/certification_study">certification_study</a> </li> <a name="certification_study"></a> <div id="#paper_study"></div> <li class="tag-head"> <a href="/blog/categories/paper_study">paper_study</a> </li> <a name="paper_study"></a> <div id="#network_hacking"></div> <li class="tag-head"> <a href="/blog/categories/network_hacking">network_hacking</a> </li> <a name="network_hacking"></a> <div id="#blockchain"></div> <li class="tag-head"> <a href="/blog/categories/blockchain">blockchain</a> </li> <a name="blockchain"></a> <div id="#reversing"></div> <li class="tag-head"> <a href="/blog/categories/reversing">reversing</a> </li> <a name="reversing"></a> <div id="#my_life"></div> <li class="tag-head"> <a href="/blog/categories/my_life">my_life</a> </li> <a name="my_life"></a> <div id="#web_hacking"></div> <li class="tag-head"> <a href="/blog/categories/web_hacking">web_hacking</a> </li> <a name="web_hacking"></a> <div id="#fuzzing"></div> <li class="tag-head"> <a href="/blog/categories/fuzzing">fuzzing</a> </li> <a name="fuzzing"></a> <div id="#forensic"></div> <li class="tag-head"> <a href="/blog/categories/forensic">forensic</a> </li> <a name="forensic"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="https://touBVa.github.io/">Home</a> </li> <li> <a href="https://touBVa.github.io/about">About</a> </li> <li> <a href="https://touBVa.github.io/blog">Blog</a> </li> <li> <a href="https://touBVa.github.io/contact">Contact</a> </li> </div> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> <form action=""method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate> <div id="mc_embed_signup_scroll_footer"> <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label> <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value=""> </div><br /> <div class="clear"> <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success"> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/touBVa"> TouBVa</a>. Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="https://touBVa.github.io/assets/js/mode-switcher.js"></script> <!-- <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> --> </body> </html>
