<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> Protostar-format1.c x86-64 - TouBVa </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="FSB(Format String Bug) exploitation in 64 bit- Protostar-format1.c x86-64"> <meta name="keywords" content="Protostar-format1.c x86-64, TouBVa, system_hacking, protostar,System Hacking, Memory Exploit, Format String Bug"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="TouBVa" property="og:site_name" /> <meta content="Protostar-format1.c x86-64" property="og:title" /> <meta content="article" property="og:type" /> <meta content="FSB(Format String Bug) exploitation in 64 bit" property="og:description" /> <meta content="http://localhost:4000/blog/system_hacking/protostar-format1/" property="og:url" /> <meta content="2022-12-06T00:20:58+09:00" property="article:published_time" /> <meta content="http://localhost:4000/about/" property="article:author" /> <meta content="http://localhost:4000/assets/img/posts/format1/Untitled%201.jpeg" property="og:image" /> <meta content="system_hacking" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="Protostar-format1.c x86-64" /> <meta name="twitter:url" content="http://localhost:4000/blog/system_hacking/protostar-format1/" /> <meta name="twitter:description" content="FSB(Format String Bug) exploitation in 64 bit" /> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css" /> <!-- <link rel="stylesheet" href="http://localhost:4000/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="http://localhost:4000/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'http://localhost:4000' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="http://localhost:4000/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="http://localhost:4000/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="http://localhost:4000/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="http://localhost:4000/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="http://localhost:4000/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="http://localhost:4000/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="http://localhost:4000/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="http://localhost:4000/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="http://localhost:4000/assets/js/search.js"></script> <script src="http://localhost:4000/assets/js/on-scroll-progress.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark nav-down" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">TouBVa</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/contact" >Contact</a > </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/styleguide"> Styleguide </a> </li>--> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <!-- <li class="nav-item" style="margin-top:5px; padding-right:20px;" > <a class="header__checkout snipcart-checkout"> <svg width="31" height="27" viewBox="0 0 31 27" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M1.10512 0.368718C0.560256 0.368718 0.118164 0.812066 0.118164 1.35848C0.118164 1.9049 0.560256 2.34824 1.10512 2.34824H4.90887L8.30138 18.4009C8.43503 19.0053 8.83085 19.5079 9.32946 19.5041H25.7788C26.3005 19.5118 26.7799 19.0375 26.7799 18.5143C26.7799 17.9911 26.3006 17.5168 25.7788 17.5245H10.1315L9.71003 15.545H27.095C27.5371 15.5412 27.9547 15.2048 28.0511 14.7718L30.354 4.87412C30.4825 4.29933 29.9852 3.67172 29.3979 3.66786H7.21171L6.6771 1.15221C6.58329 0.71276 6.15921 0.368652 5.7107 0.368652L1.10512 0.368718ZM7.623 5.64746H12.7634L13.2569 8.61674H8.25005L7.623 5.64746ZM14.7785 5.64746H20.9881L20.4946 8.61674H15.2719L14.7785 5.64746ZM23.0031 5.64746H28.1537L27.4649 8.61674H22.5097L23.0031 5.64746ZM8.67181 10.5963H13.5862L14.0797 13.5656H9.29919L8.67181 10.5963ZM15.6009 10.5963H20.1656L19.6721 13.5656H16.0944L15.6009 10.5963ZM22.1807 10.5963H27.0023L26.3135 13.5656H21.6872L22.1807 10.5963ZM12.6197 20.164C10.8141 20.164 9.32979 21.6525 9.32979 23.4632C9.32979 25.2739 10.8141 26.7624 12.6197 26.7624C14.4252 26.7624 15.9095 25.2739 15.9095 23.4632C15.9095 21.6525 14.4252 20.164 12.6197 20.164ZM22.4892 20.164C20.6837 20.164 19.1994 21.6525 19.1994 23.4632C19.1994 25.2739 20.6837 26.7624 22.4892 26.7624C24.2948 26.7624 25.7791 25.2739 25.7791 23.4632C25.7791 21.6525 24.2948 20.164 22.4892 20.164ZM12.6197 22.1435C13.3586 22.1435 13.9356 22.7222 13.9356 23.4632C13.9356 24.2042 13.3586 24.7829 12.6197 24.7829C11.8807 24.7829 11.3037 24.2042 11.3037 23.4632C11.3037 22.7222 11.8807 22.1435 12.6197 22.1435ZM22.4892 22.1435C23.2282 22.1435 23.8052 22.7222 23.8052 23.4632C23.8052 24.2042 23.2282 24.7829 22.4892 24.7829C21.7503 24.7829 21.1733 24.2042 21.1733 23.4632C21.1733 22.7222 21.7503 22.1435 22.4892 22.1435Z" fill="#ff7901" class="header__checkout-fill"></path> </svg> <span class="snipcart-items-count"></span> </a> </li> --> </ul> </nav> <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script> <script type="text/javascript"> var didScroll; var lastScrollTop = 0; var delta = 5; var navbarHeight = document.querySelector('#topNav').offsetHeight; window.addEventListener('scroll', function(event) { didScroll = true; }); setInterval(function() { if (didScroll) { hasScrolled(); didScroll = false; } }, 250); function hasScrolled() { var st = window.pageYOffset || document.documentElement.scrollTop; if (Math.abs(lastScrollTop - st) <= delta) return; var nav = document.querySelector('#topNav'); var prog = document.querySelector('#progress-bar'); if (st > lastScrollTop && st > navbarHeight) { nav.classList.remove('nav-down'); nav.classList.add('nav-up'); prog.classList.remove('toDown'); prog.classList.add('toUp'); } else { if (st < lastScrollTop) { nav.classList.remove('nav-up'); nav.classList.add('nav-down'); prog.classList.remove('toUp'); prog.classList.add('toDown'); } } lastScrollTop = st; } </script> <div id="progress-bar"></div> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div> <div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Protostar-format1.c x86-64</h1> <h4 class="post-meta">FSB(Format String Bug) exploitation in 64 bit</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="http://localhost:4000/blog/authors/TouBVa">TouBVa</a></span> </span > at <time datetime="2022-12-06 00:20:58 +0900" itemprop="datePublished" >Dec 6, 2022</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/system_hacking/protostar-format1/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/system_hacking" >system_hacking</a > &nbsp; <a href="/blog/categories/protostar" >protostar</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="http://localhost:4000/assets/img/posts/format1/Untitled%201.jpeg" alt="" /> <br /> <br /> <ul id="markdown-toc"> <li><a href="#format1c" id="markdown-toc-format1c">Format1.c</a></li> <li><a href="#0-포맷-스트링-버그란" id="markdown-toc-0-포맷-스트링-버그란">0. 포맷 스트링 버그란</a> <ul> <li><a href="#01-포맷-스트링이란" id="markdown-toc-01-포맷-스트링이란">0.1. 포맷 스트링이란</a></li> </ul> </li> <li><a href="#1-예제-코드-분석" id="markdown-toc-1-예제-코드-분석">1. 예제 코드 분석</a></li> <li><a href="#2-익스플로잇" id="markdown-toc-2-익스플로잇">2. 익스플로잇</a> <ul> <li><a href="#21-취약점-익스플로잇-방법-지정" id="markdown-toc-21-취약점-익스플로잇-방법-지정">2.1. 취약점 익스플로잇 방법 지정</a> <ul> <li><a href="#211-배경-설명" id="markdown-toc-211-배경-설명">2.1.1. 배경 설명</a></li> <li><a href="#212-익스플로잇-설계" id="markdown-toc-212-익스플로잇-설계">2.1.2. 익스플로잇 설계</a></li> </ul> </li> </ul> </li> <li><a href="#3-논외-수학적으로-읽어야-할-주소-개수-구하기를-시도했는데-고려한-변수가-한두개가-아니라-포기한-건에-대하여" id="markdown-toc-3-논외-수학적으로-읽어야-할-주소-개수-구하기를-시도했는데-고려한-변수가-한두개가-아니라-포기한-건에-대하여">3. 논외-수학적으로 읽어야 할 주소 개수 구하기를 시도했는데 고려한 변수가 한두개가 아니라 포기한 건에 대하여</a></li> </ul> <p><br /></p> <h1 id="format1c">Format1.c</h1> <p>결론부터 말하자면, 이 문제는 64비트로 푸는 게 불가능한 문제다. 입력값으로 페이로드를 받는다면 어떻게든 풀 수 있겠으나, 함수의 인자로 페이로드를 받기 때문에 리눅스 쉘의 파이프 특성상 null byte가 제외되어 불가능하다.</p> <p>그래도 문제를 풀며 많은 것을 알게 되었으니 이렇게 정리해 둔다.<br /></p> <h1 id="0-포맷-스트링-버그란">0. 포맷 스트링 버그란</h1> <blockquote> <p>버퍼 오버플로우 취약점으로 이어질 수 있는 버그로,</p> <ul> <li>사용자 입력을 검증하지 않고 사용한 결과</li> <li>사용자가 악의적인 용도로 입력한 Format String이</li> <li>프로그램 실행에 영향을 끼치는 것을 의미한다.</li> </ul> </blockquote> <h2 id="01-포맷-스트링이란">0.1. 포맷 스트링이란</h2> <ul> <li>C언어에서 자주 사용되는 “출력 용도의 함수”가 출력할 “데이터의 형식을 지정”하기 위해 사용하는 특수 문자</li> <li> <p>포맷 스트링의 종류는 매우 다양하다.</p> <table> <thead> <tr> <th style="text-align: center">인자  </th> <th style="text-align: center">  입력 타입  </th> <th style="text-align: left"> 출력  </th> <th style="text-align: left"> 익스플로잇 용도  </th> </tr> </thead> <tbody> <tr> <td style="text-align: center">%d  </td> <td style="text-align: center">  값  </td> <td style="text-align: left"> 10진수 </td> <td style="text-align: left">  </td> </tr> <tr> <td style="text-align: center">%s </td> <td style="text-align: center"> 포인터 </td> <td style="text-align: left">  해당 포인터가 가리키는 문자열  </td> <td style="text-align: left">  </td> </tr> <tr> <td style="text-align: center">%x  </td> <td style="text-align: center">  값  </td> <td style="text-align: left"> 16진수  </td> <td style="text-align: left"> 메모리를 읽을 때 사용한다  </td> </tr> <tr> <td style="text-align: center">%u  </td> <td style="text-align: center">  값  </td> <td style="text-align: left"> Unsigned 10진수  </td> <td style="text-align: left">  </td> </tr> <tr> <td style="text-align: center">%p  </td> <td style="text-align: center"> 포인터  </td> <td style="text-align: left"> 포인터가 가리키는 메모리 주소  </td> <td style="text-align: left">  </td> </tr> <tr> <td style="text-align: center">%n  </td> <td style="text-align: center"> 포인터  </td> <td style="text-align: left"> %n이 나오기 전까지 출력했던 바이트 수를, <br /> 포인터가 가리키는 메모리 주소에 넣어줌  </td> <td style="text-align: left">  메모리 값을 변조할 때 사용한다 </td> </tr> <tr> <td style="text-align: center">%c  </td> <td style="text-align: center"> 포인터  </td> <td style="text-align: left"> 1byte 한 글자  </td> <td style="text-align: left">  </td> </tr> <tr> <td style="text-align: center">…  </td> <td style="text-align: center">  …  </td> <td style="text-align: left"> …  </td> <td style="text-align: left">  </td> </tr> </tbody> </table> </li> <li>위 포맷 스트링 중 가장 중요한 건 <code class="language-plaintext highlighter-rouge">%x</code>, <code class="language-plaintext highlighter-rouge">%n</code> 이다.</li> <li>특히 <code class="language-plaintext highlighter-rouge">%n</code> 의 경우, 메모리 주소를 가리키는 포인터를 인자로 받기 때문에 32비트 환경에서는 4바이트, 64비트 환경에서는 8 바이트를 한 번에 읽어서 주소로 사용한다는 점 잊지 말기! <br /><br /></li> </ul> <h1 id="1-예제-코드-분석">1. 예제 코드 분석</h1> <p>주어진 코드는 아래와 같다.</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp">
</span> 
<span class="kt">int</span> <span class="n">target</span><span class="p">;</span>
 
<span class="kt">void</span> <span class="nf">vuln</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">string</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">printf</span><span class="p">(</span><span class="n">string</span><span class="p">);</span>
  
  <span class="k">if</span><span class="p">(</span><span class="n">target</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">printf</span><span class="p">(</span><span class="s">"you have modified the target :)</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
 
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">vuln</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></div></div> <p>사용자에게서 프로그램의 argument로 입력받은 값을 문자열의 형태로 <code class="language-plaintext highlighter-rouge">vuln</code> 함수에게 넘겨준다.</p> <p>해당 문자열은 <code class="language-plaintext highlighter-rouge">printf</code>에서 즉석으로 호명되며, 이후 프로그램의 control flow는 <code class="language-plaintext highlighter-rouge">printf</code> 내부로 흘러들어가게 되고, 해당 함수 내에서 입력된 문자열과 format string이 처리된다.</p> <p>format string bug는 바로 이 지점, 즉 프로그램이 컴파일되어 실행되는 시점과 사용자 입력을 처리하여 알맞은 행위를 취하는 시점의 시차에서 발생한다. <br /><br /></p> <h1 id="2-익스플로잇">2. 익스플로잇</h1> <p>익스플로잇은 아래의 단계로 구성된다.</p> <ol> <li>프로그램 분석해 취약점 확정</li> <li>취약점을 익스플로잇할 방법 지정</li> <li>익스플로잇 생성 및 실행</li> </ol> <p>먼저 주어진 프로그램을 익스플로잇했을 때 성취해야 할 목적은 <code class="language-plaintext highlighter-rouge">target</code> 변수를 0 이외의 것으로 변경하는 것이다. <code class="language-plaintext highlighter-rouge">target</code> 변수는 global int로 uninitialized 이기 때문에 <code class="language-plaintext highlighter-rouge">.bss</code> 영역에 저장될 것이고, 전역변수인 이상 컴파일 당시 컴파일러에 의해 0으로 자동 초기화될 것이기 때문이다.</p> <p>앞에서 프로그램 분석과 취약점 확정을 마무리했으므로, 2) 취약점 익스플로잇 방법 확정부터 시작한다.</p> <h2 id="21-취약점-익스플로잇-방법-지정">2.1. 취약점 익스플로잇 방법 지정</h2> <h3 id="211-배경-설명">2.1.1. 배경 설명</h3> <p>64bit 프로그램에서 아래와 같은 printf 구문이 함수 내에 있을 때 printf가 변수를 참조하는 방식에 대해 자세히 알아보자.</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">char</span> <span class="o">*</span><span class="n">buf</span> <span class="o">=</span> <span class="err">'</span><span class="o">%</span><span class="n">p</span><span class="p">.</span><span class="o">%</span><span class="n">x</span><span class="p">.</span><span class="o">%</span><span class="n">c</span><span class="p">.</span><span class="o">%</span><span class="n">d</span><span class="p">.</span><span class="o">%</span><span class="n">f</span><span class="p">.</span><span class="o">%</span><span class="n">h</span><span class="p">.</span><span class="o">%</span><span class="n">n</span><span class="err">'</span><span class="p">;</span>
<span class="n">printf</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</code></pre></div></div> <p>위의 코드 라인이 진행되면 결론적으로는 <code class="language-plaintext highlighter-rouge">printf('%p.%x.%c.%d.%f.%h.%n')</code> 가 실행되는데, 이때 주의깊게 봐야 할 것은 64비트 프로그램에서 함수에 인자를 전달할 때 레지스터와 스택의 사용 방식이다.</p> <blockquote> <p>리눅스용 gcc는 64비트 컴파일 시 <code class="language-plaintext highlighter-rouge">fastcall</code> 이라는 calling convention을 사용하는데, 이 규약 하에서는 <code class="language-plaintext highlighter-rouge">rdi, rsi, rdx, rcx, r8, r9</code> 순으로 인자가 들어가고 남아있는 인자는 스택에 마지막 인자부터 push하여 이후 스택에서 인자를 pop할 때 순서대로 pop되도록 한다.</p> </blockquote> <p>그렇다면 <code class="language-plaintext highlighter-rouge">printf</code> 함수에서 인자는 어떤 식으로 전달될까? 익스플잇할 대상 프로그램에 직접 디버거를 붙여 확인해 보았다.</p> <p><img src="/assets/img/posts/format1/Untitled.jpeg" alt="Untitled" width="100%" height="100%" /></p> <ul> <li><code class="language-plaintext highlighter-rouge">rdi</code> , 즉 첫 번째 인자로 프린트할 스트링의 시작 주소가 주어졌고</li> <li><code class="language-plaintext highlighter-rouge">rsi</code> , 즉 두번째 인자로 현재 프로세스의 적재 위치가 주어졌다.</li> </ul> <p>만일 대상 프로그램에서 <code class="language-plaintext highlighter-rouge">printf(string)</code> 이 아닌 <code class="language-plaintext highlighter-rouge">printf(string, 0xDEADBEEF, ... , 0xCAFECAFE)</code> 등의 형식으로 여러 인자를 전달했다면 <code class="language-plaintext highlighter-rouge">rdi</code> 는 <code class="language-plaintext highlighter-rouge">string</code> , <code class="language-plaintext highlighter-rouge">rsi</code> 는 <code class="language-plaintext highlighter-rouge">0xDEADBEEF</code> … 식이 되었을 것이다.</p> <p>이처럼, <code class="language-plaintext highlighter-rouge">printf</code> 함수는 프린트할 스트링의 시작주소를 무조건 첫 번째 인자로 받고, 해당 스트링에 포맷 스트링이 6개 포함되어 있을 경우 함수의 인자 규칙과 calling convention에 따라 <code class="language-plaintext highlighter-rouge">rsi</code>, <code class="language-plaintext highlighter-rouge">rdx</code>, <code class="language-plaintext highlighter-rouge">rcx</code>, <code class="language-plaintext highlighter-rouge">r8</code>, <code class="language-plaintext highlighter-rouge">r9</code>, <code class="language-plaintext highlighter-rouge">stack</code> 을 각 포맷 스트링에 대해 순서대로 참조한다. 이 사실을 기반으로 다시 한 번 예시를 보자.</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">char</span> <span class="o">*</span><span class="n">buf</span> <span class="o">=</span> <span class="err">'</span><span class="o">%</span><span class="n">p</span><span class="p">.</span><span class="o">%</span><span class="n">x</span><span class="p">.</span><span class="o">%</span><span class="n">c</span><span class="p">.</span><span class="o">%</span><span class="n">d</span><span class="p">.</span><span class="o">%</span><span class="n">f</span><span class="p">.</span><span class="o">%</span><span class="n">h</span><span class="p">.</span><span class="o">%</span><span class="n">n</span><span class="err">'</span><span class="p">;</span>
<span class="n">printf</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
</code></pre></div></div> <p>따라서 <code class="language-plaintext highlighter-rouge">printf(buf)</code> 가 인자를 사용하기 위해 레지스트리와 스택을 참조하는 순서는 아래와 같을 것이다.</p> <ol> <li><code class="language-plaintext highlighter-rouge">rdi</code>: &amp;buf</li> <li><code class="language-plaintext highlighter-rouge">rsi</code>: some hex value → %p에 주어질 포인터로서 참조</li> <li><code class="language-plaintext highlighter-rouge">rdx</code>: ‘’ → %x에 주어질 값으로서 참조</li> <li><code class="language-plaintext highlighter-rouge">rcx</code>: ‘’ → %c에 주어질 포인터로서 참조</li> <li><code class="language-plaintext highlighter-rouge">r8</code>: ‘’ → %d에 주어질 값으로서 참조</li> <li><code class="language-plaintext highlighter-rouge">r9</code>: ‘’ → %f에 주어질 값으로서 참조</li> <li><code class="language-plaintext highlighter-rouge">stack</code>: ‘’ → %h에 주어질 값으로서 참조</li> <li><code class="language-plaintext highlighter-rouge">stack(next address)</code>: ‘’ → %n에 주어질 포인터로서 참조</li> </ol> <p>이제 언급된 포맷 스트링 <code class="language-plaintext highlighter-rouge">%n</code>에 대해 자세히 알아보자. <code class="language-plaintext highlighter-rouge">%n</code> 은 인자로서 어떤 메모리의 주소(포인터)를 받는다. 이렇게 받은 포인터가 가리키는 메모리에 <code class="language-plaintext highlighter-rouge">%n</code> 은 자신이 나오기 전까지 입력된 문자의 개수를 입력한다.</p> <p>포맷 스트링 중 유일하게 메모리 값을 변조하는 것이 바로 <code class="language-plaintext highlighter-rouge">%n</code> 포맷 스트링이기 때문에 이는 익스플로잇에 매우 자주 이용된다.</p> <h3 id="212-익스플로잇-설계">2.1.2. 익스플로잇 설계</h3> <p>앞서 설명한 내용의 요점은 아래와 같다.</p> <ol> <li>64비트 프로그램의 Calling Convention을 고려했을 때, 입력값을 검증하지 않고 사용하는 <code class="language-plaintext highlighter-rouge">printf()</code> 함수에게 format string을 많이 주어 스택에 순차적으로 접근할 수 있다.</li> <li>포맷 스트링 중 <code class="language-plaintext highlighter-rouge">%n</code> 만이 유일하게 사용자의 입력값을 반영하여 인자로 주어진 포인터가 가리키는 메모리 값을 변조한다.</li> </ol> <p>따라서 아래와 같이 익스플로잇의 개념을 설계할 수 있다.</p> <blockquote> <p>충분히 많은 format string을 사용하여 스택에 접근할 수 있도록 한 뒤, 마지막으로 사용된 <code class="language-plaintext highlighter-rouge">%n</code> format string이 참조할 스택 위치에 <code class="language-plaintext highlighter-rouge">target</code> 변수의 주소가 들어가도록 한다면 <code class="language-plaintext highlighter-rouge">%n</code> 은 결론적으로 <code class="language-plaintext highlighter-rouge">target</code> 변수의 값을 이제까지 받은 character의 수로 변조하게 될 것이다.</p> </blockquote> <p>말로만 하니 이해가 힘들 수 있다. 그림을 보면서 이해해 보자.</p> <p><strong>주의:</strong> <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 은 사실 아래 그림과 같은 식으로 존재하지 않는다. 아무래도 이중 배열이니 <code class="language-plaintext highlighter-rouge">argv[0]</code> 이 진짜로 있는 곳 바로 아래에 <code class="language-plaintext highlighter-rouge">argv[1]</code> 이 있고, 그게 가리키는 곳에 <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 이 있을 거라… <code class="language-plaintext highlighter-rouge">main</code> 의 스택 프레임 내부에서 <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 이 보일 리가 없다. 그러나 설명의 용이를 위해 아래와 같이 그린 점 감안해 주십사…</p> <p><img src="/assets/img/posts/format1/Untitled%201.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p><code class="language-plaintext highlighter-rouge">vuln</code> 함수가 콜되었을 때의 스택 프레임이다. 함수를 시작할 때 패스했던 인자의 시작 주소는 이중 배열인 <code class="language-plaintext highlighter-rouge">argv</code> 의 두 번째 인덱스에 저장되고, 이 시작 주소 <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 은 <code class="language-plaintext highlighter-rouge">vuln()</code> 함수에게 인자로 전달된다.</p> <p><img src="/assets/img/posts/format1/Untitled%202.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>그리고 <code class="language-plaintext highlighter-rouge">vuln()</code> 스택 프레임 안에서 <code class="language-plaintext highlighter-rouge">printf()</code> 함수를 콜했을 때의 스택 프레임이다. <code class="language-plaintext highlighter-rouge">printf()</code> 에게 첫 번째 인자로 주어진 <code class="language-plaintext highlighter-rouge">string</code>, 실제로는 <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 가 포인터의 형태로 <code class="language-plaintext highlighter-rouge">rdi</code> 에 들어간 것을 확인할 수 있다.</p> <p><img src="/assets/img/posts/format1/Untitled%203.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>그렇다면 <code class="language-plaintext highlighter-rouge">format1</code> 프로그램에게 인자로 <code class="language-plaintext highlighter-rouge">%5$p.%4$x.$n</code> 을 준다면 어떻게 될까? 아래 사진은 읽어들인 내용이 모두 보이도록 <code class="language-plaintext highlighter-rouge">%{int}${format}</code> 의 형식을 취하지 않았고, 균일한 형식으로 보이게 하기 위해 동일한 <code class="language-plaintext highlighter-rouge">%p</code> 포맷 스트링을 사용했으나 개수를 기준으로 설명하겠다.</p> <p><img src="/assets/img/posts/format1/Untitled%204.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p><img src="/assets/img/posts/format1/Untitled%205.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>직전의 스택 프레임 사진을 고려하면</p> <ul> <li>출력할 스트링의 시작주소를 담고 있는 <code class="language-plaintext highlighter-rouge">rdi</code> 를 제외한 나머지 5개의 레지스터에 저장된 값을 <code class="language-plaintext highlighter-rouge">%p</code> 포맷 스트링이 읽어들이고</li> <li>스택에 저장된 값을 <code class="language-plaintext highlighter-rouge">fastcall</code> calling convention에 따라 <code class="language-plaintext highlighter-rouge">printf</code>의 <code class="language-plaintext highlighter-rouge">rbp(sfp)</code> 를 뛰어넘어서 바로 아래에 있던 <code class="language-plaintext highlighter-rouge">vuln()</code>의 스택 4개 주소를 <code class="language-plaintext highlighter-rouge">%x</code>가 읽어온 것(스택 사진과 값이 다른 점이 있으나 이건 다른 시점에 찍어서 그렇다. <code class="language-plaintext highlighter-rouge">printf</code> 가 <code class="language-plaintext highlighter-rouge">vsprintf</code> 를 내부적으로 콜하고 그 안에서 stdout이 이루어지는 것 같은데 거기까지 가서 찾기는 좀… 그래…)</li> <li>조금 논외로, <code class="language-plaintext highlighter-rouge">vuln()</code> 의 스택 프레임을 그린 사진과 바로 위에서 확인되는 실제 스택 프레임의 구조가 다른데, 내가 알기로는… 컴파일 당시 컴파일러는 최적화를 위해 로컬변수선언이 안된 함수의 경우 외부에서 받아온 인자를 굳이 스택에 저장하지 않는데 왜 저장했는지 모르겠다. 이걸 어디에서 찾아야 할지 감이 안 와</li> </ul> <p>을 확인할 수 있다.</p> <p>따라서 마지막에 사용된 <code class="language-plaintext highlighter-rouge">%n</code> 은 <code class="language-plaintext highlighter-rouge">0x7fffffffdfa0</code> 주소 안에 있는 값을 메모리 주소로 생각하고 해당 주소에 자신이 나오기 전까지 출력됐던 글자수를 입력할 것이다.</p> <p>즉, 이 익스플로잇의 요지는 아래와 같다.</p> <blockquote> <p><code class="language-plaintext highlighter-rouge">%n</code> 이 읽어올 메모리 주소 안의 값이 <code class="language-plaintext highlighter-rouge">target</code> 변수의 주소가 되도록 하는 것.</p> </blockquote> <p>위의 목적은 사용자가 변조할 수 있는 유일한 위치, 즉 <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 에 <code class="language-plaintext highlighter-rouge">target</code> 변수의 주소를 주고 <code class="language-plaintext highlighter-rouge">%n</code> 이 <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 에 접근하게 함으로써 성취할 수 있다.</p> <p>그렇다면, <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 은 대체 어디에 있고 얼마나 많은 스택의 주소를 읽어야 <code class="language-plaintext highlighter-rouge">%n</code> 이 <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 에 접근할 수 있을까?</p> <p>이를 알기 위해 pwndbg를 붙여 main을 디스어셈블해서 전체적인 흐름을 파악하고 실제로 실행해서 스택 구성이 어떻게 되었는지 확인해 보았다.</p> <p><img src="/assets/img/posts/format1/Untitled%206.jpeg" alt="main 함수의 디스어셈블 결과." width="100%" height="100%" /></p> <p>main 함수의 디스어셈블 결과.</p> <p>하얗게 하이라이트가 된 부분이 바로 <code class="language-plaintext highlighter-rouge">argv[0][0]</code> 의 위치다. 바로 위의 <code class="language-plaintext highlighter-rouge">rbp-0x4</code> 는 확보한 공간으로 미루어볼 때 int type인 argv일 것이다. 그렇다면 <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 은 아마 <code class="language-plaintext highlighter-rouge">argv[0][0]</code> 의 바로 다음 바이트에 있을 것이다. <code class="language-plaintext highlighter-rouge">argv</code> 는 <code class="language-plaintext highlighter-rouge">char **</code> 타입이기 때문이다. 그렇다면 당연히 확보 공간도 1바이트겠지!</p> <p><img src="/assets/img/posts/format1/Untitled%207.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p><code class="language-plaintext highlighter-rouge">rbp-0x10</code> 이 <code class="language-plaintext highlighter-rouge">rsp</code> 의 위치인 것을 확인했다. 이중배열답게 두 번 참조한 모습이다. 따라서 <code class="language-plaintext highlighter-rouge">argv[1]</code> 은 <code class="language-plaintext highlighter-rouge">0x7fffffffe088</code> 의 바로 다음 주소인 <code class="language-plaintext highlighter-rouge">0x7fffffffe090</code> 일 것이다. 그리고 해당 주소에 담긴 값이 바로 <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 일 테다.</p> <p><img src="/assets/img/posts/format1/Untitled%208.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p><code class="language-plaintext highlighter-rouge">0x7fffffffe3f0</code> 이 <code class="language-plaintext highlighter-rouge">argv[1][0]</code> 의 주소임을 확인했다. 해당 주소에 정말로 내가 인자로 입력했던 문자열이 저장되어 있는지 확인해 보았다.</p> <p><img src="/assets/img/posts/format1/Untitled%209.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>확인 완료!</p> <p>현재 ASLR이 꺼져 있기 때문에, 스택의 위치는 고정이다. 따라서 앞서 확인했던 ‘스택이 참조될 때 가장 먼저 참조되는 주소’는 <code class="language-plaintext highlighter-rouge">0x7fffffffdf80</code> 으로 고정일 것이다.</p> <p>즉, <code class="language-plaintext highlighter-rouge">0x7fffffffdf80</code> 에서부터 시작해 <code class="language-plaintext highlighter-rouge">0x7fffffffe3e8</code> 까지를 참조해야 마지막에 올 <code class="language-plaintext highlighter-rouge">%n</code> 은 <code class="language-plaintext highlighter-rouge">0x7fffffffe3f0</code> 을 참조할 수 있을 것이다.</p> <p>(<code class="language-plaintext highlighter-rouge">0x7fffffffe3e8</code> - <code class="language-plaintext highlighter-rouge">0x7fffffffdf80</code>)/8 = 141이다. 메모리 한 주소가 1byte짜리이기 때문에 1byte씩을 읽어 오는 포맷 스트링 몇 개가 필요한지 알아내기 위해 8로 나누었다.</p> <p>즉, 만약 5개의 레지스터 + 142개의 주소를 읽어 온다면 맨 마지막에 내가 입력해준 문자열인 ‘AAAAAAAA’가 확인될 것이다. 예상이 맞는지 직접 프로그램에 인자를 주어 실행해 보았다.</p> <p><img src="/assets/img/posts/format1/Untitled%2010.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>어? 내 입력값을 읽어온 건 맞는데…. 처음 4바이트가 잘렸다. 왜지?</p> <p><img src="/assets/img/posts/format1/Untitled%2011.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>아하… 입력값 길이가 달라지면 문자열의 시작 주소도 달라지는 모양이다.(이걸 보고 스택의 높이가 변한다고 하고(참), root 계정으로 파이썬 익스플로잇을 만들어야 스택의 높이가 변하지 않는다고 하더라(확인되지 않음. 정말 카더라임) )</p> <p>시작 주소 차이가 -3만큼 나고 문자열의 길이 차이가 +3만큼 나는 걸 생각하면 끝 주소를 고정해 놓은 것으로 추측된다. 그렇다면 어차피 근사한 위치이기 때문에 실제 익스플로잇 페이로드를 넣어보면서 오차를 좁히는 것이 가장 효율적인 방안일 것이다.</p> <p>충분히 수학적으로 계산해서 정확하게 읽어야 할 주소의 개수를 구할 수 있을 것 같은데 왜 굳이 삽질을 하냐는 의문이 들 수 있다. 그런데 계산이 더 삽질이다… 마지막에 서술해 두었다.</p> <p>아무튼, 근사치를 구해 보면,</p> <p><img src="/assets/img/posts/format1/Untitled%2012.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>아무래도 뒤의 A 4개 대신 <code class="language-plaintext highlighter-rouge">target</code>의 주소를 넣는 게 맞을 것 같다. <code class="language-plaintext highlighter-rouge">target</code>의 주소는 objdump를 떠서도 구할 수 있는데, 나는 pwndbg를 이용해 구했다.</p> <p><img src="/assets/img/posts/format1/Untitled%2013.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p><code class="language-plaintext highlighter-rouge">0x0060103c</code>인 것으로 확인되었다.</p> <p><img src="/assets/img/posts/format1/Untitled%2014.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>64비트 환경에서 포인터 타입의 데이터는 1byte로 인식되기 때문에, <code class="language-plaintext highlighter-rouge">0x000000000060103c</code> 를 입력값으로 넣을 수 있도록…. 했는데</p> <p>.</p> <p>.</p> <p>.</p> <p>.</p> <p>.</p> <p>.</p> <p>불가능하다는 것을 확인받았다. argument로 null byte를 전달하는 방법이… 없더라… input으로 전달이라면 얼마든지 어떻게든 해볼 수 있었겠지만 argument로 전달하는 건 진짜 안 되더라. 다른 분들께 물어보니 그건 0이 필수로 포함되는 64비트 환경에서는 안 되는 문제라는 답을 받을 수 있었다.</p> <p>그치만 이 문제를 64비트에서 해결하실 수 있는 분… 꼭 연락 주세요. 분명히 방법이 있을 텐데…. <br /><br /></p> <h1 id="3-논외-수학적으로-읽어야-할-주소-개수-구하기를-시도했는데-고려한-변수가-한두개가-아니라-포기한-건에-대하여">3. 논외-수학적으로 읽어야 할 주소 개수 구하기를 시도했는데 고려한 변수가 한두개가 아니라 포기한 건에 대하여</h1> <p>웹소설 제목 st 소제목 기막히죠</p> <p>length=x(null 제외) 문자열을 넣었을 때</p> <p><img src="/assets/img/posts/format1/Untitled%2015.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>문자열의 끝 주소: 0x7fffffffe401인데 null이 여기 오는 거 감안하면 0x7fffffffe400을 끝 주소로 봐도 무방함</p> <p>따라서 문자열의 시작 주소는 0x7fffffffe400-(x-1)</p> <p>{0x7fffffffe400-(x-1) - 0x7fffffffdf80}/8 = 문자열의 시작 주소까지 읽어야 하는 주소의 수</p> <p>{1152-(x-1)}/8 = 144-(x-1)/8</p> <p>따라서 입력한 문자열이 null byte 제외 x글자일 때, 해당 문자열의 시작이 나오도록 하기 위해 읽어야 하는 주소의 수는 <code class="language-plaintext highlighter-rouge">144-(x-1)/8</code> 이다.</p> <p>예를 들어 ‘AAAAAAAA..%5$x..%{3자리_수}$p…’ 면 25글자이기 때문에 들어가야 하는 3자리 수는 144-(25-1)/8 = 144-24/8 = 144-3 = 141 이다.</p> <p>즉, ‘AAAAAAAA..%5$x..%141$p…’ 를 입력해야 한다.</p> <p>그러나 논리상 맞는데 이상하게 오차가 생겼다. 왜인지 확인해 보니…</p> <p><img src="/assets/img/posts/format1/Untitled%2016.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>입력값 길이가 달라지면… 달라진 입력값 길이/8 을 올림한 만큼…. 스택은 더 위로 이동하는 것 같았다. 이곳저곳에 조언을 구해 보니, 입력값이 늘어나면 늘어날수록 시스템이 더 큰 공간을 할당해 주고, 거기에 문제가 없도록 여유 공간 또한 주기 때문에 스택 프레임의 위치가 더 위로 이동하게 된다고 하더라. (아래 그림과 위 그림 비교)</p> <p><img src="/assets/img/posts/format1/Untitled%205.jpeg" alt="Untitled" width="100%" height="100%" /></p> <p>그래서 그것까지 계산하느니 그냥 근사값 가지고 때려 맞추는 게 더 나을 것 같아서 수학적 계산은 그만뒀다.</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="http://localhost:4000/blog/system_hacking/protostar-format1/" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About TouBVA </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="http://localhost:4000/assets/img/authors/toubva.jpeg" alt="TouBVA" /> </div> <div class="col-md-6"> <p class="author_bio">A Security Researcher, now concentrating on Security Consulting.</p> <p>Email : touBVa@gmail.com</p> <p>Website : https://toubva.github.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/TouBVa" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/johndoe" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.youtube.com/channel/UCSfLBFFfNU9r6ihfei6VeJw" target="_blank"><i class="fab fa-youtube fa-fw"></i></a> <a class="social-link" href="https://www.facebook.com/johndoe" target="_blank"><i class="fab fa-facebook fa-fw"></i></a> <a class="social-link" href="https://www.twitter.com/johndoe" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <div id="disqus_thread", style="width: 90%; margin-left: 5%;"><script> var disqus_config = function () { this.page.url = "http://localhost:4000/blog/system_hacking/protostar-format1/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/system_hacking/protostar-format1"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://toubva.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About TouBVa</div> <div class="card-body"> <p class="author_bio">Welcome to my world!</p><!-- Place this tag where you want the github button to render. --> <a class="github-button" href="https://github.com/touBVa/touBVa.github.io" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star my blog on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#dreamhack_system_hacking"></div> <li class="tag-head"> <a href="/blog/categories/dreamhack_system_hacking">dreamhack_system_hacking</a> </li> <a name="dreamhack_system_hacking"></a> <div id="#system_hacking"></div> <li class="tag-head"> <a href="/blog/categories/system_hacking">system_hacking</a> </li> <a name="system_hacking"></a> <div id="#protostar"></div> <li class="tag-head"> <a href="/blog/categories/protostar">protostar</a> </li> <a name="protostar"></a> <div id="#certification_study"></div> <li class="tag-head"> <a href="/blog/categories/certification_study">certification_study</a> </li> <a name="certification_study"></a> <div id="#paper_study"></div> <li class="tag-head"> <a href="/blog/categories/paper_study">paper_study</a> </li> <a name="paper_study"></a> <div id="#network_hacking"></div> <li class="tag-head"> <a href="/blog/categories/network_hacking">network_hacking</a> </li> <a name="network_hacking"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="http://localhost:4000/">Home</a> </li> <li> <a href="http://localhost:4000/about">About</a> </li> <li> <a href="http://localhost:4000/blog">Blog</a> </li> <li> <a href="http://localhost:4000/contact">Contact</a> </li> </div> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> <form action=""method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate> <div id="mc_embed_signup_scroll_footer"> <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label> <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value=""> </div><br /> <div class="clear"> <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success"> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/touBVa"> TouBVa</a>. Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="http://localhost:4000/assets/js/mode-switcher.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
