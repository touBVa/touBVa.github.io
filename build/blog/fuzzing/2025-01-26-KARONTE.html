<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> KARONTE: Detecting Insecure Multi-binary Interactions in Embedded Firmware ì½ê¸° - TouBVa </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="ë…¼ë¬¸ ê³µë¶€ ì¢€ í–ˆìˆ˜ë‹¤- KARONTE: Detecting Insecure Multi-binary Interactions in Embedded Firmware ì½ê¸°"> <meta name="keywords" content="KARONTE: Detecting Insecure Multi-binary Interactions in Embedded Firmware ì½ê¸°, TouBVa, fuzzing, paper_study,fuzzing"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="TouBVa" property="og:site_name" /> <meta content="KARONTE: Detecting Insecure Multi-binary Interactions in Embedded Firmware ì½ê¸°" property="og:title" /> <meta content="article" property="og:type" /> <meta content="ë…¼ë¬¸ ê³µë¶€ ì¢€ í–ˆìˆ˜ë‹¤" property="og:description" /> <meta content="https://touBVa.github.io/blog/fuzzing/2025-01-26-KARONTE" property="og:url" /> <meta content="2025-01-25T22:00:00-06:00" property="article:published_time" /> <meta content="https://touBVa.github.io/about/" property="article:author" /> <meta content="https://touBVa.github.io/assets/img/posts/2025-01-26-KARONTE/image.png" property="og:image" /> <meta content="fuzzing" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="KARONTE: Detecting Insecure Multi-binary Interactions in Embedded Firmware ì½ê¸°" /> <meta name="twitter:url" content="https://touBVa.github.io/blog/fuzzing/2025-01-26-KARONTE" /> <meta name="twitter:description" content="ë…¼ë¬¸ ê³µë¶€ ì¢€ í–ˆìˆ˜ë‹¤" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/css/main.css" /> <!-- <link rel="stylesheet" href="https://touBVa.github.io/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="https://touBVa.github.io/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="https://touBVa.github.io/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'https://touBVa.github.io' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="https://touBVa.github.io/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="https://touBVa.github.io/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="https://touBVa.github.io/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="https://touBVa.github.io/assets/js/search.js"></script> <script src="https://touBVa.github.io/assets/js/on-scroll-progress.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark nav-down" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">TouBVa</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/contact" >Contact</a > </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item"> <a class="nav-link" href="https://touBVa.github.io/styleguide"> Styleguide </a> </li> --> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <!-- <li class="nav-item" style="margin-top:5px; padding-right:20px;" > <a class="header__checkout snipcart-checkout"> <svg width="31" height="27" viewBox="0 0 31 27" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M1.10512 0.368718C0.560256 0.368718 0.118164 0.812066 0.118164 1.35848C0.118164 1.9049 0.560256 2.34824 1.10512 2.34824H4.90887L8.30138 18.4009C8.43503 19.0053 8.83085 19.5079 9.32946 19.5041H25.7788C26.3005 19.5118 26.7799 19.0375 26.7799 18.5143C26.7799 17.9911 26.3006 17.5168 25.7788 17.5245H10.1315L9.71003 15.545H27.095C27.5371 15.5412 27.9547 15.2048 28.0511 14.7718L30.354 4.87412C30.4825 4.29933 29.9852 3.67172 29.3979 3.66786H7.21171L6.6771 1.15221C6.58329 0.71276 6.15921 0.368652 5.7107 0.368652L1.10512 0.368718ZM7.623 5.64746H12.7634L13.2569 8.61674H8.25005L7.623 5.64746ZM14.7785 5.64746H20.9881L20.4946 8.61674H15.2719L14.7785 5.64746ZM23.0031 5.64746H28.1537L27.4649 8.61674H22.5097L23.0031 5.64746ZM8.67181 10.5963H13.5862L14.0797 13.5656H9.29919L8.67181 10.5963ZM15.6009 10.5963H20.1656L19.6721 13.5656H16.0944L15.6009 10.5963ZM22.1807 10.5963H27.0023L26.3135 13.5656H21.6872L22.1807 10.5963ZM12.6197 20.164C10.8141 20.164 9.32979 21.6525 9.32979 23.4632C9.32979 25.2739 10.8141 26.7624 12.6197 26.7624C14.4252 26.7624 15.9095 25.2739 15.9095 23.4632C15.9095 21.6525 14.4252 20.164 12.6197 20.164ZM22.4892 20.164C20.6837 20.164 19.1994 21.6525 19.1994 23.4632C19.1994 25.2739 20.6837 26.7624 22.4892 26.7624C24.2948 26.7624 25.7791 25.2739 25.7791 23.4632C25.7791 21.6525 24.2948 20.164 22.4892 20.164ZM12.6197 22.1435C13.3586 22.1435 13.9356 22.7222 13.9356 23.4632C13.9356 24.2042 13.3586 24.7829 12.6197 24.7829C11.8807 24.7829 11.3037 24.2042 11.3037 23.4632C11.3037 22.7222 11.8807 22.1435 12.6197 22.1435ZM22.4892 22.1435C23.2282 22.1435 23.8052 22.7222 23.8052 23.4632C23.8052 24.2042 23.2282 24.7829 22.4892 24.7829C21.7503 24.7829 21.1733 24.2042 21.1733 23.4632C21.1733 22.7222 21.7503 22.1435 22.4892 22.1435Z" fill="#ff7901" class="header__checkout-fill"></path> </svg> <span class="snipcart-items-count"></span> <span class="snipcart-total-price"></span> </a> </li> --> <script type="text/javascript"> var didScroll; var lastScrollTop = 0; var delta = 5; var navbarHeight = document.querySelector('#topNav').offsetHeight; window.addEventListener('scroll', function(event) { didScroll = true; }); setInterval(function() { if (didScroll) { hasScrolled(); didScroll = false; } }, 250); function hasScrolled() { var st = window.pageYOffset || document.documentElement.scrollTop; if (Math.abs(lastScrollTop - st) <= delta) return; var nav = document.querySelector('#topNav'); var prog = document.querySelector('#progress-bar'); if (st > lastScrollTop && st > navbarHeight) { nav.classList.remove('nav-down'); nav.classList.add('nav-up'); prog.classList.remove('toDown'); prog.classList.add('toUp'); } else { if (st < lastScrollTop) { nav.classList.remove('nav-up'); nav.classList.add('nav-down'); prog.classList.remove('toUp'); prog.classList.add('toDown'); } } lastScrollTop = st; } </script> <!-- <li class="nav-item"> <input class="nav-link switch theme-toggle" type="checkbox" name="checkbox" /> </li> --> </ul> </nav> <div id="progress-bar"></div> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">KARONTE: Detecting Insecure Multi-binary Interactions in Embedded Firmware ì½ê¸°</h1> <h4 class="post-meta">ë…¼ë¬¸ ê³µë¶€ ì¢€ í–ˆìˆ˜ë‹¤</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="https://touBVa.github.io/blog/authors/TouBVa">TouBVa</a></span> </span > at <time datetime="2025-01-25 22:00:00 -0600" itemprop="datePublished" >Jan 25, 2025</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/fuzzing/2025-01-26-KARONTE" ></span> <div class="post-categories"> Category : <a href="/blog/categories/fuzzing" >fuzzing</a > &nbsp; <a href="/blog/categories/paper_study" >paper_study</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top " src="https://touBVa.github.io/assets/img/posts/2025-01-26-KARONTE/image.png" alt="" style="height: 50%; width: 50%; display: block; margin-left: auto; margin-right: auto;" /> <br /> <br /> <ul id="markdown-toc"> <li><a href="#0-ì£¼ì•ˆì " id="markdown-toc-0-ì£¼ì•ˆì ">0. ì£¼ì•ˆì </a></li> <li><a href="#1-introduction" id="markdown-toc-1-introduction">1. Introduction</a> <ul> <li><a href="#11-abstract" id="markdown-toc-11-abstract">1.1. Abstract</a></li> </ul> </li> <li><a href="#2-background" id="markdown-toc-2-background">2. Background</a> <ul> <li><a href="#emersion-of-iot-devices" id="markdown-toc-emersion-of-iot-devices">Emersion of IoT devices</a></li> <li><a href="#constraint-of-traditional-analysis-techniques" id="markdown-toc-constraint-of-traditional-analysis-techniques">Constraint of traditional analysis techniques</a></li> <li><a href="#karonte" id="markdown-toc-karonte">KARONTE</a></li> </ul> </li> <li><a href="#3-approach-overview" id="markdown-toc-3-approach-overview">3. Approach Overview</a> <ul> <li><a href="#31-firmware-pre-processing" id="markdown-toc-31-firmware-pre-processing">3.1. Firmware Pre-processing</a></li> <li><a href="#32-border-binaries-discovery" id="markdown-toc-32-border-binaries-discovery">3.2. Border Binaries Discovery</a></li> <li><a href="#33-binary-dependency-graphbdg-recovery" id="markdown-toc-33-binary-dependency-graphbdg-recovery">3.3. Binary Dependency Graph(BDG) Recovery</a></li> <li><a href="#34-multi-binary-data-flow-analysis" id="markdown-toc-34-multi-binary-data-flow-analysis">3.4. Multi-binary Data-flow Analysis</a></li> <li><a href="#35-insecure-interactions-detection" id="markdown-toc-35-insecure-interactions-detection">3.5. Insecure Interactions Detection</a></li> </ul> </li> <li><a href="#4-border-binaries-discovery" id="markdown-toc-4-border-binaries-discovery">4. Border Binaries Discovery</a></li> <li><a href="#5-binary-dependency-graphì‚¬ì‹¤ìƒ-cpfê°€-í•µì‹¬" id="markdown-toc-5-binary-dependency-graphì‚¬ì‹¤ìƒ-cpfê°€-í•µì‹¬">5. Binary Dependency Graph(ì‚¬ì‹¤ìƒ CPFê°€ í•µì‹¬)</a> <ul> <li><a href="#51-purpose-and-overview" id="markdown-toc-51-purpose-and-overview">5.1. Purpose and Overview</a></li> <li><a href="#52-communication-paradigm-finders" id="markdown-toc-52-communication-paradigm-finders">5.2. Communication Paradigm Finders</a> <ul> <li><a href="#objective" id="markdown-toc-objective">Objective</a></li> <li><a href="#key-functionalities" id="markdown-toc-key-functionalities">Key Functionalities</a></li> <li><a href="#implementation" id="markdown-toc-implementation">Implementation</a></li> </ul> </li> <li><a href="#53-building-the-bdg" id="markdown-toc-53-building-the-bdg">5.3. Building the BDG</a></li> </ul> </li> <li><a href="#6-static-taint-analysis" id="markdown-toc-6-static-taint-analysis">6. Static Taint Analysis</a></li> <li><a href="#7-multi-binary-data-flow-analysis" id="markdown-toc-7-multi-binary-data-flow-analysis"><strong>7. Multi-Binary Data-Flow Analysis</strong></a> <ul> <li><a href="#71-key-insight--concepts" id="markdown-toc-71-key-insight--concepts">7.1. Key Insight &amp; Concepts</a> <ul> <li><a href="#72-bfg-building" id="markdown-toc-72-bfg-building">7.2. BFG Building</a></li> </ul> </li> </ul> </li> <li><a href="#8-insecure-interations-detection" id="markdown-toc-8-insecure-interations-detection">8. Insecure Interations Detection</a></li> <li><a href="#9-discussion" id="markdown-toc-9-discussion">9. Discussion</a></li> <li><a href="#10-evaluation" id="markdown-toc-10-evaluation">10. Evaluation</a></li> <li><a href="#12-conclusion" id="markdown-toc-12-conclusion">12. Conclusion</a></li> <li><a href="#appendix" id="markdown-toc-appendix">Appendix</a> <ul> <li><a href="#a-functions-identification" id="markdown-toc-a-functions-identification">A. Functions Identification</a></li> <li><a href="#b-border-binaries-discovery" id="markdown-toc-b-border-binaries-discovery">B. Border Binaries Discovery</a></li> <li><a href="#c-communication-paradigm-finders" id="markdown-toc-c-communication-paradigm-finders">C. Communication Paradigm Finders</a></li> <li><a href="#d-binary-dependency-graph-algorithm" id="markdown-toc-d-binary-dependency-graph-algorithm">D. Binary Dependency Graph Algorithm</a></li> <li><a href="#e-static-taint-analysis" id="markdown-toc-e-static-taint-analysis">E. Static Taint Analysis</a></li> <li><a href="#f-multi-binary-data-flow-analysis" id="markdown-toc-f-multi-binary-data-flow-analysis">F. Multi-binary Data-flow Analysis</a></li> <li><a href="#g-vulnerability-example" id="markdown-toc-g-vulnerability-example">G. Vulnerability Example</a></li> </ul> </li> </ul> <p><br /></p> <h1 id="0-ì£¼ì•ˆì ">0. ì£¼ì•ˆì </h1> <p>ë…¼ë¬¸ì˜ ìš”ì§€ â†’ 1) ì–´ë–¤ ìƒˆë¡œìš´ ê¸°ìˆ ì„ ë„ì…í•´ 2) ì´ë§Œí¼ì˜ í–¥ìƒëœ ê²°ê³¼ë¥¼ ëƒˆë‹¤</p> <ul> <li>ì¦‰, ë…¼ë¬¸ì˜ í•µì‹¬ì€ â†’ â€˜í–¥ìƒëœ ê²°ê³¼â€™ë¥¼ ë‚¼ ìˆ˜ ìˆì—ˆë˜ ì›ì¸ì´ â€˜ì–´ë–¤ ê¸°ìˆ â€™ ì¸ê°€</li> <li>ì¶”ê°€ë¡œ, â€˜ì´ë§Œí¼ í–¥ìƒëìŒâ€™ì˜ ê·¼ê±°ëŠ” ë¬´ì—‡ì¸ê°€</li> </ul> <p>ì´ë²ˆ ë…¼ë¬¸ ê³¼ì œì˜ ì˜ë„ëŠ” ì—°êµ¬ì‹¤ì´ ê¸°ë°˜í•˜ê³  ìˆëŠ” ì—°êµ¬ ë¶„ì•¼ê°€ ë¬´ì—‡ì¸ì§€ ì´í•´í•˜ëŠ” ê²ƒì´ë¼ê³  ìƒê°</p> <p>ë”°ë¼ì„œ â€˜ê¸°ìˆ â€™ì— ì£¼ì•ˆì ì„ ë‘ê³  ë…¼ë¬¸ ë¦¬ë”© ì§„í–‰</p> <div class="notice--primary"> <p><strong>ğŸ’¡ë…¼ë¬¸ì—ì„œ ë‚´ê°€ ì–»ì–´ì•¼ í•  ê²ƒì€? </strong></p> <p>â†’ í–¥ìƒëœ ê²°ê³¼ì˜ ê¸°ë°˜ì´ ë˜ì—ˆë˜ ê¸°ìˆ ì  ë°œì „ì€ ë¬´ì—‡ì¸ê°€?</p> <ul> <li>multiple binaries analysis + inter-binary data flow analysis</li> </ul> <p>â†’ ê·¸ê²ƒì€ ì–´ë–¤ ì•„ì´ë””ì–´ì— ê¸°ë°˜í•˜ì˜€ëŠ”ê°€?</p> <ul> <li> Modeling &amp;Tracking <strong>multi-binary interactions</strong> </li> <li> <strong>IPC paradigm used in one firmware is likely to be finite(concept)</strong> <ul> <li> <strong>í•œ ë°”ì´ë„ˆë¦¬ì˜ data I/O íŒŒì•…(mid-implementation)</strong> â†’ inter-binary data flow recovery </li> </ul> </li> <li> by leveraging <strong>CPF(Communication Paradigm Finder) modules(Implementation)</strong> </li> </ul> </div> <p><br /></p> <p><strong>ì‹œí–‰ì°©ì˜¤</strong></p> <ul> <li>Appendixê°€ ê¸°ìˆ set ì„¤ëª…ê³¼ ë§¤ìš° ë°€ì ‘í•´ ë³´ì—¬, ì›í™œí•œ ì´í•´ë¥¼ ìœ„í•´ Approach Overviewë¥¼ ì½ê³  ë°”ë¡œ Appendixë¥¼ ì½ì—ˆìŒ. <ul> <li>ê·¸ëŸ¬ë‚˜ AppendixëŠ” í•µì‹¬ ê¸°ìˆ ì˜ component ë ˆë²¨ ìš”ì†Œì— ê´€í•œ ì„¸ë¶€ ì„¤ëª…ì´ì—ˆìŒ</li> <li>ì¦‰ ë…¼ë¬¸ ë³¸ë¬¸ì„ ë‹¤ ì½ê³  Appendixë¥¼ ì½ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ì—ˆìŒ</li> </ul> </li> </ul> <p><br /></p> <h1 id="1-introduction">1. Introduction</h1> <h2 id="11-abstract">1.1. Abstract</h2> <p><img src="/assets/img/posts/2025-01-26-KARONTE/image.png" alt="image.png" width="100%" height="100%" /></p> <ul> <li>IoT devices - Software on these systems(Firmware) <ul> <li>Analysis challenged <ul> <li>Hardware-dependent</li> <li>Not-standardized Environment â†’ 1) unique &amp; minimal 2) non-standard configurations</li> </ul> </li> <li>Analysis complicated <ul> <li>Multiple Binaries <ul> <li>Addressing the communication between executables is complicated</li> </ul> </li> </ul> </li> </ul> </li> <li>KARONTE <ul> <li>Static</li> <li>Modeling &amp; Tracking <strong>multi-binary interactions</strong></li> <li>Starting from taint information â†’ insecure interactions â†’ vulnerability identification</li> <li>Evaluation <ol> <li>On Tracking&amp;Constraining Multi-binary interactions abilities</li> <li>On Scaling ability about: <ol> <li>firmwares with various size and complexity</li> </ol> </li> </ol> </li> </ul> </li> </ul> <p><br /></p> <h1 id="2-background">2. Background</h1> <h3 id="emersion-of-iot-devices">Emersion of IoT devices</h3> <ul> <li>Vast amount of IoT devices introduced new-coined threats into cybersecurity landscape</li> <li>Techniques that are invented, especially in the perspective of unpacking binaries, were insufficient</li> </ul> <p><br /></p> <h3 id="constraint-of-traditional-analysis-techniques">Constraint of traditional analysis techniques</h3> <ul> <li> <p><strong>Interconnected components</strong>(functionality based on multiple programs execution)</p> <p>â†” analysis without accounting for the <strong>internal flow of data</strong></p> <p>â†’ Ignore <strong>meaningful constraints</strong> arise from inter-binary communication</p> <p>â†’ Inability to <strong>differentiate sources of input</strong>(attacker-controlled or non-attacker-controlled)</p> <p>â†’ Limited search performance that leads to uncovering <strong>only superficial bugs</strong></p> </li> </ul> <p><strong>Hence</strong>,</p> <ul> <li>Consideration about <strong>multiple binary execution</strong> is necessary</li> <li>Analysis on the <strong>data shared</strong> among multiple binary is necessary</li> </ul> <p><br /></p> <h3 id="karonte">KARONTE</h3> <ul> <li>Static</li> <li>Track data flow</li> <li>Intuition: <ol> <li><strong>IPC paradigm used in one firmware is likely to be finite</strong></li> <li>Derive commonalities in the paradigm set</li> <li>Use the commonalities to detect input locations &amp; inter-component interactions</li> <li>Use the verified interactions to track inter-component data flow</li> <li>Perform cross-binary taint analysis</li> <li>Detect insecure uses(potential vulnerabilities)</li> </ol> </li> </ul> <p><br /></p> <h1 id="3-approach-overview">3. Approach Overview</h1> <p>ì—¬ê¸° ì„¤ëª…ëœ í•­ëª© ì •ë¦¬í•˜ê³  Appendixì— ë‚˜ì˜¨ ê±°ë‘ ë§¤í•‘í•´ì„œ ì •ë¦¬í•˜ì</p> <p><br /></p> <h2 id="31-firmware-pre-processing">3.1. Firmware Pre-processing</h2> <ul> <li>unpack firmware sample using â€˜binwalkâ€™</li> </ul> <p><br /></p> <h2 id="32-border-binaries-discovery">3.2. Border Binaries Discovery</h2> <ul> <li>â€˜Border Binaryâ€™: Binaries that export the device functionality to the outside world <ul> <li>Represents the point where accepts user requests &amp; references user-controlled data</li> </ul> </li> </ul> <p><br /></p> <h2 id="33-binary-dependency-graphbdg-recovery">3.3. Binary Dependency Graph(BDG) Recovery</h2> <ul> <li>â€˜BDGâ€™ <ul> <li>Directed graph</li> <li>Models communication among border binaries by leveraging <strong>CPF(Communication Paradigm Finder) modules</strong></li> </ul> </li> </ul> <p><br /></p> <h2 id="34-multi-binary-data-flow-analysis">3.4. Multi-binary Data-flow Analysis</h2> <ul> <li>By using â€˜static taint engineâ€™, the KARONTE: <ul> <li>Tracks data propagation</li> <li>Collects data constraints</li> </ul> </li> <li>Simulate data propagation applying features gathered <ul> <li>from the target binary b to other binaries that have inbound edges from b</li> </ul> </li> </ul> <p><br /></p> <h2 id="35-insecure-interactions-detection">3.5. Insecure Interactions Detection</h2> <ul> <li>Identifying security issues</li> </ul> <p><br /></p> <h1 id="4-border-binaries-discovery">4. Border Binaries Discovery</h1> <p><br /></p> <h1 id="5-binary-dependency-graphì‚¬ì‹¤ìƒ-cpfê°€-í•µì‹¬">5. Binary Dependency Graph(ì‚¬ì‹¤ìƒ CPFê°€ í•µì‹¬)</h1> <p><br /></p> <h2 id="51-purpose-and-overview">5.1. Purpose and Overview</h2> <ul> <li>BDG: detects data dependencies &amp; model data propagation (setter binary â†’ getter binary)</li> <li>Challenges: <ul> <li>Inter-binary data propagation: <ul> <li>control flow information is useless because: <ul> <li>processes do NOT normally access other processesâ€™ memory regions.</li> </ul> </li> </ul> </li> </ul> </li> <li>Solution: <ol> <li>Model IPC paradigms by using CPFes(Communication Paradigm Finders)</li> <li>Use modeled paradigms to build a graph == BDG(Binary Dependency Graph)</li> </ol> </li> </ul> <p><br /></p> <h2 id="52-communication-paradigm-finders">5.2. Communication Paradigm Finders</h2> <h3 id="objective">Objective</h3> <ul> <li>Detect &amp; Describe specific IPC paradigm which binary uses to share data</li> <li>1) explore binary &amp; program path â†’ 2) Does the path contains the necessary code to share data through the communication paradigm? â†’ 3) If so, conduct deeper analysis using techniques below â†’ 4) create edges of BDG utilizing features distinguished <ol> <li>Data Key Recovery</li> <li>Flow Direction Determination</li> <li>Binary Set Magnification</li> </ol> </li> </ul> <p><br /></p> <h3 id="key-functionalities">Key Functionalities</h3> <ol> <li><strong>Data Key Recovery</strong> <ol> <li>referenced by the binary for IPCs</li> <li>fundamental &amp; essential â†’ THE MOST IMPORTANT TECHNIQUE</li> </ol> </li> <li>Flow Direction Determination(scope: one binary) <ol> <li>Role of each program points: â€˜Setterâ€™ &amp; â€˜Getterâ€™</li> <li>program points: access the data keys</li> </ol> </li> <li>Binary Set Magnification(scope: whole firmware) <ol> <li>if any â€˜binariesâ€™ refer to the data keys â†’ scheduled for further analysis</li> </ol> </li> </ol> <p><br /></p> <h3 id="implementation">Implementation</h3> <ul> <li>â€˜Semantic CPFâ€™: OS-Independent <ul> <li>Intuition: â€˜Data Keysâ€™ *IPC must rely on them *Often hard-coded in binaries</li> </ul> </li> <li>KARONTE uses: <ul> <li>Environment CPFes</li> <li>File CPFes</li> <li>Socket CPFes</li> <li>Semantic CPFes</li> </ul> </li> </ul> <p><br /></p> <h2 id="53-building-the-bdg">5.3. Building the BDG</h2> <p>(ì‹œê°„ì´ ë¶€ì¡±í•œ ê´€ê³„ë¡œ ìš°ì„ ìˆœìœ„ í•˜ê°•)</p> <p><br /></p> <h1 id="6-static-taint-analysis">6. Static Taint Analysis</h1> <p>The operation of the underlying taint engine</p> <p><br /></p> <h1 id="7-multi-binary-data-flow-analysis"><strong>7. Multi-Binary Data-Flow Analysis</strong></h1> <p>How KARONTE combines the taint engine with the BDG to do detection</p> <p>BDG</p> <p>BFG</p> <p><br /></p> <h2 id="71-key-insight--concepts">7.1. Key Insight &amp; Concepts</h2> <ul> <li>Paths with fewer constraints on user data dd are more likely to expose vulnerabilities.</li> <li>BFG: Extended version of the BDG in the direction of â€˜least strict set of constraint applied to the data shared among multiple binariesâ€™</li> </ul> <p><br /></p> <h3 id="72-bfg-building">7.2. BFG Building</h3> <ol> <li>Initialization</li> <li>Constraint Propagation</li> </ol> <p><br /></p> <h1 id="8-insecure-interations-detection">8. Insecure Interations Detection</h1> <p>Detection Target:</p> <ol> <li>Memory-Corruption bugs</li> <li>DoS vulnerabilities</li> </ol> <p><br /></p> <h1 id="9-discussion">9. Discussion</h1> <p><br /></p> <h1 id="10-evaluation">10. Evaluation</h1> <p><br /></p> <h1 id="12-conclusion">12. Conclusion</h1> <p>KARONTE: Detect insecure interactions among components of embedded firmware</p> <p>+) Emphasizing the effectiveness of KARONTE</p> <p>â†’ ì–´ë–»ê²Œ insecure interactionsë¥¼ ì•Œì•„ëƒˆëŠ”ì§€ì— ê´€í•´ ì„¤ëª…í•  ìˆ˜ ìˆëŠ” ê²Œ ì¤‘ìš”í•œ ë“¯í•´, Evaluation íŒŒíŠ¸ëŠ” ë‚˜ì¤‘ì— ì½ì–´ë³´ëŠ” ê²ƒìœ¼ë¡œ í•¨</p> <p><br /></p> <hr /> <p><br /></p> <h1 id="appendix">Appendix</h1> <blockquote> <p>Backgroundë¥¼ ì½ìœ¼ë©´ì„œ ì´ê±¸ ê°™ì´ ë´ì•¼ í•  ê²ƒ ê°™ìŒ</p> </blockquote> <p><br /></p> <h3 id="a-functions-identification">A. Functions Identification</h3> <p>3 types of functions is the goal of distinguishment</p> <p><br /></p> <ol> <li> <p><strong>memcmp-like functions</strong></p> <p class="notice">ğŸ‘¥: sementically equvalent to memory comparisons</p> <ol> <li><strong>methodology</strong> <ol> <li>If the target function $f$ contains at least one loop, then: <ol> <li>Scan the instructions in the body of the loop in the linear manner and list every program point $p$ which contains memory comparison instructions</li> <li>Compute a static backward slice $p$ â†’ $f$â€™s entry point</li> <li>Inspect $f$â€™s args to clarify whether they could affect operands in $p$ and if so, then: <ol> <li>$f$ becomes a candidate of memcmp-like functions</li> <li>Calculate the size of $f$(based on number of its basic blocks)</li> <li>Adopt <code class="language-plaintext highlighter-rouge">BootStomp</code>â€™s threshold to decrease the number of false positives</li> </ol> </li> </ol> </li> </ol> </li> </ol> </li> <li> <p><strong>strlen-like functions</strong></p> <p class="notice">ğŸ‘¥: calculate the length of a buffer</p> <ol> <li><strong>methodology</strong> <ol> <li><strong>similar to memcmp-like function search</strong> implementation + â€˜the existence of <strong>counter</strong>, which increases as the number of loop iteration goesâ€™</li> </ol> </li> </ol> </li> <li> <p><strong>memcpy-like functions</strong></p> <p class="notice">ğŸ‘¥: copy the content of a memory location to another</p> <ol> <li><strong>methodology</strong> <ol> <li>same with the methodology of <code class="language-plaintext highlighter-rouge">Bootstomp</code></li> </ol> </li> </ol> </li> <li><strong>function body is not available</strong> <ol> <li>Heuristically match strings on the name of the function</li> </ol> <p>(opinion) It may become an armpit of this system</p> </li> <li><strong>Optimization strategy</strong> <ol> <li> <p>Harness function generation: abstract the functions described above to minimize the resource of repeated execution</p> <p>â†’ mitigate the â€˜path explosion problemâ€™</p> <p>â†’ speed up, without losing precision.</p> </li> </ol> </li> </ol> <p><br /></p> <h3 id="b-border-binaries-discovery">B. Border Binaries Discovery</h3> <p><strong>Connection mark â†’ Flag</strong></p> <p><strong>Network mark â†’ Counter</strong></p> <p>Calculation Hardness: Connection markÂ Â»Â»Â»Â» Network mark</p> <ol> <li>Network mark calculation <ol> <li>Retrieve all the <strong>memory comparisons</strong> within a binary == Assume these will <strong>refer to hard-coded network related strings</strong></li> <li>The strings mostly referred within <strong>the basic block(the call to the memory comparison, too)</strong></li> </ol> </li> <li>Connenction mark calculation <ol> <li>Forward static taint analysis + Backward static taint analysis</li> <li>Limitation on the {Number of functions analyzed, Time of symbolic exploration}</li> <li>For the case of path(source-sink) exploration failed: <ol> <li>any imprecision from a function $f$ analysisâ‡’ analysis for $f$ is incomplete</li> <li>over 50%(setted threshold) of experiments ends up in incomplete analysis, then: <ol> <li>conservatively set the connection mark.</li> </ol> </li> </ol> </li> <li>Regarding OS dependency: if the OS is unknown, then simply set the connection mark.</li> </ol> </li> <li>Utilize the feature â€˜cmpâ€™ when calculating Parsing Score.</li> </ol> <h3 id="c-communication-paradigm-finders">C. Communication Paradigm Finders</h3> <p><mark> Purpose of CPF: When recovering BDG(Binary Dependency Graph), by leveraging CPF, it becomes able to map inter-binary data flow.</mark></p> <p><br /></p> <table> <thead> <tr> <th>Aspect</th> <th>Environment CPF</th> <th>Semantic CPF</th> </tr> </thead> <tbody> <tr> <td>Trigger for Analysis</td> <td>Calls that set/get environment variables or execute binaries.</td> <td>Memory operations using hardcoded data keys as indices or references.</td> </tr> <tr> <td>Primary Detection</td> <td>Strings representing environment keys or binary names.</td> <td>Functions setting or getting data based on predefined data keys.</td> </tr> <tr> <td>Application Context</td> <td>More suited for analyzing high-level OS interactions.</td> <td>Ideal for low-level memory and firmware analysis.</td> </tr> </tbody> </table> <p><br /></p> <ol> <li>OS-dependent CPF: Environment CPF <ol> <li>Key Idea <ol> <li>Calling to a function setting (or getting) environment variables is almost necessary when sharing data through environment variables before executing another binary. <ol> <li>Binary Execution Block Searching</li> <li>Path (entry-block) searching to find out program points calling environment variable setting functions</li> <li>reach-def analysis on path(entry-point) â†’ arguments values determination</li> <li>Determined values == â€˜data keysâ€™</li> <li> <ul> <li>â€˜Binary Set Magnification Functionalityâ€™ â‡’ reach-def analysis â†’ arg strings collection â†’ possible binary names inference</li> </ul> </li> <li>If binary names are unable to resolve â†’ find all the binaries that rely on the data keys previously recovered.</li> </ol> </li> </ol> </li> <li>Detection Focus <ol> <li>Program Path</li> <li>Binary Level Interaction</li> </ol> </li> </ol> </li> <li>OS-independent CPF: Semantic CPF <ol> <li>Key Idea <ol> <li>IPC often relies on predefined data keys, which is often hardcoded as constants.</li> </ol> </li> <li>Detection Focus <ol> <li>Function-Level Data Flow</li> <li>Memory Operations</li> </ol> </li> </ol> </li> </ol> <p><br /></p> <h3 id="d-binary-dependency-graph-algorithm">D. Binary Dependency Graph Algorithm</h3> <p><br /></p> <h3 id="e-static-taint-analysis">E. Static Taint Analysis</h3> <p><br /></p> <h3 id="f-multi-binary-data-flow-analysis">F. Multi-binary Data-flow Analysis</h3> <p><br /></p> <h3 id="g-vulnerability-example">G. Vulnerability Example</h3> <p><br /></p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="https://touBVa.github.io/blog/fuzzing/2025-01-26-KARONTE" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About TouBVA </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="https://touBVa.github.io/assets/img/authors/toubva.jpeg" alt="TouBVA" /> </div> <div class="col-md-6"> <p class="author_bio">A Security Researcher, now concentrating on Security Consulting.</p> <p>Email : touBVa@gmail.com</p> <p>Website : https://toubva.github.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/TouBVa" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/johndoe" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.youtube.com/channel/UCSfLBFFfNU9r6ihfei6VeJw" target="_blank"><i class="fab fa-youtube fa-fw"></i></a> <a class="social-link" href="https://www.facebook.com/johndoe" target="_blank"><i class="fab fa-facebook fa-fw"></i></a> <a class="social-link" href="https://www.twitter.com/johndoe" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <div id="disqus_thread", style="width: 90%; margin-left: 5%;"><script> var disqus_config = function () { this.page.url = "https://touBVa.github.io/blog/fuzzing/2025-01-26-KARONTE"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/fuzzing/KARONTE"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://toubva.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About TouBVa</div> <div class="card-body"> <p class="author_bio">Welcome to my world!</p><!-- Place this tag where you want the github button to render. --> <a class="github-button" href="https://github.com/touBVa/touBVa.github.io" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star my blog on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#dreamhack_system_hacking"></div> <li class="tag-head"> <a href="/blog/categories/dreamhack_system_hacking">dreamhack_system_hacking</a> </li> <a name="dreamhack_system_hacking"></a> <div id="#system_hacking"></div> <li class="tag-head"> <a href="/blog/categories/system_hacking">system_hacking</a> </li> <a name="system_hacking"></a> <div id="#protostar"></div> <li class="tag-head"> <a href="/blog/categories/protostar">protostar</a> </li> <a name="protostar"></a> <div id="#certification_study"></div> <li class="tag-head"> <a href="/blog/categories/certification_study">certification_study</a> </li> <a name="certification_study"></a> <div id="#paper_study"></div> <li class="tag-head"> <a href="/blog/categories/paper_study">paper_study</a> </li> <a name="paper_study"></a> <div id="#network_hacking"></div> <li class="tag-head"> <a href="/blog/categories/network_hacking">network_hacking</a> </li> <a name="network_hacking"></a> <div id="#blockchain"></div> <li class="tag-head"> <a href="/blog/categories/blockchain">blockchain</a> </li> <a name="blockchain"></a> <div id="#reversing"></div> <li class="tag-head"> <a href="/blog/categories/reversing">reversing</a> </li> <a name="reversing"></a> <div id="#my_life"></div> <li class="tag-head"> <a href="/blog/categories/my_life">my_life</a> </li> <a name="my_life"></a> <div id="#web_hacking"></div> <li class="tag-head"> <a href="/blog/categories/web_hacking">web_hacking</a> </li> <a name="web_hacking"></a> <div id="#fuzzing"></div> <li class="tag-head"> <a href="/blog/categories/fuzzing">fuzzing</a> </li> <a name="fuzzing"></a> <div id="#forensic"></div> <li class="tag-head"> <a href="/blog/categories/forensic">forensic</a> </li> <a name="forensic"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="https://touBVa.github.io/">Home</a> </li> <li> <a href="https://touBVa.github.io/about">About</a> </li> <li> <a href="https://touBVa.github.io/blog">Blog</a> </li> <li> <a href="https://touBVa.github.io/contact">Contact</a> </li> </div> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> <form action=""method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate> <div id="mc_embed_signup_scroll_footer"> <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label> <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value=""> </div><br /> <div class="clear"> <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success"> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/touBVa"> TouBVa</a>. Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="https://touBVa.github.io/assets/js/mode-switcher.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
