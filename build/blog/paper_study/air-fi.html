<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8" /> <title> [논문 스터디] Air-Fi: Leaking Data From Air-Gapped Computers Using Wi-Fi Frequencies - TouBVa </title> <meta http-equip="X-UA-Compatible" content="IE=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta name="description" content="Air-gap break using DDR-SDRAM- [논문 스터디] Air-Fi: Leaking Data From Air-Gapped Computers Using Wi-Fi Frequencies"> <meta name="keywords" content="[논문 스터디] Air-Fi: Leaking Data From Air-Gapped Computers Using Wi-Fi Frequencies, TouBVa, paper_study, network_hacking,Air-Gap break"/> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" /> <meta content="" property="fb:app_id" /> <meta content="TouBVa" property="og:site_name" /> <meta content="[논문 스터디] Air-Fi: Leaking Data From Air-Gapped Computers Using Wi-Fi Frequencies" property="og:title" /> <meta content="article" property="og:type" /> <meta content="Air-gap break using DDR-SDRAM" property="og:description" /> <meta content="http://localhost:4000/blog/paper_study/air-fi" property="og:url" /> <meta content="2023-05-29T16:59:23+09:00" property="article:published_time" /> <meta content="http://localhost:4000/about/" property="article:author" /> <meta content="http://localhost:4000/assets/img/posts/hello.jpg" property="og:image" /> <meta content="paper_study" property="article:section" /> <!-- Twitter Cards --> <meta name="twitter:card" content="summary" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:title" content="[논문 스터디] Air-Fi: Leaking Data From Air-Gapped Computers Using Wi-Fi Frequencies" /> <meta name="twitter:url" content="http://localhost:4000/blog/paper_study/air-fi" /> <meta name="twitter:description" content="Air-gap break using DDR-SDRAM" /> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css" /> <!-- <link rel="stylesheet" href="http://localhost:4000/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/lightgallery/dist/css/lightgallery.min.css" /> <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="http://localhost:4000/assets/bower_components/icono/dist/icono.min.css" /> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet" /> <!-- Favicon --> <link rel="icon" href="http://localhost:4000/assets/img/favicon.ico" type="image/gif" sizes="16x16" /> <script> var base_url = 'http://localhost:4000' ; </script> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous" ></script> <!-- <script src="http://localhost:4000/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="http://localhost:4000/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="http://localhost:4000/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="http://localhost:4000/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="http://localhost:4000/assets/bower_components/ghosthunter/dist/jquery.ghostHunter.min.js"></script> <script src="http://localhost:4000/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="http://localhost:4000/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="http://localhost:4000/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="http://localhost:4000/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <script src="http://localhost:4000/assets/js/search.js"></script> <script src="http://localhost:4000/assets/js/on-scroll-progress.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script> <!-- for Mathjax support --> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } } }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous" ></script> <!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]--> <!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]--> </head> <body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">TouBVa</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/" >Home</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/about" >About</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/contact" >Contact</a > </li> </ul> </div> <!-- <ul class="nav justify-content-end"> <li class="nav-item"> <a class="nav-link" href="http://localhost:4000/styleguide"> Styleguide </a> </li> <li class="nav-item"> <a class="nav-link toggle-search-button" href="#search"> <i class="fa fa-search search-icon" aria-hidden="true"></i> </a> </li> <li class="nav-item" style="margin-top:5px; padding-right:20px;" > <a class="header__checkout snipcart-checkout"> <svg width="31" height="27" viewBox="0 0 31 27" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M1.10512 0.368718C0.560256 0.368718 0.118164 0.812066 0.118164 1.35848C0.118164 1.9049 0.560256 2.34824 1.10512 2.34824H4.90887L8.30138 18.4009C8.43503 19.0053 8.83085 19.5079 9.32946 19.5041H25.7788C26.3005 19.5118 26.7799 19.0375 26.7799 18.5143C26.7799 17.9911 26.3006 17.5168 25.7788 17.5245H10.1315L9.71003 15.545H27.095C27.5371 15.5412 27.9547 15.2048 28.0511 14.7718L30.354 4.87412C30.4825 4.29933 29.9852 3.67172 29.3979 3.66786H7.21171L6.6771 1.15221C6.58329 0.71276 6.15921 0.368652 5.7107 0.368652L1.10512 0.368718ZM7.623 5.64746H12.7634L13.2569 8.61674H8.25005L7.623 5.64746ZM14.7785 5.64746H20.9881L20.4946 8.61674H15.2719L14.7785 5.64746ZM23.0031 5.64746H28.1537L27.4649 8.61674H22.5097L23.0031 5.64746ZM8.67181 10.5963H13.5862L14.0797 13.5656H9.29919L8.67181 10.5963ZM15.6009 10.5963H20.1656L19.6721 13.5656H16.0944L15.6009 10.5963ZM22.1807 10.5963H27.0023L26.3135 13.5656H21.6872L22.1807 10.5963ZM12.6197 20.164C10.8141 20.164 9.32979 21.6525 9.32979 23.4632C9.32979 25.2739 10.8141 26.7624 12.6197 26.7624C14.4252 26.7624 15.9095 25.2739 15.9095 23.4632C15.9095 21.6525 14.4252 20.164 12.6197 20.164ZM22.4892 20.164C20.6837 20.164 19.1994 21.6525 19.1994 23.4632C19.1994 25.2739 20.6837 26.7624 22.4892 26.7624C24.2948 26.7624 25.7791 25.2739 25.7791 23.4632C25.7791 21.6525 24.2948 20.164 22.4892 20.164ZM12.6197 22.1435C13.3586 22.1435 13.9356 22.7222 13.9356 23.4632C13.9356 24.2042 13.3586 24.7829 12.6197 24.7829C11.8807 24.7829 11.3037 24.2042 11.3037 23.4632C11.3037 22.7222 11.8807 22.1435 12.6197 22.1435ZM22.4892 22.1435C23.2282 22.1435 23.8052 22.7222 23.8052 23.4632C23.8052 24.2042 23.2282 24.7829 22.4892 24.7829C21.7503 24.7829 21.1733 24.2042 21.1733 23.4632C21.1733 22.7222 21.7503 22.1435 22.4892 22.1435Z" fill="#ff7901" class="header__checkout-fill"></path> </svg> <span class="snipcart-items-count"></span> </a> </li> </ul> --> </nav> <div id="progress-bar"></div> <!-- Search Form --> <div class="search-form-container"> <form class="search-form"> <fieldset class="search-form__fieldset"> <div class="row"> <div class="col-lg-8 offset-md-2"> <input class="search-form__field" placeholder="Type to Search..." autofocus> <input class="search-form__submit" type="submit" value="search"> </div> </div> </fieldset> </form> <div class="row"> <div class="col-lg-8 offset-md-2 search-results"> <div class="card search-results"></div> </div> </div> <div class="close-search-button search-form-container__close"> <i class="fa fa-times icon"></i> </div> </div><div class="main-container"> <div class="row justify-content-center" id="blog-post-container"> <div class="col-lg-10"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">[논문 스터디] Air-Fi: Leaking Data From Air-Gapped Computers Using Wi-Fi Frequencies</h1> <h4 class="post-meta">Air-gap break using DDR-SDRAM</h4> <p class="post-summary"> Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name"><a href="http://localhost:4000/blog/authors/TouBVa">TouBVa</a></span> </span > at <time datetime="2023-05-29 16:59:23 +0900" itemprop="datePublished" >May 29, 2023</time > </p> <span class="disqus-comment-count" data-disqus-identifier="/blog/paper_study/air-fi" ></span> <div class="post-categories"> Category : <a href="/blog/categories/paper_study" >paper_study</a > &nbsp; <a href="/blog/categories/network_hacking" >network_hacking</a > </div> </div> <div class="card-body" itemprop="articleBody"> <img class="card-img-top" src="http://localhost:4000/assets/img/posts/hello.jpg" alt="" /> <br /> <br /> <ul id="markdown-toc"> <li><a href="#들어가기에-앞서" id="markdown-toc-들어가기에-앞서">들어가기에 앞서</a></li> <li><a href="#sec3-공격-모델-이원적" id="markdown-toc-sec3-공격-모델-이원적">Sec3) 공격 모델: 이원적</a> <ul> <li><a href="#개요" id="markdown-toc-개요">개요</a></li> <li><a href="#transmitter" id="markdown-toc-transmitter">Transmitter</a></li> <li><a href="#receiver" id="markdown-toc-receiver">Receiver</a></li> </ul> </li> <li><a href="#sec4-ddr-sdram-wi-fi-배경지식-다들-알-것-같아서-생략" id="markdown-toc-sec4-ddr-sdram-wi-fi-배경지식-다들-알-것-같아서-생략">Sec4) DDR SDRAM, Wi-Fi 배경지식 (다들 알 것 같아서 생략)</a></li> <li><a href="#sec5-sendertransmissin-입장의-기작" id="markdown-toc-sec5-sendertransmissin-입장의-기작">Sec5) Sender(transmissin) 입장의 기작</a> <ul> <li><a href="#51-signal-generation" id="markdown-toc-51-signal-generation">5.1. Signal Generation</a> <ul> <li><a href="#511-전자기-신호-방출" id="markdown-toc-511-전자기-신호-방출">5.1.1. 전자기 신호 방출</a></li> <li><a href="#512-wi-fi-신호를-어떻게-생성할-것인가" id="markdown-toc-512-wi-fi-신호를-어떻게-생성할-것인가">5.1.2. Wi-Fi 신호를 어떻게 생성할 것인가?</a></li> <li><a href="#513-wi-fi-채널-간섭-현상은-어떻게-해결할-것인가" id="markdown-toc-513-wi-fi-채널-간섭-현상은-어떻게-해결할-것인가">5.1.3. Wi-Fi 채널 간섭 현상은 어떻게 해결할 것인가?</a></li> </ul> </li> <li><a href="#52-signal-modulation" id="markdown-toc-52-signal-modulation">5.2. <strong>Signal Modulation</strong></a></li> <li><a href="#53-data-transmission" id="markdown-toc-53-data-transmission">5.3. <strong>Data Transmission</strong></a></li> </ul> </li> <li><a href="#sec6-receiver-입장의-기작" id="markdown-toc-sec6-receiver-입장의-기작">Sec6) Receiver 입장의 기작</a> <ul> <li><a href="#61-개요" id="markdown-toc-61-개요">6.1. 개요</a></li> <li><a href="#62-physical-layer에-접근-가능한-wifi-스택의-레이어" id="markdown-toc-62-physical-layer에-접근-가능한-wifi-스택의-레이어">6.2. Physical Layer에 접근 가능한 Wifi 스택의 레이어</a> <ul> <li><a href="#621-application-layer-user-level" id="markdown-toc-621-application-layer-user-level">6.2.1. Application Layer (user-level)</a></li> <li><a href="#622-device-drivers-layer-kernel-layer" id="markdown-toc-622-device-drivers-layer-kernel-layer">6.2.2. Device-Drivers Layer (kernel-layer)</a></li> <li><a href="#623-firmware-level" id="markdown-toc-623-firmware-level">6.2.3. Firmware-Level</a></li> <li><a href="#624-attack-surface-설정" id="markdown-toc-624-attack-surface-설정">6.2.4. Attack Surface 설정</a></li> </ul> </li> </ul> </li> <li><a href="#sec7-실제-실험-방식-차후-수정본에서-업로드" id="markdown-toc-sec7-실제-실험-방식-차후-수정본에서-업로드">Sec7) 실제 실험 방식 (차후 수정본에서 업로드)</a></li> <li><a href="#sec8-countermeasures-차후-수정본에서-디테일-업로드" id="markdown-toc-sec8-countermeasures-차후-수정본에서-디테일-업로드">Sec8) Countermeasures (차후 수정본에서 디테일 업로드)</a> <ul> <li><a href="#81-물리적-분리" id="markdown-toc-81-물리적-분리">8.1. 물리적 분리</a></li> <li><a href="#82-runtime-detection" id="markdown-toc-82-runtime-detection">8.2. Runtime Detection</a></li> <li><a href="#83-memory-access-monitor" id="markdown-toc-83-memory-access-monitor">8.3. Memory Access Monitor</a></li> <li><a href="#84-wi-fi-monitoring" id="markdown-toc-84-wi-fi-monitoring">8.4. Wi-Fi Monitoring</a></li> <li><a href="#85-signal-jamminghw" id="markdown-toc-85-signal-jamminghw">8.5. Signal Jamming(H/W)</a></li> <li><a href="#86-signal-jammingsw" id="markdown-toc-86-signal-jammingsw">8.6. Signal Jamming(S/W)</a></li> <li><a href="#87-faraday-shielding" id="markdown-toc-87-faraday-shielding">8.7. Faraday Shielding</a></li> </ul> </li> </ul> <p><br /></p> <h1 id="들어가기에-앞서">들어가기에 앞서</h1> <p><br /></p> <p>이번에 읽은 논문은 <mark> AIR-FI: Leaking Data From Air-Gapped Computers Using Wi-Fi Frequencies </mark> (저자: Mordechai Guri)이다. 저작권을 존중해 최대한 쉬운 말로 개념을 설명하는 선에서 글을 끝낼 것이다. 원문을 보고 싶다면, <a href="https://ieeexplore.ieee.org/document/9808153">이쪽</a>에서 구독이나 구매 혹은 대학생 신분을 입증하고 무료로 pdf를 받아 보길 바란다.</p> <p>학교에서 교수님께 추천받아 읽은 논문인데, 정말 글을 잘 썼다는 생각이 들어 읽으면서 writing에 대해 다시 생각해 보게 된 논문이다. 근데 이 교수님은 추천해 주시는 논문마다 수작이더라… 어떻게 찾으셨어요 물어보고 싶다</p> <p>원래는 취미로 논문을 읽는데, 아니 이렇게 말하니까 되게 이상한데 근데 힘들여 읽는 게 아니고 전체를 이해하는 선에서 간단히 끝내는 식으로… 흥미가 가는 주제만 골라서… 그런 거라 정말 취미 독서 수준이다. 아무튼 이렇게 가볍게 읽고 넘겨버리니까 묘하게 휘발성인 느낌이라 앞으로 한 편 읽을 때마다 독후감을 남기기로 했다.</p> <p>(이번 논문은 기말고사 프로젝트 용으로 추천받은 거라 조원들과 공유하려고 더 세세하게 썼다)</p> <p>개인적으로 피지컬 레이어가 포함된 보안 관련 연구를 좋아해서 더 재밌게 읽었다. 특히 사이드 채널 어택은 너무나도 인디아나 존스의 보물찾기 느낌이라 좋아한다구!</p> <p><br /><br /></p> <h1 id="sec3-공격-모델-이원적">Sec3) 공격 모델: 이원적</h1> <p><br /></p> <h2 id="개요">개요</h2> <p><br /></p> <ul> <li> <p>Transmitter가 CPU-DDR SDRAM 간 데이터 전송을 조절한다(RAM 모델명이 DDR4-x라고 치면 x는 최대 몇 MHz로 데이터를 보낼 수 있는지를 의미한다. 따라서 순정 상태일 때 어떤 램이 방출하는 전자기파는 x MHz다).</p> <p>→ 이는 CPU의 오버클럭, 언더클럭으로 조정한다.</p> </li> <li>해당 데이터 버스에서 데이터가 전기 신호로 오갈 때마다 방출되는 전기 신호의 주파수를 2.4GHz 와이파이 채널 대역과 맞추어 와이파이 신호로서 해독될 수 있게 한다.</li> <li>그렇게 방출된 와이파이 신호를, 다양한 아키텍처 레이어에서 조작한 와이파이 Receiver를 이용해 해독하여 Usable한 데이터 포맷으로 만든다.</li> </ul> <p><br /></p> <h2 id="transmitter">Transmitter</h2> <p><br /></p> <blockquote> <p>Air-gapped workstation</p> </blockquote> <p><br /></p> <h2 id="receiver">Receiver</h2> <p><br /></p> <blockquote> <p>Transmitter가 Wi-fi signal emission 하면 그걸 받아챙기는 Wi-fiable 디바이스</p> </blockquote> <p><br /><br /></p> <h1 id="sec4-ddr-sdram-wi-fi-배경지식-다들-알-것-같아서-생략">Sec4) DDR SDRAM, Wi-Fi 배경지식 (다들 알 것 같아서 생략)</h1> <p><br /></p> <p>(그치만 혹시나 하는 마음에 간략하게 써둠)</p> <p>DDR4-2400이라고 하면 2400MHz로 데이터를 전송할 수 있는 거고, 이때 데이터 버스에서는 2400MHz 주파수의 전자기파가 발생한다. 여기에 착안하여 데이터 버스에 데이터가 오고가는 속도를 조절해서 2.4Ghz 와이파이 대역의 채널에 데이터 버스에서 발산되는 주파수를 맞출 수 있지 않을까 하게 된 게 아이디어의 핵심이다. 이후 논문에는 CPU 클럭과 DDR-SDRAM의 대역폭 간의 관계를 안다는 전에 하에 설명이 이어지기 때문에, 만일 이해가 힘들 것 같다면 관련 개념을 훑어보고 오는 것을 추천한다.</p> <p>Wi-Fi는 현재 802.11b/g/n이 제일 많이 쓰이는데, 이들은 와이파이 대역폭을 14개의 채널로 나누고 각 채널은 20MHz의 대역폭을 가진다. 보통 1~13 채널까지는 각 채널 간에 5MHz의 공간을 두고 배치되고, 13채널과 14채널은 12MHz의 공간을 두고 배치된다. 이 14개 채널 중 전세계에서 공통으로 사용 가능한 채널은 1~11채널인 11개 채널뿐이다.</p> <p><br /><br /></p> <h1 id="sec5-sendertransmissin-입장의-기작">Sec5) Sender(transmissin) 입장의 기작</h1> <p><br /></p> <h2 id="51-signal-generation">5.1. Signal Generation</h2> <p><br /></p> <h3 id="511-전자기-신호-방출">5.1.1. 전자기 신호 방출</h3> <p><br /></p> <ul> <li> <p><strong>Persistent Emission</strong></p> <p>: 그냥 언제나 방출되는 전자기 신호.</p> </li> <li> <dl> <dt><strong>Triggered Emission</strong></dt> <dd>데이터 버스에서 데이터가 오고갈 때만 발생하는 전자기 신호로, 이 논문의 익스플로잇에 사용됨</dd> </dl> </li> </ul> <p><br /></p> <h3 id="512-wi-fi-신호를-어떻게-생성할-것인가">5.1.2. Wi-Fi 신호를 어떻게 생성할 것인가?</h3> <p><br /></p> <ul> <li> <p><strong>Memory Operations</strong></p> <p>: 요즘 DDR SDRAMS 전송속도가 802.11b/g/n 채널 주파수 대역에 걸쳐 있어서 가능한 방법. 데이터 버스에 데이터가 오고가는 걸 이용함</p> </li> <li> <dl> <dt><strong>Memory Operations + Clocking</strong></dt> <dd>만약 CPU 클럭이 못 받쳐주면 CPU 클럭을 BIOS/UEFI로 조정해서(이걸 손대는 악성코드 되게 많음) 버스에서 와이파이 대역과 일치하는 주파수의 전자기파가 방출되게 만듦</dd> </dl> </li> </ul> <p><br /></p> <h3 id="513-wi-fi-채널-간섭-현상은-어떻게-해결할-것인가">5.1.3. Wi-Fi 채널 간섭 현상은 어떻게 해결할 것인가?</h3> <ul> <li>2.44000 GHz 대역으로 데이터를 방출한다고 치면 채널 5~8에 모두 걸치는 대역이 되는데, 이는 타이밍 변수를 조절해서 한 채널만을 이용한 데이터 전송을 구현할 수 있으니 해결된다. 실제로 802.11b/g/n 의 채널별로 맞추어서 신호 송신을 해냈음.</li> </ul> <p><br /></p> <h2 id="52-signal-modulation">5.2. <strong>Signal Modulation</strong></h2> <p><br /></p> <ul> <li>언제: Wifi standard상으로 한 비트를 읽는 데 들이는 시간인 Bit time 동안</li> <li>전송하려는 데이터가 1이면: 데이터를 array에서 array로 옮기며 버스에서 전자기파가 방출되게 한다.</li> <li>전송하려는 데이터가 0이면 : 아무것도 하지 않는다. 주파수를 맞추기 위하여 PWM(Pulse-Width Modulation) 기술을 사용해서 푸리에 변환을 통해 캐리어 파동(연속파동)상에 직사각파(펄스파, 불연속파동)를 구현한다.</li> <li>캐싱은 어떻게 피하는가?: 1이 n 번 전송되면 array를 randomize 한다. 아니면 몇 개 array를 사용해서 그 중 사용할 array를 랜덤하게 선택하든가.</li> <li>멀티코어 구조를 이용할 수도 있음. governor 쓰레드의 통제를 받는 멀티스레딩을 통해서 한번에 발산하는 전자기파가 중첩이 되어 신호가 더 강해지게 하는 것.</li> </ul> <p><br /></p> <h2 id="53-data-transmission">5.3. <strong>Data Transmission</strong></h2> <p><br /></p> <ul> <li>패킷 구조는 어떻게 구성할 것인가? <ul> <li>Pre-amble: 패킷들을 구분하기 위한 헤더</li> <li>Payload: 모두가 아는 그것</li> <li>Error Detection: CRC-8 사용함</li> </ul> </li> </ul> <p><br /></p> <h1 id="sec6-receiver-입장의-기작">Sec6) Receiver 입장의 기작</h1> <p><br /><br /></p> <h2 id="61-개요">6.1. 개요</h2> <p><br /></p> <p>해커는 Receiver의 물리 레이어로 들어오는 raw data를 가져와야 한다. 이는 manufacturer가 기본 제공하는 UI를 사용해서도, WiFi 칩의 드라이버나 펌웨어를 변조해서도 가능하다. 이렇게 가져온 raw data를 소프트웨어 스택으로 던져주면 디코딩 등의 과정을 거쳐 usable data 가 된다.</p> <p><br /></p> <h2 id="62-physical-layer에-접근-가능한-wifi-스택의-레이어">6.2. Physical Layer에 접근 가능한 Wifi 스택의 레이어</h2> <p><br /></p> <h3 id="621-application-layer-user-level">6.2.1. Application Layer (user-level)</h3> <p><br /></p> <ul> <li><strong>설명:</strong> Command-line tools, Userspace APIs(Linux OS), Device I/O control(Windows OS) 을 통해 커널에서 유저애플리케이션으로 데이터 전송</li> <li><strong>공격 시나리오:</strong> 공격자가 디바이스의 루트 권한 탈취 WiFi 물리 레이어 모니터링용 프로세스나 스레드 시작 쉘코드 인젝션이나 쓰레드 인젝션을 통해 프로세스 인젝션을 수행해 보안 기능 회피</li> </ul> <p><br /></p> <h3 id="622-device-drivers-layer-kernel-layer">6.2.2. Device-Drivers Layer (kernel-layer)</h3> <p><br /></p> <ul> <li><strong>설명:</strong> 보통 칩셋들은 물리 레이어로 들어온 정보를 디바이스 드라이버(커널 레벨에서 돌아감)에게 토스함. 보통 물리 레이어로 들어온 정보를 ioctl 커맨드로 받아감.</li> <li><strong>공격 시나리오:</strong> 공격자가 디바이스를 원격으로 익스함 권한 상승 기법으로 커널스페이스에 코드 인젝션 인젝션된 코드가 와이파이 모듈에서 직접 정보를 쿼리해 오거나, 아니면 와이파이 드라이버를 변조하거나 replace해서 원하는 대로 동작하게 함</li> </ul> <p><br /></p> <h3 id="623-firmware-level">6.2.3. Firmware-Level</h3> <p><br /></p> <ul> <li><strong>설명:</strong> 임베디드 기기들이 와이파이 칩 관리에 펌웨어를 사용함. 그리고 보통 이 펌웨어는 OS를 탑재함. 즉 와이파이 칩 내부에서 모든 레이어의 연산이 이루어짐.</li> <li><strong>공격 시나리오:</strong> 공격자가 디바이스를 원격으로 익스함. 와이파이 펌웨어를 변조함(이때 커널스페이스를 돌리고, 펌웨어 파일 시스템을 변조할 수 있는 루트 권한이 필요해 매우 높은 수준의 기술이 필요함)</li> </ul> <p><br /></p> <h3 id="624-attack-surface-설정">6.2.4. Attack Surface 설정</h3> <p><br /></p> <ul> <li>방법 1은 업자들이 다 엠바고를 걸어서 정보가 없음. 따라서 방법 2와 방법 3이 유효함. 방법 3은 정말 높은 수준의 기술이 필요하지만 공격자들은 할 수 있음.</li> </ul> <p><br /><br /></p> <h1 id="sec7-실제-실험-방식-차후-수정본에서-업로드">Sec7) 실제 실험 방식 (차후 수정본에서 업로드)</h1> <p><br /></p> <p>(지금 이걸 구조화해서 쉽게 쓰기엔 배고파서 못하겠다… 밥먹고 할래 근데 엄청난 지점: VM상에서도 가능하다는 것. 피지컬 레이어가 복합된 VM 익스라고도 부를 수 있을 듯)</p> <p><br /><br /></p> <h1 id="sec8-countermeasures-차후-수정본에서-디테일-업로드">Sec8) Countermeasures (차후 수정본에서 디테일 업로드)</h1> <p><br /></p> <h2 id="81-물리적-분리">8.1. 물리적 분리</h2> <p><br /></p> <ul> <li>TEMPEST 쓰라는 말이다.</li> </ul> <p><br /></p> <h2 id="82-runtime-detection">8.2. Runtime Detection</h2> <p><br /></p> <p><br /></p> <h2 id="83-memory-access-monitor">8.3. Memory Access Monitor</h2> <p><br /></p> <p><br /></p> <h2 id="84-wi-fi-monitoring">8.4. Wi-Fi Monitoring</h2> <p><br /></p> <p><br /></p> <h2 id="85-signal-jamminghw">8.5. Signal Jamming(H/W)</h2> <p><br /></p> <p><br /></p> <h2 id="86-signal-jammingsw">8.6. Signal Jamming(S/W)</h2> <p><br /></p> <p><br /></p> <h2 id="87-faraday-shielding">8.7. Faraday Shielding</h2> <p><br /></p> <p><br /></p> <br /><!-- Load Facebook SDK for JavaScript --> <div id="fb-root"></div> <script> (function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0"; fjs.parentNode.insertBefore(js, fjs); })(document, "script", "facebook-jssdk"); </script> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8" ></script> <div class="share-page"> <p class="share-text">Share this on &rarr;</p> <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="large" data-show-count="false" style="margin-top:5px;" >Tweet</a > <a class="fb-share-button" data-href="http://localhost:4000/blog/paper_study/air-fi" data-size="large" data-layout="button" >Share</a> </div><!-- Author box --> <div class="card"> <div class="card-header"> About TouBVA </div> <div class="card-body"> <div class="row"> <div class="col-md-4"> <img class="author-profile-img" src="http://localhost:4000/assets/img/authors/toubva.jpeg" alt="TouBVA" /> </div> <div class="col-md-6"> <p class="author_bio">A Security Researcher, now concentrating on Security Consulting.</p> <p>Email : touBVa@gmail.com</p> <p>Website : https://toubva.github.io</p> <p class="profile-links"> <a class="social-link" href="https://github.com/TouBVa" target="_blank"><i class="fab fa-github fa-fw"></i></a> <a class="social-link" href="https://www.linkedin.com/in/johndoe" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a> <a class="social-link" href="https://www.youtube.com/channel/UCSfLBFFfNU9r6ihfei6VeJw" target="_blank"><i class="fab fa-youtube fa-fw"></i></a> <a class="social-link" href="https://www.facebook.com/johndoe" target="_blank"><i class="fab fa-facebook fa-fw"></i></a> <a class="social-link" href="https://www.twitter.com/johndoe" target="_blank"><i class="fab fa-twitter fa-fw"></i></a> </p> </div> </div> </div> </div> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <div id="disqus_thread", style="width: 95%; margin-left: 3%;"><script> var disqus_config = function () { this.page.url = "http://localhost:4000/blog/paper_study/air-fi"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/blog/paper_study/Air-Fi-Leaking-Data-From-Air-Gapped"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://toubva.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About TouBVa</div> <div class="card-body"> <p class="author_bio">Welcome to my world!</p><!-- Place this tag where you want the github button to render. --> <a class="github-button" href="https://github.com/touBVa/touBVa.github.io" data-color-scheme="no-preference: dark; light: dark; dark: dark;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star my blog on GitHub">Star</a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#dreamhack_system_hacking"></div> <li class="tag-head"> <a href="/blog/categories/dreamhack_system_hacking">dreamhack_system_hacking</a> </li> <a name="dreamhack_system_hacking"></a> <div id="#system_hacking"></div> <li class="tag-head"> <a href="/blog/categories/system_hacking">system_hacking</a> </li> <a name="system_hacking"></a> <div id="#protostar"></div> <li class="tag-head"> <a href="/blog/categories/protostar">protostar</a> </li> <a name="protostar"></a> <div id="#certification_study"></div> <li class="tag-head"> <a href="/blog/categories/certification_study">certification_study</a> </li> <a name="certification_study"></a> <div id="#paper_study"></div> <li class="tag-head"> <a href="/blog/categories/paper_study">paper_study</a> </li> <a name="paper_study"></a> <div id="#network_hacking"></div> <li class="tag-head"> <a href="/blog/categories/network_hacking">network_hacking</a> </li> <a name="network_hacking"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="http://localhost:4000/">Home</a> </li> <li> <a href="http://localhost:4000/about">About</a> </li> <li> <a href="http://localhost:4000/blog">Blog</a> </li> <li> <a href="http://localhost:4000/contact">Contact</a> </li> </div> </div> </div> </div> </div> </div> <div class="col-lg-12" id="newsletter_footer"><!-- Mailchimp Newletters --> <form action=""method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate> <div id="mc_embed_signup_scroll_footer"> <label for="mce-EMAIL_footer"> Signup for Weekly Email Newsletters :D</label> <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL_footer" placeholder="email address" required> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"> <input type="text" name="b_50bab1c85eae24ecfb0f68361_3a2dd721d0" tabindex="-1" value=""> </div><br /> <div class="clear"> <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe_footer" class="btn btn-lg btn-success"> </div> </div> </div><footer> <p> Powered by<a href="https://github.com/touBVa"> TouBVa</a>. Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'progressline', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> <script src="http://localhost:4000/assets/js/mode-switcher.js"></script> <script> if (window.netlifyIdentity) { window.netlifyIdentity.on("init", user => { if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); } }); } </script> </body> </html>
